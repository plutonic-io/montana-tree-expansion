var Ome=Object.defineProperty,Rme=Object.defineProperties,Lme=Object.getOwnPropertyDescriptors,Ng=Object.getOwnPropertySymbols,c3=Object.prototype.hasOwnProperty,u3=Object.prototype.propertyIsEnumerable,l3=(vt,nt,Re)=>nt in vt?Ome(vt,nt,{enumerable:!0,configurable:!0,writable:!0,value:Re}):vt[nt]=Re,k=(vt,nt)=>{for(var Re in nt||(nt={}))c3.call(nt,Re)&&l3(vt,Re,nt[Re]);if(Ng)for(var Re of Ng(nt))u3.call(nt,Re)&&l3(vt,Re,nt[Re]);return vt},X=(vt,nt)=>Rme(vt,Lme(nt)),XC=(vt,nt)=>{var Re={};for(var K in vt)c3.call(vt,K)&&nt.indexOf(K)<0&&(Re[K]=vt[K]);if(null!=vt&&Ng)for(var K of Ng(vt))nt.indexOf(K)<0&&u3.call(vt,K)&&(Re[K]=vt[K]);return Re};(self.webpackChunkmontana_tree=self.webpackChunkmontana_tree||[]).push([[179],{803:vt=>{"use strict";vt.exports=Re,vt.exports.default=Re;var nt=1e20;function Re(ee,be,$e,Ue,Ie,me){this.fontSize=ee||24,this.buffer=void 0===be?3:be,this.cutoff=Ue||.25,this.fontFamily=Ie||"sans-serif",this.fontWeight=me||"normal",this.radius=$e||8;var we=this.size=this.fontSize+2*this.buffer,re=we+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=we,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(re*re),this.gridInner=new Float64Array(re*re),this.f=new Float64Array(re),this.z=new Float64Array(re+1),this.v=new Uint16Array(re),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(we/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Qt(ee,be,$e,Ue,Ie,me){for(var we=0;we<be;we++)Ht(ee,we,be,$e,Ue,Ie,me);for(var re=0;re<$e;re++)Ht(ee,re*be,1,be,Ue,Ie,me)}function Ht(ee,be,$e,Ue,Ie,me,we){var re,xe,ut,bt;for(me[0]=0,we[0]=-nt,we[1]=nt,re=0;re<Ue;re++)Ie[re]=ee[be+re*$e];for(re=1,xe=0,ut=0;re<Ue;re++){do{ut=(Ie[re]-Ie[bt=me[xe]]+re*re-bt*bt)/(re-bt)/2}while(ut<=we[xe]&&--xe>-1);me[++xe]=re,we[xe]=ut,we[xe+1]=nt}for(re=0,xe=0;re<Ue;re++){for(;we[xe+1]<re;)xe++;ee[be+re*$e]=Ie[bt=me[xe]]+(re-bt)*(re-bt)}}Re.prototype._draw=function(ee,be){var me,we,re,xe,ut,bt,wt,cn,Qe,$e=this.ctx.measureText(ee),Ue=$e.width,Ie=2*this.buffer;be&&this.useMetrics?(ut=Math.floor($e.actualBoundingBoxAscent),cn=this.buffer+Math.ceil($e.actualBoundingBoxAscent),bt=this.buffer,wt=this.buffer,me=(we=Math.min(this.size,Math.ceil($e.actualBoundingBoxRight-$e.actualBoundingBoxLeft)))+Ie,re=(xe=Math.min(this.size-bt,Math.ceil($e.actualBoundingBoxAscent+$e.actualBoundingBoxDescent)))+Ie,this.ctx.textBaseline="alphabetic"):(me=we=this.size,re=xe=this.size,ut=19*this.fontSize/24,bt=wt=0,cn=this.middle,this.ctx.textBaseline="middle"),we&&xe&&(this.ctx.clearRect(wt,bt,we,xe),this.ctx.fillText(ee,this.buffer,cn),Qe=this.ctx.getImageData(wt,bt,we,xe));var Gt=new Uint8ClampedArray(me*re);return function K(ee,be,$e,Ue,Ie,me,we){me.fill(nt,0,be*$e),we.fill(0,0,be*$e);for(var re=(be-Ue)/2,xe=0;xe<Ie;xe++)for(var ut=0;ut<Ue;ut++){var bt=(xe+re)*be+ut+re,wt=ee.data[4*(xe*Ue+ut)+3]/255;if(1===wt)me[bt]=0,we[bt]=nt;else if(0===wt)me[bt]=nt,we[bt]=0;else{var cn=Math.max(0,.5-wt),Qe=Math.max(0,wt-.5);me[bt]=cn*cn,we[bt]=Qe*Qe}}}(Qe,me,re,we,xe,this.gridOuter,this.gridInner),Qt(this.gridOuter,me,re,this.f,this.v,this.z),Qt(this.gridInner,me,re,this.f,this.v,this.z),function ce(ee,be,$e,Ue,Ie,me,we){for(var re=0;re<be*$e;re++){var xe=Math.sqrt(Ue[re])-Math.sqrt(Ie[re]);ee[re]=Math.round(255-255*(xe/me+we))}}(Gt,me,re,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:Gt,metrics:{width:we,height:xe,sdfWidth:me,sdfHeight:re,top:ut,left:0,advance:Ue}}},Re.prototype.draw=function(ee){return this._draw(ee,!1).data},Re.prototype.drawWithMetrics=function(ee){return this._draw(ee,!0)}},105:(vt,nt,Re)=>{"use strict";function K(n){return"function"==typeof n}function ce(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Qt=ce(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Ht(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class ee{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(K(i))try{i()}catch(s){e=s instanceof Qt?s.errors:[s]}const{_teardowns:r}=this;if(r){this._teardowns=null;for(const s of r)try{Ue(s)}catch(o){e=null!=e?e:[],o instanceof Qt?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Qt(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Ue(e);else{if(e instanceof ee){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._teardowns=null!==(t=this._teardowns)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Ht(t,e)}remove(e){const{_teardowns:t}=this;t&&Ht(t,e),e instanceof ee&&e._removeParent(this)}}ee.EMPTY=(()=>{const n=new ee;return n.closed=!0,n})();const be=ee.EMPTY;function $e(n){return n instanceof ee||n&&"closed"in n&&K(n.remove)&&K(n.add)&&K(n.unsubscribe)}function Ue(n){K(n)?n():n.unsubscribe()}const Ie={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},me={setTimeout(...n){const{delegate:e}=me;return((null==e?void 0:e.setTimeout)||setTimeout)(...n)},clearTimeout(n){const{delegate:e}=me;return((null==e?void 0:e.clearTimeout)||clearTimeout)(n)},delegate:void 0};function we(n){me.setTimeout(()=>{const{onUnhandledError:e}=Ie;if(!e)throw n;e(n)})}function re(){}const xe=wt("C",void 0,void 0);function wt(n,e,t){return{kind:n,value:e,error:t}}let cn=null;function Qe(n){if(Ie.useDeprecatedSynchronousErrorHandling){const e=!cn;if(e&&(cn={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=cn;if(cn=null,t)throw i}}else n()}class Ji extends ee{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,$e(e)&&e.add(this)):this.destination=Ts}static create(e,t,i){return new yi(e,t,i)}next(e){this.isStopped?un(function bt(n){return wt("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?un(function ut(n){return wt("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?un(xe,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}class yi extends Ji{constructor(e,t,i){let r;if(super(),K(e))r=e;else if(e){let s;({next:r,error:t,complete:i}=e),this&&Ie.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe()):s=e,r=null==r?void 0:r.bind(s),t=null==t?void 0:t.bind(s),i=null==i?void 0:i.bind(s)}this.destination={next:r?Oi(r):re,error:Oi(null!=t?t:vi),complete:i?Oi(i):re}}}function Oi(n,e){return(...t)=>{try{n(...t)}catch(i){Ie.useDeprecatedSynchronousErrorHandling?function Gt(n){Ie.useDeprecatedSynchronousErrorHandling&&cn&&(cn.errorThrown=!0,cn.error=n)}(i):we(i)}}}function vi(n){throw n}function un(n,e){const{onStoppedNotification:t}=Ie;t&&me.setTimeout(()=>t(n,e))}const Ts={closed:!0,next:re,error:vi,complete:re},$n="function"==typeof Symbol&&Symbol.observable||"@@observable";function Rn(n){return n}let D=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const s=function S(n){return n&&n instanceof Ji||function P(n){return n&&K(n.next)&&K(n.error)&&K(n.complete)}(n)&&$e(n)}(t)?t:new yi(t,i,r);return Qe(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=w(i))((r,s)=>{let o;o=this.subscribe(a=>{try{t(a)}catch(l){s(l),null==o||o.unsubscribe()}},s,r)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[$n](){return this}pipe(...t){return function x(n){return 0===n.length?Rn:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}(t)(this)}toPromise(t){return new(t=w(t))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=e=>new n(e),n})();function w(n){var e;return null!==(e=null!=n?n:Ie.Promise)&&void 0!==e?e:Promise}const F=ce(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let O=(()=>{class n extends D{constructor(){super(),this.closed=!1,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new z(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new F}next(t){Qe(()=>{if(this._throwIfClosed(),!this.isStopped){const i=this.observers.slice();for(const r of i)r.next(t)}})}error(t){Qe(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Qe(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:s}=this;return i||r?be:(s.push(t),new ee(()=>Ht(s,t)))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:s}=this;i?t.error(r):s&&t.complete()}asObservable(){const t=new D;return t.source=this,t}}return n.create=(e,t)=>new z(e,t),n})();class z extends O{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:be}}function j(n){return K(null==n?void 0:n.lift)}function H(n){return e=>{if(j(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}class Q extends Ji{constructor(e,t,i,r,s){super(e),this.onFinalize=s,this._next=t?function(o){try{t(o)}catch(a){e.error(a)}}:super._next,this._error=r?function(o){try{r(o)}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(o){e.error(o)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}function W(n,e){return H((t,i)=>{let r=0;t.subscribe(new Q(i,s=>{i.next(n.call(e,s,r++))}))})}function tr(n){return this instanceof tr?(this.v=n,this):new tr(n)}function bi(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(h){i[h]&&(r[h]=function(f){return new Promise(function(p,m){s.push([h,f,p,m])>1||a(h,f)})})}function a(h,f){try{!function l(h){h.value instanceof tr?Promise.resolve(h.value.v).then(c,u):d(s[0][2],h)}(i[h](f))}catch(p){d(s[0][3],p)}}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}function zg(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function oo(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(o){return new Promise(function(a,l){!function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}(a,l,(o=n[s](o)).done,o.value)})}}}const $a=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Jo(n){return K(null==n?void 0:n.then)}function Ya(n){return K(n[$n])}function yh(n){return Symbol.asyncIterator&&K(null==n?void 0:n[Symbol.asyncIterator])}function vh(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const bh=function Wg(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function wh(n){return K(null==n?void 0:n[bh])}function ea(n){return bi(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield tr(t.read());if(r)return yield tr(void 0);yield yield tr(i)}}finally{t.releaseLock()}})}function xh(n){return K(null==n?void 0:n.getReader)}function ai(n){if(n instanceof D)return n;if(null!=n){if(Ya(n))return function Ch(n){return new D(e=>{const t=n[$n]();if(K(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if($a(n))return function Eh(n){return new D(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(Jo(n))return function Yc(n){return new D(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,we)})}(n);if(yh(n))return Mh(n);if(wh(n))return function qg(n){return new D(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(xh(n))return function $g(n){return Mh(ea(n))}(n)}throw vh(n)}function Mh(n){return new D(e=>{(function Th(n,e){var t,i,r,s;return function Ss(n,e,t,i){return new(t||(t=Promise))(function(s,o){function a(u){try{c(i.next(u))}catch(d){o(d)}}function l(u){try{c(i.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):function r(s){return s instanceof t?s:new t(function(o){o(s)})}(u.value).then(a,l)}c((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=zg(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function wr(n,e,t,i=0,r=!1){const s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function rn(n,e,t=1/0){return K(e)?rn((i,r)=>W((s,o)=>e(i,s,r,o))(ai(n(i,r))),t):("number"==typeof e&&(t=e),H((i,r)=>function Yg(n,e,t,i,r,s,o,a){const l=[];let c=0,u=0,d=!1;const h=()=>{d&&!l.length&&!c&&e.complete()},f=m=>c<i?p(m):l.push(m),p=m=>{s&&e.next(m),c++;let _=!1;ai(t(m,u++)).subscribe(new Q(e,y=>{null==r||r(y),s?f(y):e.next(y)},()=>{_=!0},void 0,()=>{if(_)try{for(c--;l.length&&c<i;){const y=l.shift();o?wr(e,o,()=>p(y)):p(y)}h()}catch(y){e.error(y)}}))};return n.subscribe(new Q(e,f,()=>{d=!0,h()})),()=>{null==a||a()}}(i,r,n,t)))}function Wr(n=1/0){return rn(Rn,n)}const xr=new D(n=>n.complete());function Za(n){return n&&K(n.schedule)}function Zc(n){return n[n.length-1]}function ta(n){return Za(Zc(n))?n.pop():void 0}function Kc(n,e=0){return H((t,i)=>{t.subscribe(new Q(i,r=>wr(i,n,()=>i.next(r),e),()=>wr(i,n,()=>i.complete(),e),r=>wr(i,n,()=>i.error(r),e)))})}function Qc(n,e=0){return H((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function lo(n,e){if(!n)throw new Error("Iterable cannot be null");return new D(t=>{wr(t,e,()=>{const i=n[Symbol.asyncIterator]();wr(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function vn(n,e){return e?function eu(n,e){if(null!=n){if(Ya(n))return function Dh(n,e){return ai(n).pipe(Qc(e),Kc(e))}(n,e);if($a(n))return function Ds(n,e){return new D(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(Jo(n))return function Jc(n,e){return ai(n).pipe(Qc(e),Kc(e))}(n,e);if(yh(n))return lo(n,e);if(wh(n))return function na(n,e){return new D(t=>{let i;return wr(t,e,()=>{i=n[bh](),wr(t,e,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void t.error(o)}s?t.complete():t.next(r)},0,!0)}),()=>K(null==i?void 0:i.return)&&i.return()})}(n,e);if(xh(n))return function Xa(n,e){return lo(ea(n),e)}(n,e)}throw vh(n)}(n,e):ai(n)}function Cr(...n){const e=ta(n),t=function Ah(n,e){return"number"==typeof Zc(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?ai(i[0]):Wr(t)(vn(i,e)):xr}function Mt(n){return n<=0?()=>xr:H((e,t)=>{let i=0;e.subscribe(new Q(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function qr(n,e,...t){return!0===e?(n(),null):!1===e?null:e(...t).pipe(Mt(1)).subscribe(()=>n())}function ot(n){for(let e in n)if(n[e]===ot)return e;throw Error("Could not find renamed property on target object.")}function Ri(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function ft(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(ft).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function wi(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const Er=ot({__forward_ref__:ot});function Je(n){return n.__forward_ref__=Je,n.toString=function(){return ft(this())},n}function Be(n){return ia(n)?n():n}function ia(n){return"function"==typeof n&&n.hasOwnProperty(Er)&&n.__forward_ref__===Je}class Xe extends Error{constructor(e,t){super(function ra(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function Pe(n){return"string"==typeof n?n:null==n?"":String(n)}function Tn(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Pe(n)}function Ka(n,e){const t=e?` in ${e}`:"";throw new Xe(-201,`No provider for ${Tn(n)} found${t}`)}function Tt(n,e){null==n&&function Ge(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function J(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Te(n){return{providers:n.providers||[],imports:n.imports||[]}}function Zg(n){return nE(n,kh)||nE(n,rE)}function nE(n,e){return n.hasOwnProperty(e)?n[e]:null}function iE(n){return n&&(n.hasOwnProperty(Xg)||n.hasOwnProperty(f3))?n[Xg]:null}const kh=ot({\u0275prov:ot}),Xg=ot({\u0275inj:ot}),rE=ot({ngInjectableDef:ot}),f3=ot({ngInjectorDef:ot});var Ve=(()=>((Ve=Ve||{})[Ve.Default=0]="Default",Ve[Ve.Host=1]="Host",Ve[Ve.Self=2]="Self",Ve[Ve.SkipSelf=4]="SkipSelf",Ve[Ve.Optional=8]="Optional",Ve))();let Kg;function uo(n){const e=Kg;return Kg=n,e}function sE(n,e,t){const i=Zg(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Ve.Optional?null:void 0!==e?e:void Ka(ft(n),"Injector")}function ho(n){return{toString:n}.toString()}var Sr=(()=>((Sr=Sr||{})[Sr.OnPush=0]="OnPush",Sr[Sr.Default=1]="Default",Sr))(),Ar=(()=>{return(n=Ar||(Ar={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Ar;var n})();const m3="undefined"!=typeof globalThis&&globalThis,g3="undefined"!=typeof window&&window,_3="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,kt=m3||"undefined"!=typeof global&&global||g3||_3,Qa={},Ft=[],Oh=ot({\u0275cmp:ot}),Qg=ot({\u0275dir:ot}),Jg=ot({\u0275pipe:ot}),oE=ot({\u0275mod:ot}),Is=ot({\u0275fac:ot}),iu=ot({__NG_ELEMENT_ID__:ot});let y3=0;function Ot(n){return ho(()=>{const t={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Sr.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||Ft,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Ar.Emulated,id:"c",styles:n.styles||Ft,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,s=n.features,o=n.pipes;return i.id+=y3++,i.inputs=uE(n.inputs,t),i.outputs=uE(n.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(aE):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(lE):null,i})}function aE(n){return Zn(n)||function fo(n){return n[Qg]||null}(n)}function lE(n){return function sa(n){return n[Jg]||null}(n)}const cE={};function Se(n){return ho(()=>{const e={type:n.type,bootstrap:n.bootstrap||Ft,declarations:n.declarations||Ft,imports:n.imports||Ft,exports:n.exports||Ft,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(cE[n.id]=n.type),e})}function uE(n,e){if(null==n)return Qa;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),t[r]=i,e&&(e[r]=s)}return t}const te=Ot;function Zn(n){return n[Oh]||null}function ir(n,e){const t=n[oE]||null;if(!t&&!0===e)throw new Error(`Type ${ft(n)} does not have '\u0275mod' property.`);return t}function $r(n){return Array.isArray(n)&&"object"==typeof n[1]}function Ir(n){return Array.isArray(n)&&!0===n[1]}function n_(n){return 0!=(8&n.flags)}function Nh(n){return 2==(2&n.flags)}function Bh(n){return 1==(1&n.flags)}function Pr(n){return null!==n.template}function E3(n){return 0!=(512&n[2])}function ca(n,e){return n.hasOwnProperty(Is)?n[Is]:null}class S3{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function fn(){return hE}function hE(n){return n.type.prototype.ngOnChanges&&(n.setInput=D3),A3}function A3(){const n=pE(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===Qa)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function D3(n,e,t,i){const r=pE(n)||function I3(n,e){return n[fE]=e}(n,{previous:Qa,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[t],l=o[a];s[a]=new S3(l&&l.currentValue,e,o===Qa),n[i]=e}fn.ngInherit=!0;const fE="__ngSimpleChanges__";function pE(n){return n[fE]||null}const mE="http://www.w3.org/2000/svg";let s_;function o_(){return void 0!==s_?s_:"undefined"!=typeof document?document:void 0}function sn(n){return!!n.listen}const _E={createRenderer:(n,e)=>o_()};function bn(n){for(;Array.isArray(n);)n=n[0];return n}function Vh(n,e){return bn(e[n])}function or(n,e){return bn(e[n.index])}function a_(n,e){return n.data[e]}function Fi(n,e){const t=e[n];return $r(t)?t:t[0]}function yE(n){return 4==(4&n[2])}function l_(n){return 128==(128&n[2])}function po(n,e){return null==e?null:n[e]}function vE(n){n[18]=0}function c_(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const Le={lFrame:SE(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function bE(){return Le.bindingsEnabled}function U(){return Le.lFrame.lView}function _t(){return Le.lFrame.tView}function rl(n){return Le.lFrame.contextLView=n,n[8]}function An(){let n=wE();for(;null!==n&&64===n.type;)n=n.parent;return n}function wE(){return Le.lFrame.currentTNode}function Yr(n,e){const t=Le.lFrame;t.currentTNode=n,t.isParent=e}function u_(){return Le.lFrame.isParent}function d_(){Le.lFrame.isParent=!1}function zh(){return Le.isInCheckNoChangesMode}function jh(n){Le.isInCheckNoChangesMode=n}function sl(){return Le.lFrame.bindingIndex++}function G3(n,e){const t=Le.lFrame;t.bindingIndex=t.bindingRootIndex=n,h_(e)}function h_(n){Le.lFrame.currentDirectiveIndex=n}function f_(n){const e=Le.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}function EE(){return Le.lFrame.currentQueryIndex}function p_(n){Le.lFrame.currentQueryIndex=n}function q3(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function ME(n,e,t){if(t&Ve.SkipSelf){let r=e,s=n;for(;!(r=r.parent,null!==r||t&Ve.Host||(r=q3(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;e=r,n=s}const i=Le.lFrame=TE();return i.currentTNode=e,i.lView=n,!0}function Uh(n){const e=TE(),t=n[1];Le.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function TE(){const n=Le.lFrame,e=null===n?null:n.child;return null===e?SE(n):e}function SE(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function AE(){const n=Le.lFrame;return Le.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const DE=AE;function Hh(){const n=AE();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function ui(){return Le.lFrame.selectedIndex}function mo(n){Le.lFrame.selectedIndex=n}function on(){const n=Le.lFrame;return a_(n.tView,n.selectedIndex)}function ol(){Le.lFrame.currentNamespace=mE}function Gh(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-t,o),a&&((n.contentHooks||(n.contentHooks=[])).push(t,a),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,a)),l&&(n.viewHooks||(n.viewHooks=[])).push(-t,l),c&&((n.viewHooks||(n.viewHooks=[])).push(t,c),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,c)),null!=u&&(n.destroyHooks||(n.destroyHooks=[])).push(t,u)}}function Wh(n,e,t){PE(n,e,3,t)}function qh(n,e,t,i){(3&n[2])===t&&PE(n,e,t,i)}function m_(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function PE(n,e,t,i){const s=null!=i?i:-1,o=e.length-1;let a=0;for(let l=void 0!==i?65535&n[18]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=i&&a>=i)break}else e[l]<0&&(n[18]+=65536),(a<s||-1==s)&&(J3(n,t,e,l),n[18]=(4294901760&n[18])+l+2),l++}function J3(n,e,t,i){const r=t[i]<0,s=t[i+1],a=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class lu{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function $h(n,e,t){const i=sn(n);let r=0;for(;r<t.length;){const s=t[r];if("number"==typeof s){if(0!==s)break;r++;const o=t[r++],a=t[r++],l=t[r++];i?n.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=t[++r];__(o)?i&&n.setProperty(e,o,a):i?n.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function kE(n){return 3===n||4===n||6===n}function __(n){return 64===n.charCodeAt(0)}function Yh(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||OE(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function OE(n,e,t,i,r){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function RE(n){return-1!==n}function al(n){return 32767&n}function ll(n,e){let t=function rV(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let y_=!0;function Zh(n){const e=y_;return y_=n,e}let sV=0;function uu(n,e){const t=b_(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,v_(i.data,n),v_(e,null),v_(i.blueprint,null));const r=Xh(n,e),s=n.injectorIndex;if(RE(r)){const o=al(r),a=ll(r,e),l=a[1].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function v_(n,e){n.push(0,0,0,0,0,0,0,0,e)}function b_(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function Xh(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function Kh(n,e,t){!function oV(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(iu)&&(i=t[iu]),null==i&&(i=t[iu]=sV++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function NE(n,e,t){if(t&Ve.Optional)return n;Ka(e,"NodeInjector")}function BE(n,e,t,i){if(t&Ve.Optional&&void 0===i&&(i=null),0==(t&(Ve.Self|Ve.Host))){const r=n[9],s=uo(void 0);try{return r?r.get(e,i,t&Ve.Optional):sE(e,i,t&Ve.Optional)}finally{uo(s)}}return NE(i,e,t)}function VE(n,e,t,i=Ve.Default,r){if(null!==n){const s=function uV(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(iu)?n[iu]:void 0;return"number"==typeof e?e>=0?255&e:lV:e}(t);if("function"==typeof s){if(!ME(e,n,i))return i&Ve.Host?NE(r,t,i):BE(e,t,i,r);try{const o=s(i);if(null!=o||i&Ve.Optional)return o;Ka(t)}finally{DE()}}else if("number"==typeof s){let o=null,a=b_(n,e),l=-1,c=i&Ve.Host?e[16][6]:null;for((-1===a||i&Ve.SkipSelf)&&(l=-1===a?Xh(n,e):e[a+8],-1!==l&&UE(i,!1)?(o=e[1],a=al(l),e=ll(l,e)):a=-1);-1!==a;){const u=e[1];if(jE(s,a,u.data)){const d=cV(a,e,t,o,i,c);if(d!==zE)return d}l=e[a+8],-1!==l&&UE(i,e[1].data[a+8]===c)&&jE(s,a,e)?(o=u,a=al(l),e=ll(l,e)):a=-1}}}return BE(e,t,i,r)}const zE={};function lV(){return new cl(An(),U())}function cV(n,e,t,i,r,s){const o=e[1],a=o.data[n+8],u=Qh(a,o,t,null==i?Nh(a)&&y_:i!=o&&0!=(3&a.type),r&Ve.Host&&s===a);return null!==u?du(e,o,u,a):zE}function Qh(n,e,t,i,r){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,u=s>>20,h=r?a+u:n.directiveEnd;for(let f=i?a:a+u;f<h;f++){const p=o[f];if(f<l&&t===p||f>=l&&p.type===t)return f}if(r){const f=o[l];if(f&&Pr(f)&&f.type===t)return l}return null}function du(n,e,t,i){let r=n[t];const s=e.data;if(function eV(n){return n instanceof lu}(r)){const o=r;o.resolving&&function tu(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new Xe(-200,`Circular dependency in DI detected for ${n}${t}`)}(Tn(s[t]));const a=Zh(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?uo(o.injectImpl):null;ME(n,i,Ve.Default);try{r=n[t]=o.factory(void 0,s,n,i),e.firstCreatePass&&t>=i.directiveStart&&function Q3(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const o=hE(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),s&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,s),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,s))}(t,s[t],e)}finally{null!==l&&uo(l),Zh(a),o.resolving=!1,DE()}}return r}function jE(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function UE(n,e){return!(n&Ve.Self||n&Ve.Host&&e)}class cl{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return VE(this._tNode,this._lView,e,i,t)}}function pn(n){return ho(()=>{const e=n.prototype.constructor,t=e[Is]||w_(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Is]||w_(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function w_(n){return ia(n)?()=>{const e=w_(Be(n));return e&&e()}:ca(n)}function Zr(n){return function aV(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const s=t[r];if(kE(s))break;if(0===s)r+=2;else if("number"==typeof s)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(s===e)return t[r+1];r+=2}}}return null}(An(),n)}const dl="__parameters__";function fl(n,e,t){return ho(()=>{const i=function x_(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(l,c,u){const d=l.hasOwnProperty(dl)?l[dl]:Object.defineProperty(l,dl,{value:[]})[dl];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(o),l}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class q{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=J({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}const hV=new q("AnalyzeForEntryComponents");function ar(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),ar(i,e)):e!==n&&e.push(i)}return e}function Xr(n,e){n.forEach(t=>Array.isArray(t)?Xr(t,e):e(t))}function GE(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Jh(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function pu(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function Ni(n,e,t){let i=pl(n,e);return i>=0?n[1|i]=t:(i=~i,function mV(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function E_(n,e){const t=pl(n,e);if(t>=0)return n[1|t]}function pl(n,e){return function $E(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<t];if(e===o)return s<<t;o>e?r=s:i=s+1}return~(r<<t)}(n,e,1)}const mu={},T_="__NG_DI_FLAG__",tf="ngTempTokenPath",xV=/\n/gm,ZE="__source",EV=ot({provide:String,useValue:ot});let gu;function XE(n){const e=gu;return gu=n,e}function MV(n,e=Ve.Default){if(void 0===gu)throw new Xe(203,"");return null===gu?sE(n,void 0,e):gu.get(n,e&Ve.Optional?null:void 0,e)}function L(n,e=Ve.Default){return(function p3(){return Kg}()||MV)(Be(n),e)}const nf=L;function S_(n){const e=[];for(let t=0;t<n.length;t++){const i=Be(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Xe(900,"");let r,s=Ve.Default;for(let o=0;o<i.length;o++){const a=i[o],l=TV(a);"number"==typeof l?-1===l?r=a.token:s|=l:r=a}e.push(L(r,s))}else e.push(L(i))}return e}function _u(n,e){return n[T_]=e,n.prototype[T_]=e,n}function TV(n){return n[T_]}const yu=_u(fl("Inject",n=>({token:n})),-1),Bi=_u(fl("Optional"),8),ua=_u(fl("SkipSelf"),4);let sf,af;function gl(n){var e;return(null===(e=function D_(){if(void 0===sf&&(sf=null,kt.trustedTypes))try{sf=kt.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch(n){}return sf}())||void 0===e?void 0:e.createHTML(n))||n}function nM(n){var e;return(null===(e=function I_(){if(void 0===af&&(af=null,kt.trustedTypes))try{af=kt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch(n){}return af}())||void 0===e?void 0:e.createHTML(n))||n}class da{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function Vi(n){return n instanceof da?n.changingThisBreaksApplicationSecurity:n}function Kr(n,e){const t=function sM(n){return n instanceof da&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see https://g.co/ng/security#xss)`)}return t===e}class ZV{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(gl(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(t){return null}}}class XV{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const i=this.inertDocument.createElement("body");t.appendChild(i)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=gl(e),t;const i=this.inertDocument.createElement("body");return i.innerHTML=gl(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(e){const t=e.attributes;for(let r=t.length-1;0<r;r--){const o=t.item(r).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&e.removeAttribute(o)}let i=e.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const QV=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,JV=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function bu(n){return(n=String(n)).match(QV)||n.match(JV)?n:"unsafe:"+n}function aM(n){return(n=String(n)).split(",").map(e=>bu(e.trim())).join(", ")}function Qr(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function wu(...n){const e={};for(const t of n)for(const i in t)t.hasOwnProperty(i)&&(e[i]=!0);return e}const lM=Qr("area,br,col,hr,img,wbr"),cM=Qr("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),uM=Qr("rp,rt"),P_=wu(lM,wu(cM,Qr("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),wu(uM,Qr("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),wu(uM,cM)),k_=Qr("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),O_=Qr("srcset"),dM=wu(k_,O_,Qr("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Qr("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),ez=Qr("script,style,template");class tz{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!P_.hasOwnProperty(t))return this.sanitizedSomething=!0,!ez.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),o=s.name,a=o.toLowerCase();if(!dM.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=s.value;k_[a]&&(l=bu(l)),O_[a]&&(l=aM(l)),this.buf.push(" ",o,'="',hM(l),'"')}return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();P_.hasOwnProperty(t)&&!lM.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(hM(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const nz=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,iz=/([^\#-~ |!])/g;function hM(n){return n.replace(/&/g,"&amp;").replace(nz,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(iz,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let lf;function fM(n,e){let t=null;try{lf=lf||function oM(n){const e=new XV(n);return function KV(){try{return!!(new window.DOMParser).parseFromString(gl(""),"text/html")}catch(n){return!1}}()?new ZV(e):e}(n);let i=e?String(e):"";t=lf.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=t.innerHTML,t=lf.getInertBodyElement(i)}while(i!==s);return gl((new tz).sanitizeChildren(R_(t)||t))}finally{if(t){const i=R_(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function R_(n){return"content"in n&&function rz(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var St=(()=>((St=St||{})[St.NONE=0]="NONE",St[St.HTML=1]="HTML",St[St.STYLE=2]="STYLE",St[St.SCRIPT=3]="SCRIPT",St[St.URL=4]="URL",St[St.RESOURCE_URL=5]="RESOURCE_URL",St))();function pM(n){const e=function xu(){const n=U();return n&&n[12]}();return e?nM(e.sanitize(St.HTML,n)||""):Kr(n,"HTML")?nM(Vi(n)):fM(o_(),Pe(n))}const _M="__ngContext__";function Kn(n,e){n[_M]=e}function N_(n){const e=function Cu(n){return n[_M]||null}(n);return e?Array.isArray(e)?e:e.lView:null}function V_(n){return n.ngOriginalError}function bz(n,...e){n.error(...e)}class _o{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),i=function vz(n){return n&&n.ngErrorLogger||bz}(e);i(this._console,"ERROR",e),t&&i(this._console,"ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&V_(e);for(;t&&V_(t);)t=V_(t);return t||null}}const xM=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(kt))();function Jr(n){return n instanceof Function?n():n}var zi=(()=>((zi=zi||{})[zi.Important=1]="Important",zi[zi.DashCase=2]="DashCase",zi))();function j_(n,e){return undefined(n,e)}function Eu(n){const e=n[3];return Ir(e)?e[3]:e}function U_(n){return SM(n[13])}function H_(n){return SM(n[4])}function SM(n){for(;null!==n&&!Ir(n);)n=n[4];return n}function yl(n,e,t,i,r){if(null!=i){let s,o=!1;Ir(i)?s=i:$r(i)&&(o=!0,i=i[0]);const a=bn(i);0===n&&null!==t?null==r?OM(e,t,a):ha(e,t,a,r||null,!0):1===n&&null!==t?ha(e,t,a,r||null,!0):2===n?function zM(n,e,t){const i=cf(n,e);i&&function Hz(n,e,t,i){sn(n)?n.removeChild(e,t,i):e.removeChild(t)}(n,i,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function qz(n,e,t,i,r){const s=t[7];s!==bn(t)&&yl(e,n,i,s,r);for(let a=10;a<t.length;a++){const l=t[a];Mu(l[1],l,n,e,i,s)}}(e,n,s,t,r)}}function W_(n,e,t){return sn(n)?n.createElement(e,t):null===t?n.createElement(e):n.createElementNS(t,e)}function DM(n,e){const t=n[9],i=t.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,c_(r,-1)),t.splice(i,1)}function q_(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&DM(r,i),e>0&&(n[t-1][4]=i[4]);const s=Jh(n,10+e);!function Lz(n,e){Mu(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function IM(n,e){if(!(256&e[2])){const t=e[11];sn(t)&&t.destroyNode&&Mu(n,e,t,3,null,null),function Bz(n){let e=n[13];if(!e)return $_(n[1],n);for(;e;){let t=null;if($r(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)$r(e)&&$_(e[1],e),e=e[3];null===e&&(e=n),$r(e)&&$_(e[1],e),t=e&&e[4]}e=t}}(e)}}function $_(n,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function Uz(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof lu)){const s=t[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],l=s[o+1];try{l.call(a)}finally{}}else try{s.call(r)}finally{}}}}(n,e),function jz(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+1],a="function"==typeof o?o(e):bn(e[o]),l=i[r=t[s+2]],c=t[s+3];"boolean"==typeof c?a.removeEventListener(t[s],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),s+=2}else{const o=i[r=t[s+1]];t[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();e[7]=null}}(n,e),1===e[1].type&&sn(e[11])&&e[11].destroy();const t=e[17];if(null!==t&&Ir(e[3])){t!==e[3]&&DM(t,e);const i=e[19];null!==i&&i.detachView(n)}}}function PM(n,e,t){return function kM(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===Ar.None||r===Ar.Emulated)return null}return or(i,t)}(n,e.parent,t)}function ha(n,e,t,i,r){sn(n)?n.insertBefore(e,t,i,r):e.insertBefore(t,i,r)}function OM(n,e,t){sn(n)?n.appendChild(e,t):e.appendChild(t)}function RM(n,e,t,i,r){null!==i?ha(n,e,t,i,r):OM(n,e,t)}function cf(n,e){return sn(n)?n.parentNode(e):e.parentNode}function LM(n,e,t){return NM(n,e,t)}let NM=function FM(n,e,t){return 40&n.type?or(n,t):null};function uf(n,e,t,i){const r=PM(n,i,e),s=e[11],a=LM(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let l=0;l<t.length;l++)RM(s,r,t[l],a,!1);else RM(s,r,t,a,!1)}function df(n,e){if(null!==e){const t=e.type;if(3&t)return or(e,n);if(4&t)return Z_(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return df(n,i);{const r=n[e.index];return Ir(r)?Z_(-1,r):bn(r)}}if(32&t)return j_(e,n)()||bn(n[e.index]);{const i=VM(n,e);return null!==i?Array.isArray(i)?i[0]:df(Eu(n[16]),i):df(n,e.next)}}return null}function VM(n,e){return null!==e?n[16][6].projection[e.projection]:null}function Z_(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return df(i,r)}return e[7]}function X_(n,e,t,i,r,s,o){for(;null!=t;){const a=i[t.index],l=t.type;if(o&&0===e&&(a&&Kn(bn(a),i),t.flags|=4),64!=(64&t.flags))if(8&l)X_(n,e,t.child,i,r,s,!1),yl(e,n,r,a,s);else if(32&l){const c=j_(t,i);let u;for(;u=c();)yl(e,n,r,u,s);yl(e,n,r,a,s)}else 16&l?jM(n,e,i,t,r,s):yl(e,n,r,a,s);t=o?t.projectionNext:t.next}}function Mu(n,e,t,i,r,s){X_(t,i,n.firstChild,e,r,s,!1)}function jM(n,e,t,i,r,s){const o=t[16],l=o[6].projection[i.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++)yl(e,n,r,l[c],s);else X_(n,e,l,o[3],r,s,!0)}function UM(n,e,t){sn(n)?n.setAttribute(e,"style",t):e.style.cssText=t}function K_(n,e,t){sn(n)?""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t):e.className=t}function HM(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=e.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}t=r+1}}const GM="ng-template";function Yz(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==HM(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function WM(n){return 4===n.type&&n.value!==GM}function Zz(n,e,t){return e===(4!==n.type||t?n.value:GM)}function Xz(n,e,t){let i=4;const r=n.attrs||[],s=function Jz(n){for(let e=0;e<n.length;e++)if(kE(n[e]))return e;return n.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!Zz(n,l,t)||""===l&&1===e.length){if(kr(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==n.attrs){if(!Yz(n.attrs,c,t)){if(kr(i))return!1;o=!0}continue}const d=Kz(8&i?"class":l,r,WM(n),t);if(-1===d){if(kr(i))return!1;o=!0;continue}if(""!==c){let h;h=d>s?"":r[d+1].toLowerCase();const f=8&i?h:null;if(f&&-1!==HM(f,c,0)||2&i&&c!==h){if(kr(i))return!1;o=!0}}}}else{if(!o&&!kr(i)&&!kr(l))return!1;if(o&&kr(l))continue;o=!1,i=l|1&i}}return kr(i)||o}function kr(n){return 0==(1&n)}function Kz(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let s=!1;for(;r<e.length;){const o=e[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++r];for(;"string"==typeof a;)a=e[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function ej(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function qM(n,e,t=!1){for(let i=0;i<e.length;i++)if(Xz(n,e[i],t))return!0;return!1}function tj(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function $M(n,e){return n?":not("+e.trim()+")":e}function nj(n){let e=n[0],t=1,i=2,r="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&i){const a=n[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!kr(o)&&(e+=$M(s,r),r=""),i=o,s=s||!kr(i);t++}return""!==r&&(e+=$M(s,r)),e}const ze={};function Fe(n){YM(_t(),U(),ui()+n,zh())}function YM(n,e,t,i){if(!i)if(3==(3&e[2])){const s=n.preOrderCheckHooks;null!==s&&Wh(e,s,t)}else{const s=n.preOrderHooks;null!==s&&qh(e,s,0,t)}mo(t)}function hf(n,e){return n<<17|e<<2}function Or(n){return n>>17&32767}function Q_(n){return 2|n}function Os(n){return(131068&n)>>2}function J_(n,e){return-131069&n|e<<2}function ey(n){return 1|n}function sT(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],s=t[i+1];if(-1!==s){const o=n.data[s];p_(r),o.contentQueries(2,e[s],s)}}}function Tu(n,e,t,i,r,s,o,a,l,c){const u=e.blueprint.slice();return u[0]=r,u[2]=140|i,vE(u),u[3]=u[15]=n,u[8]=t,u[10]=o||n&&n[10],u[11]=a||n&&n[11],u[12]=l||n&&n[12]||null,u[9]=c||n&&n[9]||null,u[6]=s,u[16]=2==e.type?n[16]:u,u}function vl(n,e,t,i,r){let s=n.data[e];if(null===s)s=function cy(n,e,t,i,r){const s=wE(),o=u_(),l=n.data[e]=function bj(n,e,t,i,r,s){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l)),l}(n,e,t,i,r),function H3(){return Le.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=t,s.value=i,s.attrs=r;const o=function au(){const n=Le.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return Yr(s,!0),s}function bl(n,e,t,i){if(0===t)return-1;const r=e.length;for(let s=0;s<t;s++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function Su(n,e,t){Uh(e);try{const i=n.viewQuery;null!==i&&yy(1,i,t);const r=n.template;null!==r&&oT(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&sT(n,e),n.staticViewQueries&&yy(2,n.viewQuery,t);const s=n.components;null!==s&&function _j(n,e){for(let t=0;t<e.length;t++)Bj(n,e[t])}(e,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,Hh()}}function wl(n,e,t,i){const r=e[2];if(256==(256&r))return;Uh(e);const s=zh();try{vE(e),function xE(n){return Le.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&oT(n,e,t,2,i);const o=3==(3&r);if(!s)if(o){const c=n.preOrderCheckHooks;null!==c&&Wh(e,c,null)}else{const c=n.preOrderHooks;null!==c&&qh(e,c,0,null),m_(e,0)}if(function Fj(n){for(let e=U_(n);null!==e;e=H_(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],s=r[3];0==(1024&r[2])&&c_(s,1),r[2]|=1024}}}(e),function Lj(n){for(let e=U_(n);null!==e;e=H_(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];l_(i)&&wl(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&sT(n,e),!s)if(o){const c=n.contentCheckHooks;null!==c&&Wh(e,c)}else{const c=n.contentHooks;null!==c&&qh(e,c,1),m_(e,1)}!function mj(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)mo(~r);else{const s=r,o=t[++i],a=t[++i];G3(o,s),a(2,e[s])}}}finally{mo(-1)}}(n,e);const a=n.components;null!==a&&function gj(n,e){for(let t=0;t<e.length;t++)Nj(n,e[t])}(e,a);const l=n.viewQuery;if(null!==l&&yy(2,l,i),!s)if(o){const c=n.viewCheckHooks;null!==c&&Wh(e,c)}else{const c=n.viewHooks;null!==c&&qh(e,c,2),m_(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,c_(e[3],-1))}finally{Hh()}}function yj(n,e,t,i){const r=e[10],s=!zh(),o=yE(e);try{s&&!o&&r.begin&&r.begin(),o&&Su(n,e,i),wl(n,e,t,i)}finally{s&&!o&&r.end&&r.end()}}function oT(n,e,t,i,r){const s=ui(),o=2&i;try{mo(-1),o&&e.length>20&&YM(n,e,20,zh()),t(i,r)}finally{mo(s)}}function aT(n,e,t){if(n_(e)){const r=e.directiveEnd;for(let s=e.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,t[s],s)}}}function uy(n,e,t){!bE()||(function Sj(n,e,t,i){const r=t.directiveStart,s=t.directiveEnd;n.firstCreatePass||uu(t,e),Kn(i,e);const o=t.initialInputs;for(let a=r;a<s;a++){const l=n.data[a],c=Pr(l);c&&kj(e,t,l);const u=du(e,n,a,t);Kn(u,e),null!==o&&Oj(0,a-r,u,l,0,o),c&&(Fi(t.index,e)[8]=u)}}(n,e,t,or(t,e)),128==(128&t.flags)&&function Aj(n,e,t){const i=t.directiveStart,r=t.directiveEnd,o=t.index,a=function W3(){return Le.lFrame.currentDirectiveIndex}();try{mo(o);for(let l=i;l<r;l++){const c=n.data[l],u=e[l];h_(l),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&mT(c,u)}}finally{mo(-1),h_(a)}}(n,e,t))}function dy(n,e,t=or){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?t(e,n):n[o];n[r++]=a}}}function lT(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=mf(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function mf(n,e,t,i,r,s,o,a,l,c){const u=20+i,d=u+r,h=function vj(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:ze);return t}(u,d),f="function"==typeof c?c():c;return h[1]={type:n,blueprint:h,template:t,queries:null,viewQuery:a,declTNode:e,data:h.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function dT(n,e,t,i){const r=wT(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&xT(n).push(i,r.length-1))}function hT(n,e,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(t=null===t?{}:t).hasOwnProperty(i)?t[i].push(e,r):t[i]=[e,r]}return t}function ji(n,e,t,i,r,s,o,a){const l=or(e,t);let u,c=e.inputs;!a&&null!=c&&(u=c[i])?(MT(n,t,u,i,r),Nh(e)&&function Cj(n,e){const t=Fi(e,n);16&t[2]||(t[2]|=64)}(t,e.index)):3&e.type&&(i=function xj(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,e.value||"",i):r,sn(s)?s.setProperty(l,i,r):__(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function hy(n,e,t,i){let r=!1;if(bE()){const s=function Dj(n,e,t){const i=n.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];qM(t,o.selectors,!1)&&(r||(r=[]),Kh(uu(t,e),n,o.type),Pr(o)?(gT(n,t),r.unshift(o)):r.push(o))}return r}(n,e,t),o=null===i?null:{"":-1};if(null!==s){r=!0,_T(t,n.data.length,s.length);for(let u=0;u<s.length;u++){const d=s[u];d.providersResolver&&d.providersResolver(d)}let a=!1,l=!1,c=bl(n,e,s.length,null);for(let u=0;u<s.length;u++){const d=s[u];t.mergedAttrs=Yh(t.mergedAttrs,d.hostAttrs),yT(n,t,e,c,d),Pj(c,d,o),null!==d.contentQueries&&(t.flags|=8),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(t.flags|=128);const h=d.type.prototype;!a&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),a=!0),!l&&(h.ngOnChanges||h.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),l=!0),c++}!function wj(n,e){const i=e.directiveEnd,r=n.data,s=e.attrs,o=[];let a=null,l=null;for(let c=e.directiveStart;c<i;c++){const u=r[c],d=u.inputs,h=null===s||WM(e)?null:Rj(d,s);o.push(h),a=hT(d,c,a),l=hT(u.outputs,c,l)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=l}(n,t)}o&&function Ij(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const s=t[e[r+1]];if(null==s)throw new Xe(-301,`Export of name '${e[r+1]}' not found!`);i.push(e[r],s)}}}(t,i,o)}return t.mergedAttrs=Yh(t.mergedAttrs,t.attrs),r}function pT(n,e,t,i,r,s){const o=s.hostBindings;if(o){let a=n.hostBindingOpCodes;null===a&&(a=n.hostBindingOpCodes=[]);const l=~e.index;(function Tj(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(a)!=l&&a.push(l),a.push(i,r,o)}}function mT(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function gT(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function Pj(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;Pr(e)&&(t[""]=n)}}function _T(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function yT(n,e,t,i,r){n.data[i]=r;const s=r.factory||(r.factory=ca(r.type)),o=new lu(s,Pr(r),null);n.blueprint[i]=o,t[i]=o,pT(n,e,0,i,bl(n,t,r.hostVars,ze),r)}function kj(n,e,t){const i=or(e,n),r=lT(t),s=n[10],o=gf(n,Tu(n,r,null,t.onPush?64:16,i,e,s,s.createRenderer(i,t),null,null));n[e.index]=o}function es(n,e,t,i,r,s){const o=or(n,e);!function fy(n,e,t,i,r,s,o){if(null==s)sn(n)?n.removeAttribute(e,r,t):e.removeAttribute(r);else{const a=null==o?Pe(s):o(s,i||"",r);sn(n)?n.setAttribute(e,r,a,t):t?e.setAttributeNS(t,r,a):e.setAttribute(r,a)}}(e[11],o,s,n.value,t,i,r)}function Oj(n,e,t,i,r,s){const o=s[e];if(null!==o){const a=i.setInput;for(let l=0;l<o.length;){const c=o[l++],u=o[l++],d=o[l++];null!==a?i.setInput(t,d,c,u):t[u]=d}}}function Rj(n,e){let t=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,n[r],e[i+1])),i+=2}else i+=2;else i+=4}return t}function vT(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function Nj(n,e){const t=Fi(e,n);if(l_(t)){const i=t[1];80&t[2]?wl(i,t,i.template,t[8]):t[5]>0&&py(t)}}function py(n){for(let i=U_(n);null!==i;i=H_(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];wl(o,s,o.template,s[8])}else s[5]>0&&py(s)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=Fi(t[i],n);l_(r)&&r[5]>0&&py(r)}}function Bj(n,e){const t=Fi(e,n),i=t[1];(function Vj(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),Su(i,t,t[8])}function gf(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function my(n){for(;n;){n[2]|=64;const e=Eu(n);if(E3(n)&&!e)return n;n=e}return null}function _y(n,e,t){const i=e[10];i.begin&&i.begin();try{wl(n,e,n.template,t)}catch(r){throw ET(e,r),r}finally{i.end&&i.end()}}function bT(n){!function gy(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],i=N_(t),r=i[1];yj(r,i,r.template,t)}}(n[8])}function yy(n,e,t){p_(0),e(n,t)}const Hj=(()=>Promise.resolve(null))();function wT(n){return n[7]||(n[7]=[])}function xT(n){return n.cleanup||(n.cleanup=[])}function CT(n,e,t){return(null===n||Pr(n))&&(t=function R3(n){for(;Array.isArray(n);){if("object"==typeof n[1])return n;n=n[0]}return null}(t[e.index])),t[11]}function ET(n,e){const t=n[9],i=t?t.get(_o,null):null;i&&i.handleError(e)}function MT(n,e,t,i,r){for(let s=0;s<t.length;){const o=t[s++],a=t[s++],l=e[o],c=n.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function Rs(n,e,t){const i=Vh(e,n);!function AM(n,e,t){sn(n)?n.setValue(e,t):e.textContent=t}(n[11],i,t)}function _f(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?r=wi(r,a):2==s&&(i=wi(i,a+": "+e[++o]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}const vy=new q("INJECTOR",-1);class TT{get(e,t=mu){if(t===mu){const i=new Error(`NullInjectorError: No provider for ${ft(e)}!`);throw i.name="NullInjectorError",i}return t}}const by=new q("Set Injector scope."),Au={},qj={};let wy;function ST(){return void 0===wy&&(wy=new TT),wy}function AT(n,e=null,t=null,i){const r=DT(n,e,t,i);return r._resolveInjectorDefTypes(),r}function DT(n,e=null,t=null,i){return new $j(n,t,e||ST(),i)}class $j{constructor(e,t,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];t&&Xr(t,a=>this.processProvider(a,e,t)),Xr([e],a=>this.processInjectorType(a,[],s)),this.records.set(vy,xl(void 0,this));const o=this.records.get(by);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof e?null:ft(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=mu,i=Ve.Default){this.assertNotDestroyed();const r=XE(this),s=uo(void 0);try{if(!(i&Ve.SkipSelf)){let a=this.records.get(e);if(void 0===a){const l=function tU(n){return"function"==typeof n||"object"==typeof n&&n instanceof q}(e)&&Zg(e);a=l&&this.injectableDefInScope(l)?xl(xy(e),Au):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(i&Ve.Self?ST():this.parent).get(e,t=i&Ve.Optional&&t===mu?null:t)}catch(o){if("NullInjectorError"===o.name){if((o[tf]=o[tf]||[]).unshift(ft(e)),r)throw o;return function SV(n,e,t,i){const r=n[tf];throw e[ZE]&&r.unshift(e[ZE]),n.message=function AV(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=ft(e);if(Array.isArray(e))r=e.map(ft).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):ft(a)))}r=`{${s.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(xV,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[tf]=null,n}(o,e,"R3InjectorError",this.source)}throw o}finally{uo(s),XE(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((i,r)=>e.push(ft(r))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Xe(205,"")}processInjectorType(e,t,i){if(!(e=Be(e)))return!1;let r=iE(e);const s=null==r&&e.ngModule||void 0,o=void 0===s?e:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=iE(s)),null==r)return!1;if(null!=r.imports&&!a){let u;i.push(o);try{Xr(r.imports,d=>{this.processInjectorType(d,t,i)&&(void 0===u&&(u=[]),u.push(d))})}finally{}if(void 0!==u)for(let d=0;d<u.length;d++){const{ngModule:h,providers:f}=u[d];Xr(f,p=>this.processProvider(p,h,f||Ft))}}this.injectorDefTypes.add(o);const l=ca(o)||(()=>new o);this.records.set(o,xl(l,Au));const c=r.providers;if(null!=c&&!a){const u=e;Xr(c,d=>this.processProvider(d,u,c))}return void 0!==s&&void 0!==e.providers}processProvider(e,t,i){let r=Cl(e=Be(e))?e:Be(e&&e.provide);const s=function Zj(n,e,t){return PT(n)?xl(void 0,n.useValue):xl(IT(n),Au)}(e);if(Cl(e)||!0!==e.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=xl(void 0,Au,!0),o.factory=()=>S_(o.multi),this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,s)}hydrate(e,t){return t.value===Au&&(t.value=qj,t.value=t.factory()),"object"==typeof t.value&&t.value&&function eU(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Be(e.providedIn);return"string"==typeof t?"any"===t||t===this.scope:this.injectorDefTypes.has(t)}}function xy(n){const e=Zg(n),t=null!==e?e.factory:ca(n);if(null!==t)return t;if(n instanceof q)throw new Xe(204,"");if(n instanceof Function)return function Yj(n){const e=n.length;if(e>0)throw pu(e,"?"),new Xe(204,"");const t=function d3(n){const e=n&&(n[kh]||n[rE]);if(e){const t=function h3(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Xe(204,"")}function IT(n,e,t){let i;if(Cl(n)){const r=Be(n);return ca(r)||xy(r)}if(PT(n))i=()=>Be(n.useValue);else if(function Kj(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...S_(n.deps||[]));else if(function Xj(n){return!(!n||!n.useExisting)}(n))i=()=>L(Be(n.useExisting));else{const r=Be(n&&(n.useClass||n.provide));if(!function Jj(n){return!!n.deps}(n))return ca(r)||xy(r);i=()=>new r(...S_(n.deps))}return i}function xl(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function PT(n){return null!==n&&"object"==typeof n&&EV in n}function Cl(n){return"function"==typeof n}let Nt=(()=>{class n{static create(t,i){var r;if(Array.isArray(t))return AT({name:""},i,t,"");{const s=null!==(r=t.name)&&void 0!==r?r:"";return AT({name:s},t.parent,t.providers,s)}}}return n.THROW_IF_NOT_FOUND=mu,n.NULL=new TT,n.\u0275prov=J({token:n,providedIn:"any",factory:()=>L(vy)}),n.__NG_ELEMENT_ID__=-1,n})();function cU(n,e){Gh(N_(n)[1],An())}function ke(n){let e=function HT(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(Pr(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Xe(903,"");r=e.\u0275dir}if(r){if(t){i.push(r);const o=n;o.inputs=My(n.inputs),o.declaredInputs=My(n.declaredInputs),o.outputs=My(n.outputs);const a=r.hostBindings;a&&fU(n,a);const l=r.viewQuery,c=r.contentQueries;if(l&&dU(n,l),c&&hU(n,c),Ri(n.inputs,r.inputs),Ri(n.declaredInputs,r.declaredInputs),Ri(n.outputs,r.outputs),Pr(r)&&r.data.animation){const u=n.data;u.animation=(u.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===ke&&(t=!1)}}e=Object.getPrototypeOf(e)}!function uU(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Yh(r.hostAttrs,t=Yh(t,r.hostAttrs))}}(i)}function My(n){return n===Qa?{}:n===Ft?[]:n}function dU(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function hU(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,s)=>{e(i,r,s),t(i,r,s)}:e}function fU(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}let yf=null;function El(){if(!yf){const n=kt.Symbol;if(n&&n.iterator)yf=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(yf=i)}}}return yf}function Du(n){return!!Ty(n)&&(Array.isArray(n)||!(n instanceof Map)&&El()in n)}function Ty(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Qn(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function yt(n,e,t,i){const r=U();return Qn(r,sl(),e)&&(_t(),es(on(),r,n,e,t,i)),yt}function Jn(n,e,t,i,r,s,o,a){const l=U(),c=_t(),u=n+20,d=c.firstCreatePass?function bU(n,e,t,i,r,s,o,a,l){const c=e.consts,u=vl(e,n,4,o||null,po(c,a));hy(e,t,u,po(c,l)),Gh(e,u);const d=u.tViews=mf(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,t,i,r,s,o):c.data[u];Yr(d,!1);const h=l[11].createComment("");uf(c,l,h,d),Kn(h,l),gf(l,l[u]=vT(h,l,h,d)),Bh(d)&&uy(c,l,d),null!=o&&dy(l,d,a)}function Ls(n){return function il(n,e){return n[e]}(function U3(){return Le.lFrame.contextLView}(),20+n)}function T(n,e=Ve.Default){const t=U();return null===t?L(n,e):VE(An(),t,Be(n),e)}function wf(){throw new Error("invalid")}function He(n,e,t){const i=U();return Qn(i,sl(),e)&&ji(_t(),on(),i,n,e,i[11],t,!1),He}function Py(n,e,t,i,r){const o=r?"class":"style";MT(n,t,e.inputs[o],o,i)}function ue(n,e,t,i){const r=U(),s=_t(),o=20+n,a=r[11],l=r[o]=W_(a,e,function K3(){return Le.lFrame.currentNamespace}()),c=s.firstCreatePass?function jU(n,e,t,i,r,s,o){const a=e.consts,c=vl(e,n,2,r,po(a,s));return hy(e,t,c,po(a,o)),null!==c.attrs&&_f(c,c.attrs,!1),null!==c.mergedAttrs&&_f(c,c.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,c),c}(o,s,r,0,e,t,i):s.data[o];Yr(c,!0);const u=c.mergedAttrs;null!==u&&$h(a,l,u);const d=c.classes;null!==d&&K_(a,l,d);const h=c.styles;null!==h&&UM(a,l,h),64!=(64&c.flags)&&uf(s,r,l,c),0===function N3(){return Le.lFrame.elementDepthCount}()&&Kn(l,r),function B3(){Le.lFrame.elementDepthCount++}(),Bh(c)&&(uy(s,r,c),aT(s,c,r)),null!==i&&dy(r,c)}function de(){let n=An();u_()?d_():(n=n.parent,Yr(n,!1));const e=n;!function V3(){Le.lFrame.elementDepthCount--}();const t=_t();t.firstCreatePass&&(Gh(t,n),n_(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function nV(n){return 0!=(16&n.flags)}(e)&&Py(t,e,U(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function iV(n){return 0!=(32&n.flags)}(e)&&Py(t,e,U(),e.stylesWithoutHost,!1)}function rt(n,e,t,i){ue(n,e,t,i),de()}function Ry(){return U()}function Pu(n){return!!n&&"function"==typeof n.then}const Ly=function cS(n){return!!n&&"function"==typeof n.subscribe};function At(n,e,t,i){const r=U(),s=_t(),o=An();return uS(s,r,r[11],o,n,e,!!t,i),At}function xf(n,e){const t=An(),i=U(),r=_t();return uS(r,i,CT(f_(r.data),t,i),t,n,e,!1),xf}function uS(n,e,t,i,r,s,o,a){const l=Bh(i),u=n.firstCreatePass&&xT(n),d=e[8],h=wT(e);let f=!0;if(3&i.type||a){const _=or(i,e),y=a?a(_):_,v=h.length,E=a?M=>a(bn(M[i.index])):i.index;if(sn(t)){let M=null;if(!a&&l&&(M=function GU(n,e,t,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===t&&r[s+1]===i){const a=e[7],l=r[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,r,i.index)),null!==M)(M.__ngLastListenerFn__||M).__ngNextListenerFn__=s,M.__ngLastListenerFn__=s,f=!1;else{s=Fy(i,e,d,s,!1);const R=t.listen(y,r,s);h.push(s,R),u&&u.push(r,E,v,v+1)}}else s=Fy(i,e,d,s,!0),y.addEventListener(r,s,o),h.push(s),u&&u.push(r,E,v,o)}else s=Fy(i,e,d,s,!1);const p=i.outputs;let m;if(f&&null!==p&&(m=p[r])){const _=m.length;if(_)for(let y=0;y<_;y+=2){const B=e[m[y]][m[y+1]].subscribe(s),V=h.length;h.push(s,B),u&&u.push(r,i.index,V,-(V+1))}}}function dS(n,e,t,i){try{return!1!==t(i)}catch(r){return ET(n,r),!1}}function Fy(n,e,t,i,r){return function s(o){if(o===Function)return i;const a=2&n.flags?Fi(n.index,e):e;0==(32&e[2])&&my(a);let l=dS(e,0,i,o),c=s.__ngNextListenerFn__;for(;c;)l=dS(e,0,c,o)&&l,c=c.__ngNextListenerFn__;return r&&!1===l&&(o.preventDefault(),o.returnValue=!1),l}}function ei(n=1){return function $3(n){return(Le.lFrame.contextLView=function Y3(n,e){for(;n>0;)e=e[15],n--;return e}(n,Le.lFrame.contextLView))[8]}(n)}function WU(n,e){let t=null;const i=function Qz(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const s=e[r];if("*"!==s){if(null===i?qM(n,s,!0):tj(i,s))return r}else t=r}return t}function cr(n){const e=U()[16][6];if(!e.projection){const i=e.projection=pu(n?n.length:1,null),r=i.slice();let s=e.child;for(;null!==s;){const o=n?WU(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function Ui(n,e=0,t){const i=U(),r=_t(),s=vl(r,20+n,16,null,t||null);null===s.projection&&(s.projection=e),d_(),64!=(64&s.flags)&&function Wz(n,e,t){jM(e[11],0,e,t,PM(n,t,e),LM(t.parent||e[6],t,e))}(r,i,s)}function wS(n,e,t,i,r){const s=n[t+1],o=null===e;let a=i?Or(s):Os(s),l=!1;for(;0!==a&&(!1===l||o);){const u=n[a+1];YU(n[a],e)&&(l=!0,n[a+1]=i?ey(u):Q_(u)),a=i?Or(u):Os(u)}l&&(n[t+1]=i?Q_(s):ey(s))}function YU(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&pl(n,e)>=0}function Fl(n,e,t){return Lr(n,e,t,!1),Fl}function Pn(n,e){return Lr(n,e,null,!0),Pn}function Lr(n,e,t,i){const r=U(),s=_t(),o=function ks(n){const e=Le.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}(2);s.firstUpdatePass&&function DS(n,e,t,i){const r=n.data;if(null===r[t+1]){const s=r[ui()],o=function AS(n,e){return e>=n.expandoStartIndex}(n,t);(function OS(n,e){return 0!=(n.flags&(e?16:32))})(s,i)&&null===e&&!o&&(e=!1),e=function r4(n,e,t,i){const r=f_(n);let s=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=ku(t=By(null,n,e,t,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==r)if(t=By(r,n,e,t,i),null===s){let l=function s4(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==Os(i))return n[Or(i)]}(n,e,i);void 0!==l&&Array.isArray(l)&&(l=By(null,n,e,l[1],i),l=ku(l,e.attrs,i),function o4(n,e,t,i){n[Or(t?e.classBindings:e.styleBindings)]=i}(n,e,i,l))}else s=function a4(n,e,t){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=ku(i,n[s].hostAttrs,t);return ku(i,e.attrs,t)}(n,e,i)}return void 0!==s&&(i?e.residualClasses=s:e.residualStyles=s),t}(r,s,e,i),function qU(n,e,t,i,r,s){let o=s?e.classBindings:e.styleBindings,a=Or(o),l=Os(o);n[i]=t;let u,c=!1;if(Array.isArray(t)){const d=t;u=d[1],(null===u||pl(d,u)>0)&&(c=!0)}else u=t;if(r)if(0!==l){const h=Or(n[a+1]);n[i+1]=hf(h,a),0!==h&&(n[h+1]=J_(n[h+1],i)),n[a+1]=function sj(n,e){return 131071&n|e<<17}(n[a+1],i)}else n[i+1]=hf(a,0),0!==a&&(n[a+1]=J_(n[a+1],i)),a=i;else n[i+1]=hf(l,0),0===a?a=i:n[l+1]=J_(n[l+1],i),l=i;c&&(n[i+1]=Q_(n[i+1])),wS(n,u,i,!0),wS(n,u,i,!1),function $U(n,e,t,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&pl(s,e)>=0&&(t[i+1]=ey(t[i+1]))}(e,u,n,i,s),o=hf(a,l),s?e.classBindings=o:e.styleBindings=o}(r,s,e,t,o,i)}}(s,n,o,i),e!==ze&&Qn(r,o,e)&&function PS(n,e,t,i,r,s,o,a){if(!(3&e.type))return;const l=n.data,c=l[a+1];Cf(function KM(n){return 1==(1&n)}(c)?kS(l,e,t,r,Os(c),o):void 0)||(Cf(s)||function XM(n){return 2==(2&n)}(c)&&(s=kS(l,null,t,r,a,o)),function $z(n,e,t,i,r){const s=sn(n);if(e)r?s?n.addClass(t,i):t.classList.add(i):s?n.removeClass(t,i):t.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:zi.DashCase;if(null==r)s?n.removeStyle(t,i,o):t.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=zi.Important),s?n.setStyle(t,i,r,o):t.style.setProperty(i,r,a?"important":"")}}}(i,o,Vh(ui(),t),r,s))}(s,s.data[ui()],r,r[11],n,r[o+1]=function u4(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=ft(Vi(n)))),n}(e,t),i,o)}function By(n,e,t,i,r){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],i=ku(i,s.hostAttrs,r),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),i}function ku(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Ni(n,o,!!t||e[++s]))}return void 0===n?null:n}function kS(n,e,t,i,r,s){const o=null===e;let a;for(;r>0;){const l=n[r],c=Array.isArray(l),u=c?l[1]:l,d=null===u;let h=t[r+1];h===ze&&(h=d?Ft:void 0);let f=d?E_(h,i):u===i?h:void 0;if(c&&!Cf(f)&&(f=E_(l,i)),Cf(f)&&(a=f,o))return a;const p=n[r+1];r=o?Or(p):Os(p)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=E_(l,i))}return a}function Cf(n){return void 0!==n}function Ei(n,e=""){const t=U(),i=_t(),r=n+20,s=i.firstCreatePass?vl(i,r,1,e,null):i.data[r],o=t[r]=function G_(n,e){return sn(n)?n.createText(e):n.createTextNode(e)}(t[11],e);uf(i,t,o,s),Yr(s,!1)}function rs(n){return Ef("",n,""),rs}function Ef(n,e,t){const i=U(),r=function Tl(n,e,t,i){return Qn(n,sl(),t)?e+Pe(t)+i:ze}(i,n,e,t);return r!==ze&&Rs(i,ui(),r),Ef}function Nl(n,e,t){const i=U();return Qn(i,sl(),e)&&ji(_t(),on(),i,n,e,i[11],t,!0),Nl}function Mf(n,e,t){const i=U();if(Qn(i,sl(),e)){const s=_t(),o=on();ji(s,o,i,n,e,CT(f_(s.data),o,i),t,!0)}return Mf}const pa=void 0;var I4=["en",[["a","p"],["AM","PM"],pa],[["AM","PM"],pa,pa],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],pa,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],pa,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",pa,"{1} 'at' {0}",pa],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function D4(n){const t=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}];let Bl={};function QS(n){return n in Bl||(Bl[n]=kt.ng&&kt.ng.common&&kt.ng.common.locales&&kt.ng.common.locales[n]),Bl[n]}var se=(()=>((se=se||{})[se.LocaleId=0]="LocaleId",se[se.DayPeriodsFormat=1]="DayPeriodsFormat",se[se.DayPeriodsStandalone=2]="DayPeriodsStandalone",se[se.DaysFormat=3]="DaysFormat",se[se.DaysStandalone=4]="DaysStandalone",se[se.MonthsFormat=5]="MonthsFormat",se[se.MonthsStandalone=6]="MonthsStandalone",se[se.Eras=7]="Eras",se[se.FirstDayOfWeek=8]="FirstDayOfWeek",se[se.WeekendRange=9]="WeekendRange",se[se.DateFormat=10]="DateFormat",se[se.TimeFormat=11]="TimeFormat",se[se.DateTimeFormat=12]="DateTimeFormat",se[se.NumberSymbols=13]="NumberSymbols",se[se.NumberFormats=14]="NumberFormats",se[se.CurrencyCode=15]="CurrencyCode",se[se.CurrencySymbol=16]="CurrencySymbol",se[se.CurrencyName=17]="CurrencyName",se[se.Currencies=18]="Currencies",se[se.Directionality=19]="Directionality",se[se.PluralCase=20]="PluralCase",se[se.ExtraData=21]="ExtraData",se))();const Tf="en-US";let JS=Tf;function jy(n,e,t,i,r){if(n=Be(n),Array.isArray(n))for(let s=0;s<n.length;s++)jy(n[s],e,t,i,r);else{const s=_t(),o=U();let a=Cl(n)?n:Be(n.provide),l=IT(n);const c=An(),u=1048575&c.providerIndexes,d=c.directiveStart,h=c.providerIndexes>>20;if(Cl(n)||!n.multi){const f=new lu(l,r,T),p=Hy(a,e,r?u:u+h,d);-1===p?(Kh(uu(c,o),s,a),Uy(s,n,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(f),o.push(f)):(t[p]=f,o[p]=f)}else{const f=Hy(a,e,u+h,d),p=Hy(a,e,u,u+h),m=f>=0&&t[f],_=p>=0&&t[p];if(r&&!_||!r&&!m){Kh(uu(c,o),s,a);const y=function DH(n,e,t,i,r){const s=new lu(n,t,T);return s.multi=[],s.index=e,s.componentProviders=0,CA(s,r,i&&!t),s}(r?AH:SH,t.length,r,i,l);!r&&_&&(t[p].providerFactory=y),Uy(s,n,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),t.push(y),o.push(y)}else Uy(s,n,f>-1?f:p,CA(t[r?p:f],l,!r&&i));!r&&i&&_&&t[p].componentProviders++}}}function Uy(n,e,t,i){const r=Cl(e),s=function Qj(n){return!!n.useClass}(e);if(r||s){const l=(s?Be(e.useClass):e).prototype.ngOnDestroy;if(l){const c=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const u=c.indexOf(t);-1===u?c.push(t,[i,l]):c[u+1].push(i,l)}else c.push(t,l)}}}function CA(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Hy(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function SH(n,e,t,i){return Gy(this.multi,[])}function AH(n,e,t,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=du(t,t[1],this.providerFactory.index,i);s=a.slice(0,o),Gy(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],Gy(r,s);return s}function Gy(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Ct(n,e=[]){return t=>{t.providersResolver=(i,r)=>function TH(n,e,t){const i=_t();if(i.firstCreatePass){const r=Pr(n);jy(t,i.data,i.blueprint,r,!0),jy(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class EA{}class kH{resolveComponentFactory(e){throw function PH(n){const e=Error(`No component factory found for ${ft(n)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=n,e}(e)}}let bo=(()=>{class n{}return n.NULL=new kH,n})();function OH(){return zl(An(),U())}function zl(n,e){return new pt(or(n,e))}let pt=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=OH,n})();function RH(n){return n instanceof pt?n.nativeElement:n}class Nu{}let Fs=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function FH(){const n=U(),t=Fi(An().index,n);return function LH(n){return n[11]}($r(t)?t:n)}(),n})(),NH=(()=>{class n{}return n.\u0275prov=J({token:n,providedIn:"root",factory:()=>null}),n})();class ma{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const BH=new ma("13.1.3"),Wy={};function Pf(n,e,t,i,r=!1){for(;null!==t;){const s=e[t.index];if(null!==s&&i.push(bn(s)),Ir(s))for(let a=10;a<s.length;a++){const l=s[a],c=l[1].firstChild;null!==c&&Pf(l[1],l,c,i)}const o=t.type;if(8&o)Pf(n,e,t.child,i);else if(32&o){const a=j_(t,e);let l;for(;l=a();)i.push(l)}else if(16&o){const a=VM(e,t);if(Array.isArray(a))i.push(...a);else{const l=Eu(e[16]);Pf(l[1],l,a,i,!0)}}t=r?t.projectionNext:t.next}return i}class Bu{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return Pf(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Ir(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(q_(e,i),Jh(t,i))}this._attachedToViewContainer=!1}IM(this._lView[1],this._lView)}onDestroy(e){dT(this._lView[1],this._lView,null,e)}markForCheck(){my(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){_y(this._lView[1],this._lView,this.context)}checkNoChanges(){!function jj(n,e,t){jh(!0);try{_y(n,e,t)}finally{jh(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Xe(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Nz(n,e){Mu(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Xe(902,"");this._appRef=e}}class VH extends Bu{constructor(e){super(e),this._view=e}detectChanges(){bT(this._view)}checkNoChanges(){!function Uj(n){jh(!0);try{bT(n)}finally{jh(!1)}}(this._view)}get context(){return null}}class TA extends bo{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=Zn(e);return new qy(t,this.ngModule)}}function SA(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}const jH=new q("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>xM});class qy extends EA{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function ij(n){return n.map(nj).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return SA(this.componentDef.inputs)}get outputs(){return SA(this.componentDef.outputs)}create(e,t,i,r){const s=(r=r||this.ngModule)?function UH(n,e){return{get:(t,i,r)=>{const s=n.get(t,Wy,r);return s!==Wy||i===Wy?s:e.get(t,i,r)}}}(e,r.injector):e,o=s.get(Nu,_E),a=s.get(NH,null),l=o.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",u=i?function uT(n,e,t){if(sn(n))return n.selectRootElement(e,t===Ar.ShadowDom);let i="string"==typeof e?n.querySelector(e):e;return i.textContent="",i}(l,i,this.componentDef.encapsulation):W_(o.createRenderer(null,this.componentDef),c,function zH(n){const e=n.toLowerCase();return"svg"===e?mE:"math"===e?"http://www.w3.org/1998/MathML/":null}(c)),d=this.componentDef.onPush?576:528,h=function UT(n,e){return{components:[],scheduler:n||xM,clean:Hj,playerHandler:e||null,flags:0}}(),f=mf(0,null,null,1,0,null,null,null,null,null),p=Tu(null,f,h,d,null,null,o,l,a,s);let m,_;Uh(p);try{const y=function zT(n,e,t,i,r,s){const o=t[1];t[20]=n;const l=vl(o,20,2,"#host",null),c=l.mergedAttrs=e.hostAttrs;null!==c&&(_f(l,c,!0),null!==n&&($h(r,n,c),null!==l.classes&&K_(r,n,l.classes),null!==l.styles&&UM(r,n,l.styles)));const u=i.createRenderer(n,e),d=Tu(t,lT(e),null,e.onPush?64:16,t[20],l,i,u,s||null,null);return o.firstCreatePass&&(Kh(uu(l,t),o,e.type),gT(o,l),_T(l,t.length,1)),gf(t,d),t[20]=d}(u,this.componentDef,p,o,l);if(u)if(i)$h(l,u,["ng-version",BH.full]);else{const{attrs:v,classes:E}=function rj(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&e.push(s,n[++i]):8===r&&t.push(s);else{if(!kr(r))break;r=s}i++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);v&&$h(l,u,v),E&&E.length>0&&K_(l,u,E.join(" "))}if(_=a_(f,20),void 0!==t){const v=_.projection=[];for(let E=0;E<this.ngContentSelectors.length;E++){const M=t[E];v.push(null!=M?Array.from(M):null)}}m=function jT(n,e,t,i,r){const s=t[1],o=function Mj(n,e,t){const i=An();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),yT(n,i,e,bl(n,e,1,null),t));const r=du(e,n,i.directiveStart,i);Kn(r,e);const s=or(i,e);return s&&Kn(s,e),r}(s,t,e);if(i.components.push(o),n[8]=o,r&&r.forEach(l=>l(o,e)),e.contentQueries){const l=An();e.contentQueries(1,o,l.directiveStart)}const a=An();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(mo(a.index),pT(t[1],a,0,a.directiveStart,a.directiveEnd,e),mT(e,o)),o}(y,this.componentDef,p,h,[cU]),Su(f,p,null)}finally{Hh()}return new GH(this.componentType,m,zl(_,p),p,_)}}class GH extends class IH{}{constructor(e,t,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=t,this.hostView=this.changeDetectorRef=new VH(r),this.componentType=e}get injector(){return new cl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}class Ns{}class AA{}const jl=new Map;class PA extends Ns{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new TA(this);const i=ir(e);this._bootstrapComponents=Jr(i.bootstrap),this._r3Injector=DT(e,t,[{provide:Ns,useValue:this},{provide:bo,useValue:this.componentFactoryResolver}],ft(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=Nt.THROW_IF_NOT_FOUND,i=Ve.Default){return e===Nt||e===Ns||e===vy?this:this._r3Injector.get(e,t,i)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class $y extends AA{constructor(e){super(),this.moduleType=e,null!==ir(e)&&function qH(n){const e=new Set;!function t(i){const r=ir(i,!0),s=r.id;null!==s&&(function DA(n,e,t){if(e&&e!==t)throw new Error(`Duplicate module registered for ${n} - ${ft(e)} vs ${ft(e.name)}`)}(s,jl.get(s),i),jl.set(s,i));const o=Jr(r.imports);for(const a of o)e.has(a)||(e.add(a),t(a))}(n)}(e)}create(e){return new PA(this.moduleType,e)}}function Vu(n,e,t,i){return function kA(n,e,t,i,r,s){const o=e+t;return Qn(n,o,r)?function ts(n,e,t){return n[e]=t}(n,o+1,s?i.call(s,r):i(r)):function zu(n,e){const t=n[e];return t===ze?void 0:t}(n,o+1)}(U(),function ci(){const n=Le.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}(),n,e,t,i)}function Yy(n){return e=>{setTimeout(n,void 0,e)}}const Oe=class u5 extends O{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var r,s,o;let a=e,l=t||(()=>null),c=i;if(e&&"object"==typeof e){const d=e;a=null===(r=d.next)||void 0===r?void 0:r.bind(d),l=null===(s=d.error)||void 0===s?void 0:s.bind(d),c=null===(o=d.complete)||void 0===o?void 0:o.bind(d)}this.__isAsync&&(l=Yy(l),a&&(a=Yy(a)),c&&(c=Yy(c)));const u=super.subscribe({next:a,error:l,complete:c});return e instanceof ee&&e.add(u),u}};function d5(){return this._results[El()]()}class Ul{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=El(),i=Ul.prototype;i[t]||(i[t]=d5)}get changes(){return this._changes||(this._changes=new Oe)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=ar(e);(this._changesDetected=!function fV(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=e[i];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let ur=(()=>{class n{}return n.__NG_ELEMENT_ID__=p5,n})();const h5=ur,f5=class extends h5{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e){const t=this._declarationTContainer.tViews,i=Tu(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(t)),Su(t,i,e),new Bu(i)}};function p5(){return kf(An(),U())}function kf(n,e){return 4&n.type?new f5(e,n,zl(n,e)):null}let Mi=(()=>{class n{}return n.__NG_ELEMENT_ID__=m5,n})();function m5(){return VA(An(),U())}const g5=Mi,NA=class extends g5{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return zl(this._hostTNode,this._hostLView)}get injector(){return new cl(this._hostTNode,this._hostLView)}get parentInjector(){const e=Xh(this._hostTNode,this._hostLView);if(RE(e)){const t=ll(e,this._hostLView),i=al(e);return new cl(t[1].data[i+8],t)}return new cl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=BA(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){const r=e.createEmbeddedView(t||{});return this.insert(r,i),r}createComponent(e,t,i,r,s){const o=e&&!function fu(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const d=t||{};a=d.index,i=d.injector,r=d.projectableNodes,s=d.ngModuleRef}const l=o?e:new qy(Zn(e)),c=i||this.parentInjector;if(!s&&null==l.ngModule&&c){const d=c.get(Ns,null);d&&(s=d)}const u=l.create(c,r,void 0,s);return this.insert(u.hostView,a),u}insert(e,t){const i=e._lView,r=i[1];if(function F3(n){return Ir(n[3])}(i)){const u=this.indexOf(e);if(-1!==u)this.detach(u);else{const d=i[3],h=new NA(d,d[6],d[3]);h.detach(h.indexOf(e))}}const s=this._adjustIndex(t),o=this._lContainer;!function Vz(n,e,t,i){const r=10+i,s=t.length;i>0&&(t[r-1][4]=e),i<s-10?(e[4]=t[r],GE(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const o=e[17];null!==o&&t!==o&&function zz(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(n),e[2]|=128}(r,i,o,s);const a=Z_(s,o),l=i[11],c=cf(l,o[7]);return null!==c&&function Fz(n,e,t,i,r,s){i[0]=r,i[6]=e,Mu(n,i,t,1,r,s)}(r,o[6],l,i,c,a),e.attachToViewContainerRef(),GE(Zy(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=BA(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=q_(this._lContainer,t);i&&(Jh(Zy(this._lContainer),t),IM(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=q_(this._lContainer,t);return i&&null!=Jh(Zy(this._lContainer),t)?new Bu(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function BA(n){return n[8]}function Zy(n){return n[8]||(n[8]=[])}function VA(n,e){let t;const i=e[n.index];if(Ir(i))t=i;else{let r;if(8&n.type)r=bn(i);else{const s=e[11];r=s.createComment("");const o=or(n,e);ha(s,cf(s,o),r,function Gz(n,e){return sn(n)?n.nextSibling(e):e.nextSibling}(s,o),!1)}e[n.index]=t=vT(i,e,r,n),gf(e,t)}return new NA(t,n,e)}class Xy{constructor(e){this.queryList=e,this.matches=null}clone(){return new Xy(this.queryList)}setDirty(){this.queryList.setDirty()}}class Ky{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let s=0;s<i;s++){const o=t.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new Ky(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==GA(e,t).matches&&this.queries[t].setDirty()}}class zA{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class Qy{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,s=this.getByIndex(i).embeddedTView(e,r);s&&(s.indexInDeclarationView=i,null!==t?t.push(s):t=[s])}return null!==t?new Qy(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Jy{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Jy(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(e,t,v5(t,s)),this.matchTNodeWithReadOption(e,t,Qh(t,e,s,!1,!1))}else i===ur?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Qh(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===pt||r===Mi||r===ur&&4&t.type)this.addMatch(t.index,-2);else{const s=Qh(t,e,r,!1,!1);null!==s&&this.addMatch(t.index,s)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function v5(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function w5(n,e,t,i){return-1===t?function b5(n,e){return 11&n.type?zl(n,e):4&n.type?kf(n,e):null}(e,n):-2===t?function x5(n,e,t){return t===pt?zl(e,n):t===ur?kf(e,n):t===Mi?VA(e,n):void 0}(n,e,i):du(n,n[1],t,e)}function jA(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const s=n.data,o=t.matches,a=[];for(let l=0;l<o.length;l+=2){const c=o[l];a.push(c<0?null:w5(e,s[c],o[l+1],t.metadata.read))}r.matches=a}return r.matches}function ev(n,e,t,i){const r=n.queries.getByIndex(t),s=r.matches;if(null!==s){const o=jA(n,e,r,t);for(let a=0;a<s.length;a+=2){const l=s[a];if(l>0)i.push(o[a/2]);else{const c=s[a+1],u=e[-l];for(let d=10;d<u.length;d++){const h=u[d];h[17]===h[3]&&ev(h[1],h,c,i)}if(null!==u[9]){const d=u[9];for(let h=0;h<d.length;h++){const f=d[h];ev(f[1],f,c,i)}}}}}return i}function Wt(n){const e=U(),t=_t(),i=EE();p_(i+1);const r=GA(t,i);if(n.dirty&&yE(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?ev(t,e,i,[]):jA(t,e,r,i);n.reset(s,RH),n.notifyOnChanges()}return!0}return!1}function Ti(n,e,t){const i=_t();i.firstCreatePass&&(HA(i,new zA(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),UA(i,U(),e)}function dr(n,e,t,i){const r=_t();if(r.firstCreatePass){const s=An();HA(r,new zA(e,t,i),s.index),function E5(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),2==(2&t)&&(r.staticContentQueries=!0)}UA(r,U(),t)}function qt(){return function C5(n,e){return n[19].queries[e].queryList}(U(),EE())}function UA(n,e,t){const i=new Ul(4==(4&t));dT(n,e,i,i.destroy),null===e[19]&&(e[19]=new Ky),e[19].queries.push(new Xy(i))}function HA(n,e,t){null===n.queries&&(n.queries=new Qy),n.queries.track(new Jy(e,t))}function GA(n,e){return n.queries.getByIndex(e)}function Lf(...n){}const Hu=new q("Application Initializer");let Gl=(()=>{class n{constructor(t){this.appInits=t,this.resolve=Lf,this.reject=Lf,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(Pu(s))t.push(s);else if(Ly(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(L(Hu,8))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();const Gu=new q("AppId"),H5={provide:Gu,useFactory:function U5(){return`${ov()}${ov()}${ov()}`},deps:[]};function ov(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const l1=new q("Platform Initializer"),Wl=new q("Platform ID"),c1=new q("appBootstrapListener");let u1=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();const Bs=new q("LocaleId"),d1=new q("DefaultCurrencyCode");class G5{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let Ff=(()=>{class n{compileModuleSync(t){return new $y(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),s=Jr(ir(t).declarations).reduce((o,a)=>{const l=Zn(a);return l&&o.push(new qy(l)),o},[]);return new G5(i,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();const q5=(()=>Promise.resolve(0))();function av(n){"undefined"==typeof Zone?q5.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class _e{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Oe(!1),this.onMicrotaskEmpty=new Oe(!1),this.onStable=new Oe(!1),this.onError=new Oe(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function $5(){let n=kt.requestAnimationFrame,e=kt.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function X5(n){const e=()=>{!function Z5(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(kt,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,cv(n),n.isCheckStableRunning=!0,lv(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),cv(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,s,o,a)=>{try{return h1(n),t.invokeTask(r,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),f1(n)}},onInvoke:(t,i,r,s,o,a,l)=>{try{return h1(n),t.invoke(r,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),f1(n)}},onHasTask:(t,i,r,s)=>{t.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,cv(n),lv(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,i,r,s)=>(t.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!_e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(_e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,Y5,Lf,Lf);try{return s.runTask(o,t,i)}finally{s.cancelTask(o)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const Y5={};function lv(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function cv(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function h1(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function f1(n){n._nesting--,lv(n)}class K5{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Oe,this.onMicrotaskEmpty=new Oe,this.onStable=new Oe,this.onError=new Oe}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}let uv=(()=>{class n{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{_e.assertNotInAngularZone(),av(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())av(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(L(_e))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})(),p1=(()=>{class n{constructor(){this._applications=new Map,dv.addToWindow(this)}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return dv.findTestabilityInTree(this,t,i)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();class Q5{addToWindow(e){}findTestabilityInTree(e,t,i){return null}}let Nr,dv=new Q5;const m1=new q("AllowMultipleToken");class g1{constructor(e,t){this.name=e,this.token=t}}function _1(n,e,t=[]){const i=`Platform: ${e}`,r=new q(i);return(s=[])=>{let o=y1();if(!o||o.injector.get(m1,!1))if(n)n(t.concat(s).concat({provide:r,useValue:!0}));else{const a=t.concat(s).concat({provide:r,useValue:!0},{provide:by,useValue:"platform"});!function n6(n){if(Nr&&!Nr.destroyed&&!Nr.injector.get(m1,!1))throw new Xe(400,"");Nr=n.get(v1);const e=n.get(l1,null);e&&e.forEach(t=>t())}(Nt.create({providers:a,name:i}))}return function r6(n){const e=y1();if(!e)throw new Xe(401,"");return e}()}}function y1(){return Nr&&!Nr.destroyed?Nr:null}let v1=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const a=function s6(n,e){let t;return t="noop"===n?new K5:("zone.js"===n?void 0:n)||new _e({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),t}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),l=[{provide:_e,useValue:a}];return a.run(()=>{const c=Nt.create({providers:l,parent:this.injector,name:t.moduleType.name}),u=t.create(c),d=u.injector.get(_o,null);if(!d)throw new Xe(402,"");return a.runOutsideAngular(()=>{const h=a.onError.subscribe({next:f=>{d.handleError(f)}});u.onDestroy(()=>{hv(this._modules,u),h.unsubscribe()})}),function o6(n,e,t){try{const i=t();return Pu(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(d,a,()=>{const h=u.injector.get(Gl);return h.runInitializers(),h.donePromise.then(()=>(function L4(n){Tt(n,"Expected localeId to be defined"),"string"==typeof n&&(JS=n.toLowerCase().replace(/_/g,"-"))}(u.injector.get(Bs,Tf)||Tf),this._moduleDoBootstrap(u),u))})})}bootstrapModule(t,i=[]){const r=b1({},i);return function e6(n,e,t){const i=new $y(t);return Promise.resolve(i)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(t){const i=t.injector.get(ql);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new Xe(403,"");t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Xe(404,"");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(L(Nt))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();function b1(n,e){return Array.isArray(e)?e.reduce(b1,n):Object.assign(Object.assign({},n),e)}let ql=(()=>{class n{constructor(t,i,r,s,o){this._zone=t,this._injector=i,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new D(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),l=new D(c=>{let u;this._zone.runOutsideAngular(()=>{u=this._zone.onStable.subscribe(()=>{_e.assertNotInAngularZone(),av(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const d=this._zone.onUnstable.subscribe(()=>{_e.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{u.unsubscribe(),d.unsubscribe()}});this.isStable=Cr(a,l.pipe(function li(n={}){const{connector:e=(()=>new O),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o=null,a=null,l=null,c=0,u=!1,d=!1;const h=()=>{null==a||a.unsubscribe(),a=null},f=()=>{h(),o=l=null,u=d=!1},p=()=>{const m=o;f(),null==m||m.unsubscribe()};return H((m,_)=>{c++,!d&&!u&&h();const y=l=null!=l?l:e();_.add(()=>{c--,0===c&&!d&&!u&&(a=qr(p,r))}),y.subscribe(_),o||(o=new yi({next:v=>y.next(v),error:v=>{d=!0,h(),a=qr(f,t,v),y.error(v)},complete:()=>{u=!0,h(),a=qr(f,i),y.complete()}}),vn(m).subscribe(o))})(s)}}()))}bootstrap(t,i){if(!this._initStatus.done)throw new Xe(405,"");let r;r=t instanceof EA?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(r.componentType);const s=function t6(n){return n.isBoundToModule}(r)?void 0:this._injector.get(Ns),a=r.create(Nt.NULL,[],i||r.selector,s),l=a.location.nativeElement,c=a.injector.get(uv,null),u=c&&a.injector.get(p1);return c&&u&&u.registerApplication(l,c),a.onDestroy(()=>{this.detachView(a.hostView),hv(this.components,a),u&&u.unregisterApplication(l)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new Xe(101,"");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;hv(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(c1,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(t){return new(t||n)(L(_e),L(Nt),L(_o),L(bo),L(Gl))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();function hv(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let x1=!0,Fn=(()=>{class n{}return n.__NG_ELEMENT_ID__=c6,n})();function c6(n){return function u6(n,e,t){if(Nh(n)&&!t){const i=Fi(n.index,e);return new Bu(i,i)}return 47&n.type?new Bu(e[16],e):null}(An(),U(),16==(16&n))}class D1{constructor(){}supports(e){return Du(e)}create(e){return new g6(e)}}const m6=(n,e)=>e;class g6{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||m6}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,i=this._removalsHead,r=0,s=null;for(;t||i;){const o=!i||t&&t.currentIndex<P1(i,r,s)?t:i,a=P1(o,r,s),l=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{s||(s=[]);const c=a-r,u=l-r;if(c!=u){for(let h=0;h<c;h++){const f=h<s.length?s[h]:s[h]=0,p=f+h;u<=p&&p<c&&(s[h]=f+1)}s[o.previousIndex]=u-c}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!Du(e))throw new Xe(900,"");return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let r,s,o,t=this._itHead,i=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),i=!0),t=t._next}else r=0,function vU(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[El()]();let i;for(;!(i=t.next()).done;)e(i.value)}}(e,a=>{o=this._trackByFn(r,a),null!==t&&Object.is(t.trackById,o)?(i&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,i,r){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new _6(t,i),s,r),e}_verifyReinsertion(e,t,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const r=e._prevRemoved,s=e._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,i),this._addToMoves(e,i),e}_moveAfter(e,t,i){return this._unlink(e),this._insertAfter(e,t,i),this._addToMoves(e,i),e}_addAfter(e,t,i){return this._insertAfter(e,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,i){const r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new I1),this._linkedRecords.put(e),e.currentIndex=i,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,i=e._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new I1),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class _6{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class y6{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,e))return i;return null}remove(e){const t=e._prevDup,i=e._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class I1{constructor(){this.map=new Map}put(e){const t=e.trackById;let i=this.map.get(t);i||(i=new y6,this.map.set(t,i)),i.add(e)}get(e,t){const r=this.map.get(e);return r?r.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function P1(n,e,t){const i=n.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+e+r}class k1{constructor(){}supports(e){return e instanceof Map||Ty(e)}create(){return new v6}}class v6{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||Ty(e)))throw new Xe(900,"")}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new b6(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class b6{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function O1(){return new Wu([new D1])}let Wu=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||O1()),deps:[[n,new ua,new Bi]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new Xe(901,"")}}return n.\u0275prov=J({token:n,providedIn:"root",factory:O1}),n})();function R1(){return new $l([new k1])}let $l=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||R1()),deps:[[n,new ua,new Bi]]}}find(t){const i=this.factories.find(s=>s.supports(t));if(i)return i;throw new Xe(901,"")}}return n.\u0275prov=J({token:n,providedIn:"root",factory:R1}),n})();const w6=[new k1],C6=new Wu([new D1]),E6=new $l(w6),M6=_1(null,"core",[{provide:Wl,useValue:"unknown"},{provide:v1,deps:[Nt]},{provide:p1,deps:[]},{provide:u1,deps:[]}]),I6=[{provide:ql,useClass:ql,deps:[_e,Nt,_o,bo,Gl]},{provide:jH,deps:[_e],useFactory:function P6(n){let e=[];return n.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:Gl,useClass:Gl,deps:[[new Bi,Hu]]},{provide:Ff,useClass:Ff,deps:[]},H5,{provide:Wu,useFactory:function T6(){return C6},deps:[]},{provide:$l,useFactory:function S6(){return E6},deps:[]},{provide:Bs,useFactory:function A6(n){return n||function D6(){return"undefined"!=typeof $localize&&$localize.locale||Tf}()},deps:[[new yu(Bs),new Bi,new ua]]},{provide:d1,useValue:"USD"}];let k6=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(L(ql))},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:I6}),n})(),Bf=null;function ss(){return Bf}const je=new q("DocumentToken");let _a=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=J({token:n,factory:function(){return function F6(){return L(L1)}()},providedIn:"platform"}),n})();const N6=new q("Location Initialized");let L1=(()=>{class n extends _a{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ss().getBaseHref(this._doc)}onPopState(t){const i=ss().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=ss().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,i,r){F1()?this._history.pushState(t,i,r):this.location.hash=r}replaceState(t,i,r){F1()?this._history.replaceState(t,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(L(je))},n.\u0275prov=J({token:n,factory:function(){return function B6(){return new L1(L(je))}()},providedIn:"platform"}),n})();function F1(){return!!window.history.pushState}function _v(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function N1(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Vs(n){return n&&"?"!==n[0]?"?"+n:n}let Yl=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=J({token:n,factory:function(){return function V6(n){const e=L(je).location;return new B1(L(_a),e&&e.origin||"")}()},providedIn:"root"}),n})();const yv=new q("appBaseHref");let B1=(()=>{class n extends Yl{constructor(t,i){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return _v(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Vs(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,s){const o=this.prepareExternalUrl(r+Vs(s));this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){const o=this.prepareExternalUrl(r+Vs(s));this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(L(_a),L(yv,8))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})(),z6=(()=>{class n extends Yl{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=_v(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,s){let o=this.prepareExternalUrl(r+Vs(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,i,o)}replaceState(t,i,r,s){let o=this.prepareExternalUrl(r+Vs(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(L(_a),L(yv,8))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})(),Zl=(()=>{class n{constructor(t,i){this._subject=new Oe,this._urlChangeListeners=[],this._platformStrategy=t;const r=this._platformStrategy.getBaseHref();this._platformLocation=i,this._baseHref=N1(V1(r)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Vs(i))}normalize(t){return n.stripTrailingSlash(function U6(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,V1(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._platformStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Vs(i)),r)}replaceState(t,i="",r=null){this._platformStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Vs(i)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var i,r;null===(r=(i=this._platformStrategy).historyGo)||void 0===r||r.call(i,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}))}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=Vs,n.joinWithSlash=_v,n.stripTrailingSlash=N1,n.\u0275fac=function(t){return new(t||n)(L(Yl),L(_a))},n.\u0275prov=J({token:n,factory:function(){return function j6(){return new Zl(L(Yl),L(_a))}()},providedIn:"root"}),n})();function V1(n){return n.replace(/\/index.html$/,"")}var wn=(()=>((wn=wn||{})[wn.Zero=0]="Zero",wn[wn.One=1]="One",wn[wn.Two=2]="Two",wn[wn.Few=3]="Few",wn[wn.Many=4]="Many",wn[wn.Other=5]="Other",wn))();const Z6=function KS(n){return function hi(n){const e=function P4(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=QS(e);if(t)return t;const i=e.split("-")[0];if(t=QS(i),t)return t;if("en"===i)return I4;throw new Error(`Missing locale data for the locale "${n}".`)}(n)[se.PluralCase]};class Yf{}let EG=(()=>{class n extends Yf{constructor(t){super(),this.locale=t}getPluralCategory(t,i){switch(Z6(i||this.locale)(t)){case wn.Zero:return"zero";case wn.One:return"one";case wn.Two:return"two";case wn.Few:return"few";case wn.Many:return"many";default:return"other"}}}return n.\u0275fac=function(t){return new(t||n)(L(Bs))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();function Y1(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,s]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}let Z1=(()=>{class n{constructor(t,i,r,s){this._iterableDiffers=t,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&(Du(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),t.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),t.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${ft(i.item)}`);this._toggleClass(i.item,!0)}),t.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(i=>this._toggleClass(i,!0)):Object.keys(t).forEach(i=>this._toggleClass(i,!!t[i])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(i=>this._toggleClass(i,!1)):Object.keys(t).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(t,i){(t=t.trim())&&t.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return n.\u0275fac=function(t){return new(t||n)(T(Wu),T($l),T(pt),T(Fs))},n.\u0275dir=te({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),n})();class TG{constructor(e,t,i,r){this.$implicit=e,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Sv=(()=>{class n{constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new TG(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),X1(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{X1(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(T(Mi),T(ur),T(Wu))},n.\u0275dir=te({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();function X1(n,e){n.context.$implicit=e.item}let Xl=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new SG,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){K1("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){K1("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(T(Mi),T(ur))},n.\u0275dir=te({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class SG{constructor(){this.$implicit=null,this.ngIf=null}}function K1(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${ft(e)}'.`)}class Av{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let Zf=(()=>{class n{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(t)}_matchCase(t){const i=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(t){if(this._defaultViews&&t!==this._defaultUsed){this._defaultUsed=t;for(let i=0;i<this._defaultViews.length;i++)this._defaultViews[i].enforceState(t)}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=te({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),n})(),Q1=(()=>{class n{constructor(t,i,r){this.ngSwitch=r,r._addCase(),this._view=new Av(t,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(t){return new(t||n)(T(Mi),T(ur),T(Zf,9))},n.\u0275dir=te({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),n})(),Dv=(()=>{class n{constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){const[r,s]=t.split(".");null!=(i=null!=i&&s?`${i}${s}`:i)?this._renderer.setStyle(this._ngEl.nativeElement,r,i):this._renderer.removeStyle(this._ngEl.nativeElement,r)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return n.\u0275fac=function(t){return new(t||n)(T(pt),T($l),T(Fs))},n.\u0275dir=te({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),n})(),Ai=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:[{provide:Yf,useClass:EG}]}),n})();const tD="browser";let t8=(()=>{class n{}return n.\u0275prov=J({token:n,providedIn:"root",factory:()=>new n8(L(je),window)}),n})();class n8{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function r8(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const s=r.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),this.attemptFocus(t))}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(i-s[0],r-s[1])}attemptFocus(e){return e.focus(),this.document.activeElement===e}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=iD(this.window.history)||iD(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function iD(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class rD{}class kv extends class s8 extends class L6{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function R6(n){Bf||(Bf=n)}(new kv)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function o8(){return Yu=Yu||document.querySelector("base"),Yu?Yu.getAttribute("href"):null}();return null==t?null:function a8(n){Xf=Xf||document.createElement("a"),Xf.setAttribute("href",n);const e=Xf.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Yu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Y1(document.cookie,e)}}let Xf,Yu=null;const sD=new q("TRANSITION_ID"),c8=[{provide:Hu,useFactory:function l8(n,e,t){return()=>{t.get(Gl).donePromise.then(()=>{const i=ss(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[sD,je,Nt],multi:!0}];class Ov{static init(){!function J5(n){dv=n}(new Ov)}addToWindow(e){kt.getAngularTestability=(i,r=!0)=>{const s=e.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},kt.getAllAngularTestabilities=()=>e.getAllTestabilities(),kt.getAllAngularRootElements=()=>e.getAllRootElements(),kt.frameworkStabilizers||(kt.frameworkStabilizers=[]),kt.frameworkStabilizers.push(i=>{const r=kt.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(l){o=o||l,s--,0==s&&i(o)};r.forEach(function(l){l.whenStable(a)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:i?ss().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let u8=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();const Kf=new q("EventManagerPlugins");let Qf=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(t))return this._eventNameToPlugin.set(t,o),o}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(L(Kf),L(_e))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();class oD{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=ss().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let aD=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})(),Zu=(()=>{class n extends aD{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach(lD),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(lD))}}return n.\u0275fac=function(t){return new(t||n)(L(je))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();function lD(n){ss().remove(n)}const Rv={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Lv=/%COMP%/g;function Jf(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?Jf(n,r,t):(r=r.replace(Lv,n),t.push(r))}return t}function dD(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let ep=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new Fv(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case Ar.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new g8(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case Ar.ShadowDom:return new _8(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=Jf(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(L(Qf),L(Zu),L(Gu))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();class Fv{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Rv[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,i){e&&e.insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const s=Rv[r];s?e.setAttributeNS(s,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=Rv[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(zi.DashCase|zi.Important)?e.style.setProperty(t,i,r&zi.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&zi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,dD(i)):this.eventManager.addEventListener(e,t,dD(i))}}class g8 extends Fv{constructor(e,t,i,r){super(e),this.component=i;const s=Jf(r+"-"+i.id,i.styles,[]);t.addStyles(s),this.contentAttr=function f8(n){return"_ngcontent-%COMP%".replace(Lv,n)}(r+"-"+i.id),this.hostAttr=function p8(n){return"_nghost-%COMP%".replace(Lv,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class _8 extends Fv{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Jf(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let y8=(()=>{class n extends oD{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(L(je))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();const fD=["alt","control","meta","shift"],b8={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},pD={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},w8={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let x8=(()=>{class n extends oD{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ss().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="";if(fD.forEach(l=>{const c=i.indexOf(l);c>-1&&(i.splice(c,1),o+=l+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let i="",r=function C8(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&pD.hasOwnProperty(e)&&(e=pD[e]))}return b8[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),fD.forEach(s=>{s!=r&&w8[s](t)&&(i+=s+".")}),i+=r,i}static eventCallback(t,i,r){return s=>{n.getEventFullKey(s)===t&&r.runGuarded(()=>i(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(L(je))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();const S8=_1(M6,"browser",[{provide:Wl,useValue:tD},{provide:l1,useValue:function E8(){kv.makeCurrent(),Ov.init()},multi:!0},{provide:je,useFactory:function T8(){return function k3(n){s_=n}(document),document},deps:[]}]),A8=[{provide:by,useValue:"root"},{provide:_o,useFactory:function M8(){return new _o},deps:[]},{provide:Kf,useClass:y8,multi:!0,deps:[je,_e,Wl]},{provide:Kf,useClass:x8,multi:!0,deps:[je]},{provide:ep,useClass:ep,deps:[Qf,Zu,Gu]},{provide:Nu,useExisting:ep},{provide:aD,useExisting:Zu},{provide:Zu,useClass:Zu,deps:[je]},{provide:uv,useClass:uv,deps:[_e]},{provide:Qf,useClass:Qf,deps:[Kf,_e]},{provide:rD,useClass:u8,deps:[]}];let mD=(()=>{class n{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:n,providers:[{provide:Gu,useValue:t.appId},{provide:sD,useExisting:Gu},c8]}}}return n.\u0275fac=function(t){return new(t||n)(L(n,12))},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:A8,imports:[Ai,k6]}),n})();"undefined"!=typeof window&&window;const{isArray:V8}=Array,{getPrototypeOf:z8,prototype:j8,keys:U8}=Object;const{isArray:G8}=Array;function Vv(n){return W(e=>function W8(n,e){return G8(e)?n(...e):n(e)}(n,e))}const ti=new q("NgValueAccessor");let cI=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({}),n})(),HW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[cI]]}),n})(),GW=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[HW]}),n})();function Ce(...n){return vn(n,ta(n))}function Ql(n,e){return K(e)?rn(n,e,1):rn(n,1)}function gn(n,e){return H((t,i)=>{let r=0;t.subscribe(new Q(i,s=>n.call(e,s,r++)&&i.next(s)))})}class TI{}class SI{}class js{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),s=r.toLowerCase(),o=t.slice(i+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const r=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof js?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new js;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof js?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class WW{encodeKey(e){return AI(e)}encodeValue(e){return AI(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const $W=/%(\d[a-f0-9])/gi,YW={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function AI(n){return encodeURIComponent(n).replace($W,(e,t)=>{var i;return null!==(i=YW[t])&&void 0!==i?i:e})}function DI(n){return`${n}`}class Mo{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new WW,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function qW(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[o,a]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t];this.map.set(t,Array.isArray(i)?i:[i])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(s=>{t.push({param:i,value:s,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Mo({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(DI(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(DI(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class ZW{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function II(n){return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer}function PI(n){return"undefined"!=typeof Blob&&n instanceof Blob}function kI(n){return"undefined"!=typeof FormData&&n instanceof FormData}class nd{constructor(e,t,i,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function XW(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,s=r):s=i,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new js),this.context||(this.context=new ZW),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Mo,this.urlWithParams=t}serializeBody(){return null===this.body?null:II(this.body)||PI(this.body)||kI(this.body)||function KW(n){return"undefined"!=typeof URLSearchParams&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Mo?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||kI(this.body)?null:PI(this.body)?this.body.type||null:II(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Mo?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const i=e.method||this.method,r=e.url||this.url,s=e.responseType||this.responseType,o=void 0!==e.body?e.body:this.body,a=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,l=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let c=e.headers||this.headers,u=e.params||this.params;const d=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(c=Object.keys(e.setHeaders).reduce((h,f)=>h.set(f,e.setHeaders[f]),c)),e.setParams&&(u=Object.keys(e.setParams).reduce((h,f)=>h.set(f,e.setParams[f]),u)),new nd(i,r,o,{params:u,headers:c,context:d,reportProgress:l,responseType:s,withCredentials:a})}}var _n=(()=>((_n=_n||{})[_n.Sent=0]="Sent",_n[_n.UploadProgress=1]="UploadProgress",_n[_n.ResponseHeader=2]="ResponseHeader",_n[_n.DownloadProgress=3]="DownloadProgress",_n[_n.Response=4]="Response",_n[_n.User=5]="User",_n))();class cb{constructor(e,t=200,i="OK"){this.headers=e.headers||new js,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class ub extends cb{constructor(e={}){super(e),this.type=_n.ResponseHeader}clone(e={}){return new ub({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class id extends cb{constructor(e={}){super(e),this.type=_n.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new id({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class up extends cb{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function db(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let dp=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let s;if(t instanceof nd)s=t;else{let l,c;l=r.headers instanceof js?r.headers:new js(r.headers),r.params&&(c=r.params instanceof Mo?r.params:new Mo({fromObject:r.params})),s=new nd(t,i,void 0!==r.body?r.body:null,{headers:l,context:r.context,params:c,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const o=Ce(s).pipe(Ql(l=>this.handler.handle(l)));if(t instanceof nd||"events"===r.observe)return o;const a=o.pipe(gn(l=>l instanceof id));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(W(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(W(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(W(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(W(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Mo).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,db(r,i))}post(t,i,r={}){return this.request("POST",t,db(r,i))}put(t,i,r={}){return this.request("PUT",t,db(r,i))}}return n.\u0275fac=function(t){return new(t||n)(L(TI))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();class OI{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const hb=new q("HTTP_INTERCEPTORS");let QW=(()=>{class n{intercept(t,i){return i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})(),JW=0;class RI{}let LI=(()=>{class n{constructor(t,i){this.callbackMap=t,this.document=i,this.resolvedPromise=Promise.resolve()}nextCallback(){return"ng_jsonp_callback_"+JW++}handle(t){if("JSONP"!==t.method)throw new Error("JSONP requests must use JSONP request method.");if("json"!==t.responseType)throw new Error("JSONP requests must use Json response type.");return new D(i=>{const r=this.nextCallback(),s=t.urlWithParams.replace(/=JSONP_CALLBACK(&|$)/,`=${r}$1`),o=this.document.createElement("script");o.src=s;let a=null,l=!1,c=!1;this.callbackMap[r]=f=>{delete this.callbackMap[r],!c&&(a=f,l=!0)};const u=()=>{o.parentNode&&o.parentNode.removeChild(o),delete this.callbackMap[r]},d=f=>{c||this.resolvedPromise.then(()=>{u(),l?(i.next(new id({body:a,status:200,statusText:"OK",url:s})),i.complete()):i.error(new up({url:s,status:0,statusText:"JSONP Error",error:new Error("JSONP injected script did not invoke callback.")}))})},h=f=>{c||(u(),i.error(new up({error:f,status:0,statusText:"JSONP Error",url:s})))};return o.addEventListener("load",d),o.addEventListener("error",h),this.document.body.appendChild(o),i.next({type:_n.Sent}),()=>{c=!0,o.removeEventListener("load",d),o.removeEventListener("error",h),u()}})}}return n.\u0275fac=function(t){return new(t||n)(L(RI),L(je))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})(),r7=(()=>{class n{constructor(t){this.jsonp=t}intercept(t,i){return"JSONP"===t.method?this.jsonp.handle(t):i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(L(LI))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();const s7=/^\)\]\}',?\n/;let FI=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new D(i=>{const r=this.xhrFactory.build();if(r.open(t.method,t.urlWithParams),t.withCredentials&&(r.withCredentials=!0),t.headers.forEach((f,p)=>r.setRequestHeader(f,p.join(","))),t.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const f=t.detectContentTypeHeader();null!==f&&r.setRequestHeader("Content-Type",f)}if(t.responseType){const f=t.responseType.toLowerCase();r.responseType="json"!==f?f:"text"}const s=t.serializeBody();let o=null;const a=()=>{if(null!==o)return o;const f=1223===r.status?204:r.status,p=r.statusText||"OK",m=new js(r.getAllResponseHeaders()),_=function o7(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(r)||t.url;return o=new ub({headers:m,status:f,statusText:p,url:_}),o},l=()=>{let{headers:f,status:p,statusText:m,url:_}=a(),y=null;204!==p&&(y=void 0===r.response?r.responseText:r.response),0===p&&(p=y?200:0);let v=p>=200&&p<300;if("json"===t.responseType&&"string"==typeof y){const E=y;y=y.replace(s7,"");try{y=""!==y?JSON.parse(y):null}catch(M){y=E,v&&(v=!1,y={error:M,text:y})}}v?(i.next(new id({body:y,headers:f,status:p,statusText:m,url:_||void 0})),i.complete()):i.error(new up({error:y,headers:f,status:p,statusText:m,url:_||void 0}))},c=f=>{const{url:p}=a(),m=new up({error:f,status:r.status||0,statusText:r.statusText||"Unknown Error",url:p||void 0});i.error(m)};let u=!1;const d=f=>{u||(i.next(a()),u=!0);let p={type:_n.DownloadProgress,loaded:f.loaded};f.lengthComputable&&(p.total=f.total),"text"===t.responseType&&!!r.responseText&&(p.partialText=r.responseText),i.next(p)},h=f=>{let p={type:_n.UploadProgress,loaded:f.loaded};f.lengthComputable&&(p.total=f.total),i.next(p)};return r.addEventListener("load",l),r.addEventListener("error",c),r.addEventListener("timeout",c),r.addEventListener("abort",c),t.reportProgress&&(r.addEventListener("progress",d),null!==s&&r.upload&&r.upload.addEventListener("progress",h)),r.send(s),i.next({type:_n.Sent}),()=>{r.removeEventListener("error",c),r.removeEventListener("abort",c),r.removeEventListener("load",l),r.removeEventListener("timeout",c),t.reportProgress&&(r.removeEventListener("progress",d),null!==s&&r.upload&&r.upload.removeEventListener("progress",h)),r.readyState!==r.DONE&&r.abort()}})}}return n.\u0275fac=function(t){return new(t||n)(L(rD))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();const fb=new q("XSRF_COOKIE_NAME"),pb=new q("XSRF_HEADER_NAME");class NI{}let a7=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Y1(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return n.\u0275fac=function(t){return new(t||n)(L(je),L(Wl),L(fb))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})(),mb=(()=>{class n{constructor(t,i){this.tokenService=t,this.headerName=i}intercept(t,i){const r=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||r.startsWith("http://")||r.startsWith("https://"))return i.handle(t);const s=this.tokenService.getToken();return null!==s&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,s)})),i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(L(NI),L(pb))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})(),l7=(()=>{class n{constructor(t,i){this.backend=t,this.injector=i,this.chain=null}handle(t){if(null===this.chain){const i=this.injector.get(hb,[]);this.chain=i.reduceRight((r,s)=>new OI(r,s),this.backend)}return this.chain.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(L(SI),L(Nt))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();function c7(){return"object"==typeof window?window:{}}let u7=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:mb,useClass:QW}]}}static withOptions(t={}){return{ngModule:n,providers:[t.cookieName?{provide:fb,useValue:t.cookieName}:[],t.headerName?{provide:pb,useValue:t.headerName}:[]]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:[mb,{provide:hb,useExisting:mb,multi:!0},{provide:NI,useClass:a7},{provide:fb,useValue:"XSRF-TOKEN"},{provide:pb,useValue:"X-XSRF-TOKEN"}]}),n})(),d7=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:[dp,{provide:TI,useClass:l7},FI,{provide:SI,useExisting:FI}],imports:[[u7.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),n})(),h7=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:[LI,{provide:RI,useFactory:c7},{provide:hb,useClass:r7,multi:!0}]}),n})();class BI{}const Us="*";function Di(n,e){return{type:7,name:n,definitions:e,options:{}}}function $t(n,e=null){return{type:4,styles:e,timings:n}}function VI(n,e=null){return{type:3,steps:n,options:e}}function zI(n,e=null){return{type:2,steps:n,options:e}}function ve(n){return{type:6,styles:n,offset:null}}function yn(n,e,t){return{type:0,name:n,styles:e,options:t}}function jt(n,e,t=null){return{type:1,expr:n,animation:e,options:t}}function gb(n=null){return{type:9,options:n}}function _b(n,e,t=null){return{type:11,selector:n,animation:e,options:t}}function jI(n){Promise.resolve(null).then(n)}class Jl{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){jI(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class UI{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const s=this.players.length;0==s?jI(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function HI(){return"undefined"!=typeof window&&void 0!==window.document}function vb(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function To(n){switch(n.length){case 0:return new Jl;case 1:return n[0];default:return new UI(n)}}function GI(n,e,t,i,r={},s={}){const o=[],a=[];let l=-1,c=null;if(i.forEach(u=>{const d=u.offset,h=d==l,f=h&&c||{};Object.keys(u).forEach(p=>{let m=p,_=u[p];if("offset"!==p)switch(m=e.normalizePropertyName(m,o),_){case"!":_=r[p];break;case Us:_=s[p];break;default:_=e.normalizeStyleValue(p,m,_,o)}f[m]=_}),h||a.push(f),c=f,l=d}),o.length){const u="\n - ";throw new Error(`Unable to animate due to the following errors:${u}${o.join(u)}`)}return a}function bb(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&wb(t,"start",n)));break;case"done":n.onDone(()=>i(t&&wb(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&wb(t,"destroy",n)))}}function wb(n,e,t){const i=t.totalTime,s=xb(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,null==i?n.totalTime:i,!!t.disabled),o=n._data;return null!=o&&(s._data=o),s}function xb(n,e,t,i,r="",s=0,o){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function Hi(n,e,t){let i;return n instanceof Map?(i=n.get(e),i||n.set(e,i=t)):(i=n[e],i||(i=n[e]=t)),i}function WI(n){const e=n.indexOf(":");return[n.substring(1,e),n.substr(e+1)]}let Cb=(n,e)=>!1,qI=(n,e,t)=>[];(vb()||"undefined"!=typeof Element)&&(Cb=HI()?(n,e)=>{for(;e&&e!==document.documentElement;){if(e===n)return!0;e=e.parentNode||e.host}return!1}:(n,e)=>n.contains(e),qI=(n,e,t)=>{if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]});let va=null,$I=!1;function Eb(n){va||(va=function g7(){return"undefined"!=typeof document?document.body:null}()||{},$I=!!va.style&&"WebkitAppearance"in va.style);let e=!0;return va.style&&!function m7(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in va.style,!e&&$I&&(e="Webkit"+n.charAt(0).toUpperCase()+n.substr(1)in va.style)),e}const Mb=Cb,Tb=qI;function YI(n){const e={};return Object.keys(n).forEach(t=>{const i=t.replace(/([a-z])([A-Z])/g,"$1-$2");e[i]=n[t]}),e}let ZI=(()=>{class n{validateStyleProperty(t){return Eb(t)}matchesElement(t,i){return!1}containsElement(t,i){return Mb(t,i)}query(t,i,r){return Tb(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,s,o,a=[],l){return new Jl(r,s)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})(),Sb=(()=>{class n{}return n.NOOP=new ZI,n})();const Ab="ng-enter",hp="ng-leave",fp="ng-trigger",pp=".ng-trigger",KI="ng-animating",Db=".ng-animating";function ba(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:Ib(parseFloat(e[1]),e[2])}function Ib(n,e){return"s"===e?1e3*n:n}function mp(n,e,t){return n.hasOwnProperty("duration")?n:function v7(n,e,t){let r,s=0,o="";if("string"==typeof n){const a=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return e.push(`The provided timing value "${n}" is invalid.`),{duration:0,delay:0,easing:""};r=Ib(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(s=Ib(parseFloat(l),a[4]));const c=a[5];c&&(o=c)}else r=n;if(!t){let a=!1,l=e.length;r<0&&(e.push("Duration values below 0 are not allowed for this animation step."),a=!0),s<0&&(e.push("Delay values below 0 are not allowed for this animation step."),a=!0),a&&e.splice(l,0,`The provided timing value "${n}" is invalid.`)}return{duration:r,delay:s,easing:o}}(n,e,t)}function ec(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function So(n,e,t={}){if(e)for(let i in n)t[i]=n[i];else ec(n,t);return t}function JI(n,e,t){return t?e+":"+t+";":""}function eP(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=JI(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=JI(0,x7(t),n.style[t]));n.setAttribute("style",e)}function os(n,e,t){n.style&&(Object.keys(e).forEach(i=>{const r=kb(i);t&&!t.hasOwnProperty(i)&&(t[i]=n.style[r]),n.style[r]=e[i]}),vb()&&eP(n))}function wa(n,e){n.style&&(Object.keys(e).forEach(t=>{const i=kb(t);n.style[i]=""}),vb()&&eP(n))}function rd(n){return Array.isArray(n)?1==n.length?n[0]:zI(n):n}const Pb=new RegExp("{{\\s*(.+?)\\s*}}","g");function tP(n){let e=[];if("string"==typeof n){let t;for(;t=Pb.exec(n);)e.push(t[1]);Pb.lastIndex=0}return e}function gp(n,e,t){const i=n.toString(),r=i.replace(Pb,(s,o)=>{let a=e[o];return e.hasOwnProperty(o)||(t.push(`Please provide a value for the animation param ${o}`),a=""),a.toString()});return r==i?n:r}function _p(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const w7=/-+([a-z0-9])/g;function kb(n){return n.replace(w7,(...e)=>e[1].toUpperCase())}function x7(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function nP(n,e){return 0===n||0===e}function iP(n,e,t){const i=Object.keys(t);if(i.length&&e.length){let s=e[0],o=[];if(i.forEach(a=>{s.hasOwnProperty(a)||o.push(a),s[a]=t[a]}),o.length)for(var r=1;r<e.length;r++){let a=e[r];o.forEach(function(l){a[l]=Ob(n,l)})}}return e}function Gi(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw new Error(`Unable to resolve animation metadata node #${e.type}`)}}function Ob(n,e){return window.getComputedStyle(n)[e]}function C7(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function E7(n,e,t){if(":"==n[0]){const l=function M7(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(`The transition alias value "${n}" is not supported`),"* => *"}}(n,t);if("function"==typeof l)return void e.push(l);n=l}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(`The provided transition expression "${n}" is not supported`),e;const r=i[1],s=i[2],o=i[3];e.push(rP(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&e.push(rP(o,r))}(i,t,e)):t.push(n),t}const vp=new Set(["true","1"]),bp=new Set(["false","0"]);function rP(n,e){const t=vp.has(n)||bp.has(n),i=vp.has(e)||bp.has(e);return(r,s)=>{let o="*"==n||n==r,a="*"==e||e==s;return!o&&t&&"boolean"==typeof r&&(o=r?vp.has(n):bp.has(n)),!a&&i&&"boolean"==typeof s&&(a=s?vp.has(e):bp.has(e)),o&&a}}const T7=new RegExp("s*:selfs*,?","g");function Rb(n,e,t){return new S7(n).build(e,t)}class S7{constructor(e){this._driver=e}build(e,t){const i=new I7(t);return this._resetContextStyleTimingState(i),Gi(this,rd(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const s=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),0==a.type){const l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,s.push(this.visitState(l,t))}),l.name=c}else if(1==a.type){const l=this.visitTransition(a,t);i+=l.queryCount,r+=l.depCount,o.push(l)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};if(i.styles.forEach(a=>{if(wp(a)){const l=a;Object.keys(l).forEach(c=>{tP(l[c]).forEach(u=>{o.hasOwnProperty(u)||s.add(u)})})}}),s.size){const a=_p(s.values());t.errors.push(`state("${e.name}", ...) must define default values for all the following style substitutions: ${a.join(", ")}`)}}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=Gi(this,rd(e.animation),t);return{type:1,matchers:C7(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:xa(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>Gi(this,i,t)),options:xa(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const s=e.steps.map(o=>{t.currentTime=i;const a=Gi(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:s,options:xa(e.options)}}visitAnimate(e,t){const i=function k7(n,e){let t=null;if(n.hasOwnProperty("duration"))t=n;else if("number"==typeof n)return Lb(mp(n,e).duration,0,"");const i=n;if(i.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=Lb(0,0,"");return s.dynamic=!0,s.strValue=i,s}return t=t||mp(i,e),Lb(t.duration,t.delay,t.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,s=e.styles?e.styles:ve({});if(5==s.type)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;const c={};i.easing&&(c.easing=i.easing),o=ve(c)}t.currentTime+=i.duration+i.delay;const l=this.visitStyle(o,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[];Array.isArray(e.styles)?e.styles.forEach(o=>{"string"==typeof o?o==Us?i.push(o):t.errors.push(`The provided style string value ${o} is not allowed.`):i.push(o)}):i.push(e.styles);let r=!1,s=null;return i.forEach(o=>{if(wp(o)){const a=o,l=a.easing;if(l&&(s=l,delete a.easing),!r)for(let c in a)if(a[c].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:i,easing:s,offset:e.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,s=t.currentTime;i&&s>0&&(s-=i.duration+i.delay),e.styles.forEach(o=>{"string"!=typeof o&&Object.keys(o).forEach(a=>{if(!this._driver.validateStyleProperty(a))return void t.errors.push(`The provided animation property "${a}" is not a supported CSS property for animations`);const l=t.collectedStyles[t.currentQuerySelector],c=l[a];let u=!0;c&&(s!=r&&s>=c.startTime&&r<=c.endTime&&(t.errors.push(`The CSS property "${a}" that exists between the times of "${c.startTime}ms" and "${c.endTime}ms" is also being animated in a parallel animation between the times of "${s}ms" and "${r}ms"`),u=!1),s=c.startTime),u&&(l[a]={startTime:s,endTime:r}),t.options&&function b7(n,e,t){const i=e.params||{},r=tP(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||t.push(`Unable to resolve the local animation param ${s} in the given list of values`)})}(o[a],t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),i;let s=0;const o=[];let a=!1,l=!1,c=0;const u=e.steps.map(y=>{const v=this._makeStyleAst(y,t);let E=null!=v.offset?v.offset:function P7(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(wp(t)&&t.hasOwnProperty("offset")){const i=t;e=parseFloat(i.offset),delete i.offset}});else if(wp(n)&&n.hasOwnProperty("offset")){const t=n;e=parseFloat(t.offset),delete t.offset}return e}(v.styles),M=0;return null!=E&&(s++,M=v.offset=E),l=l||M<0||M>1,a=a||M<c,c=M,o.push(M),v});l&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),a&&t.errors.push("Please ensure that all keyframe offsets are in order");const d=e.steps.length;let h=0;s>0&&s<d?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==s&&(h=1/(d-1));const f=d-1,p=t.currentTime,m=t.currentAnimateTimings,_=m.duration;return u.forEach((y,v)=>{const E=h>0?v==f?1:h*v:o[v],M=E*_;t.currentTime=p+m.delay+M,m.duration=M,this._validateStyleAst(y,t),y.offset=E,i.styles.push(y)}),i}visitReference(e,t){return{type:8,animation:Gi(this,rd(e.animation),t),options:xa(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:xa(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:xa(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[s,o]=function A7(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(T7,"")),n=n.replace(/@\*/g,pp).replace(/@\w+/g,t=>pp+"-"+t.substr(1)).replace(/:animating/g,Db),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+s:s,Hi(t.collectedStyles,t.currentQuerySelector,{});const a=Gi(this,rd(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:xa(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:mp(e.timings,t.errors,!0);return{type:12,animation:Gi(this,rd(e.animation),t),timings:i,options:null}}}class I7{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function wp(n){return!Array.isArray(n)&&"object"==typeof n}function xa(n){return n?(n=ec(n)).params&&(n.params=function D7(n){return n?ec(n):null}(n.params)):n={},n}function Lb(n,e,t){return{duration:n,delay:e,easing:t}}function Fb(n,e,t,i,r,s,o=null,a=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class xp{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const L7=new RegExp(":enter","g"),N7=new RegExp(":leave","g");function Nb(n,e,t,i,r,s={},o={},a,l,c=[]){return(new B7).buildKeyframes(n,e,t,i,r,s,o,a,l,c)}class B7{buildKeyframes(e,t,i,r,s,o,a,l,c,u=[]){c=c||new xp;const d=new Bb(e,t,c,r,s,u,[]);d.options=l,d.currentTimeline.setStyles([o],null,d.errors,l),Gi(this,i,d);const h=d.timelines.filter(f=>f.containsAnimation());if(Object.keys(a).length){let f;for(let p=h.length-1;p>=0;p--){const m=h[p];if(m.element===t){f=m;break}}f&&!f.allowOnlyTimelineStyles()&&f.setStyles([a],null,d.errors,l)}return h.length?h.map(f=>f.buildKeyframes()):[Fb(t,[],[],[],0,0,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,i){let s=t.currentTimeline.currentTime;const o=null!=i.duration?ba(i.duration):null,a=null!=i.delay?ba(i.delay):null;return 0!==o&&e.forEach(l=>{const c=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),Gi(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Cp);const o=ba(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>Gi(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const s=e.options&&e.options.delay?ba(e.options.delay):0;e.steps.forEach(o=>{const a=t.createSubContext(e.options);s&&a.delayNextStep(s),Gi(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return mp(t.params?gp(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const s=e.style;5==s.type?this.visitKeyframes(s,t):(t.incrementTime(i.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.getCurrentStyleProperties().length&&i.forwardFrame();const s=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(s):i.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,s=i.duration,a=t.createSubContext().currentTimeline;a.easing=i.easing,e.styles.forEach(l=>{a.forwardTime((l.offset||0)*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?ba(r.delay):0;s&&(6===t.previousNode.type||0==i&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Cp);let o=i;const a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{t.currentQueryIndex=u;const d=t.createSubContext(e.options,c);s&&d.delayNextStep(s),c===t.element&&(l=d.currentTimeline),Gi(this,e.animation,d),d.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,d.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1);let l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const u=t.currentTimeline;l&&u.delayNextStep(l);const d=u.currentTime;Gi(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-d+(r.startTime-i.currentTimeline.startTime)}}const Cp={};class Bb{constructor(e,t,i,r,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Cp,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new Ep(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=ba(i.duration)),null!=i.delay&&(r.delay=ba(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=gp(s[a],o,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,s=new Bb(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=Cp,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=i?i:0)+e.delay,easing:""},s=new V7(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=(e=e.replace(L7,"."+this._enterClassName)).replace(N7,"."+this._leaveClassName);let c=this._driver.query(this.element,e,1!=i);0!==i&&(c=i<0?c.slice(c.length+i,c.length):c.slice(0,i)),a.push(...c)}return!s&&0==a.length&&o.push(`\`query("${t}")\` returned zero elements. (Use \`query("${t}", { optional: true })\` if you wish to allow this.)`),a}}class Ep{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Ep(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||Us,this._currentKeyframe[t]=Us}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){t&&(this._previousKeyframe.easing=t);const s=r&&r.params||{},o=function z7(n,e){const t={};let i;return n.forEach(r=>{"*"===r?(i=i||Object.keys(e),i.forEach(s=>{t[s]=Us})):So(r,!1,t)}),t}(e,this._globalTimelineStyles);Object.keys(o).forEach(a=>{const l=gp(o[a],s,i);this._pendingStyles[a]=l,this._localTimelineStyles.hasOwnProperty(a)||(this._backFill[a]=this._globalTimelineStyles.hasOwnProperty(a)?this._globalTimelineStyles[a]:Us),this._updateStyle(a,l)})}applyStylesToKeyframe(){const e=this._pendingStyles,t=Object.keys(e);0!=t.length&&(this._pendingStyles={},t.forEach(i=>{this._currentKeyframe[i]=e[i]}),Object.keys(this._localTimelineStyles).forEach(i=>{this._currentKeyframe.hasOwnProperty(i)||(this._currentKeyframe[i]=this._localTimelineStyles[i])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(e=>{const t=this._localTimelineStyles[e];this._pendingStyles[e]=t,this._updateStyle(e,t)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){Object.keys(e._styleSummary).forEach(t=>{const i=this._styleSummary[t],r=e._styleSummary[t];(!i||r.time>i.time)&&this._updateStyle(t,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const c=So(a,!0);Object.keys(c).forEach(u=>{const d=c[u];"!"==d?e.add(u):d==Us&&t.add(u)}),i||(c.offset=l/this.duration),r.push(c)});const s=e.size?_p(e.values()):[],o=t.size?_p(t.values()):[];if(i){const a=r[0],l=ec(a);a.offset=0,l.offset=1,r=[a,l]}return Fb(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class V7 extends Ep{constructor(e,t,i,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const s=[],o=i+t,a=t/o,l=So(e[0],!1);l.offset=0,s.push(l);const c=So(e[0],!1);c.offset=aP(a),s.push(c);const u=e.length-1;for(let d=1;d<=u;d++){let h=So(e[d],!1);h.offset=aP((t+h.offset*i)/o),s.push(h)}i=o,t=0,r="",e=s}return Fb(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function aP(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class Vb{}class j7 extends Vb{normalizePropertyName(e,t){return kb(e)}normalizeStyleValue(e,t,i,r){let s="";const o=i.toString().trim();if(U7[t]&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(`Please provide a CSS unit value for ${e}:${i}`)}return o+s}}const U7=(()=>function H7(n){const e={};return n.forEach(t=>e[t]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function lP(n,e,t,i,r,s,o,a,l,c,u,d,h){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:d,errors:h}}const zb={};class cP{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function G7(n,e,t,i,r){return n.some(s=>s(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){const r=this._stateStyles["*"],s=this._stateStyles[e],o=r?r.buildStyles(t,i):{};return s?s.buildStyles(t,i):o}build(e,t,i,r,s,o,a,l,c,u){const d=[],h=this.ast.options&&this.ast.options.params||zb,p=this.buildStyles(i,a&&a.params||zb,d),m=l&&l.params||zb,_=this.buildStyles(r,m,d),y=new Set,v=new Map,E=new Map,M="void"===r,R={params:Object.assign(Object.assign({},h),m)},B=u?[]:Nb(e,t,this.ast.animation,s,o,p,_,R,c,d);let V=0;if(B.forEach(Y=>{V=Math.max(Y.duration+Y.delay,V)}),d.length)return lP(t,this._triggerName,i,r,M,p,_,[],[],v,E,V,d);B.forEach(Y=>{const $=Y.element,fe=Hi(v,$,{});Y.preStyleProps.forEach(he=>fe[he]=!0);const ye=Hi(E,$,{});Y.postStyleProps.forEach(he=>ye[he]=!0),$!==t&&y.add($)});const Z=_p(y.values());return lP(t,this._triggerName,i,r,M,p,_,B,Z,v,E,V)}}class W7{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i={},r=ec(this.defaultParams);return Object.keys(e).forEach(s=>{const o=e[s];null!=o&&(r[s]=o)}),this.styles.styles.forEach(s=>{if("string"!=typeof s){const o=s;Object.keys(o).forEach(a=>{let l=o[a];l.length>1&&(l=gp(l,r,t));const c=this.normalizer.normalizePropertyName(a,t);l=this.normalizer.normalizeStyleValue(a,c,l,t),i[c]=l})}}),i}}class $7{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states={},t.states.forEach(r=>{this.states[r.name]=new W7(r.style,r.options&&r.options.params||{},i)}),uP(this.states,"true","1"),uP(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new cP(e,r,this.states))}),this.fallbackTransition=function Y7(n,e,t){return new cP(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(o=>o.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function uP(n,e,t){n.hasOwnProperty(e)?n.hasOwnProperty(t)||(n[t]=n[e]):n.hasOwnProperty(t)&&(n[e]=n[t])}const Z7=new xp;class X7{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations={},this._playersById={},this.players=[]}register(e,t){const i=[],r=Rb(this._driver,t,i);if(i.length)throw new Error(`Unable to build the animation due to the following errors: ${i.join("\n")}`);this._animations[e]=r}_buildPlayer(e,t,i){const r=e.element,s=GI(0,this._normalizer,0,e.keyframes,t,i);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],s=this._animations[e];let o;const a=new Map;if(s?(o=Nb(this._driver,t,s,Ab,hp,{},{},i,Z7,r),o.forEach(u=>{const d=Hi(a,u.element,{});u.postStyleProps.forEach(h=>d[h]=null)})):(r.push("The requested animation doesn't exist or has already been destroyed"),o=[]),r.length)throw new Error(`Unable to create the animation due to the following errors: ${r.join("\n")}`);a.forEach((u,d)=>{Object.keys(u).forEach(h=>{u[h]=this._driver.computeStyle(d,h,Us)})});const c=To(o.map(u=>{const d=a.get(u.element);return this._buildPlayer(u,{},d)}));return this._playersById[e]=c,c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){const t=this._getPlayer(e);t.destroy(),delete this._playersById[e];const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById[e];if(!t)throw new Error(`Unable to find the timeline player referenced by ${e}`);return t}listen(e,t,i,r){const s=xb(t,"","","");return bb(this._getPlayer(e),i,s,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const s=this._getPlayer(e);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const dP="ng-animate-queued",jb="ng-animate-disabled",tq=[],hP={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},nq={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},pr="__ng_removed";class Ub{constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function oq(n){return null!=n?n:null}(i?e.value:e),i){const s=ec(e);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const sd="void",Hb=new Ub(sd);class iq{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,mr(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.hasOwnProperty(t))throw new Error(`Unable to listen on the animation trigger event "${i}" because the animation trigger "${t}" doesn't exist!`);if(null==i||0==i.length)throw new Error(`Unable to listen on the animation trigger "${t}" because the provided event is undefined!`);if(!function aq(n){return"start"==n||"done"==n}(i))throw new Error(`The provided animation trigger event "${i}" for the animation trigger "${t}" is not supported!`);const s=Hi(this._elementListeners,e,[]),o={name:t,phase:i,callback:r};s.push(o);const a=Hi(this._engine.statesByElement,e,{});return a.hasOwnProperty(t)||(mr(e,fp),mr(e,fp+"-"+t),a[t]=Hb),()=>{this._engine.afterFlush(()=>{const l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers[t]||delete a[t]})}}register(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}_getTrigger(e){const t=this._triggers[e];if(!t)throw new Error(`The provided animation trigger "${e}" has not been registered!`);return t}trigger(e,t,i,r=!0){const s=this._getTrigger(t),o=new Gb(this.id,t,e);let a=this._engine.statesByElement.get(e);a||(mr(e,fp),mr(e,fp+"-"+t),this._engine.statesByElement.set(e,a={}));let l=a[t];const c=new Ub(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a[t]=c,l||(l=Hb),c.value!==sd&&l.value===c.value){if(!function uq(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s)||n[s]!==e[s])return!1}return!0}(l.params,c.params)){const m=[],_=s.matchStyles(l.value,l.params,m),y=s.matchStyles(c.value,c.params,m);m.length?this._engine.reportError(m):this._engine.afterFlush(()=>{wa(e,_),os(e,y)})}return}const h=Hi(this._engine.playersByElement,e,[]);h.forEach(m=>{m.namespaceId==this.id&&m.triggerName==t&&m.queued&&m.destroy()});let f=s.matchTransition(l.value,c.value,e,c.params),p=!1;if(!f){if(!r)return;f=s.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:l,toState:c,player:o,isFallbackTransition:p}),p||(mr(e,dP),o.onStart(()=>{tc(e,dP)})),o.onDone(()=>{let m=this.players.indexOf(o);m>=0&&this.players.splice(m,1);const _=this._engine.playersByElement.get(e);if(_){let y=_.indexOf(o);y>=0&&_.splice(y,1)}}),this.players.push(o),h.push(o),o}deregister(e){delete this._triggers[e],this._engine.statesByElement.forEach((t,i)=>{delete t[e]}),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,pp,!0);i.forEach(r=>{if(r[pr])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const s=this._engine.statesByElement.get(e),o=new Map;if(s){const a=[];if(Object.keys(s).forEach(l=>{if(o.set(l,s[l].value),this._triggers[l]){const c=this.trigger(e,l,sd,r);c&&a.push(c)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),i&&To(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const l=this._triggers[o].fallbackTransition,c=i[o]||Hb,u=new Ub(sd),d=new Gb(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:c,toState:u,player:d,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const s=e[pr];(!s||s===hP)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){mr(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==i.triggerName){const l=xb(s,i.triggerName,i.fromState.value,i.toState.value);l._data=e,bb(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(i=>i.element===e)||t,t}}class rq{constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new iq(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList.length-1;if(i>=0){let r=!1;for(let s=i;s>=0;s--)if(this.driver.containsElement(this._namespaceList[s].hostElement,t)){this._namespaceList.splice(s+1,0,e),r=!0;break}r||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){if(!e)return;const i=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i){const r=Object.keys(i);for(let s=0;s<r.length;s++){const o=i[r[s]].namespaceId;if(o){const a=this._fetchNamespace(o);a&&t.add(a)}}}return t}trigger(e,t,i,r){if(Mp(t)){const s=this._fetchNamespace(e);if(s)return s.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!Mp(t))return;const s=t[pr];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){const o=this._fetchNamespace(e);o&&o.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),mr(e,jb)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),tc(e,jb))}removeNode(e,t,i,r){if(Mp(t)){const s=e?this._fetchNamespace(e):null;if(s?s.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),i){const o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,i,r,s){this.collectedLeaveElements.push(t),t[pr]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,i,r,s){return Mp(t)?this._fetchNamespace(e).listen(t,i,r,s):()=>{}}_buildInstruction(e,t,i,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,pp,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,Db,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return To(this.players).onDone(()=>e());e()})}processLeaveNode(e){var t;const i=e[pr];if(i&&i.setForRemoval){if(e[pr]=hP,i.namespaceId){this.destroyInnerAnimations(e);const r=this._fetchNamespace(i.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,i.setForRemoval)}(null===(t=e.classList)||void 0===t?void 0:t.contains(jb))&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)mr(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?To(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${e.join("\n")}`)}_flushAnimations(e,t){const i=new xp,r=[],s=new Map,o=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(ie=>{u.add(ie);const pe=this.driver.query(ie,".ng-animate-queued",!0);for(let Me=0;Me<pe.length;Me++)u.add(pe[Me])});const d=this.bodyNode,h=Array.from(this.statesByElement.keys()),f=mP(h,this.collectedEnterElements),p=new Map;let m=0;f.forEach((ie,pe)=>{const Me=Ab+m++;p.set(pe,Me),ie.forEach(ct=>mr(ct,Me))});const _=[],y=new Set,v=new Set;for(let ie=0;ie<this.collectedLeaveElements.length;ie++){const pe=this.collectedLeaveElements[ie],Me=pe[pr];Me&&Me.setForRemoval&&(_.push(pe),y.add(pe),Me.hasAnimation?this.driver.query(pe,".ng-star-inserted",!0).forEach(ct=>y.add(ct)):v.add(pe))}const E=new Map,M=mP(h,Array.from(y));M.forEach((ie,pe)=>{const Me=hp+m++;E.set(pe,Me),ie.forEach(ct=>mr(ct,Me))}),e.push(()=>{f.forEach((ie,pe)=>{const Me=p.get(pe);ie.forEach(ct=>tc(ct,Me))}),M.forEach((ie,pe)=>{const Me=E.get(pe);ie.forEach(ct=>tc(ct,Me))}),_.forEach(ie=>{this.processLeaveNode(ie)})});const R=[],B=[];for(let ie=this._namespaceList.length-1;ie>=0;ie--)this._namespaceList[ie].drainQueuedTransitions(t).forEach(Me=>{const ct=Me.player,Un=Me.element;if(R.push(ct),this.collectedEnterElements.length){const _i=Un[pr];if(_i&&_i.setForMove){if(_i.previousTriggersValues&&_i.previousTriggersValues.has(Me.triggerName)){const Wa=_i.previousTriggersValues.get(Me.triggerName),Qo=this.statesByElement.get(Me.element);Qo&&Qo[Me.triggerName]&&(Qo[Me.triggerName].value=Wa)}return void ct.destroy()}}const Ms=!d||!this.driver.containsElement(d,Un),Qi=E.get(Un),Ko=p.get(Un),nn=this._buildInstruction(Me,i,Ko,Qi,Ms);if(nn.errors&&nn.errors.length)return void B.push(nn);if(Ms)return ct.onStart(()=>wa(Un,nn.fromStyles)),ct.onDestroy(()=>os(Un,nn.toStyles)),void r.push(ct);if(Me.isFallbackTransition)return ct.onStart(()=>wa(Un,nn.fromStyles)),ct.onDestroy(()=>os(Un,nn.toStyles)),void r.push(ct);const a3=[];nn.timelines.forEach(_i=>{_i.stretchStartingKeyframe=!0,this.disabledNodes.has(_i.element)||a3.push(_i)}),nn.timelines=a3,i.append(Un,nn.timelines),o.push({instruction:nn,player:ct,element:Un}),nn.queriedElements.forEach(_i=>Hi(a,_i,[]).push(ct)),nn.preStyleProps.forEach((_i,Wa)=>{const Qo=Object.keys(_i);if(Qo.length){let qa=l.get(Wa);qa||l.set(Wa,qa=new Set),Qo.forEach(ZC=>qa.add(ZC))}}),nn.postStyleProps.forEach((_i,Wa)=>{const Qo=Object.keys(_i);let qa=c.get(Wa);qa||c.set(Wa,qa=new Set),Qo.forEach(ZC=>qa.add(ZC))})});if(B.length){const ie=[];B.forEach(pe=>{ie.push(`@${pe.triggerName} has failed due to:\n`),pe.errors.forEach(Me=>ie.push(`- ${Me}\n`))}),R.forEach(pe=>pe.destroy()),this.reportError(ie)}const V=new Map,Z=new Map;o.forEach(ie=>{const pe=ie.element;i.has(pe)&&(Z.set(pe,pe),this._beforeAnimationBuild(ie.player.namespaceId,ie.instruction,V))}),r.forEach(ie=>{const pe=ie.element;this._getPreviousPlayers(pe,!1,ie.namespaceId,ie.triggerName,null).forEach(ct=>{Hi(V,pe,[]).push(ct),ct.destroy()})});const Y=_.filter(ie=>_P(ie,l,c)),$=new Map;pP($,this.driver,v,c,Us).forEach(ie=>{_P(ie,l,c)&&Y.push(ie)});const ye=new Map;f.forEach((ie,pe)=>{pP(ye,this.driver,new Set(ie),l,"!")}),Y.forEach(ie=>{const pe=$.get(ie),Me=ye.get(ie);$.set(ie,Object.assign(Object.assign({},pe),Me))});const he=[],Ee=[],Mn={};o.forEach(ie=>{const{element:pe,player:Me,instruction:ct}=ie;if(i.has(pe)){if(u.has(pe))return Me.onDestroy(()=>os(pe,ct.toStyles)),Me.disabled=!0,Me.overrideTotalTime(ct.totalTime),void r.push(Me);let Un=Mn;if(Z.size>1){let Qi=pe;const Ko=[];for(;Qi=Qi.parentNode;){const nn=Z.get(Qi);if(nn){Un=nn;break}Ko.push(Qi)}Ko.forEach(nn=>Z.set(nn,Un))}const Ms=this._buildAnimation(Me.namespaceId,ct,V,s,ye,$);if(Me.setRealPlayer(Ms),Un===Mn)he.push(Me);else{const Qi=this.playersByElement.get(Un);Qi&&Qi.length&&(Me.parentPlayer=To(Qi)),r.push(Me)}}else wa(pe,ct.fromStyles),Me.onDestroy(()=>os(pe,ct.toStyles)),Ee.push(Me),u.has(pe)&&r.push(Me)}),Ee.forEach(ie=>{const pe=s.get(ie.element);if(pe&&pe.length){const Me=To(pe);ie.setRealPlayer(Me)}}),r.forEach(ie=>{ie.parentPlayer?ie.syncPlayerEvents(ie.parentPlayer):ie.destroy()});for(let ie=0;ie<_.length;ie++){const pe=_[ie],Me=pe[pr];if(tc(pe,hp),Me&&Me.hasAnimation)continue;let ct=[];if(a.size){let Ms=a.get(pe);Ms&&Ms.length&&ct.push(...Ms);let Qi=this.driver.query(pe,Db,!0);for(let Ko=0;Ko<Qi.length;Ko++){let nn=a.get(Qi[Ko]);nn&&nn.length&&ct.push(...nn)}}const Un=ct.filter(Ms=>!Ms.destroyed);Un.length?lq(this,pe,Un):this.processLeaveNode(pe)}return _.length=0,he.forEach(ie=>{this.players.push(ie),ie.onDone(()=>{ie.destroy();const pe=this.players.indexOf(ie);this.players.splice(pe,1)}),ie.play()}),he}elementContainsData(e,t){let i=!1;const r=t[pr];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(t)&&(i=!0),this.playersByQueriedElement.has(t)&&(i=!0),this.statesByElement.has(t)&&(i=!0),this._fetchNamespace(e).elementContainsData(t)||i}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,s){let o=[];if(t){const a=this.playersByQueriedElement.get(e);a&&(o=a)}else{const a=this.playersByElement.get(e);if(a){const l=!s||s==sd;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||o.push(c)})}}return(i||r)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,i){const s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:t.triggerName;for(const l of t.timelines){const c=l.element,u=c!==s,d=Hi(i,c,[]);this._getPreviousPlayers(c,u,o,a,t.toState).forEach(f=>{const p=f.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),f.destroy(),d.push(f)})}wa(s,t.fromStyles)}_buildAnimation(e,t,i,r,s,o){const a=t.triggerName,l=t.element,c=[],u=new Set,d=new Set,h=t.timelines.map(p=>{const m=p.element;u.add(m);const _=m[pr];if(_&&_.removedBeforeQueried)return new Jl(p.duration,p.delay);const y=m!==l,v=function cq(n){const e=[];return gP(n,e),e}((i.get(m)||tq).map(V=>V.getRealPlayer())).filter(V=>!!V.element&&V.element===m),E=s.get(m),M=o.get(m),R=GI(0,this._normalizer,0,p.keyframes,E,M),B=this._buildPlayer(p,R,v);if(p.subTimeline&&r&&d.add(m),y){const V=new Gb(e,a,m);V.setRealPlayer(B),c.push(V)}return B});c.forEach(p=>{Hi(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>function sq(n,e,t){let i;if(n instanceof Map){if(i=n.get(e),i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}}else if(i=n[e],i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&delete n[e]}return i}(this.playersByQueriedElement,p.element,p))}),u.forEach(p=>mr(p,KI));const f=To(h);return f.onDestroy(()=>{u.forEach(p=>tc(p,KI)),os(l,t.toStyles)}),d.forEach(p=>{Hi(r,p,[]).push(f)}),f}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new Jl(e.duration,e.delay)}}class Gb{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new Jl,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(t=>{this._queuedCallbacks[t].forEach(i=>bb(e,t,void 0,i))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Hi(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Mp(n){return n&&1===n.nodeType}function fP(n,e){const t=n.style.display;return n.style.display=null!=e?e:"none",t}function pP(n,e,t,i,r){const s=[];t.forEach(l=>s.push(fP(l)));const o=[];i.forEach((l,c)=>{const u={};l.forEach(d=>{const h=u[d]=e.computeStyle(c,d,r);(!h||0==h.length)&&(c[pr]=nq,o.push(c))}),n.set(c,u)});let a=0;return t.forEach(l=>fP(l,s[a++])),o}function mP(n,e){const t=new Map;if(n.forEach(a=>t.set(a,[])),0==e.length)return t;const r=new Set(e),s=new Map;function o(a){if(!a)return 1;let l=s.get(a);if(l)return l;const c=a.parentNode;return l=t.has(c)?c:r.has(c)?1:o(c),s.set(a,l),l}return e.forEach(a=>{const l=o(a);1!==l&&t.get(l).push(a)}),t}function mr(n,e){var t;null===(t=n.classList)||void 0===t||t.add(e)}function tc(n,e){var t;null===(t=n.classList)||void 0===t||t.remove(e)}function lq(n,e,t){To(t).onDone(()=>n.processLeaveNode(e))}function gP(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof UI?gP(i.players,e):e.push(i)}}function _P(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(s=>r.add(s)):e.set(n,i),t.delete(n),!0}class Tp{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new rq(e,t,i),this._timelineEngine=new X7(e,t,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(e,t,i,r,s){const o=e+"-"+r;let a=this._triggerCache[o];if(!a){const l=[],c=Rb(this._driver,s,l);if(l.length)throw new Error(`The animation trigger "${r}" has failed to build due to the following errors:\n - ${l.join("\n - ")}`);a=function q7(n,e,t){return new $7(n,e,t)}(r,c,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i,r){this._transitionEngine.removeNode(e,t,r||!1,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[s,o]=WI(i);this._timelineEngine.command(s,t,o,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,s){if("@"==i.charAt(0)){const[o,a]=WI(i);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,i,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function yP(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=Wb(e[0]),e.length>1&&(i=Wb(e[e.length-1]))):e&&(t=Wb(e)),t||i?new dq(n,t,i):null}let dq=(()=>{class n{constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let s=n.initialStylesByElement.get(t);s||n.initialStylesByElement.set(t,s={}),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&os(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(os(this._element,this._initialStyles),this._endStyles&&(os(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(wa(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(wa(this._element,this._endStyles),this._endStyles=null),os(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function Wb(n){let e=null;const t=Object.keys(n);for(let i=0;i<t.length;i++){const r=t[i];hq(r)&&(e=e||{},e[r]=n[r])}return e}function hq(n){return"display"===n||"position"===n}const vP="animation",bP="animationend";class mq{constructor(e,t,i,r,s,o,a){this._element=e,this._name=t,this._duration=i,this._delay=r,this._easing=s,this._fillMode=o,this._onDoneFn=a,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=l=>this._handleCallback(l)}apply(){(function gq(n,e){const t=$b(n,"").trim();let i=0;t.length&&(i=function yq(n,e){let t=0;for(let i=0;i<n.length;i++)n.charAt(i)===e&&t++;return t}(t,",")+1,e=`${t}, ${e}`),Sp(n,"",e)})(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),CP(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){wP(this._element,this._name,"paused")}resume(){wP(this._element,this._name,"running")}setPosition(e){const t=xP(this._element,this._name);this._position=e*this._duration,Sp(this._element,"Delay",`-${this._position}ms`,t)}getPosition(){return this._position}_handleCallback(e){const t=e._ngTestManualTimestamp||Date.now(),i=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&i>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),CP(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function _q(n,e){const i=$b(n,"").split(","),r=qb(i,e);r>=0&&(i.splice(r,1),Sp(n,"",i.join(",")))}(this._element,this._name))}}function wP(n,e,t){Sp(n,"PlayState",t,xP(n,e))}function xP(n,e){const t=$b(n,"");return t.indexOf(",")>0?qb(t.split(","),e):qb([t],e)}function qb(n,e){for(let t=0;t<n.length;t++)if(n[t].indexOf(e)>=0)return t;return-1}function CP(n,e,t){t?n.removeEventListener(bP,e):n.addEventListener(bP,e)}function Sp(n,e,t,i){const r=vP+e;if(null!=i){const s=n.style[r];if(s.length){const o=s.split(",");o[i]=t,t=o.join(",")}}n.style[r]=t}function $b(n,e){return n.style[vP+e]||""}class EP{constructor(e,t,i,r,s,o,a,l){this.element=e,this.keyframes=t,this.animationName=i,this._duration=r,this._delay=s,this._finalStyles=a,this._specialStyles=l,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=r+s,this._buildStyler()}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}destroy(){this.init(),!(this._state>=4)&&(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(e=>e()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}finish(){this.init(),!(this._state>=3)&&(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(e){this._styler.setPosition(e)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._state=0,this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new mq(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}beforeDestroy(){this.init();const e={};if(this.hasStarted()){const t=this._state>=3;Object.keys(this._finalStyles).forEach(i=>{"offset"!=i&&(e[i]=t?this._finalStyles[i]:Ob(this.element,i))})}this.currentSnapshot=e}}class wq extends Jl{constructor(e,t){super(),this.element=e,this._startingStyles={},this.__initialized=!1,this._styles=YI(t)}init(){this.__initialized||!this._startingStyles||(this.__initialized=!0,Object.keys(this._styles).forEach(e=>{this._startingStyles[e]=this.element.style[e]}),super.init())}play(){!this._startingStyles||(this.init(),Object.keys(this._styles).forEach(e=>this.element.style.setProperty(e,this._styles[e])),super.play())}destroy(){!this._startingStyles||(Object.keys(this._startingStyles).forEach(e=>{const t=this._startingStyles[e];t?this.element.style.setProperty(e,t):this.element.style.removeProperty(e)}),this._startingStyles=null,super.destroy())}}class TP{constructor(){this._count=0}validateStyleProperty(e){return Eb(e)}matchesElement(e,t){return!1}containsElement(e,t){return Mb(e,t)}query(e,t,i){return Tb(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}buildKeyframeElement(e,t,i){i=i.map(a=>YI(a));let r=`@keyframes ${t} {\n`,s="";i.forEach(a=>{s=" ";const l=parseFloat(a.offset);r+=`${s}${100*l}% {\n`,s+=" ",Object.keys(a).forEach(c=>{const u=a[c];switch(c){case"offset":return;case"easing":return void(u&&(r+=`${s}animation-timing-function: ${u};\n`));default:return void(r+=`${s}${c}: ${u};\n`)}}),r+=`${s}}\n`}),r+="}\n";const o=document.createElement("style");return o.textContent=r,o}animate(e,t,i,r,s,o=[],a){const l=o.filter(_=>_ instanceof EP),c={};nP(i,r)&&l.forEach(_=>{let y=_.currentSnapshot;Object.keys(y).forEach(v=>c[v]=y[v])});const u=function Eq(n){let e={};return n&&(Array.isArray(n)?n:[n]).forEach(i=>{Object.keys(i).forEach(r=>{"offset"==r||"easing"==r||(e[r]=i[r])})}),e}(t=iP(e,t,c));if(0==i)return new wq(e,u);const d="gen_css_kf_"+this._count++,h=this.buildKeyframeElement(e,d,t);(function Cq(n){var e;const t=null===(e=n.getRootNode)||void 0===e?void 0:e.call(n);return"undefined"!=typeof ShadowRoot&&t instanceof ShadowRoot?t:document.head})(e).appendChild(h);const p=yP(e,t),m=new EP(e,t,d,i,r,s,u,p);return m.onDestroy(()=>function Mq(n){n.parentNode.removeChild(n)}(h)),m}}class AP{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(e,t,i){return e.animate(t,i)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e={};if(this.hasStarted()){const t=this._finalKeyframe;Object.keys(t).forEach(i=>{"offset"!=i&&(e[i]=this._finished?t[i]:Ob(this.element,i))})}this.currentSnapshot=e}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class Tq{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(DP().toString()),this._cssKeyframesDriver=new TP}validateStyleProperty(e){return Eb(e)}matchesElement(e,t){return!1}containsElement(e,t){return Mb(e,t)}query(e,t,i){return Tb(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}overrideWebAnimationsSupport(e){this._isNativeImpl=e}animate(e,t,i,r,s,o=[],a){if(!a&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,i,r,s,o);const u={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(u.easing=s);const d={},h=o.filter(p=>p instanceof AP);nP(i,r)&&h.forEach(p=>{let m=p.currentSnapshot;Object.keys(m).forEach(_=>d[_]=m[_])});const f=yP(e,t=iP(e,t=t.map(p=>So(p,!1)),d));return new AP(e,t,u,f)}}function DP(){return HI()&&Element.prototype.animate||{}}let Aq=(()=>{class n extends BI{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:Ar.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?zI(t):t;return IP(this._renderer,null,i,"register",[r]),new Dq(i,this._renderer)}}return n.\u0275fac=function(t){return new(t||n)(L(Nu),L(je))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();class Dq extends class f7{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Iq(this._id,e,t||{},this._renderer)}}class Iq{constructor(e,t,i,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return IP(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}function IP(n,e,t,i,r){return n.setProperty(e,`@@${t}:${i}`,r)}const PP="@.disabled";let Pq=(()=>{class n{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,o)=>{const a=null==o?void 0:o.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(t,i){const s=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let u=this._rendererCache.get(s);return u||(u=new kP("",s,this.engine),this._rendererCache.set(s,u)),u}const o=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,t);const l=u=>{Array.isArray(u)?u.forEach(l):this.engine.registerTrigger(o,a,t,u.name,u)};return i.data.animation.forEach(l),new kq(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(t){return new(t||n)(L(Nu),L(Tp),L(_e))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();class kP{constructor(e,t,i){this.namespaceId=e,this.delegate=t,this.engine=i,this.destroyNode=this.delegate.destroyNode?r=>t.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==PP?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class kq extends kP{constructor(e,t,i,r){super(t,i,r),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==PP?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.substr(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function Oq(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let s=t.substr(1),o="";return"@"!=s.charAt(0)&&([s,o]=function Rq(n){const e=n.indexOf(".");return[n.substring(0,e),n.substr(e+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(e,t,i)}}let Lq=(()=>{class n extends Tp{constructor(t,i,r){super(t.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(t){return new(t||n)(L(je),L(Sb),L(Vb))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();const as=new q("AnimationModuleType"),OP=[{provide:BI,useClass:Aq},{provide:Vb,useFactory:function Nq(){return new j7}},{provide:Tp,useClass:Lq},{provide:Nu,useFactory:function Bq(n,e,t){return new Pq(n,e,t)},deps:[ep,Tp,_e]}],RP=[{provide:Sb,useFactory:function Fq(){return function Sq(){return"function"==typeof DP()}()?new Tq:new TP}},{provide:as,useValue:"BrowserAnimations"},...OP],Vq=[{provide:Sb,useClass:ZI},{provide:as,useValue:"NoopAnimations"},...OP];let zq=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?Vq:RP}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:RP,imports:[mD]}),n})();class mt extends O{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}function Ao(...n){const e=ta(n),t=function Xc(n){return K(Zc(n))?n.pop():void 0}(n),{args:i,keys:r}=function vD(n){if(1===n.length){const e=n[0];if(V8(e))return{args:e,keys:null};if(function H8(n){return n&&"object"==typeof n&&z8(n)===j8}(e)){const t=U8(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}(n);if(0===i.length)return vn([],e);const s=new D(function jq(n,e,t=Rn){return i=>{LP(e,()=>{const{length:r}=n,s=new Array(r);let o=r,a=r;for(let l=0;l<r;l++)LP(e,()=>{const c=vn(n[l],e);let u=!1;c.subscribe(new Q(i,d=>{s[l]=d,u||(u=!0,a--),a||i.next(t(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}(i,e,r?o=>function bD(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}(r,o):Rn));return t?s.pipe(Vv(t)):s}function LP(n,e,t){n?wr(t,n,e):e()}const Dp=ce(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function od(...n){return function Uq(){return Wr(1)}()(vn(n,ta(n)))}function Ip(n){return new D(e=>{ai(n()).subscribe(e)})}function FP(){return H((n,e)=>{let t=null;n._refCount++;const i=new Q(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class Hq extends D{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,j(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new ee;const t=this.getSubject();e.add(this.source.subscribe(new Q(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=ee.EMPTY)}return e}refCount(){return FP()(this)}}function Wi(n,e){return H((t,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();t.subscribe(new Q(i,l=>{null==r||r.unsubscribe();let c=0;const u=s++;ai(n(l,u)).subscribe(r=new Q(i,d=>i.next(e?e(l,d,u,c++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Hs(...n){const e=ta(n);return H((t,i)=>{(e?od(n,t,e):od(n,t)).subscribe(i)})}function Gq(n,e,t,i,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(new Q(o,u=>{const d=c++;l=a?n(l,u,d):(a=!0,u),i&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function NP(n,e){return H(Gq(n,e,arguments.length>=2,!0))}function Gs(n){return H((e,t)=>{let s,i=null,r=!1;i=e.subscribe(new Q(t,void 0,void 0,o=>{s=ai(n(o,Gs(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function Yb(n){return n<=0?()=>xr:H((e,t)=>{let i=[];e.subscribe(new Q(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function BP(n=Wq){return H((e,t)=>{let i=!1;e.subscribe(new Q(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function Wq(){return new Dp}function VP(n){return H((e,t)=>{let i=!1;e.subscribe(new Q(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function nc(n,e){const t=arguments.length>=2;return i=>i.pipe(n?gn((r,s)=>n(r,s,i)):Rn,Mt(1),t?VP(e):BP(()=>new Dp))}function Bn(n,e,t){const i=K(n)||e||t?{next:n,error:e,complete:t}:n;return i?H((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(new Q(s,l=>{var c;null===(c=i.next)||void 0===c||c.call(i,l),s.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),s.complete()},l=>{var c;a=!1,null===(c=i.error)||void 0===c||c.call(i,l),s.error(l)},()=>{var l,c;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(c=i.finalize)||void 0===c||c.call(i)}))}):Rn}class Ws{constructor(e,t){this.id=e,this.url=t}}class Zb extends Ws{constructor(e,t,i="imperative",r=null){super(e,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class ad extends Ws{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class jP extends Ws{constructor(e,t,i){super(e,t),this.reason=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class $q extends Ws{constructor(e,t,i){super(e,t),this.error=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Yq extends Ws{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Zq extends Ws{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xq extends Ws{constructor(e,t,i,r,s){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Kq extends Ws{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Qq extends Ws{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class UP{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class HP{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Jq{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class e9{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class t9{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class n9{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class GP{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const tt="primary";class i9{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function ic(n){return new i9(n)}const WP="ngNavigationCancelingError";function Xb(n){const e=Error("NavigationCancelingError: "+n);return e[WP]=!0,e}function s9(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let s=0;s<i.length;s++){const o=i[s],a=n[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function ls(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!qP(n[r],e[r]))return!1;return!0}function qP(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,s)=>i[s]===r)}return n===e}function $P(n){return Array.prototype.concat.apply([],n)}function YP(n){return n.length>0?n[n.length-1]:null}function Hn(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function cs(n){return Ly(n)?n:Pu(n)?vn(Promise.resolve(n)):Ce(n)}const l9={exact:function KP(n,e,t){if(!Ea(n.segments,e.segments)||!Pp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!KP(n.children[i],e.children[i],t))return!1;return!0},subset:QP},ZP={exact:function c9(n,e){return ls(n,e)},subset:function u9(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>qP(n[t],e[t]))},ignored:()=>!0};function XP(n,e,t){return l9[t.paths](n.root,e.root,t.matrixParams)&&ZP[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function QP(n,e,t){return JP(n,e,e.segments,t)}function JP(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!Ea(r,t)||e.hasChildren()||!Pp(r,t,i))}if(n.segments.length===t.length){if(!Ea(n.segments,t)||!Pp(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!QP(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(Ea(n.segments,r)&&Pp(n.segments,r,i)&&n.children[tt])&&JP(n.children[tt],e,s,i)}}function Pp(n,e,t){return e.every((i,r)=>ZP[t](n[r].parameters,i.parameters))}class Ca{constructor(e,t,i){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ic(this.queryParams)),this._queryParamMap}toString(){return f9.serialize(this)}}class at{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Hn(t,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return kp(this)}}class ld{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=ic(this.parameters)),this._parameterMap}toString(){return rk(this)}}function Ea(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}class ek{}class tk{parse(e){const t=new x9(e);return new Ca(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${cd(e.root,!0)}`,i=function g9(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${Op(t)}=${Op(r)}`).join("&"):`${Op(t)}=${Op(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function p9(n){return encodeURI(n)}(e.fragment)}`:""}`}}const f9=new tk;function kp(n){return n.segments.map(e=>rk(e)).join("/")}function cd(n,e){if(!n.hasChildren())return kp(n);if(e){const t=n.children[tt]?cd(n.children[tt],!1):"",i=[];return Hn(n.children,(r,s)=>{s!==tt&&i.push(`${s}:${cd(r,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function h9(n,e){let t=[];return Hn(n.children,(i,r)=>{r===tt&&(t=t.concat(e(i,r)))}),Hn(n.children,(i,r)=>{r!==tt&&(t=t.concat(e(i,r)))}),t}(n,(i,r)=>r===tt?[cd(n.children[tt],!1)]:[`${r}:${cd(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[tt]?`${kp(n)}/${t[0]}`:`${kp(n)}/(${t.join("//")})`}}function nk(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Op(n){return nk(n).replace(/%3B/gi,";")}function Kb(n){return nk(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Rp(n){return decodeURIComponent(n)}function ik(n){return Rp(n.replace(/\+/g,"%20"))}function rk(n){return`${Kb(n.path)}${function m9(n){return Object.keys(n).map(e=>`;${Kb(e)}=${Kb(n[e])}`).join("")}(n.parameters)}`}const _9=/^[^\/()?;=#]+/;function Lp(n){const e=n.match(_9);return e?e[0]:""}const y9=/^[^=?&#]+/,b9=/^[^&#]+/;class x9{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new at([],{}):new at([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[tt]=new at(e,t)),i}parseSegment(){const e=Lp(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new ld(Rp(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=Lp(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=Lp(this.remaining);r&&(i=r,this.capture(i))}e[Rp(t)]=Rp(i)}parseQueryParam(e){const t=function v9(n){const e=n.match(y9);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const o=function w9(n){const e=n.match(b9);return e?e[0]:""}(this.remaining);o&&(i=o,this.capture(i))}const r=ik(t),s=ik(i);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=Lp(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let s;i.indexOf(":")>-1?(s=i.substr(0,i.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=tt);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[tt]:new at([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class sk{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=Qb(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=Qb(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=Jb(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Jb(e,this._root).map(t=>t.value)}}function Qb(n,e){if(n===e.value)return e;for(const t of e.children){const i=Qb(n,t);if(i)return i}return null}function Jb(n,e){if(n===e.value)return[e];for(const t of e.children){const i=Jb(n,t);if(i.length)return i.unshift(e),i}return[]}class qs{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function rc(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class ok extends sk{constructor(e,t){super(e),this.snapshot=t,e0(this,e)}toString(){return this.snapshot.toString()}}function ak(n,e){const t=function C9(n,e){const o=new Fp([],{},{},"",{},tt,e,null,n.root,-1,{});return new ck("",new qs(o,[]))}(n,e),i=new mt([new ld("",{})]),r=new mt({}),s=new mt({}),o=new mt({}),a=new mt(""),l=new sc(i,r,o,a,s,tt,e,t.root);return l.snapshot=t.root,new ok(new qs(l,[]),t)}class sc{constructor(e,t,i,r,s,o,a,l){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this._futureSnapshot=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(W(e=>ic(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(W(e=>ic(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function lk(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],s=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(s.component)break;i--}}return function E9(n){return n.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(t.slice(i))}class Fp{constructor(e,t,i,r,s,o,a,l,c,u,d){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._urlSegment=c,this._lastPathIndex=u,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ic(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ic(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class ck extends sk{constructor(e,t){super(t),this.url=e,e0(this,t)}toString(){return uk(this._root)}}function e0(n,e){e.value._routerState=n,e.children.forEach(t=>e0(n,t))}function uk(n){const e=n.children.length>0?` { ${n.children.map(uk).join(", ")} } `:"";return`${n.value}${e}`}function t0(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,ls(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),ls(e.params,t.params)||n.params.next(t.params),function o9(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!ls(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),ls(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function n0(n,e){const t=ls(n.params,e.params)&&function d9(n,e){return Ea(n,e)&&n.every((t,i)=>ls(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||n0(n.parent,e.parent))}function ud(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function T9(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return ud(n,i,r);return ud(n,i)})}(n,e,t);return new qs(i,r)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>ud(n,a)),o}}const i=function S9(n){return new sc(new mt(n.url),new mt(n.params),new mt(n.queryParams),new mt(n.fragment),new mt(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(s=>ud(n,s));return new qs(i,r)}}function Np(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function dd(n){return"object"==typeof n&&null!=n&&n.outlets}function r0(n,e,t,i,r){let s={};return i&&Hn(i,(o,a)=>{s[a]=Array.isArray(o)?o.map(l=>`${l}`):`${o}`}),new Ca(t.root===n?e:dk(t.root,n,e),s,r)}function dk(n,e,t){const i={};return Hn(n.children,(r,s)=>{i[s]=r===e?t:dk(r,e,t)}),new at(n.segments,i)}class hk{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Np(i[0]))throw new Error("Root segment cannot have matrix parameters");const r=i.find(dd);if(r&&r!==YP(i))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class s0{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function fk(n,e,t){if(n||(n=new at([],{})),0===n.segments.length&&n.hasChildren())return Bp(n,e,t);const i=function O9(n,e,t){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return s;const o=n.segments[r],a=t[i];if(dd(a))break;const l=`${a}`,c=i<t.length-1?t[i+1]:null;if(r>0&&void 0===l)break;if(l&&c&&"object"==typeof c&&void 0===c.outlets){if(!mk(l,c,o))return s;i+=2}else{if(!mk(l,{},o))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const s=new at(n.segments.slice(0,i.pathIndex),{});return s.children[tt]=new at(n.segments.slice(i.pathIndex),n.children),Bp(s,0,r)}return i.match&&0===r.length?new at(n.segments,{}):i.match&&!n.hasChildren()?o0(n,e,t):i.match?Bp(n,0,r):o0(n,e,t)}function Bp(n,e,t){if(0===t.length)return new at(n.segments,{});{const i=function k9(n){return dd(n[0])?n[0].outlets:{[tt]:n}}(t),r={};return Hn(i,(s,o)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[o]=fk(n.children[o],e,s))}),Hn(n.children,(s,o)=>{void 0===i[o]&&(r[o]=s)}),new at(n.segments,r)}}function o0(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(dd(s)){const l=R9(s.outlets);return new at(i,l)}if(0===r&&Np(t[0])){i.push(new ld(n.segments[e].path,pk(t[0]))),r++;continue}const o=dd(s)?s.outlets[tt]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&Np(a)?(i.push(new ld(o,pk(a))),r+=2):(i.push(new ld(o,{})),r++)}return new at(i,{})}function R9(n){const e={};return Hn(n,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=o0(new at([],{}),0,t))}),e}function pk(n){const e={};return Hn(n,(t,i)=>e[i]=`${t}`),e}function mk(n,e,t){return n==t.path&&ls(e,t.parameters)}class F9{constructor(e,t,i,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),t0(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=rc(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,r[o],i),delete r[o]}),Hn(r,(s,o)=>{this.deactivateRouteAndItsChildren(s,i)})}deactivateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const o=i.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,i);else s&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=rc(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);if(i&&i.outlet){const o=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,s=rc(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const r=rc(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],i),this.forwardEvent(new n9(s.value.snapshot))}),e.children.length&&this.forwardEvent(new e9(e.value.snapshot))}activateRoutes(e,t,i){const r=e.value,s=t?t.value:null;if(t0(r),r===s)if(r.component){const o=i.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,i);else if(r.component){const o=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),t0(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=function N9(n){for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(r.snapshot),l=a?a.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=l,o.outlet&&o.outlet.activateWith(r,l),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,i)}}class a0{constructor(e,t){this.routes=e,this.module=t}}function Do(n){return"function"==typeof n}function Ma(n){return n instanceof Ca}const hd=Symbol("INITIAL_VALUE");function fd(){return Wi(n=>Ao(n.map(e=>e.pipe(Mt(1),Hs(hd)))).pipe(NP((e,t)=>{let i=!1;return t.reduce((r,s,o)=>r!==hd?r:(s===hd&&(i=!0),i||!1!==s&&o!==t.length-1&&!Ma(s)?r:s),e)},hd),gn(e=>e!==hd),W(e=>Ma(e)?e:!0===e),Mt(1)))}class H9{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new pd,this.attachRef=null}}class pd{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const i=this.getOrCreateContext(e);i.outlet=t,this.contexts.set(e,i)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new H9,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}let l0=(()=>{class n{constructor(t,i,r,s,o){this.parentContexts=t,this.location=i,this.resolver=r,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new Oe,this.deactivateEvents=new Oe,this.attachEvents=new Oe,this.detachEvents=new Oe,this.name=s||tt,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const o=(i=i||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),a=this.parentContexts.getOrCreateContext(this.name).children,l=new G9(t,a,this.location.injector);this.activated=this.location.createComponent(o,this.location.length,l),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)(T(pd),T(Mi),T(bo),Zr("name"),T(Fn))},n.\u0275dir=te({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),n})();class G9{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===sc?this.route:e===pd?this.childContexts:this.parent.get(e,t)}}let gk=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Ot({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,i){1&t&&rt(0,"router-outlet")},directives:[l0],encapsulation:2}),n})();function _k(n,e=""){for(let t=0;t<n.length;t++){const i=n[t];W9(i,q9(e,i))}}function W9(n,e){n.children&&_k(n.children,e)}function q9(n,e){return e?n||e.path?n&&!e.path?`${n}/`:!n&&e.path?e.path:`${n}/${e.path}`:"":n}function c0(n){const e=n.children&&n.children.map(c0),t=e?Object.assign(Object.assign({},n),{children:e}):Object.assign({},n);return!t.component&&(e||t.loadChildren)&&t.outlet&&t.outlet!==tt&&(t.component=gk),t}function gr(n){return n.outlet||tt}function yk(n,e){const t=n.filter(i=>gr(i)===e);return t.push(...n.filter(i=>gr(i)!==e)),t}const vk={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Vp(n,e,t){var i;if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?Object.assign({},vk):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const s=(e.matcher||s9)(t,n,e);if(!s)return Object.assign({},vk);const o={};Hn(s.posParams,(l,c)=>{o[c]=l.path});const a=s.consumed.length>0?Object.assign(Object.assign({},o),s.consumed[s.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:s.consumed,lastChild:s.consumed.length,parameters:a,positionalParamSegments:null!==(i=s.posParams)&&void 0!==i?i:{}}}function zp(n,e,t,i,r="corrected"){if(t.length>0&&function Z9(n,e,t){return t.some(i=>jp(n,e,i)&&gr(i)!==tt)}(n,t,i)){const o=new at(e,function Y9(n,e,t,i){const r={};r[tt]=i,i._sourceSegment=n,i._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&gr(s)!==tt){const o=new at([],{});o._sourceSegment=n,o._segmentIndexShift=e.length,r[gr(s)]=o}return r}(n,e,i,new at(t,n.children)));return o._sourceSegment=n,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:[]}}if(0===t.length&&function X9(n,e,t){return t.some(i=>jp(n,e,i))}(n,t,i)){const o=new at(n.segments,function $9(n,e,t,i,r,s){const o={};for(const a of i)if(jp(n,t,a)&&!r[gr(a)]){const l=new at([],{});l._sourceSegment=n,l._segmentIndexShift="legacy"===s?n.segments.length:e.length,o[gr(a)]=l}return Object.assign(Object.assign({},r),o)}(n,e,t,i,n.children,r));return o._sourceSegment=n,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:t}}const s=new at(n.segments,n.children);return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}function jp(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function bk(n,e,t,i){return!!(gr(n)===i||i!==tt&&jp(e,t,n))&&("**"===n.path||Vp(e,n,t).matched)}function wk(n,e,t){return 0===e.length&&!n.children[t]}class md{constructor(e){this.segmentGroup=e||null}}class xk{constructor(e){this.urlTree=e}}function Up(n){return new D(e=>e.error(new md(n)))}function Ck(n){return new D(e=>e.error(new xk(n)))}function K9(n){return new D(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${n}'`)))}class e${constructor(e,t,i,r,s){this.configLoader=t,this.urlSerializer=i,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=e.get(Ns)}apply(){const e=zp(this.urlTree.root,[],[],this.config).segmentGroup,t=new at(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,tt).pipe(W(s=>this.createUrlTree(u0(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Gs(s=>{if(s instanceof xk)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof md?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,tt).pipe(W(r=>this.createUrlTree(u0(r),e.queryParams,e.fragment))).pipe(Gs(r=>{throw r instanceof md?this.noMatchError(r):r}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,i){const r=e.segments.length>0?new at([],{[tt]:e}):e;return new Ca(r,t,i)}expandSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(W(s=>new at([],s))):this.expandSegment(e,i,t,i.segments,r,!0)}expandChildren(e,t,i){const r=[];for(const s of Object.keys(i.children))"primary"===s?r.unshift(s):r.push(s);return vn(r).pipe(Ql(s=>{const o=i.children[s],a=yk(t,s);return this.expandSegmentGroup(e,a,o,s).pipe(W(l=>({segment:l,outlet:s})))}),NP((s,o)=>(s[o.outlet]=o.segment,s),{}),function qq(n,e){const t=arguments.length>=2;return i=>i.pipe(n?gn((r,s)=>n(r,s,i)):Rn,Yb(1),t?VP(e):BP(()=>new Dp))}())}expandSegment(e,t,i,r,s,o){return vn(i).pipe(Ql(a=>this.expandSegmentAgainstRoute(e,t,i,a,r,s,o).pipe(Gs(c=>{if(c instanceof md)return Ce(null);throw c}))),nc(a=>!!a),Gs((a,l)=>{if(a instanceof Dp||"EmptyError"===a.name){if(wk(t,r,s))return Ce(new at([],{}));throw new md(t)}throw a}))}expandSegmentAgainstRoute(e,t,i,r,s,o,a){return bk(r,t,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,o):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o):Up(t):Up(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const s=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?Ck(s):this.lineralizeSegments(i,s).pipe(rn(o=>{const a=new at(o,{});return this.expandSegment(e,a,t,o,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,s,o){const{matched:a,consumedSegments:l,lastChild:c,positionalParamSegments:u}=Vp(t,r,s);if(!a)return Up(t);const d=this.applyRedirectCommands(l,r.redirectTo,u);return r.redirectTo.startsWith("/")?Ck(d):this.lineralizeSegments(r,d).pipe(rn(h=>this.expandSegment(e,t,i,h.concat(s.slice(c)),o,!1)))}matchSegmentAgainstRoute(e,t,i,r,s){if("**"===i.path)return i.loadChildren?(i._loadedConfig?Ce(i._loadedConfig):this.configLoader.load(e.injector,i)).pipe(W(h=>(i._loadedConfig=h,new at(r,{})))):Ce(new at(r,{}));const{matched:o,consumedSegments:a,lastChild:l}=Vp(t,i,r);if(!o)return Up(t);const c=r.slice(l);return this.getChildConfig(e,i,r).pipe(rn(d=>{const h=d.module,f=d.routes,{segmentGroup:p,slicedSegments:m}=zp(t,a,c,f),_=new at(p.segments,p.children);if(0===m.length&&_.hasChildren())return this.expandChildren(h,f,_).pipe(W(M=>new at(a,M)));if(0===f.length&&0===m.length)return Ce(new at(a,{}));const y=gr(i)===s;return this.expandSegment(h,_,f,m,y?tt:s,!0).pipe(W(E=>new at(a.concat(E.segments),E.children)))}))}getChildConfig(e,t,i){return t.children?Ce(new a0(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Ce(t._loadedConfig):this.runCanLoadGuards(e.injector,t,i).pipe(rn(r=>r?this.configLoader.load(e.injector,t).pipe(W(s=>(t._loadedConfig=s,s))):function Q9(n){return new D(e=>e.error(Xb(`Cannot load children because the guard of the route "path: '${n.path}'" returned false`)))}(t))):Ce(new a0([],e))}runCanLoadGuards(e,t,i){const r=t.canLoad;return r&&0!==r.length?Ce(r.map(o=>{const a=e.get(o);let l;if(function V9(n){return n&&Do(n.canLoad)}(a))l=a.canLoad(t,i);else{if(!Do(a))throw new Error("Invalid CanLoad guard");l=a(t,i)}return cs(l)})).pipe(fd(),Bn(o=>{if(!Ma(o))return;const a=Xb(`Redirecting to "${this.urlSerializer.serialize(o)}"`);throw a.url=o,a}),W(o=>!0===o)):Ce(!0)}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Ce(i);if(r.numberOfChildren>1||!r.children[tt])return K9(e.redirectTo);r=r.children[tt]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreatreUrlTree(e,t,i,r){const s=this.createSegmentGroup(e,t.root,i,r);return new Ca(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return Hn(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const a=r.substring(1);i[s]=t[a]}else i[s]=r}),i}createSegmentGroup(e,t,i,r){const s=this.createSegments(e,t.segments,i,r);let o={};return Hn(t.children,(a,l)=>{o[l]=this.createSegmentGroup(e,a,i,r)}),new at(s,o)}createSegments(e,t,i,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}function u0(n){const e={};for(const i of Object.keys(n.children)){const s=u0(n.children[i]);(s.segments.length>0||s.hasChildren())&&(e[i]=s)}return function t$(n){if(1===n.numberOfChildren&&n.children[tt]){const e=n.children[tt];return new at(n.segments.concat(e.segments),e.children)}return n}(new at(n.segments,e))}class Ek{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class Hp{constructor(e,t){this.component=e,this.route=t}}function i$(n,e,t){const i=n._root;return gd(i,e?e._root:null,t,[i.value])}function Gp(n,e,t){const i=function s$(n){if(!n)return null;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(i?i.module.injector:t).get(n)}function gd(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=rc(e);return n.children.forEach(o=>{(function o$(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function a$(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Ea(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Ea(n.url,e.url)||!ls(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!n0(n,e)||!ls(n.queryParams,e.queryParams);default:return!n0(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new Ek(i)):(s.data=o.data,s._resolvedData=o._resolvedData),gd(n,e,s.component?a?a.children:null:t,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Hp(a.outlet.component,o))}else o&&_d(e,a,r),r.canActivateChecks.push(new Ek(i)),gd(n,null,s.component?a?a.children:null:t,i,r)})(o,s[o.value.outlet],t,i.concat([o.value]),r),delete s[o.value.outlet]}),Hn(s,(o,a)=>_d(o,t.getContext(a),r)),r}function _d(n,e,t){const i=rc(n),r=n.value;Hn(i,(s,o)=>{_d(s,r.component?e?e.children.getContext(o):null:e,t)}),t.canDeactivateChecks.push(new Hp(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}class g${}function Mk(n){return new D(e=>e.error(n))}class y${constructor(e,t,i,r,s,o){this.rootComponentType=e,this.config=t,this.urlTree=i,this.url=r,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=o}recognize(){const e=zp(this.urlTree.root,[],[],this.config.filter(o=>void 0===o.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,tt);if(null===t)return null;const i=new Fp([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},tt,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new qs(i,t),s=new ck(this.url,r);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(e){const t=e.value,i=lk(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,i)}processChildren(e,t){const i=[];for(const s of Object.keys(t.children)){const o=t.children[s],a=yk(e,s),l=this.processSegmentGroup(a,o,s);if(null===l)return null;i.push(...l)}const r=Tk(i);return function v$(n){n.sort((e,t)=>e.value.outlet===tt?-1:t.value.outlet===tt?1:e.value.outlet.localeCompare(t.value.outlet))}(r),r}processSegment(e,t,i,r){for(const s of e){const o=this.processSegmentAgainstRoute(s,t,i,r);if(null!==o)return o}return wk(t,i,r)?[]:null}processSegmentAgainstRoute(e,t,i,r){if(e.redirectTo||!bk(e,t,i,r))return null;let s,o=[],a=[];if("**"===e.path){const f=i.length>0?YP(i).parameters:{};s=new Fp(i,f,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Dk(e),gr(e),e.component,e,Sk(t),Ak(t)+i.length,Ik(e))}else{const f=Vp(t,e,i);if(!f.matched)return null;o=f.consumedSegments,a=i.slice(f.lastChild),s=new Fp(o,f.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Dk(e),gr(e),e.component,e,Sk(t),Ak(t)+o.length,Ik(e))}const l=function b$(n){return n.children?n.children:n.loadChildren?n._loadedConfig.routes:[]}(e),{segmentGroup:c,slicedSegments:u}=zp(t,o,a,l.filter(f=>void 0===f.redirectTo),this.relativeLinkResolution);if(0===u.length&&c.hasChildren()){const f=this.processChildren(l,c);return null===f?null:[new qs(s,f)]}if(0===l.length&&0===u.length)return[new qs(s,[])];const d=gr(e)===r,h=this.processSegment(l,c,u,d?tt:r);return null===h?null:[new qs(s,h)]}}function w$(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function Tk(n){const e=[],t=new Set;for(const i of n){if(!w$(i)){e.push(i);continue}const r=e.find(s=>i.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=Tk(i.children);e.push(new qs(i.value,r))}return e.filter(i=>!t.has(i))}function Sk(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function Ak(n){let e=n,t=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift?e._segmentIndexShift:0;return t-1}function Dk(n){return n.data||{}}function Ik(n){return n.resolve||{}}function d0(n){return Wi(e=>{const t=n(e);return t?vn(t).pipe(W(()=>e)):Ce(e)})}class D$ extends class A${shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const h0=new q("ROUTES");class Pk{constructor(e,t,i,r){this.injector=e,this.compiler=t,this.onLoadStartListener=i,this.onLoadEndListener=r}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const r=this.loadModuleFactory(t.loadChildren).pipe(W(s=>{this.onLoadEndListener&&this.onLoadEndListener(t);const o=s.create(e);return new a0($P(o.injector.get(h0,void 0,Ve.Self|Ve.Optional)).map(c0),o)}),Gs(s=>{throw t._loader$=void 0,s}));return t._loader$=new Hq(r,()=>new O).pipe(FP()),t._loader$}loadModuleFactory(e){return cs(e()).pipe(rn(t=>t instanceof AA?Ce(t):vn(this.compiler.compileModuleAsync(t))))}}class P${shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function k$(n){throw n}function O$(n,e,t){return e.parse("/")}function kk(n,e){return Ce(null)}const R$={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},L$={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Vn=(()=>{class n{constructor(t,i,r,s,o,a,l){this.rootComponentType=t,this.urlSerializer=i,this.rootContexts=r,this.location=s,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new O,this.errorHandler=k$,this.malformedUriErrorHandler=O$,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:kk,afterPreactivation:kk},this.urlHandlingStrategy=new P$,this.routeReuseStrategy=new D$,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=o.get(Ns),this.console=o.get(u1);const d=o.get(_e);this.isNgZoneEnabled=d instanceof _e&&_e.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=function a9(){return new Ca(new at([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Pk(o,a,h=>this.triggerEvent(new UP(h)),h=>this.triggerEvent(new HP(h))),this.routerState=ak(this.currentUrlTree,this.rootComponentType),this.transitions=new mt({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var t;return null===(t=this.location.getState())||void 0===t?void 0:t.\u0275routerPageId}setupNavigations(t){const i=this.events;return t.pipe(gn(r=>0!==r.id),W(r=>Object.assign(Object.assign({},r),{extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),Wi(r=>{let s=!1,o=!1;return Ce(r).pipe(Bn(a=>{this.currentNavigation={id:a.id,initialUrl:a.currentRawUrl,extractedUrl:a.extractedUrl,trigger:a.source,extras:a.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Wi(a=>{const l=this.browserUrlTree.toString(),c=!this.navigated||a.extractedUrl.toString()!==l||l!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||c)&&this.urlHandlingStrategy.shouldProcessUrl(a.rawUrl))return Wp(a.source)&&(this.browserUrlTree=a.extractedUrl),Ce(a).pipe(Wi(d=>{const h=this.transitions.getValue();return i.next(new Zb(d.id,this.serializeUrl(d.extractedUrl),d.source,d.restoredState)),h!==this.transitions.getValue()?xr:Promise.resolve(d)}),function n$(n,e,t,i){return Wi(r=>function J9(n,e,t,i,r){return new e$(n,e,t,i,r).apply()}(n,e,t,r.extractedUrl,i).pipe(W(s=>Object.assign(Object.assign({},r),{urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Bn(d=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:d.urlAfterRedirects})}),function x$(n,e,t,i,r){return rn(s=>function _$(n,e,t,i,r="emptyOnly",s="legacy"){try{const o=new y$(n,e,t,i,r,s).recognize();return null===o?Mk(new g$):Ce(o)}catch(o){return Mk(o)}}(n,e,s.urlAfterRedirects,t(s.urlAfterRedirects),i,r).pipe(W(o=>Object.assign(Object.assign({},s),{targetSnapshot:o}))))}(this.rootComponentType,this.config,d=>this.serializeUrl(d),this.paramsInheritanceStrategy,this.relativeLinkResolution),Bn(d=>{if("eager"===this.urlUpdateStrategy){if(!d.extras.skipLocationChange){const f=this.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl);this.setBrowserUrl(f,d)}this.browserUrlTree=d.urlAfterRedirects}const h=new Yq(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot);i.next(h)}));if(c&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:h,extractedUrl:f,source:p,restoredState:m,extras:_}=a,y=new Zb(h,this.serializeUrl(f),p,m);i.next(y);const v=ak(f,this.rootComponentType).snapshot;return Ce(Object.assign(Object.assign({},a),{targetSnapshot:v,urlAfterRedirects:f,extras:Object.assign(Object.assign({},_),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=a.rawUrl,a.resolve(null),xr}),d0(a=>{const{targetSnapshot:l,id:c,extractedUrl:u,rawUrl:d,extras:{skipLocationChange:h,replaceUrl:f}}=a;return this.hooks.beforePreactivation(l,{navigationId:c,appliedUrlTree:u,rawUrlTree:d,skipLocationChange:!!h,replaceUrl:!!f})}),Bn(a=>{const l=new Zq(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot);this.triggerEvent(l)}),W(a=>Object.assign(Object.assign({},a),{guards:i$(a.targetSnapshot,a.currentSnapshot,this.rootContexts)})),function l$(n,e){return rn(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?Ce(Object.assign(Object.assign({},t),{guardsResult:!0})):function c$(n,e,t,i){return vn(n).pipe(rn(r=>function m$(n,e,t,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?Ce(s.map(a=>{const l=Gp(a,e,r);let c;if(function U9(n){return n&&Do(n.canDeactivate)}(l))c=cs(l.canDeactivate(n,e,t,i));else{if(!Do(l))throw new Error("Invalid CanDeactivate guard");c=cs(l(n,e,t,i))}return c.pipe(nc())})).pipe(fd()):Ce(!0)}(r.component,r.route,t,e,i)),nc(r=>!0!==r,!0))}(o,i,r,n).pipe(rn(a=>a&&function B9(n){return"boolean"==typeof n}(a)?function u$(n,e,t,i){return vn(e).pipe(Ql(r=>od(function h$(n,e){return null!==n&&e&&e(new Jq(n)),Ce(!0)}(r.route.parent,i),function d$(n,e){return null!==n&&e&&e(new t9(n)),Ce(!0)}(r.route,i),function p$(n,e,t){const i=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function r$(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>Ip(()=>Ce(o.guards.map(l=>{const c=Gp(l,o.node,t);let u;if(function j9(n){return n&&Do(n.canActivateChild)}(c))u=cs(c.canActivateChild(i,n));else{if(!Do(c))throw new Error("Invalid CanActivateChild guard");u=cs(c(i,n))}return u.pipe(nc())})).pipe(fd())));return Ce(s).pipe(fd())}(n,r.path,t),function f$(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return Ce(!0);const r=i.map(s=>Ip(()=>{const o=Gp(s,e,t);let a;if(function z9(n){return n&&Do(n.canActivate)}(o))a=cs(o.canActivate(e,n));else{if(!Do(o))throw new Error("Invalid CanActivate guard");a=cs(o(e,n))}return a.pipe(nc())}));return Ce(r).pipe(fd())}(n,r.route,t))),nc(r=>!0!==r,!0))}(i,s,n,e):Ce(a)),W(a=>Object.assign(Object.assign({},t),{guardsResult:a})))})}(this.ngModule.injector,a=>this.triggerEvent(a)),Bn(a=>{if(Ma(a.guardsResult)){const c=Xb(`Redirecting to "${this.serializeUrl(a.guardsResult)}"`);throw c.url=a.guardsResult,c}const l=new Xq(a.id,this.serializeUrl(a.extractedUrl),this.serializeUrl(a.urlAfterRedirects),a.targetSnapshot,!!a.guardsResult);this.triggerEvent(l)}),gn(a=>!!a.guardsResult||(this.restoreHistory(a),this.cancelNavigationTransition(a,""),!1)),d0(a=>{if(a.guards.canActivateChecks.length)return Ce(a).pipe(Bn(l=>{const c=new Kq(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}),Wi(l=>{let c=!1;return Ce(l).pipe(function C$(n,e){return rn(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return Ce(t);let s=0;return vn(r).pipe(Ql(o=>function E$(n,e,t,i){return function M$(n,e,t,i){const r=Object.keys(n);if(0===r.length)return Ce({});const s={};return vn(r).pipe(rn(o=>function T$(n,e,t,i){const r=Gp(n,e,i);return cs(r.resolve?r.resolve(e,t):r(e,t))}(n[o],e,t,i).pipe(Bn(a=>{s[o]=a}))),Yb(1),rn(()=>Object.keys(s).length===r.length?Ce(s):xr))}(n._resolve,n,e,i).pipe(W(s=>(n._resolvedData=s,n.data=Object.assign(Object.assign({},n.data),lk(n,t).resolve),null)))}(o.route,i,n,e)),Bn(()=>s++),Yb(1),rn(o=>s===r.length?Ce(t):xr))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Bn({next:()=>c=!0,complete:()=>{c||(this.restoreHistory(l),this.cancelNavigationTransition(l,"At least one route resolver didn't emit any value."))}}))}),Bn(l=>{const c=new Qq(l.id,this.serializeUrl(l.extractedUrl),this.serializeUrl(l.urlAfterRedirects),l.targetSnapshot);this.triggerEvent(c)}))}),d0(a=>{const{targetSnapshot:l,id:c,extractedUrl:u,rawUrl:d,extras:{skipLocationChange:h,replaceUrl:f}}=a;return this.hooks.afterPreactivation(l,{navigationId:c,appliedUrlTree:u,rawUrlTree:d,skipLocationChange:!!h,replaceUrl:!!f})}),W(a=>{const l=function M9(n,e,t){const i=ud(n,e._root,t?t._root:void 0);return new ok(i,e)}(this.routeReuseStrategy,a.targetSnapshot,a.currentRouterState);return Object.assign(Object.assign({},a),{targetRouterState:l})}),Bn(a=>{this.currentUrlTree=a.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(a.urlAfterRedirects,a.rawUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a),this.browserUrlTree=a.urlAfterRedirects)}),((n,e,t)=>W(i=>(new F9(e,i.targetRouterState,i.currentRouterState,t).activate(n),i)))(this.rootContexts,this.routeReuseStrategy,a=>this.triggerEvent(a)),Bn({next(){s=!0},complete(){s=!0}}),function zP(n){return H((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}(()=>{var a;s||o||this.cancelNavigationTransition(r,`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`),(null===(a=this.currentNavigation)||void 0===a?void 0:a.id)===r.id&&(this.currentNavigation=null)}),Gs(a=>{if(o=!0,function r9(n){return n&&n[WP]}(a)){const l=Ma(a.url);l||(this.navigated=!0,this.restoreHistory(r,!0));const c=new jP(r.id,this.serializeUrl(r.extractedUrl),a.message);i.next(c),l?setTimeout(()=>{const u=this.urlHandlingStrategy.merge(a.url,this.rawUrlTree),d={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Wp(r.source)};this.scheduleNavigation(u,"imperative",null,d,{resolve:r.resolve,reject:r.reject,promise:r.promise})},0):r.resolve(!1)}else{this.restoreHistory(r,!0);const l=new $q(r.id,this.serializeUrl(r.extractedUrl),a);i.next(l);try{r.resolve(this.errorHandler(a))}catch(c){r.reject(c)}}return xr}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{var r;const s={replaceUrl:!0},o=(null===(r=t.state)||void 0===r?void 0:r.navigationId)?t.state:null;if(o){const l=Object.assign({},o);delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t.url);this.scheduleNavigation(a,i,o,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){_k(t),this.config=t.map(c0),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=i,c=r||this.routerState.root,u=l?this.currentUrlTree.fragment:o;let d=null;switch(a){case"merge":d=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}return null!==d&&(d=this.removeEmptyProps(d)),function A9(n,e,t,i,r){if(0===t.length)return r0(e.root,e.root,e,i,r);const s=function D9(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new hk(!0,0,n);let e=0,t=!1;const i=n.reduce((r,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Hn(s.outlets,(l,c)=>{a[c]="string"==typeof l?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&r.push(a))}),r):[...r,s]},[]);return new hk(t,e,i)}(t);if(s.toRoot())return r0(e.root,new at([],{}),e,i,r);const o=function I9(n,e,t){if(n.isAbsolute)return new s0(e.root,!0,0);if(-1===t.snapshot._lastPathIndex){const s=t.snapshot._urlSegment;return new s0(s,s===e.root,0)}const i=Np(n.commands[0])?0:1;return function P9(n,e,t){let i=n,r=e,s=t;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Error("Invalid number of '../'");r=i.segments.length}return new s0(i,!1,r-s)}(t.snapshot._urlSegment,t.snapshot._lastPathIndex+i,n.numberOfDoubleDots)}(s,e,n),a=o.processChildren?Bp(o.segmentGroup,o.index,s.commands):fk(o.segmentGroup,o.index,s.commands);return r0(o.segmentGroup,a,e,i,r)}(c,this.currentUrlTree,t,d,null!=u?u:null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=Ma(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,i)}navigate(t,i={skipLocationChange:!1}){return function F$(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new Error(`The requested path contains ${t} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?Object.assign({},R$):!1===i?Object.assign({},L$):i,Ma(t))return XP(this.currentUrlTree,t,r);const s=this.parseUrl(t);return XP(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const s=t[r];return null!=s&&(i[r]=s),i},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new ad(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,i,r,s,o){var a,l,c;if(this.disposed)return Promise.resolve(!1);const u=this.transitions.value,d=Wp(i)&&u&&!Wp(u.source),h=u.rawUrl.toString()===t.toString(),f=u.id===(null===(a=this.currentNavigation)||void 0===a?void 0:a.id);if(d&&h&&f)return Promise.resolve(!0);let m,_,y;o?(m=o.resolve,_=o.reject,y=o.promise):y=new Promise((M,R)=>{m=M,_=R});const v=++this.navigationId;let E;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),E=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(l=this.browserPageId)&&void 0!==l?l:0:(null!==(c=this.browserPageId)&&void 0!==c?c:0)+1):E=0,this.setTransition({id:v,targetPageId:E,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:s,resolve:m,reject:_,promise:y,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),y.catch(M=>Promise.reject(M))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t),s=Object.assign(Object.assign({},i.extras.state),this.generateNgRouterState(i.id,i.targetPageId));this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,i=!1){var r,s;if("computed"===this.canceledNavigationResolution){const o=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)||0===o?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===o&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(o)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,i){const r=new jP(t.id,this.serializeUrl(t.extractedUrl),i);this.triggerEvent(r),t.resolve(!1)}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){wf()},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();function Wp(n){return"imperative"!==n}class Ok{}class Rk{preload(e,t){return Ce(null)}}let Lk=(()=>{class n{constructor(t,i,r,s){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=new Pk(r,i,l=>t.triggerEvent(new UP(l)),l=>t.triggerEvent(new HP(l)))}setUpPreloading(){this.subscription=this.router.events.pipe(gn(t=>t instanceof ad),Ql(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(Ns);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const s of i)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const o=s._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else s.loadChildren&&!s.canLoad?r.push(this.preloadConfig(t,s)):s.children&&r.push(this.processRoutes(t,s.children));return vn(r).pipe(Wr(),W(s=>{}))}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>(i._loadedConfig?Ce(i._loadedConfig):this.loader.load(t.injector,i)).pipe(rn(s=>(i._loadedConfig=s,this.processRoutes(s.module,s.routes)))))}}return n.\u0275fac=function(t){return new(t||n)(L(Vn),L(Ff),L(Nt),L(Ok))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})(),m0=(()=>{class n{constructor(t,i,r={}){this.router=t,this.viewportScroller=i,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Zb?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof ad&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof GP&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.router.triggerEvent(new GP(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){wf()},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();const Ta=new q("ROUTER_CONFIGURATION"),Fk=new q("ROUTER_FORROOT_GUARD"),z$=[Zl,{provide:ek,useClass:tk},{provide:Vn,useFactory:function W$(n,e,t,i,r,s,o={},a,l){const c=new Vn(null,n,e,t,i,r,$P(s));return a&&(c.urlHandlingStrategy=a),l&&(c.routeReuseStrategy=l),function q$(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(e.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(e.canceledNavigationResolution=n.canceledNavigationResolution)}(o,c),o.enableTracing&&c.events.subscribe(u=>{var d,h;null===(d=console.group)||void 0===d||d.call(console,`Router Event: ${u.constructor.name}`),console.log(u.toString()),console.log(u),null===(h=console.groupEnd)||void 0===h||h.call(console)}),c},deps:[ek,pd,Zl,Nt,Ff,h0,Ta,[class I${},new Bi],[class S${},new Bi]]},pd,{provide:sc,useFactory:function $$(n){return n.routerState.root},deps:[Vn]},Lk,Rk,class V${preload(e,t){return t().pipe(Gs(()=>Ce(null)))}},{provide:Ta,useValue:{enableTracing:!1}}];function j$(){return new g1("Router",Vn)}let Nk=(()=>{class n{constructor(t,i){}static forRoot(t,i){return{ngModule:n,providers:[z$,Bk(t),{provide:Fk,useFactory:G$,deps:[[Vn,new Bi,new ua]]},{provide:Ta,useValue:i||{}},{provide:Yl,useFactory:H$,deps:[_a,[new yu(yv),new Bi],Ta]},{provide:m0,useFactory:U$,deps:[Vn,t8,Ta]},{provide:Ok,useExisting:i&&i.preloadingStrategy?i.preloadingStrategy:Rk},{provide:g1,multi:!0,useFactory:j$},[g0,{provide:Hu,multi:!0,useFactory:Y$,deps:[g0]},{provide:Vk,useFactory:Z$,deps:[g0]},{provide:c1,multi:!0,useExisting:Vk}]]}}static forChild(t){return{ngModule:n,providers:[Bk(t)]}}}return n.\u0275fac=function(t){return new(t||n)(L(Fk,8),L(Vn,8))},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({}),n})();function U$(n,e,t){return t.scrollOffset&&e.setOffset(t.scrollOffset),new m0(n,e,t)}function H$(n,e,t={}){return t.useHash?new z6(n,e):new B1(n,e)}function G$(n){return"guarded"}function Bk(n){return[{provide:hV,multi:!0,useValue:n},{provide:h0,multi:!0,useValue:n}]}let g0=(()=>{class n{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new O}appInitializer(){return this.injector.get(N6,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let i=null;const r=new Promise(a=>i=a),s=this.injector.get(Vn),o=this.injector.get(Ta);return"disabled"===o.initialNavigation?(s.setUpLocationChangeListener(),i(!0)):"enabled"===o.initialNavigation||"enabledBlocking"===o.initialNavigation?(s.hooks.afterPreactivation=()=>this.initNavigation?Ce(null):(this.initNavigation=!0,i(!0),this.resultOfPreactivationDone),s.initialNavigation()):i(!0),r})}bootstrapListener(t){const i=this.injector.get(Ta),r=this.injector.get(Lk),s=this.injector.get(m0),o=this.injector.get(Vn),a=this.injector.get(ql);t===a.components[0]&&(("enabledNonBlocking"===i.initialNavigation||void 0===i.initialNavigation)&&o.initialNavigation(),r.setUpPreloading(),s.init(),o.resetRootComponentType(a.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return n.\u0275fac=function(t){return new(t||n)(L(Nt))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();function Y$(n){return n.appInitializer.bind(n)}function Z$(n){return n.bootstrapListener.bind(n)}const Vk=new q("Router Initializer");class qp{constructor(e){this.type={id:"none",tileurl:"",format:"XYZ"},this.minzoom=4,this.maxzoom=20,this.maxnativezoom=16,this.tile_params=[],this.year=2020,this.showControl=!0,Object.assign(this,e),this.handlers={click:(e.handlers||{click:()=>{}}).click,mousemove:(e.handlers||{mousemove:()=>{}}).mousemove},this.opacity=e.opacity||0===e.opacity?e.opacity:.6,this.config()}config(){this.bounds||(this.bounds=new google.maps.LatLngBounds(new google.maps.LatLng(40.005779201292384,-114.60604051826046),new google.maps.LatLng(56.12908567856297,-96.300538948688)))}}let Q$=(()=>{class n{constructor(){}get_static_style(t){const i=[];return t.forEach(function(r,s,o){let a="";r.stylers&&r.stylers.length>0&&(a+=(r.hasOwnProperty("featureType")?"feature:"+r.featureType:"feature:all")+"|",a+=(r.hasOwnProperty("elementType")?"element:"+r.elementType:"element:all")+"|",r.stylers.forEach(l=>{const c=Object.keys(l)[0],u=l[c].toString().replace("#","0x");a+=c+":"+u+"|"})),i.push("style="+encodeURIComponent(a))}),i.join("&")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ac=(()=>{class n{constructor(t){this.styleConverter=t,this.basemapSource=new mt("roadmap"),this.basemap=this.basemapSource.asObservable(),this.overlaysSource=new mt([]),this.overlays=this.overlaysSource.asObservable(),this.clickSource=new O,this.click=this.clickSource.asObservable(),this.zoomSource=new mt(6),this.zoom=this.zoomSource.asObservable(),this.boundsSource=new O,this.bounds=this.boundsSource.asObservable(),this.centerSource=new mt(void 0),this.center=this.centerSource.asObservable(),this.infoWindowSource=new O,this.infoWindow=this.infoWindowSource.asObservable()}setClickHandler(t){this.clickSource.next(t)}setOverlay(t,i){if(t&&t instanceof qp){const r=this.overlaysSource.getValue();this.removeOverlay(t),r.splice(i||r.length,0,t),this.overlaysSource.next(r)}}removeOverlay(t){if(t){const i=this.overlaysSource.getValue();this.overlaysSource.next(i.filter(r=>r.id!==t.id))}}refresh(){const t=this.overlaysSource.getValue();this.overlaysSource.next([]),this.overlaysSource.next(t)}setBasemap(t){this.basemapSource.next(t)}setZoom(t){t&&this.zoomSource.next(t)}setBounds(t){t&&this.boundsSource.next(t)}setCenter(t){t&&this.centerSource.next(t)}openWindow(t){this.infoWindowSource.next(t)}}return n.\u0275fac=function(t){return new(t||n)(L(Q$))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})(),Sa=(()=>{class n{constructor(t,i){this.router=t,this.location=i,this.urlSubject=new mt(this.location.path()),this.url=this.urlSubject.asObservable()}getParams(){return this.router.parseUrl(this.router.url).queryParams}updateUrlParams(t){const i=this.router.createUrlTree([],{queryParams:this.cleanParams(Object.assign(this.router.parseUrl(this.router.url).queryParams,t))}),r=this.router.createUrlTree([],{queryParams:this.cleanParams(this.router.parseUrl(this.router.url).queryParams)});i.toString()!==r.toString()&&(this.router.navigateByUrl(i,{replaceUrl:!0,skipLocationChange:!1}),this.urlSubject.next(i.toString()))}cleanParams(t){const i={};return Object.keys(t).filter(r=>t[r]||0===t[r]).forEach(r=>i[r]=t[r]),i}}return n.\u0275fac=function(t){return new(t||n)(L(Vn),L(Zl))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();const J$={version:"1.3.1",toHtml(n,e){const i=Object.assign(Object.assign({},{indent:3,lineNumbers:!1,linkUrls:!0,linksNewTab:!0,quoteKeys:!1}),e),s=(f,p)=>p?"<span class=json-"+f+">"+p+"</span>":"",u=(f=JSON.stringify(n,null,i.indent)||"undefined",f.replace(/&/g,"&amp;").replace(/\\"/g,"&bsol;&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/^( *)("[^"]+": )?("[^"]*"|[\w.+-]*)?([{}[\],]*)?$/gm,(f,p,m,_,y)=>{const v={indent:p,key:m,value:_,end:y},M=v.indent||"",R=v.key&&v.key.replace(i.quoteKeys?/(.*)(): /:/"([\w$]+)": |(.*): /,"$1$2"),B=v.key?s("key",R)+s("mark",": "):"",V=v.value?(f=>{const p=/^"/.test(f)&&"string",y=(["true","false"].includes(f)?"boolean":"null"===f&&"null")||p||"number",E=i.linksNewTab?" target=_blank":"",R=p&&i.linkUrls?f.replace(/https?:\/\/[^\s"]+/g,B=>`<a class=json-link href="${B}"${E}>${B}</a>`):f;return s(y,R)})(v.value):"";return M+B+V+s("mark",v.end)}),d=f=>`   <li>${f}</li>`;var f;return i.lineNumbers?(f=>["<ol class=json-lines>",...f.split("\n").map(d),"</ol>"].join("\n"))(u):u}},eY=Di("rollUpDown",[yn("up",ve({height:"0px"})),yn("down",ve({height:"*"})),jt(":enter",[ve({height:0,overflow:"hidden"}),$t(300,ve({height:"*"}))]),jt(":leave",[ve({height:"*",display:"block",overflow:"hidden"}),$t(300,ve({height:0}))])]),tY=(Di("expandWidth",[jt(":enter",[ve({width:"0px",overflow:"hidden"}),$t(500,ve({width:"*"}))]),jt(":leave",[$t(500,ve({width:"0px"}))])]),Di("flyInOut",[yn("out",ve({width:"0px"})),yn("in",ve({width:"*"})),jt(":enter",[ve({width:"0px"}),$t(700,ve({width:"*"}))]),jt(":leave",[ve({width:"*"}),$t(700,ve({width:"0px"}))])]),Di("fadeInOut",[yn("out",ve({opacity:0})),yn("in",ve({opacity:1})),jt(":enter",[ve({opacity:0}),$t(400,ve({opacity:"*"}))]),jt(":leave",[ve({opacity:"*"}),$t(400,ve({opacity:0}))])]),Di("spinInOut",[jt(":enter",[ve({opacity:0}),$t(400,ve({opacity:1,transform:"*"}))]),jt(":leave",[ve({transform:"*"}),$t(400,ve({opacity:0,transform:"rotate(0.5turn)"}))])]));function Kt(n){return null!=n&&"false"!=`${n}`}function us(n,e=0){return function nY(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}function $p(n){return Array.isArray(n)?n:[n]}function Cn(n){return null==n?"":"string"==typeof n?n:`${n}px`}function Aa(n){return n instanceof pt?n.nativeElement:n}const iY=["addListener","removeListener"],rY=["addEventListener","removeEventListener"],sY=["on","off"];function lc(n,e,t,i){if(K(t)&&(i=t,t=void 0),i)return lc(n,e,t).pipe(Vv(i));const[r,s]=function lY(n){return K(n.addEventListener)&&K(n.removeEventListener)}(n)?rY.map(o=>a=>n[o](e,a,t)):function oY(n){return K(n.addListener)&&K(n.removeListener)}(n)?iY.map(zk(n,e)):function aY(n){return K(n.on)&&K(n.off)}(n)?sY.map(zk(n,e)):[];if(!r&&$a(n))return rn(o=>lc(o,e,t))(ai(n));if(!r)throw new TypeError("Invalid event target");return new D(o=>{const a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function zk(n,e){return t=>i=>n[t](e,i)}class cY extends ee{constructor(e,t){super()}schedule(e,t=0){return this}}const Yp={setInterval(...n){const{delegate:e}=Yp;return((null==e?void 0:e.setInterval)||setInterval)(...n)},clearInterval(n){const{delegate:e}=Yp;return((null==e?void 0:e.clearInterval)||clearInterval)(n)},delegate:void 0};class _0 extends cY{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return Yp.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;Yp.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Ht(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const yd={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=yd;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=e(s=>{t=void 0,n(s)});return new ee(()=>null==t?void 0:t(r))},requestAnimationFrame(...n){const{delegate:e}=yd;return((null==e?void 0:e.requestAnimationFrame)||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=yd;return((null==e?void 0:e.cancelAnimationFrame)||cancelAnimationFrame)(...n)},delegate:void 0},jk={now:()=>(jk.delegate||Date).now(),delegate:void 0};class vd{constructor(e,t=vd.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}vd.now=jk.now;class y0 extends vd{constructor(e,t=vd.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}new class dY extends y0{flush(e){this._active=!0,this._scheduled=void 0;const{actions:t}=this;let i,r=-1;e=e||t.shift();const s=t.length;do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this._active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class uY extends _0{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=yd.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){if(null!=i&&i>0||null==i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(yd.cancelAnimationFrame(t),e._scheduled=void 0)}});let v0,fY=1;const Zp={};function Uk(n){return n in Zp&&(delete Zp[n],!0)}const pY={setImmediate(n){const e=fY++;return Zp[e]=!0,v0||(v0=Promise.resolve()),v0.then(()=>Uk(e)&&n()),e},clearImmediate(n){Uk(n)}},{setImmediate:mY,clearImmediate:gY}=pY,Xp={setImmediate(...n){const{delegate:e}=Xp;return((null==e?void 0:e.setImmediate)||mY)(...n)},clearImmediate(n){const{delegate:e}=Xp;return((null==e?void 0:e.clearImmediate)||gY)(n)},delegate:void 0},b0=new class yY extends y0{flush(e){this._active=!0,this._scheduled=void 0;const{actions:t}=this;let i,r=-1;e=e||t.shift();const s=t.length;do{if(i=e.execute(e.state,e.delay))break}while(++r<s&&(e=t.shift()));if(this._active=!1,i){for(;++r<s&&(e=t.shift());)e.unsubscribe();throw i}}}(class _Y extends _0{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=Xp.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){if(null!=i&&i>0||null==i&&this.delay>0)return super.recycleAsyncId(e,t,i);0===e.actions.length&&(Xp.clearImmediate(t),e._scheduled=void 0)}}),w0=new y0(_0),Hk=w0;function Gk(n=0,e,t=Hk){let i=-1;return null!=e&&(Za(e)?t=e:i=e),new D(r=>{let s=function bY(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}function Wk(n,e=Hk){return function vY(n){return H((e,t)=>{let i=!1,r=null,s=null,o=!1;const a=()=>{if(null==s||s.unsubscribe(),s=null,i){i=!1;const c=r;r=null,t.next(c)}o&&t.complete()},l=()=>{s=null,o&&t.complete()};e.subscribe(new Q(t,c=>{i=!0,r=c,s||ai(n(c)).subscribe(s=new Q(t,a,l))},()=>{o=!0,(!i||!s||s.closed)&&t.complete()}))})}(()=>Gk(n,e))}let x0;try{x0="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(n){x0=!1}let bd,Da,C0,qi=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function nD(n){return n===tD}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!x0)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(L(Wl))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Io(n){return function wY(){if(null==bd&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>bd=!0}))}finally{bd=bd||!1}return bd}()?n:!!n.capture}function xY(){if(null==Da){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Da=!1,Da;if("scrollBehavior"in document.documentElement.style)Da=!0;else{const n=Element.prototype.scrollTo;Da=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return Da}function $k(n){if(function CY(){if(null==C0){const n="undefined"!=typeof document?document.head:null;C0=!(!n||!n.createShadowRoot&&!n.attachShadow)}return C0}()){const e=n.getRootNode?n.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function E0(){let n="undefined"!=typeof document&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const e=n.shadowRoot.activeElement;if(e===n)break;n=e}return n}function Po(n){return n.composedPath?n.composedPath()[0]:n.target}function M0(){return"undefined"!=typeof __karma__&&!!__karma__||"undefined"!=typeof jasmine&&!!jasmine||"undefined"!=typeof jest&&!!jest||"undefined"!=typeof Mocha&&!!Mocha}const EY=new q("cdk-dir-doc",{providedIn:"root",factory:function MY(){return nf(je)}}),TY=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let uc=(()=>{class n{constructor(t){if(this.value="ltr",this.change=new Oe,t){const r=t.documentElement?t.documentElement.dir:null;this.value=function SY(n){const e=(null==n?void 0:n.toLowerCase())||"";return"auto"===e&&"undefined"!=typeof navigator&&(null==navigator?void 0:navigator.language)?TY.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||r||"ltr")}}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(t){return new(t||n)(L(EY,8))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),wd=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({}),n})(),DY=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new O,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new D(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(Wk(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Ce()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(gn(s=>!s||r.indexOf(s)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,s)=>{this._scrollableContainsElement(s,t)&&i.push(s)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=Aa(i),s=t.getElementRef().nativeElement;do{if(r==s)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>lc(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(t){return new(t||n)(L(_e),L(qi),L(je,8))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Qp=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new O,this._changeListener=s=>{this._change.next(s)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const s=this._getWindow();s.addEventListener("resize",this._changeListener),s.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,s=r.getBoundingClientRect();return{top:-s.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-s.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(Wk(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(t){return new(t||n)(L(qi),L(_e),L(je,8))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),dc=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({}),n})(),Yk=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[wd,dc],wd,dc]}),n})();class T0{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class xd extends T0{constructor(e,t,i,r){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=r}}class Cd extends T0{constructor(e,t,i){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class PY extends T0{constructor(e){super(),this.element=e instanceof pt?e.nativeElement:e}}class Jp{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof xd?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof Cd?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof PY?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class kY extends Jp{constructor(e,t,i,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=r,this.attachDomPortal=o=>{const a=o.element,l=this._document.createComment("dom-portal");a.parentNode.insertBefore(l,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(a,l)})},this._document=s}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector),this.setDisposeFn(()=>r.destroy())):(r=i.create(e.injector||this._defaultInjector||Nt.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context);return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let em=(()=>{class n extends Jp{constructor(t,i,r){super(),this._componentFactoryResolver=t,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new Oe,this.attachDomPortal=s=>{const o=s.element,a=this._document.createComment("dom-portal");s.setAttachedHost(this),o.parentNode.insertBefore(a,o),this._getRootNode().appendChild(o),this._attachedPortal=s,super.setDisposeFn(()=>{a.parentNode&&a.parentNode.replaceChild(o,a)})},this._document=r}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(t){t.setAttachedHost(this);const i=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,s=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),o=i.createComponent(s,i.length,t.injector||i.injector);return i!==this._viewContainerRef&&this._getRootNode().appendChild(o.hostView.rootNodes[0]),super.setDisposeFn(()=>o.destroy()),this._attachedPortal=t,this._attachedRef=o,this.attached.emit(o),o}attachTemplatePortal(t){t.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context);return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}}return n.\u0275fac=function(t){return new(t||n)(T(bo),T(Mi),T(je))},n.\u0275dir=te({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[ke]}),n})(),tm=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({}),n})();function Pt(n){return H((e,t)=>{ai(n).subscribe(new Q(t,()=>t.complete(),re)),!t.closed&&e.subscribe(t)})}const Zk=xY();class OY{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=Cn(-this._previousScrollPosition.left),e.style.top=Cn(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,r=this._document.body.style,s=i.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),Zk&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),Zk&&(i.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class RY{constructor(e,t,i,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class Xk{enable(){}disable(){}attach(){}}function S0(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function Kk(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class LY{constructor(e,t,i,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();S0(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let FY=(()=>{class n{constructor(t,i,r,s){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=r,this.noop=()=>new Xk,this.close=o=>new RY(this._scrollDispatcher,this._ngZone,this._viewportRuler,o),this.block=()=>new OY(this._viewportRuler,this._document),this.reposition=o=>new LY(this._scrollDispatcher,this._viewportRuler,this._ngZone,o),this._document=s}}return n.\u0275fac=function(t){return new(t||n)(L(DY),L(Qp),L(_e),L(je))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Ed{constructor(e){if(this.scrollStrategy=new Xk,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class NY{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}class BY{constructor(e,t,i,r,s,o,a,l,c){this._portalOutlet=e,this._host=t,this._pane=i,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=l,this._outsideClickDispatcher=c,this._backdropElement=null,this._backdropClick=new O,this._attachments=new O,this._detachments=new O,this._locationChanges=ee.EMPTY,this._backdropClickHandler=u=>this._backdropClick.next(u),this._backdropTransitionendHandler=u=>{this._disposeBackdrop(u.target)},this._keydownEvents=new O,this._outsidePointerEvents=new O,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(Mt(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){var e;const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),null===(e=this._host)||void 0===e||e.remove(),this._previousHostParent=this._pane=this._host=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config=Object.assign(Object.assign({},this._config),e),this._updateElementSize()}setDirection(e){this._config=Object.assign(Object.assign({},this._config),{direction:e}),this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=Cn(this._config.width),e.height=Cn(this._config.height),e.minWidth=Cn(this._config.minWidth),e.minHeight=Cn(this._config.minHeight),e.maxWidth=Cn(this._config.maxWidth),e.maxHeight=Cn(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;!e||(e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500)))}_toggleClasses(e,t,i){const r=$p(t||[]).filter(s=>!!s);r.length&&(i?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(Pt(Cr(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}let A0=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){var t;null===(t=this._containerElement)||void 0===t||t.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||M0()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let s=0;s<r.length;s++)r[s].remove()}const i=this._document.createElement("div");i.classList.add(t),M0()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}}return n.\u0275fac=function(t){return new(t||n)(L(je),L(qi))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Qk="cdk-overlay-connected-position-bounding-box",VY=/([A-Za-z%]+)$/;class zY{constructor(e,t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new O,this._resizeSubscription=ee.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}get positions(){return this._preferredPositions}attach(e){this._validatePositions(),e.hostElement.classList.add(Qk),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,s=[];let o;for(let a of this._preferredPositions){let l=this._getOriginPoint(e,r,a),c=this._getOverlayPoint(l,t,a),u=this._getOverlayFit(c,t,i,a);if(u.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(a,l);this._canFitWithFlexibleDimensions(u,c,i)?s.push({position:a,origin:l,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(l,a)}):(!o||o.overlayFit.visibleArea<u.visibleArea)&&(o={overlayFit:u,overlayPoint:c,originPoint:l,position:a,overlayRect:t})}if(s.length){let a=null,l=-1;for(const c of s){const u=c.boundingBoxRect.width*c.boundingBoxRect.height*(c.position.weight||1);u>l&&(l=u,a=c)}return this._isPushed=!1,void this._applyPosition(a.position,a.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(o.position,o.originPoint);this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Ia(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(Qk),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,i){let r,s;if("center"==i.originX)r=e.left+e.width/2;else{const o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;r="start"==i.originX?o:a}return t.left<0&&(r-=t.left),s="center"==i.originY?e.top+e.height/2:"top"==i.originY?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,i){let r,s;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,s="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,i,r){const s=eO(t);let{x:o,y:a}=e,l=this._getOffset(r,"x"),c=this._getOffset(r,"y");l&&(o+=l),c&&(a+=c);let h=0-a,f=a+s.height-i.height,p=this._subtractOverflows(s.width,0-o,o+s.width-i.width),m=this._subtractOverflows(s.height,h,f),_=p*m;return{visibleArea:_,isCompletelyWithinViewport:s.width*s.height===_,fitsInViewportVertically:m===s.height,fitsInViewportHorizontally:p==s.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,s=i.right-t.x,o=Jk(this._overlayRef.getConfig().minHeight),a=Jk(this._overlayRef.getConfig().minWidth),c=e.fitsInViewportHorizontally||null!=a&&a<=s;return(e.fitsInViewportVertically||null!=o&&o<=r)&&c}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const r=eO(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),l=Math.max(s.top-i.top-e.y,0),c=Math.max(s.left-i.left-e.x,0);let u=0,d=0;return u=r.width<=s.width?c||-o:e.x<this._viewportMargin?s.left-i.left-e.x:0,d=r.height<=s.height?l||-a:e.y<this._viewportMargin?s.top-i.top-e.y:0,this._previousPushAmount={x:u,y:d},{x:e.x+u,y:e.y+d}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const i=this._getScrollVisibility(),r=new NY(e,i);this._positionChanges.next(r)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,r=this._isRtl();let s,o,a,u,d,h;if("top"===t.overlayY)o=e.y,s=i.height-o+this._viewportMargin;else if("bottom"===t.overlayY)a=i.height-e.y+2*this._viewportMargin,s=i.height-a+this._viewportMargin;else{const f=Math.min(i.bottom-e.y+i.top,e.y),p=this._lastBoundingBoxSize.height;s=2*f,o=e.y-f,s>p&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-p/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)h=i.width-e.x+this._viewportMargin,u=e.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)d=e.x,u=i.right-e.x;else{const f=Math.min(i.right-e.x+i.left,e.x),p=this._lastBoundingBoxSize.width;u=2*f,d=e.x-f,u>p&&!this._isInitialRender&&!this._growAfterOpen&&(d=e.x-p/2)}return{top:o,left:d,bottom:a,right:h,width:u,height:s}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=Cn(i.height),r.top=Cn(i.top),r.bottom=Cn(i.bottom),r.width=Cn(i.width),r.left=Cn(i.left),r.right=Cn(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",s&&(r.maxHeight=Cn(s)),o&&(r.maxWidth=Cn(o))}this._lastBoundingBoxSize=i,Ia(this._boundingBox.style,r)}_resetBoundingBoxStyles(){Ia(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Ia(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const u=this._viewportRuler.getViewportScrollPosition();Ia(i,this._getExactOverlayY(t,e,u)),Ia(i,this._getExactOverlayX(t,e,u))}else i.position="static";let a="",l=this._getOffset(t,"x"),c=this._getOffset(t,"y");l&&(a+=`translateX(${l}px) `),c&&(a+=`translateY(${c}px)`),i.transform=a.trim(),o.maxHeight&&(r?i.maxHeight=Cn(o.maxHeight):s&&(i.maxHeight="")),o.maxWidth&&(r?i.maxWidth=Cn(o.maxWidth):s&&(i.maxWidth="")),Ia(this._pane.style,i)}_getExactOverlayY(e,t,i){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),"bottom"===e.overlayY?r.bottom=this._document.documentElement.clientHeight-(s.y+this._overlayRect.height)+"px":r.top=Cn(s.y),r}_getExactOverlayX(e,t,i){let o,r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,i)),o=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===o?r.right=this._document.documentElement.clientWidth-(s.x+this._overlayRect.width)+"px":r.left=Cn(s.x),r}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Kk(e,i),isOriginOutsideView:S0(e,i),isOverlayClipped:Kk(t,i),isOverlayOutsideView:S0(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,r)=>i-Math.max(r,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&$p(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof pt)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function Ia(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function Jk(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(VY);return t&&"px"!==t?null:parseFloat(e)}return n||null}function eO(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const tO="cdk-global-overlay-wrapper";class jY{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(tO),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._rightOffset="",this._leftOffset=e,this._justifyContent="flex-start",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._leftOffset="",this._rightOffset=e,this._justifyContent="flex-end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._justifyContent="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=i,l=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),c=!("100%"!==s&&"100vh"!==s||a&&"100%"!==a&&"100vh"!==a);e.position=this._cssPosition,e.marginLeft=l?"0":this._leftOffset,e.marginTop=c?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=this._rightOffset,l?t.justifyContent="flex-start":"center"===this._justifyContent?t.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?t.justifyContent="flex-end":"flex-end"===this._justifyContent&&(t.justifyContent="flex-start"):t.justifyContent=this._justifyContent,t.alignItems=c?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(tO),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let UY=(()=>{class n{constructor(t,i,r,s){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=s}global(){return new jY}flexibleConnectedTo(t){return new zY(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(t){return new(t||n)(L(Qp),L(je),L(qi),L(A0))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),nO=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(t){return new(t||n)(L(je))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),HY=(()=>{class n extends nO{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=r=>{const s=this._attachedOverlays;for(let o=s.length-1;o>-1;o--)if(s[o]._keydownEvents.observers.length>0){const a=s[o]._keydownEvents;this._ngZone?this._ngZone.run(()=>a.next(r)):a.next(r);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(t){return new(t||n)(L(je),L(_e,8))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),GY=(()=>{class n extends nO{constructor(t,i,r){super(t),this._platform=i,this._ngZone=r,this._cursorStyleIsSet=!1,this._pointerDownListener=s=>{this._pointerDownEventTarget=Po(s)},this._clickListener=s=>{const o=Po(s),a="click"===s.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:o;this._pointerDownEventTarget=null;const l=this._attachedOverlays.slice();for(let c=l.length-1;c>-1;c--){const u=l[c];if(u._outsidePointerEvents.observers.length<1||!u.hasAttached())continue;if(u.overlayElement.contains(o)||u.overlayElement.contains(a))break;const d=u._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>d.next(s)):d.next(s)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}}return n.\u0275fac=function(t){return new(t||n)(L(je),L(qi),L(_e,8))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),WY=0,_r=(()=>{class n{constructor(t,i,r,s,o,a,l,c,u,d,h){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=r,this._positionBuilder=s,this._keyboardDispatcher=o,this._injector=a,this._ngZone=l,this._document=c,this._directionality=u,this._location=d,this._outsideClickDispatcher=h}create(t){const i=this._createHostElement(),r=this._createPaneElement(i),s=this._createPortalOutlet(r),o=new Ed(t);return o.direction=o.direction||this._directionality.value,new BY(s,i,r,o,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+WY++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(ql)),new kY(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(t){return new(t||n)(L(FY),L(A0),L(bo),L(UY),L(HY),L(Nt),L(_e),L(je),L(uc),L(Zl),L(GY))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();const YY={provide:new q("cdk-connected-overlay-scroll-strategy"),deps:[_r],useFactory:function $Y(n){return()=>n.scrollStrategies.reposition()}};let hc=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:[_r,YY],imports:[[wd,tm,Yk],Yk]}),n})();function $s(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}function I0(n,e=w0){return H((t,i)=>{let r=null,s=null,o=null;const a=()=>{if(r){r.unsubscribe(),r=null;const c=s;s=null,i.next(c)}};function l(){const c=o+n,u=e.now();if(u<c)return r=this.schedule(void 0,c-u),void i.add(r);a()}t.subscribe(new Q(i,c=>{s=c,o=e.now(),r||(r=e.schedule(l,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{s=r=null}))})}function cO(n){return gn((e,t)=>n<=t)}function oZ(n,e){return n===e}let uO=(()=>{class n{create(t){return"undefined"==typeof MutationObserver?null:new MutationObserver(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),aZ=(()=>{class n{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,i)=>this._cleanupObserver(i))}observe(t){const i=Aa(t);return new D(r=>{const o=this._observeElement(i).subscribe(r);return()=>{o.unsubscribe(),this._unobserveElement(i)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const i=new O,r=this._mutationObserverFactory.create(s=>i.next(s));r&&r.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:r,stream:i,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:i,stream:r}=this._observedElements.get(t);i&&i.disconnect(),r.complete(),this._observedElements.delete(t)}}}return n.\u0275fac=function(t){return new(t||n)(L(uO))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),dO=(()=>{class n{constructor(t,i,r){this._contentObserver=t,this._elementRef=i,this._ngZone=r,this.event=new Oe,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(t){this._disabled=Kt(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=us(t),this._subscribe()}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(I0(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){var t;null===(t=this._currentSubscription)||void 0===t||t.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(T(aZ),T(pt),T(_e))},n.\u0275dir=te({type:n,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),n})(),Td=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:[uO]}),n})();class pO extends class uZ{constructor(e){this._items=e,this._activeItemIndex=-1,this._activeItem=null,this._wrap=!1,this._letterKeyStream=new O,this._typeaheadSubscription=ee.EMPTY,this._vertical=!0,this._allowedModifierKeys=[],this._homeAndEnd=!1,this._skipPredicateFn=t=>t.disabled,this._pressedLetters=[],this.tabOut=new O,this.change=new O,e instanceof Ul&&e.changes.subscribe(t=>{if(this._activeItem){const r=t.toArray().indexOf(this._activeItem);r>-1&&r!==this._activeItemIndex&&(this._activeItemIndex=r)}})}skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){return this._typeaheadSubscription.unsubscribe(),this._typeaheadSubscription=this._letterKeyStream.pipe(Bn(t=>this._pressedLetters.push(t)),I0(e),gn(()=>this._pressedLetters.length>0),W(()=>this._pressedLetters.join(""))).subscribe(t=>{const i=this._getItemsArray();for(let r=1;r<i.length+1;r++){const s=(this._activeItemIndex+r)%i.length,o=i[s];if(!this._skipPredicateFn(o)&&0===o.getLabel().toUpperCase().trim().indexOf(t)){this.setActiveItem(s);break}}this._pressedLetters=[]}),this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}setActiveItem(e){const t=this._activeItem;this.updateActiveItem(e),this._activeItem!==t&&this.change.next(this._activeItemIndex)}onKeydown(e){const t=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(s=>!e[s]||this._allowedModifierKeys.indexOf(s)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;default:return void((r||$s(e,"shiftKey"))&&(e.key&&1===e.key.length?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))))}this._pressedLetters=[],e.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem}isTyping(){return this._pressedLetters.length>0}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._items.length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){const t=this._getItemsArray(),i="number"==typeof e?e:t.indexOf(e),r=t[i];this._activeItem=null==r?null:r,this._activeItemIndex=i}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){const t=this._getItemsArray();for(let i=1;i<=t.length;i++){const r=(this._activeItemIndex+e*i+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex+e,e)}_setActiveItemByIndex(e,t){const i=this._getItemsArray();if(i[e]){for(;this._skipPredicateFn(i[e]);)if(!i[e+=t])return;this.setActiveItem(e)}}_getItemsArray(){return this._items instanceof Ul?this._items.toArray():this._items}}{constructor(){super(...arguments),this._origin="program"}setFocusOrigin(e){return this._origin=e,this}setActiveItem(e){super.setActiveItem(e),this.activeItem&&this.activeItem.focus(this._origin)}}let mO=(()=>{class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function hZ(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const i=function dZ(n){try{return n.frameElement}catch(e){return null}}(function bZ(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(t));if(i&&(-1===_O(i)||!this.isVisible(i)))return!1;let r=t.nodeName.toLowerCase(),s=_O(t);return t.hasAttribute("contenteditable")?-1!==s:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function yZ(n){let e=n.nodeName.toLowerCase(),t="input"===e&&n.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==s:"video"===r?-1!==s&&(null!==s||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,i){return function vZ(n){return!function pZ(n){return function gZ(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function fZ(n){let e=n.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(n)||function mZ(n){return function _Z(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||gO(n))}(t)&&!this.isDisabled(t)&&((null==i?void 0:i.ignoreVisibility)||this.isVisible(t))}}return n.\u0275fac=function(t){return new(t||n)(L(qi))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function gO(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let e=n.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function _O(n){if(!gO(n))return null;const e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class wZ{constructor(e,t,i,r,s=!1){this._element=e,this._checker=t,this._ngZone=i,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,s||this.attachAnchors()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const i=this._getFirstTabbableElement(t);return null==i||i.focus(e),!!i}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=0;i<t.length;i++){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=t.length-1;i>=0;i--){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(Mt(1)).subscribe(e)}}let xZ=(()=>{class n{constructor(t,i,r){this._checker=t,this._ngZone=i,this._document=r}create(t,i=!1){return new wZ(t,this._checker,this._ngZone,this._document,i)}}return n.\u0275fac=function(t){return new(t||n)(L(mO),L(_e),L(je))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function P0(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function k0(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const CZ=new q("cdk-input-modality-detector-options"),EZ={ignoreKeys:[18,17,224,91,16]},pc=Io({passive:!0,capture:!0});let MZ=(()=>{class n{constructor(t,i,r,s){this._platform=t,this._mostRecentTarget=null,this._modality=new mt(null),this._lastTouchMs=0,this._onKeydown=o=>{var a,l;(null===(l=null===(a=this._options)||void 0===a?void 0:a.ignoreKeys)||void 0===l?void 0:l.some(c=>c===o.keyCode))||(this._modality.next("keyboard"),this._mostRecentTarget=Po(o))},this._onMousedown=o=>{Date.now()-this._lastTouchMs<650||(this._modality.next(P0(o)?"keyboard":"mouse"),this._mostRecentTarget=Po(o))},this._onTouchstart=o=>{k0(o)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Po(o))},this._options=Object.assign(Object.assign({},EZ),s),this.modalityDetected=this._modality.pipe(cO(1)),this.modalityChanged=this.modalityDetected.pipe(function sZ(n,e=Rn){return n=null!=n?n:oZ,H((t,i)=>{let r,s=!0;t.subscribe(new Q(i,o=>{const a=e(o);(s||!n(r,a))&&(s=!1,r=a,i.next(o))}))})}()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,pc),r.addEventListener("mousedown",this._onMousedown,pc),r.addEventListener("touchstart",this._onTouchstart,pc)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,pc),document.removeEventListener("mousedown",this._onMousedown,pc),document.removeEventListener("touchstart",this._onTouchstart,pc))}}return n.\u0275fac=function(t){return new(t||n)(L(qi),L(_e),L(je),L(CZ,8))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const TZ=new q("liveAnnouncerElement",{providedIn:"root",factory:function SZ(){return null}}),AZ=new q("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let vO=(()=>{class n{constructor(t,i,r,s){this._ngZone=i,this._defaultOptions=s,this._document=r,this._liveElement=t||this._createLiveElement()}announce(t,...i){const r=this._defaultOptions;let s,o;return 1===i.length&&"number"==typeof i[0]?o=i[0]:[s,o]=i,this.clear(),clearTimeout(this._previousTimeout),s||(s=r&&r.politeness?r.politeness:"polite"),null==o&&r&&(o=r.duration),this._liveElement.setAttribute("aria-live",s),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(a=>this._currentResolve=a)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=t,"number"==typeof o&&(this._previousTimeout=setTimeout(()=>this.clear(),o)),this._currentResolve(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){var t,i;clearTimeout(this._previousTimeout),null===(t=this._liveElement)||void 0===t||t.remove(),this._liveElement=null,null===(i=this._currentResolve)||void 0===i||i.call(this),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const t="cdk-live-announcer-element",i=this._document.getElementsByClassName(t),r=this._document.createElement("div");for(let s=0;s<i.length;s++)i[s].remove();return r.classList.add(t),r.classList.add("cdk-visually-hidden"),r.setAttribute("aria-atomic","true"),r.setAttribute("aria-live","polite"),this._document.body.appendChild(r),r}}return n.\u0275fac=function(t){return new(t||n)(L(TZ,8),L(_e),L(je),L(AZ,8))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const DZ=new q("cdk-focus-monitor-default-options"),sm=Io({passive:!0,capture:!0});let Ys=(()=>{class n{constructor(t,i,r,s,o){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new O,this._rootNodeFocusAndBlurListener=a=>{const l=Po(a),c="focus"===a.type?this._onFocus:this._onBlur;for(let u=l;u;u=u.parentElement)c.call(this,a,u)},this._document=s,this._detectionMode=(null==o?void 0:o.detectionMode)||0}monitor(t,i=!1){const r=Aa(t);if(!this._platform.isBrowser||1!==r.nodeType)return Ce(null);const s=$k(r)||this._getDocument(),o=this._elementInfo.get(r);if(o)return i&&(o.checkChildren=!0),o.subject;const a={checkChildren:i,subject:new O,rootNode:s};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){const i=Aa(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const s=Aa(t);s===this._getDocument().activeElement?this._getClosestElementsInfo(s).forEach(([a,l])=>this._originChanged(a,i,l)):(this._setOrigin(i),"function"==typeof s.focus&&s.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!(null==t?void 0:t.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),s=Po(t);!r||!r.checkChildren&&i!==s||this._originChanged(i,this._getFocusOrigin(s),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r.subject,null))}_emitOrigin(t,i){this._ngZone.run(()=>t.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,sm),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,sm)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Pt(this._stopInputModalityDetector)).subscribe(s=>{this._setOrigin(s,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,sm),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,sm),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r.subject,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,s)=>{(s===t||r.checkChildren&&s.contains(t))&&i.push([s,r])}),i}}return n.\u0275fac=function(t){return new(t||n)(L(_e),L(qi),L(MZ),L(je,8),L(DZ,8))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const bO="cdk-high-contrast-black-on-white",wO="cdk-high-contrast-white-on-black",O0="cdk-high-contrast-active";let xO=(()=>{class n{constructor(t,i){this._platform=t,this._document=i}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,s=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),s){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(O0),t.remove(bO),t.remove(wO),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?(t.add(O0),t.add(bO)):2===i&&(t.add(O0),t.add(wO))}}}return n.\u0275fac=function(t){return new(t||n)(L(qi),L(je))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),CO=(()=>{class n{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return n.\u0275fac=function(t){return new(t||n)(L(xO))},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Td]]}),n})();const PZ=new q("mat-sanity-checks",{providedIn:"root",factory:function IZ(){return!0}});let Ne=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!M0()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return n.\u0275fac=function(t){return new(t||n)(L(xO),L(PZ,8),L(je))},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[wd],wd]}),n})();function Sd(n){return class extends n{constructor(...e){super(...e),this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=Kt(e)}}}function Ad(n,e){return class extends n{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}}}function Pa(n){return class extends n{constructor(...e){super(...e),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=Kt(e)}}}function R0(n,e=0){return class extends n{constructor(...t){super(...t),this._tabIndex=e,this.defaultTabIndex=e}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?us(t):this.defaultTabIndex}}}let OZ=(()=>{class n{isErrorState(t,i){return!!(t&&t.invalid&&(t.touched||i&&i.submitted))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),MO=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Ne],Ne]}),n})();class FZ{constructor(e,t,i){this._renderer=e,this.element=t,this.config=i,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const TO={enterDuration:225,exitDuration:150},L0=Io({passive:!0}),SO=["mousedown","touchstart"],AO=["mouseup","mouseleave","touchend","touchcancel"];class BZ{constructor(e,t,i,r){this._target=e,this._ngZone=t,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=Aa(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=Object.assign(Object.assign({},TO),i.animation);i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const o=i.radius||function zZ(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),a=e-r.left,l=t-r.top,c=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=a-o+"px",u.style.top=l-o+"px",u.style.height=2*o+"px",u.style.width=2*o+"px",null!=i.color&&(u.style.backgroundColor=i.color),u.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(u),function VZ(n){window.getComputedStyle(n).getPropertyValue("opacity")}(u),u.style.transform="scale(1)";const d=new FZ(this,u,i);return d.state=0,this._activeRipples.add(d),i.persistent||(this._mostRecentTransientRipple=d),this._runTimeoutOutsideZone(()=>{const h=d===this._mostRecentTransientRipple;d.state=1,!i.persistent&&(!h||!this._isPointerDown)&&d.fadeOut()},c),d}fadeOutRipple(e){const t=this._activeRipples.delete(e);if(e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!t)return;const i=e.element,r=Object.assign(Object.assign({},TO),e.config.animation);i.style.transitionDuration=`${r.exitDuration}ms`,i.style.opacity="0",e.state=2,this._runTimeoutOutsideZone(()=>{e.state=3,i.remove()},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._activeRipples.forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=Aa(e);!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(SO))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(AO),this._pointerUpEventsRegistered=!0)}_onMousedown(e){const t=P0(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!k0(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._activeRipples.forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_runTimeoutOutsideZone(e,t=0){this._ngZone.runOutsideAngular(()=>setTimeout(e,t))}_registerEvents(e){this._ngZone.runOutsideAngular(()=>{e.forEach(t=>{this._triggerElement.addEventListener(t,this,L0)})})}_removeTriggerEvents(){this._triggerElement&&(SO.forEach(e=>{this._triggerElement.removeEventListener(e,this,L0)}),this._pointerUpEventsRegistered&&AO.forEach(e=>{this._triggerElement.removeEventListener(e,this,L0)}))}}const jZ=new q("mat-ripple-global-options");let ko=(()=>{class n{constructor(t,i,r,s,o){this._elementRef=t,this._animationMode=o,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=s||{},this._rippleRenderer=new BZ(this,i,t,r)}get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,Object.assign(Object.assign({},this.rippleConfig),r)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),t))}}return n.\u0275fac=function(t){return new(t||n)(T(pt),T(_e),T(qi),T(jZ,8),T(as,8))},n.\u0275dir=te({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,i){2&t&&Pn("mat-ripple-unbounded",i.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),n})(),Oo=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Ne],Ne]}),n})(),F0=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Ne]]}),n})(),om=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Oo,Ai,Ne,F0]]}),n})();const qZ=["mat-button",""],$Z=["*"],ZZ=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"],XZ=Ad(Sd(Pa(class{constructor(n){this._elementRef=n}})));let KZ=(()=>{class n extends XZ{constructor(t,i,r){super(t),this._focusMonitor=i,this._animationMode=r,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const s of ZZ)this._hasHostAttributes(s)&&this._getHostElement().classList.add(s);t.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t,i){t?this._focusMonitor.focusVia(this._getHostElement(),t,i):this._getHostElement().focus(i)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...t){return t.some(i=>this._getHostElement().hasAttribute(i))}}return n.\u0275fac=function(t){return new(t||n)(T(pt),T(Ys),T(as,8))},n.\u0275cmp=Ot({type:n,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(t,i){if(1&t&&Ti(ko,5),2&t){let r;Wt(r=qt())&&(i.ripple=r.first)}},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(t,i){2&t&&(yt("disabled",i.disabled||null),Pn("_mat-animation-noopable","NoopAnimations"===i._animationMode)("mat-button-disabled",i.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[ke],attrs:qZ,ngContentSelectors:$Z,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(t,i){1&t&&(cr(),ue(0,"span",0),Ui(1),de(),rt(2,"span",1),rt(3,"span",2)),2&t&&(Fe(2),Pn("mat-button-ripple-round",i.isRoundButton||i.isIconButton),He("matRippleDisabled",i._isRippleDisabled())("matRippleCentered",i.isIconButton)("matRippleTrigger",i._getHostElement()))},directives:[ko],styles:[".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:inline-flex;justify-content:center;align-items:center;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}.cdk-high-contrast-active .mat-button-base.cdk-keyboard-focused,.cdk-high-contrast-active .mat-button-base.cdk-program-focused{outline:solid 3px}\n"],encapsulation:2,changeDetection:0}),n})(),DO=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Oo,Ne],Ne]}),n})();const IO=new Set;let mc,QZ=(()=>{class n{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):eX}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function JZ(n){if(!IO.has(n))try{mc||(mc=document.createElement("style"),mc.setAttribute("type","text/css"),document.head.appendChild(mc)),mc.sheet&&(mc.sheet.insertRule(`@media ${n} {body{ }}`,0),IO.add(n))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return n.\u0275fac=function(t){return new(t||n)(L(qi))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function eX(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let PO=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new O}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return kO($p(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let s=Ao(kO($p(t)).map(o=>this._registerQuery(o).observable));return s=od(s.pipe(Mt(1)),s.pipe(cO(1),I0(0))),s.pipe(W(o=>{const a={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:c})=>{a.matches=a.matches||l,a.breakpoints[c]=l}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),s={observable:new D(o=>{const a=l=>this._zone.run(()=>o.next(l));return i.addListener(a),()=>{i.removeListener(a)}}).pipe(Hs(i),W(({matches:o})=>({query:t,matches:o})),Pt(this._destroySubject)),mql:i};return this._queries.set(t,s),s}}return n.\u0275fac=function(t){return new(t||n)(L(QZ),L(_e))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function kO(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}function nX(n,e){if(1&n){const t=Ry();ue(0,"div",2),ue(1,"button",3),At("click",function(){return rl(t),ei().action()}),Ei(2),de(),de()}if(2&n){const t=ei();Fe(2),rs(t.data.action)}}function iX(n,e){}const OO=new q("MatSnackBarData");class am{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}}const rX=Math.pow(2,31)-1;class N0{constructor(e,t){this._overlayRef=t,this._afterDismissed=new O,this._afterOpened=new O,this._onAction=new O,this._dismissedByAction=!1,this.containerInstance=e,e._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(e){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(e,rX))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}}let sX=(()=>{class n{constructor(t,i){this.snackBarRef=t,this.data=i}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}}return n.\u0275fac=function(t){return new(t||n)(T(N0),T(OO))},n.\u0275cmp=Ot({type:n,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-simple-snackbar"],decls:3,vars:2,consts:[[1,"mat-simple-snack-bar-content"],["class","mat-simple-snackbar-action",4,"ngIf"],[1,"mat-simple-snackbar-action"],["mat-button","",3,"click"]],template:function(t,i){1&t&&(ue(0,"span",0),Ei(1),de(),Jn(2,nX,3,1,"div",1)),2&t&&(Fe(1),rs(i.data.message),Fe(1),He("ngIf",i.hasAction))},directives:[KZ,Xl],styles:[".mat-simple-snackbar{display:flex;justify-content:space-between;align-items:center;line-height:20px;opacity:1}.mat-simple-snackbar-action{flex-shrink:0;margin:-8px -8px -8px 8px}.mat-simple-snackbar-action button{max-height:36px;min-width:0}[dir=rtl] .mat-simple-snackbar-action{margin-left:-8px;margin-right:8px}.mat-simple-snack-bar-content{overflow:hidden;text-overflow:ellipsis}\n"],encapsulation:2,changeDetection:0}),n})();const oX={snackBarState:Di("state",[yn("void, hidden",ve({transform:"scale(0.8)",opacity:0})),yn("visible",ve({transform:"scale(1)",opacity:1})),jt("* => visible",$t("150ms cubic-bezier(0, 0, 0.2, 1)")),jt("* => void, * => hidden",$t("75ms cubic-bezier(0.4, 0.0, 1, 1)",ve({opacity:0})))])};let aX=(()=>{class n extends Jp{constructor(t,i,r,s,o){super(),this._ngZone=t,this._elementRef=i,this._changeDetectorRef=r,this._platform=s,this.snackBarConfig=o,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new O,this._onExit=new O,this._onEnter=new O,this._animationState="void",this.attachDomPortal=a=>(this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachDomPortal(a)),this._live="assertive"!==o.politeness||o.announcementMessage?"off"===o.politeness?"off":"polite":"assertive",this._platform.FIREFOX&&("polite"===this._live&&(this._role="status"),"assertive"===this._live&&(this._role="alert"))}attachComponentPortal(t){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachComponentPortal(t)}attachTemplatePortal(t){return this._assertNotAttached(),this._applySnackBarClasses(),this._portalOutlet.attachTemplatePortal(t)}onAnimationEnd(t){const{fromState:i,toState:r}=t;if(("void"===r&&"void"!==i||"hidden"===r)&&this._completeExit(),"visible"===r){const s=this._onEnter;this._ngZone.run(()=>{s.next(),s.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._ngZone.run(()=>{this._animationState="hidden",this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId)}),this._onExit}ngOnDestroy(){this._destroyed=!0,this._completeExit()}_completeExit(){this._ngZone.onMicrotaskEmpty.pipe(Mt(1)).subscribe(()=>{this._ngZone.run(()=>{this._onExit.next(),this._onExit.complete()})})}_applySnackBarClasses(){const t=this._elementRef.nativeElement,i=this.snackBarConfig.panelClass;i&&(Array.isArray(i)?i.forEach(r=>t.classList.add(r)):t.classList.add(i)),"center"===this.snackBarConfig.horizontalPosition&&t.classList.add("mat-snack-bar-center"),"top"===this.snackBarConfig.verticalPosition&&t.classList.add("mat-snack-bar-top")}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{const t=this._elementRef.nativeElement.querySelector("[aria-hidden]"),i=this._elementRef.nativeElement.querySelector("[aria-live]");if(t&&i){let r=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&t.contains(document.activeElement)&&(r=document.activeElement),t.removeAttribute("aria-hidden"),i.appendChild(t),null==r||r.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}}return n.\u0275fac=function(t){return new(t||n)(T(_e),T(pt),T(Fn),T(qi),T(am))},n.\u0275cmp=Ot({type:n,selectors:[["snack-bar-container"]],viewQuery:function(t,i){if(1&t&&Ti(em,7),2&t){let r;Wt(r=qt())&&(i._portalOutlet=r.first)}},hostAttrs:[1,"mat-snack-bar-container"],hostVars:1,hostBindings:function(t,i){1&t&&xf("@state.done",function(s){return i.onAnimationEnd(s)}),2&t&&Mf("@state",i._animationState)},features:[ke],decls:3,vars:2,consts:[["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(t,i){1&t&&(ue(0,"div",0),Jn(1,iX,0,0,"ng-template",1),de(),rt(2,"div")),2&t&&(Fe(2),yt("aria-live",i._live)("role",i._role))},directives:[em],styles:[".mat-snack-bar-container{border-radius:4px;box-sizing:border-box;display:block;margin:24px;max-width:33vw;min-width:344px;padding:14px 16px;min-height:48px;transform-origin:center}.cdk-high-contrast-active .mat-snack-bar-container{border:solid 1px}.mat-snack-bar-handset{width:100%}.mat-snack-bar-handset .mat-snack-bar-container{margin:8px;max-width:100%;min-width:0;width:100%}\n"],encapsulation:2,data:{animation:[oX.snackBarState]}}),n})(),RO=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[hc,tm,Ai,DO,Ne],Ne]}),n})();const LO=new q("mat-snack-bar-default-options",{providedIn:"root",factory:function lX(){return new am}});let cX=(()=>{class n{constructor(t,i,r,s,o,a){this._overlay=t,this._live=i,this._injector=r,this._breakpointObserver=s,this._parentSnackBar=o,this._defaultConfig=a,this._snackBarRefAtThisLevel=null}get _openedSnackBarRef(){const t=this._parentSnackBar;return t?t._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(t){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=t:this._snackBarRefAtThisLevel=t}openFromComponent(t,i){return this._attach(t,i)}openFromTemplate(t,i){return this._attach(t,i)}open(t,i="",r){const s=Object.assign(Object.assign({},this._defaultConfig),r);return s.data={message:t,action:i},s.announcementMessage===t&&(s.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,s)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(t,i){const s=Nt.create({parent:i&&i.viewContainerRef&&i.viewContainerRef.injector||this._injector,providers:[{provide:am,useValue:i}]}),o=new xd(this.snackBarContainerComponent,i.viewContainerRef,s),a=t.attach(o);return a.instance.snackBarConfig=i,a.instance}_attach(t,i){const r=Object.assign(Object.assign(Object.assign({},new am),this._defaultConfig),i),s=this._createOverlay(r),o=this._attachSnackBarContainer(s,r),a=new N0(o,s);if(t instanceof ur){const l=new Cd(t,null,{$implicit:r.data,snackBarRef:a});a.instance=o.attachTemplatePortal(l)}else{const l=this._createInjector(r,a),c=new xd(t,void 0,l),u=o.attachComponentPortal(c);a.instance=u.instance}return this._breakpointObserver.observe("(max-width: 599.98px) and (orientation: portrait)").pipe(Pt(s.detachments())).subscribe(l=>{s.overlayElement.classList.toggle(this.handsetCssClass,l.matches)}),r.announcementMessage&&o._onAnnounce.subscribe(()=>{this._live.announce(r.announcementMessage,r.politeness)}),this._animateSnackBar(a,r),this._openedSnackBarRef=a,this._openedSnackBarRef}_animateSnackBar(t,i){t.afterDismissed().subscribe(()=>{this._openedSnackBarRef==t&&(this._openedSnackBarRef=null),i.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{t.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):t.containerInstance.enter(),i.duration&&i.duration>0&&t.afterOpened().subscribe(()=>t._dismissAfter(i.duration))}_createOverlay(t){const i=new Ed;i.direction=t.direction;let r=this._overlay.position().global();const s="rtl"===t.direction,o="left"===t.horizontalPosition||"start"===t.horizontalPosition&&!s||"end"===t.horizontalPosition&&s,a=!o&&"center"!==t.horizontalPosition;return o?r.left("0"):a?r.right("0"):r.centerHorizontally(),"top"===t.verticalPosition?r.top("0"):r.bottom("0"),i.positionStrategy=r,this._overlay.create(i)}_createInjector(t,i){return Nt.create({parent:t&&t.viewContainerRef&&t.viewContainerRef.injector||this._injector,providers:[{provide:N0,useValue:i},{provide:OO,useValue:t.data}]})}}return n.\u0275fac=function(t){return new(t||n)(L(_r),L(vO),L(Nt),L(PO),L(n,12),L(LO))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})(),uX=(()=>{class n extends cX{constructor(t,i,r,s,o,a){super(t,i,r,s,o,a),this.simpleSnackBarComponent=sX,this.snackBarContainerComponent=aX,this.handsetCssClass="mat-snack-bar-handset"}}return n.\u0275fac=function(t){return new(t||n)(L(_r),L(vO),L(Nt),L(PO),L(n,12),L(LO))},n.\u0275prov=J({token:n,factory:n.\u0275fac,providedIn:RO}),n})();function FO(n,e){return e?t=>od(e.pipe(Mt(1),function dX(){return H((n,e)=>{n.subscribe(new Q(e,re))})}()),t.pipe(FO(n))):rn((t,i)=>n(t,i).pipe(Mt(1),function hX(n){return W(()=>n)}(t)))}function B0(n,e=w0){const t=Gk(n,e);return FO(()=>t)}const fX=["mat-menu-item",""];function pX(n,e){1&n&&(ol(),ue(0,"svg",2),rt(1,"polygon",3),de())}const NO=["*"];function mX(n,e){if(1&n){const t=Ry();ue(0,"div",0),At("keydown",function(r){return rl(t),ei()._handleKeydown(r)})("click",function(){return rl(t),ei().closed.emit("click")})("@transformMenu.start",function(r){return rl(t),ei()._onAnimationStart(r)})("@transformMenu.done",function(r){return rl(t),ei()._onAnimationDone(r)}),ue(1,"div",1),Ui(2),de(),de()}if(2&n){const t=ei();He("id",t.panelId)("ngClass",t._classList)("@transformMenu",t._panelAnimationState),yt("aria-label",t.ariaLabel||null)("aria-labelledby",t.ariaLabelledby||null)("aria-describedby",t.ariaDescribedby||null)}}const lm={transformMenu:Di("transformMenu",[yn("void",ve({opacity:0,transform:"scale(0.8)"})),jt("void => enter",$t("120ms cubic-bezier(0, 0, 0.2, 1)",ve({opacity:1,transform:"scale(1)"}))),jt("* => void",$t("100ms 25ms linear",ve({opacity:0})))]),fadeInItems:Di("fadeInItems",[yn("showing",ve({opacity:1})),jt("void => *",[ve({opacity:0}),$t("400ms 100ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])},gX=new q("MatMenuContent"),V0=new q("MAT_MENU_PANEL"),_X=Pa(Sd(class{}));let z0=(()=>{class n extends _X{constructor(t,i,r,s,o){var a;super(),this._elementRef=t,this._document=i,this._focusMonitor=r,this._parentMenu=s,this._changeDetectorRef=o,this.role="menuitem",this._hovered=new O,this._focused=new O,this._highlighted=!1,this._triggersSubmenu=!1,null===(a=null==s?void 0:s.addItem)||void 0===a||a.call(s,this)}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._getHostElement(),t,i):this._getHostElement().focus(i),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(t){this.disabled&&(t.preventDefault(),t.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){var t;const i=this._elementRef.nativeElement.cloneNode(!0),r=i.querySelectorAll("mat-icon, .material-icons");for(let s=0;s<r.length;s++)r[s].remove();return(null===(t=i.textContent)||void 0===t?void 0:t.trim())||""}_setHighlighted(t){var i;this._highlighted=t,null===(i=this._changeDetectorRef)||void 0===i||i.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}}return n.\u0275fac=function(t){return new(t||n)(T(pt),T(je),T(Ys),T(V0,8),T(Fn))},n.\u0275cmp=Ot({type:n,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-focus-indicator"],hostVars:10,hostBindings:function(t,i){1&t&&At("click",function(s){return i._checkDisabled(s)})("mouseenter",function(){return i._handleMouseEnter()}),2&t&&(yt("role",i.role)("tabindex",i._getTabIndex())("aria-disabled",i.disabled.toString())("disabled",i.disabled||null),Pn("mat-menu-item",!0)("mat-menu-item-highlighted",i._highlighted)("mat-menu-item-submenu-trigger",i._triggersSubmenu))},inputs:{disabled:"disabled",disableRipple:"disableRipple",role:"role"},exportAs:["matMenuItem"],features:[ke],attrs:fX,ngContentSelectors:NO,decls:3,vars:3,consts:[["matRipple","",1,"mat-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["class","mat-menu-submenu-icon","viewBox","0 0 5 10","focusable","false",4,"ngIf"],["viewBox","0 0 5 10","focusable","false",1,"mat-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(t,i){1&t&&(cr(),Ui(0),rt(1,"div",0),Jn(2,pX,2,0,"svg",1)),2&t&&(Fe(1),He("matRippleDisabled",i.disableRipple||i.disabled)("matRippleTrigger",i._getHostElement()),Fe(1),He("ngIf",i._triggersSubmenu))},directives:[ko,Xl],encapsulation:2,changeDetection:0}),n})();const BO=new q("mat-menu-default-options",{providedIn:"root",factory:function yX(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}});let vX=0,Id=(()=>{class n{constructor(t,i,r,s){this._elementRef=t,this._ngZone=i,this._defaultOptions=r,this._changeDetectorRef=s,this._xPosition=this._defaultOptions.xPosition,this._yPosition=this._defaultOptions.yPosition,this._directDescendantItems=new Ul,this._tabSubscription=ee.EMPTY,this._classList={},this._panelAnimationState="void",this._animationDone=new O,this.overlayPanelClass=this._defaultOptions.overlayPanelClass||"",this.backdropClass=this._defaultOptions.backdropClass,this._overlapTrigger=this._defaultOptions.overlapTrigger,this._hasBackdrop=this._defaultOptions.hasBackdrop,this.closed=new Oe,this.close=this.closed,this.panelId="mat-menu-panel-"+vX++}get xPosition(){return this._xPosition}set xPosition(t){this._xPosition=t,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(t){this._yPosition=t,this.setPositionClasses()}get overlapTrigger(){return this._overlapTrigger}set overlapTrigger(t){this._overlapTrigger=Kt(t)}get hasBackdrop(){return this._hasBackdrop}set hasBackdrop(t){this._hasBackdrop=Kt(t)}set panelClass(t){const i=this._previousPanelClass;i&&i.length&&i.split(" ").forEach(r=>{this._classList[r]=!1}),this._previousPanelClass=t,t&&t.length&&(t.split(" ").forEach(r=>{this._classList[r]=!0}),this._elementRef.nativeElement.className="")}get classList(){return this.panelClass}set classList(t){this.panelClass=t}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new pO(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._tabSubscription=this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(Hs(this._directDescendantItems),Wi(t=>Cr(...t.map(i=>i._focused)))).subscribe(t=>this._keyManager.updateActiveItem(t)),this._directDescendantItems.changes.subscribe(t=>{var i;const r=this._keyManager;if("enter"===this._panelAnimationState&&(null===(i=r.activeItem)||void 0===i?void 0:i._hasFocus())){const s=t.toArray(),o=Math.max(0,Math.min(s.length-1,r.activeItemIndex||0));s[o]&&!s[o].disabled?r.setActiveItem(o):r.setNextItemActive()}})}ngOnDestroy(){this._directDescendantItems.destroy(),this._tabSubscription.unsubscribe(),this.closed.complete()}_hovered(){return this._directDescendantItems.changes.pipe(Hs(this._directDescendantItems),Wi(i=>Cr(...i.map(r=>r._hovered))))}addItem(t){}removeItem(t){}_handleKeydown(t){const i=t.keyCode,r=this._keyManager;switch(i){case 27:$s(t)||(t.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case 39:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:return(38===i||40===i)&&r.setFocusOrigin("keyboard"),void r.onKeydown(t)}t.stopPropagation()}focusFirstItem(t="program"){this._ngZone.onStable.pipe(Mt(1)).subscribe(()=>{let i=null;if(this._directDescendantItems.length&&(i=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),!i||!i.contains(document.activeElement)){const r=this._keyManager;r.setFocusOrigin(t).setFirstItemActive(),!r.activeItem&&i&&i.focus()}})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(t){const i=Math.min(this._baseElevation+t,24),r=`${this._elevationPrefix}${i}`,s=Object.keys(this._classList).find(o=>o.startsWith(this._elevationPrefix));(!s||s===this._previousElevation)&&(this._previousElevation&&(this._classList[this._previousElevation]=!1),this._classList[r]=!0,this._previousElevation=r)}setPositionClasses(t=this.xPosition,i=this.yPosition){var r;const s=this._classList;s["mat-menu-before"]="before"===t,s["mat-menu-after"]="after"===t,s["mat-menu-above"]="above"===i,s["mat-menu-below"]="below"===i,null===(r=this._changeDetectorRef)||void 0===r||r.markForCheck()}_startAnimation(){this._panelAnimationState="enter"}_resetAnimation(){this._panelAnimationState="void"}_onAnimationDone(t){this._animationDone.next(t),this._isAnimating=!1}_onAnimationStart(t){this._isAnimating=!0,"enter"===t.toState&&0===this._keyManager.activeItemIndex&&(t.element.scrollTop=0)}_updateDirectDescendants(){this._allItems.changes.pipe(Hs(this._allItems)).subscribe(t=>{this._directDescendantItems.reset(t.filter(i=>i._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}}return n.\u0275fac=function(t){return new(t||n)(T(pt),T(_e),T(BO),T(Fn))},n.\u0275dir=te({type:n,contentQueries:function(t,i,r){if(1&t&&(dr(r,gX,5),dr(r,z0,5),dr(r,z0,4)),2&t){let s;Wt(s=qt())&&(i.lazyContent=s.first),Wt(s=qt())&&(i._allItems=s),Wt(s=qt())&&(i.items=s)}},viewQuery:function(t,i){if(1&t&&Ti(ur,5),2&t){let r;Wt(r=qt())&&(i.templateRef=r.first)}},inputs:{backdropClass:"backdropClass",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:"overlapTrigger",hasBackdrop:"hasBackdrop",panelClass:["class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"}}),n})(),bX=(()=>{class n extends Id{constructor(t,i,r,s){super(t,i,r,s),this._elevationPrefix="mat-elevation-z",this._baseElevation=4}}return n.\u0275fac=function(t){return new(t||n)(T(pt),T(_e),T(BO),T(Fn))},n.\u0275cmp=Ot({type:n,selectors:[["mat-menu"]],hostVars:3,hostBindings:function(t,i){2&t&&yt("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},exportAs:["matMenu"],features:[Ct([{provide:V0,useExisting:n}]),ke],ngContentSelectors:NO,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-menu-panel",3,"id","ngClass","keydown","click"],[1,"mat-menu-content"]],template:function(t,i){1&t&&(cr(),Jn(0,mX,3,6,"ng-template"))},directives:[Z1],styles:['mat-menu{display:none}.mat-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;max-height:calc(100vh - 48px);border-radius:4px;outline:0;min-height:64px}.mat-menu-panel.ng-animating{pointer-events:none}.cdk-high-contrast-active .mat-menu-panel{outline:solid 1px}.mat-menu-content:not(:empty){padding-top:8px;padding-bottom:8px}.mat-menu-item{-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;line-height:48px;height:48px;padding:0 16px;text-align:left;text-decoration:none;max-width:100%;position:relative}.mat-menu-item::-moz-focus-inner{border:0}.mat-menu-item[disabled]{cursor:default}[dir=rtl] .mat-menu-item{text-align:right}.mat-menu-item .mat-icon{margin-right:16px;vertical-align:middle}.mat-menu-item .mat-icon svg{vertical-align:top}[dir=rtl] .mat-menu-item .mat-icon{margin-left:16px;margin-right:0}.mat-menu-item[disabled]::before{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.cdk-high-contrast-active .mat-menu-item{margin-top:1px}.cdk-high-contrast-active .mat-menu-item.cdk-program-focused,.cdk-high-contrast-active .mat-menu-item.cdk-keyboard-focused,.cdk-high-contrast-active .mat-menu-item-highlighted{outline:dotted 1px}.mat-menu-item-submenu-trigger{padding-right:32px}[dir=rtl] .mat-menu-item-submenu-trigger{padding-right:16px;padding-left:32px}.mat-menu-submenu-icon{position:absolute;top:50%;right:16px;transform:translateY(-50%);width:5px;height:10px;fill:currentColor}[dir=rtl] .mat-menu-submenu-icon{right:auto;left:16px;transform:translateY(-50%) scaleX(-1)}.cdk-high-contrast-active .mat-menu-submenu-icon{fill:CanvasText}button.mat-menu-item{width:100%}.mat-menu-item .mat-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}\n'],encapsulation:2,data:{animation:[lm.transformMenu,lm.fadeInItems]},changeDetection:0}),n})();const VO=new q("mat-menu-scroll-strategy"),xX={provide:VO,deps:[_r],useFactory:function wX(n){return()=>n.scrollStrategies.reposition()}},jO=Io({passive:!0});let CX=(()=>{class n{constructor(t,i,r,s,o,a,l,c,u){this._overlay=t,this._element=i,this._viewContainerRef=r,this._menuItemInstance=a,this._dir=l,this._focusMonitor=c,this._ngZone=u,this._overlayRef=null,this._menuOpen=!1,this._closingActionsSubscription=ee.EMPTY,this._hoverSubscription=ee.EMPTY,this._menuCloseSubscription=ee.EMPTY,this._handleTouchStart=d=>{k0(d)||(this._openedBy="touch")},this._openedBy=void 0,this.restoreFocus=!0,this.menuOpened=new Oe,this.onMenuOpen=this.menuOpened,this.menuClosed=new Oe,this.onMenuClose=this.menuClosed,this._scrollStrategy=s,this._parentMaterialMenu=o instanceof Id?o:void 0,i.nativeElement.addEventListener("touchstart",this._handleTouchStart,jO),a&&(a._triggersSubmenu=this.triggersSubmenu())}get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(t){this.menu=t}get menu(){return this._menu}set menu(t){t!==this._menu&&(this._menu=t,this._menuCloseSubscription.unsubscribe(),t&&(this._menuCloseSubscription=t.close.subscribe(i=>{this._destroyMenu(i),("click"===i||"tab"===i)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(i)})))}ngAfterContentInit(){this._checkMenu(),this._handleHover()}ngOnDestroy(){this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,jO),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe()}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!(!this._menuItemInstance||!this._parentMaterialMenu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){if(this._menuOpen)return;this._checkMenu();const t=this._createOverlay(),i=t.getConfig(),r=i.positionStrategy;this._setPosition(r),i.hasBackdrop=null==this.menu.hasBackdrop?!this.triggersSubmenu():this.menu.hasBackdrop,t.attach(this._getPortal()),this.menu.lazyContent&&this.menu.lazyContent.attach(this.menuData),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),this._initMenu(),this.menu instanceof Id&&(this.menu._startAnimation(),this.menu._directDescendantItems.changes.pipe(Pt(this.menu.close)).subscribe(()=>{r.withLockedPosition(!1).reapplyLastPosition(),r.withLockedPosition(!0)}))}closeMenu(){this.menu.close.emit()}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._element,t,i):this._element.nativeElement.focus(i)}updatePosition(){var t;null===(t=this._overlayRef)||void 0===t||t.updatePosition()}_destroyMenu(t){if(!this._overlayRef||!this.menuOpen)return;const i=this.menu;this._closingActionsSubscription.unsubscribe(),this._overlayRef.detach(),this.restoreFocus&&("keydown"===t||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,i instanceof Id?(i._resetAnimation(),i.lazyContent?i._animationDone.pipe(gn(r=>"void"===r.toState),Mt(1),Pt(i.lazyContent._attached)).subscribe({next:()=>i.lazyContent.detach(),complete:()=>this._setIsMenuOpen(!1)}):this._setIsMenuOpen(!1)):(this._setIsMenuOpen(!1),i.lazyContent&&i.lazyContent.detach())}_initMenu(){this.menu.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,this.menu.direction=this.dir,this._setMenuElevation(),this.menu.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0)}_setMenuElevation(){if(this.menu.setElevation){let t=0,i=this.menu.parentMenu;for(;i;)t++,i=i.parentMenu;this.menu.setElevation(t)}}_setIsMenuOpen(t){this._menuOpen=t,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(t)}_checkMenu(){}_createOverlay(){if(!this._overlayRef){const t=this._getOverlayConfig();this._subscribeToPositions(t.positionStrategy),this._overlayRef=this._overlay.create(t),this._overlayRef.keydownEvents().subscribe()}return this._overlayRef}_getOverlayConfig(){return new Ed({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:this.menu.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:this.menu.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir})}_subscribeToPositions(t){this.menu.setPositionClasses&&t.positionChanges.subscribe(i=>{const r="start"===i.connectionPair.overlayX?"after":"before",s="top"===i.connectionPair.overlayY?"below":"above";this._ngZone?this._ngZone.run(()=>this.menu.setPositionClasses(r,s)):this.menu.setPositionClasses(r,s)})}_setPosition(t){let[i,r]="before"===this.menu.xPosition?["end","start"]:["start","end"],[s,o]="above"===this.menu.yPosition?["bottom","top"]:["top","bottom"],[a,l]=[s,o],[c,u]=[i,r],d=0;this.triggersSubmenu()?(u=i="before"===this.menu.xPosition?"start":"end",r=c="end"===i?"start":"end",d="bottom"===s?8:-8):this.menu.overlapTrigger||(a="top"===s?"bottom":"top",l="top"===o?"bottom":"top"),t.withPositions([{originX:i,originY:a,overlayX:c,overlayY:s,offsetY:d},{originX:r,originY:a,overlayX:u,overlayY:s,offsetY:d},{originX:i,originY:l,overlayX:c,overlayY:o,offsetY:-d},{originX:r,originY:l,overlayX:u,overlayY:o,offsetY:-d}])}_menuClosingActions(){const t=this._overlayRef.backdropClick(),i=this._overlayRef.detachments();return Cr(t,this._parentMaterialMenu?this._parentMaterialMenu.closed:Ce(),this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(gn(o=>o!==this._menuItemInstance),gn(()=>this._menuOpen)):Ce(),i)}_handleMousedown(t){P0(t)||(this._openedBy=0===t.button?"mouse":void 0,this.triggersSubmenu()&&t.preventDefault())}_handleKeydown(t){const i=t.keyCode;(13===i||32===i)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(39===i&&"ltr"===this.dir||37===i&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(t){this.triggersSubmenu()?(t.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){!this.triggersSubmenu()||!this._parentMaterialMenu||(this._hoverSubscription=this._parentMaterialMenu._hovered().pipe(gn(t=>t===this._menuItemInstance&&!t.disabled),B0(0,b0)).subscribe(()=>{this._openedBy="mouse",this.menu instanceof Id&&this.menu._isAnimating?this.menu._animationDone.pipe(Mt(1),B0(0,b0),Pt(this._parentMaterialMenu._hovered())).subscribe(()=>this.openMenu()):this.openMenu()}))}_getPortal(){return(!this._portal||this._portal.templateRef!==this.menu.templateRef)&&(this._portal=new Cd(this.menu.templateRef,this._viewContainerRef)),this._portal}}return n.\u0275fac=function(t){return new(t||n)(T(_r),T(pt),T(Mi),T(VO),T(V0,8),T(z0,10),T(uc,8),T(Ys),T(_e))},n.\u0275dir=te({type:n,hostAttrs:["aria-haspopup","true"],hostVars:2,hostBindings:function(t,i){1&t&&At("click",function(s){return i._handleClick(s)})("mousedown",function(s){return i._handleMousedown(s)})("keydown",function(s){return i._handleKeydown(s)}),2&t&&yt("aria-expanded",i.menuOpen||null)("aria-controls",i.menuOpen?i.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:["mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:["matMenuTriggerFor","menu"],menuData:["matMenuTriggerData","menuData"],restoreFocus:["matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"}}),n})(),EX=(()=>{class n extends CX{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pn(n)))(i||n)}}(),n.\u0275dir=te({type:n,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-menu-trigger"],exportAs:["matMenuTrigger"],features:[ke]}),n})(),MX=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:[xX],imports:[[Ai,Ne,Oo,hc],dc,Ne]}),n})();const TX=["*"];let SX=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Ot({type:n,selectors:[["app-popover"]],ngContentSelectors:TX,decls:6,vars:1,consts:[[1,"icon","material-icons",3,"matMenuTriggerFor"],["menu","matMenu"],[1,"popover",3,"click"]],template:function(t,i){1&t&&(cr(),ue(0,"i",0),Ei(1,"info_outline"),de(),ue(2,"mat-menu",null,1),ue(4,"div",2),At("click",function(s){return s.stopPropagation()}),Ui(5),de(),de()),2&t&&He("matMenuTriggerFor",Ls(3))},directives:[EX,bX],styles:["[_nghost-%COMP%]{margin:2px;vertical-align:baseline}.popover[_ngcontent-%COMP%]{padding:5px}.icon[_ngcontent-%COMP%]{position:relative;height:20px;top:4px;font-size:22px;cursor:pointer;cursor:hand}"]}),n})();const AX=["thumbContainer"],DX=["toggleBar"],IX=["input"],PX=function(n){return{enterDuration:n}},kX=["*"],OX=new q("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let RX=0;const LX={provide:ti,useExisting:Je(()=>UO),multi:!0};class FX{constructor(e,t){this.source=e,this.checked=t}}const NX=R0(Ad(Pa(Sd(class{constructor(n){this._elementRef=n}}))));let UO=(()=>{class n extends NX{constructor(t,i,r,s,o,a){super(t),this._focusMonitor=i,this._changeDetectorRef=r,this.defaults=o,this._onChange=l=>{},this._onTouched=()=>{},this._uniqueId="mat-slide-toggle-"+ ++RX,this._required=!1,this._checked=!1,this.name=null,this.id=this._uniqueId,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new Oe,this.toggleChange=new Oe,this.tabIndex=parseInt(s)||0,this.color=this.defaultColor=o.color||"accent",this._noopAnimations="NoopAnimations"===a}get required(){return this._required}set required(t){this._required=Kt(t)}get checked(){return this._checked}set checked(t){this._checked=Kt(t),this._changeDetectorRef.markForCheck()}get inputId(){return`${this.id||this._uniqueId}-input`}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{t||Promise.resolve().then(()=>this._onTouched())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}_onChangeEvent(t){t.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(t){t.stopPropagation()}writeValue(t){this.checked=!!t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck()}focus(t,i){i?this._focusMonitor.focusVia(this._inputElement,i,t):this._inputElement.nativeElement.focus(t)}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(new FX(this,this.checked))}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return n.\u0275fac=function(t){return new(t||n)(T(pt),T(Ys),T(Fn),Zr("tabindex"),T(OX),T(as,8))},n.\u0275cmp=Ot({type:n,selectors:[["mat-slide-toggle"]],viewQuery:function(t,i){if(1&t&&(Ti(AX,5),Ti(DX,5),Ti(IX,5)),2&t){let r;Wt(r=qt())&&(i._thumbEl=r.first),Wt(r=qt())&&(i._thumbBarEl=r.first),Wt(r=qt())&&(i._inputElement=r.first)}},hostAttrs:[1,"mat-slide-toggle"],hostVars:13,hostBindings:function(t,i){2&t&&(Nl("id",i.id),yt("tabindex",null)("aria-label",null)("aria-labelledby",null)("name",null),Pn("mat-checked",i.checked)("mat-disabled",i.disabled)("mat-slide-toggle-label-before","before"==i.labelPosition)("_mat-animation-noopable",i._noopAnimations))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"],required:"required",checked:"checked"},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],features:[Ct([LX]),ke],ngContentSelectors:kX,decls:16,vars:20,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["toggleBar",""],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],["thumbContainer",""],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(t,i){if(1&t&&(cr(),ue(0,"label",0,1),ue(2,"span",2,3),ue(4,"input",4,5),At("change",function(s){return i._onChangeEvent(s)})("click",function(s){return i._onInputClick(s)}),de(),ue(6,"span",6,7),rt(8,"span",8),ue(9,"span",9),rt(10,"span",10),de(),de(),de(),ue(11,"span",11,12),At("cdkObserveContent",function(){return i._onLabelTextChange()}),ue(13,"span",13),Ei(14,"\xa0"),de(),Ui(15),de(),de()),2&t){const r=Ls(1),s=Ls(12);yt("for",i.inputId),Fe(2),Pn("mat-slide-toggle-bar-no-side-margin",!s.textContent||!s.textContent.trim()),Fe(2),He("id",i.inputId)("required",i.required)("tabIndex",i.tabIndex)("checked",i.checked)("disabled",i.disabled),yt("name",i.name)("aria-checked",i.checked)("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledby)("aria-describedby",i.ariaDescribedby),Fe(5),He("matRippleTrigger",r)("matRippleDisabled",i.disableRipple||i.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",Vu(18,PX,i._noopAnimations?0:150))}},directives:[ko,dO],styles:[".mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:transparent}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{-webkit-user-select:none;user-select:none;display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%;display:block}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}.cdk-high-contrast-active .mat-slide-toggle.cdk-keyboard-focused .mat-slide-toggle-bar{outline:2px dotted;outline-offset:5px}\n"],encapsulation:2,changeDetection:0}),n})(),HO=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({}),n})(),zX=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[HO,Oo,Ne,Td],HO,Ne]}),n})(),jX=(()=>{class n{constructor(t,i,r){this.router=t,this.routing=i,this.mapState=r,this.overlayChange=new Oe}toggleOverlay(t){this.overlay.visible=t&&t.checked,this.overlay.visible?this.mapState.setOverlay(this.overlay):this.mapState.removeOverlay(this.overlay);const i={};i[this.overlay.id+"_v"]=this.overlay.visible?"true":"false",this.routing.updateUrlParams(i)}ngOnInit(){const t=this.router.parseUrl(this.router.url).queryParams;this.overlay.visible="true"===t[this.overlay.id+"_v"]||this.overlay.visible,this.toggleOverlay({checked:this.overlay.visible})}}return n.\u0275fac=function(t){return new(t||n)(T(Vn),T(Sa),T(ac))},n.\u0275cmp=Ot({type:n,selectors:[["app-overlay-toggle-control"]],inputs:{overlay:"overlay"},outputs:{overlayChange:"overlayChange"},decls:1,vars:1,consts:[[3,"checked","change"]],template:function(t,i){1&t&&(ue(0,"mat-slide-toggle",0),At("change",function(s){return i.toggleOverlay(s)}),de()),2&t&&He("checked",i.overlay.visible)},directives:[UO],styles:["[_nghost-%COMP%]{margin:auto}"]}),n})();const UX=["sliderWrapper"],yr=Io({passive:!1}),$X={provide:ti,useExisting:Je(()=>GO),multi:!0};class YX{}const ZX=R0(Ad(Sd(class{constructor(n){this._elementRef=n}}),"accent"));let GO=(()=>{class n extends ZX{constructor(t,i,r,s,o,a,l,c){super(t),this._focusMonitor=i,this._changeDetectorRef=r,this._dir=s,this._ngZone=a,this._animationMode=c,this._invert=!1,this._max=100,this._min=0,this._step=1,this._thumbLabel=!1,this._tickInterval=0,this._value=null,this._vertical=!1,this.change=new Oe,this.input=new Oe,this.valueChange=new Oe,this.onTouched=()=>{},this._percent=0,this._isSliding=null,this._isActive=!1,this._tickIntervalPercent=0,this._sliderDimensions=null,this._controlValueAccessorChangeFn=()=>{},this._dirChangeSubscription=ee.EMPTY,this._pointerDown=u=>{this.disabled||this._isSliding||!Pd(u)&&0!==u.button||this._ngZone.run(()=>{this._touchId=Pd(u)?function XX(n,e){for(let t=0;t<n.touches.length;t++){const i=n.touches[t].target;if(e===i||e.contains(i))return n.touches[t].identifier}}(u,this._elementRef.nativeElement):void 0;const d=qO(u,this._touchId);if(d){const h=this.value;this._isSliding="pointer",this._lastPointerEvent=u,this._focusHostElement(),this._onMouseenter(),this._bindGlobalEvents(u),this._focusHostElement(),this._updateValueFromPosition(d),this._valueOnSlideStart=h,u.cancelable&&u.preventDefault(),h!=this.value&&this._emitInputEvent()}})},this._pointerMove=u=>{if("pointer"===this._isSliding){const d=qO(u,this._touchId);if(d){u.preventDefault();const h=this.value;this._lastPointerEvent=u,this._updateValueFromPosition(d),h!=this.value&&this._emitInputEvent()}}},this._pointerUp=u=>{"pointer"===this._isSliding&&(!Pd(u)||"number"!=typeof this._touchId||j0(u.changedTouches,this._touchId))&&(u.preventDefault(),this._removeGlobalEvents(),this._isSliding=null,this._touchId=void 0,this._valueOnSlideStart!=this.value&&!this.disabled&&this._emitChangeEvent(),this._valueOnSlideStart=this._lastPointerEvent=null)},this._windowBlur=()=>{this._lastPointerEvent&&this._pointerUp(this._lastPointerEvent)},this._document=l,this.tabIndex=parseInt(o)||0,a.runOutsideAngular(()=>{const u=t.nativeElement;u.addEventListener("mousedown",this._pointerDown,yr),u.addEventListener("touchstart",this._pointerDown,yr)})}get invert(){return this._invert}set invert(t){this._invert=Kt(t)}get max(){return this._max}set max(t){this._max=us(t,this._max),this._percent=this._calculatePercentage(this._value),this._changeDetectorRef.markForCheck()}get min(){return this._min}set min(t){this._min=us(t,this._min),this._percent=this._calculatePercentage(this._value),this._changeDetectorRef.markForCheck()}get step(){return this._step}set step(t){this._step=us(t,this._step),this._step%1!=0&&(this._roundToDecimal=this._step.toString().split(".").pop().length),this._changeDetectorRef.markForCheck()}get thumbLabel(){return this._thumbLabel}set thumbLabel(t){this._thumbLabel=Kt(t)}get tickInterval(){return this._tickInterval}set tickInterval(t){this._tickInterval="auto"===t?"auto":"number"==typeof t||"string"==typeof t?us(t,this._tickInterval):0}get value(){return null===this._value&&(this.value=this._min),this._value}set value(t){if(t!==this._value){let i=us(t,0);this._roundToDecimal&&i!==this.min&&i!==this.max&&(i=parseFloat(i.toFixed(this._roundToDecimal))),this._value=i,this._percent=this._calculatePercentage(this._value),this._changeDetectorRef.markForCheck()}}get vertical(){return this._vertical}set vertical(t){this._vertical=Kt(t)}get displayValue(){return this.displayWith?this.displayWith(this.value):this._roundToDecimal&&this.value&&this.value%1!=0?this.value.toFixed(this._roundToDecimal):this.value||0}focus(t){this._focusHostElement(t)}blur(){this._blurHostElement()}get percent(){return this._clamp(this._percent)}_shouldInvertAxis(){return this.vertical?!this.invert:this.invert}_isMinValue(){return 0===this.percent}_getThumbGap(){return this.disabled?7:this._isMinValue()&&!this.thumbLabel?this._isActive?10:7:0}_getTrackBackgroundStyles(){const i=this.vertical?`1, ${1-this.percent}, 1`:1-this.percent+", 1, 1";return{transform:`translate${this.vertical?"Y":"X"}(${this._shouldInvertMouseCoords()?"-":""}${this._getThumbGap()}px) scale3d(${i})`}}_getTrackFillStyles(){const t=this.percent,r=this.vertical?`1, ${t}, 1`:`${t}, 1, 1`;return{transform:`translate${this.vertical?"Y":"X"}(${this._shouldInvertMouseCoords()?"":"-"}${this._getThumbGap()}px) scale3d(${r})`,display:0===t?"none":""}}_getTicksContainerStyles(){return{transform:`translate${this.vertical?"Y":"X"}(${this.vertical||"rtl"!=this._getDirection()?"-":""}${this._tickIntervalPercent/2*100}%)`}}_getTicksStyles(){let t=100*this._tickIntervalPercent,a={backgroundSize:this.vertical?`2px ${t}%`:`${t}% 2px`,transform:`translateZ(0) translate${this.vertical?"Y":"X"}(${this.vertical||"rtl"!=this._getDirection()?"":"-"}${t/2}%)${this.vertical||"rtl"!=this._getDirection()?"":" rotate(180deg)"}`};if(this._isMinValue()&&this._getThumbGap()){const l=this._shouldInvertAxis();let c;c=this.vertical?l?"Bottom":"Top":l?"Right":"Left",a[`padding${c}`]=`${this._getThumbGap()}px`}return a}_getThumbContainerStyles(){const t=this._shouldInvertAxis();return{transform:`translate${this.vertical?"Y":"X"}(-${100*(("rtl"!=this._getDirection()||this.vertical?t:!t)?this.percent:1-this.percent)}%)`}}_shouldInvertMouseCoords(){const t=this._shouldInvertAxis();return"rtl"!=this._getDirection()||this.vertical?t:!t}_getDirection(){return this._dir&&"rtl"==this._dir.value?"rtl":"ltr"}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{this._isActive=!!t&&"keyboard"!==t,this._changeDetectorRef.detectChanges()}),this._dir&&(this._dirChangeSubscription=this._dir.change.subscribe(()=>{this._changeDetectorRef.markForCheck()}))}ngOnDestroy(){const t=this._elementRef.nativeElement;t.removeEventListener("mousedown",this._pointerDown,yr),t.removeEventListener("touchstart",this._pointerDown,yr),this._lastPointerEvent=null,this._removeGlobalEvents(),this._focusMonitor.stopMonitoring(this._elementRef),this._dirChangeSubscription.unsubscribe()}_onMouseenter(){this.disabled||(this._sliderDimensions=this._getSliderDimensions(),this._updateTickIntervalPercent())}_onFocus(){this._sliderDimensions=this._getSliderDimensions(),this._updateTickIntervalPercent()}_onBlur(){this.onTouched()}_onKeydown(t){if(this.disabled||$s(t)||this._isSliding&&"keyboard"!==this._isSliding)return;const i=this.value;switch(t.keyCode){case 33:this._increment(10);break;case 34:this._increment(-10);break;case 35:this.value=this.max;break;case 36:this.value=this.min;break;case 37:this._increment("rtl"==this._getDirection()?1:-1);break;case 38:this._increment(1);break;case 39:this._increment("rtl"==this._getDirection()?-1:1);break;case 40:this._increment(-1);break;default:return}i!=this.value&&(this._emitInputEvent(),this._emitChangeEvent()),this._isSliding="keyboard",t.preventDefault()}_onKeyup(){"keyboard"===this._isSliding&&(this._isSliding=null)}_getWindow(){return this._document.defaultView||window}_bindGlobalEvents(t){const i=this._document,r=Pd(t),o=r?"touchend":"mouseup";i.addEventListener(r?"touchmove":"mousemove",this._pointerMove,yr),i.addEventListener(o,this._pointerUp,yr),r&&i.addEventListener("touchcancel",this._pointerUp,yr);const a=this._getWindow();void 0!==a&&a&&a.addEventListener("blur",this._windowBlur)}_removeGlobalEvents(){const t=this._document;t.removeEventListener("mousemove",this._pointerMove,yr),t.removeEventListener("mouseup",this._pointerUp,yr),t.removeEventListener("touchmove",this._pointerMove,yr),t.removeEventListener("touchend",this._pointerUp,yr),t.removeEventListener("touchcancel",this._pointerUp,yr);const i=this._getWindow();void 0!==i&&i&&i.removeEventListener("blur",this._windowBlur)}_increment(t){const i=this._clamp(this.value||0,this.min,this.max);this.value=this._clamp(i+this.step*t,this.min,this.max)}_updateValueFromPosition(t){if(!this._sliderDimensions)return;let o=this._clamp(((this.vertical?t.y:t.x)-(this.vertical?this._sliderDimensions.top:this._sliderDimensions.left))/(this.vertical?this._sliderDimensions.height:this._sliderDimensions.width));if(this._shouldInvertMouseCoords()&&(o=1-o),0===o)this.value=this.min;else if(1===o)this.value=this.max;else{const a=this._calculateValue(o),l=Math.round((a-this.min)/this.step)*this.step+this.min;this.value=this._clamp(l,this.min,this.max)}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.value),this.valueChange.emit(this.value),this.change.emit(this._createChangeEvent())}_emitInputEvent(){this.input.emit(this._createChangeEvent())}_updateTickIntervalPercent(){if(!this.tickInterval||!this._sliderDimensions)return;let t;if("auto"==this.tickInterval){let i=this.vertical?this._sliderDimensions.height:this._sliderDimensions.width;t=Math.ceil(30/(i*this.step/(this.max-this.min)))*this.step/i}else t=this.tickInterval*this.step/(this.max-this.min);this._tickIntervalPercent=WO(t)?t:0}_createChangeEvent(t=this.value){let i=new YX;return i.source=this,i.value=t,i}_calculatePercentage(t){const i=((t||0)-this.min)/(this.max-this.min);return WO(i)?i:0}_calculateValue(t){return this.min+t*(this.max-this.min)}_clamp(t,i=0,r=1){return Math.max(i,Math.min(t,r))}_getSliderDimensions(){return this._sliderWrapper?this._sliderWrapper.nativeElement.getBoundingClientRect():null}_focusHostElement(t){this._elementRef.nativeElement.focus(t)}_blurHostElement(){this._elementRef.nativeElement.blur()}writeValue(t){this.value=t}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this.disabled=t}}return n.\u0275fac=function(t){return new(t||n)(T(pt),T(Ys),T(Fn),T(uc,8),Zr("tabindex"),T(_e),T(je),T(as,8))},n.\u0275cmp=Ot({type:n,selectors:[["mat-slider"]],viewQuery:function(t,i){if(1&t&&Ti(UX,5),2&t){let r;Wt(r=qt())&&(i._sliderWrapper=r.first)}},hostAttrs:["role","slider",1,"mat-slider","mat-focus-indicator"],hostVars:29,hostBindings:function(t,i){1&t&&At("focus",function(){return i._onFocus()})("blur",function(){return i._onBlur()})("keydown",function(s){return i._onKeydown(s)})("keyup",function(){return i._onKeyup()})("mouseenter",function(){return i._onMouseenter()})("selectstart",function(s){return s.preventDefault()}),2&t&&(Nl("tabIndex",i.tabIndex),yt("aria-disabled",i.disabled)("aria-valuemax",i.max)("aria-valuemin",i.min)("aria-valuenow",i.value)("aria-valuetext",null==i.valueText?i.displayValue:i.valueText)("aria-orientation",i.vertical?"vertical":"horizontal"),Pn("mat-slider-disabled",i.disabled)("mat-slider-has-ticks",i.tickInterval)("mat-slider-horizontal",!i.vertical)("mat-slider-axis-inverted",i._shouldInvertAxis())("mat-slider-invert-mouse-coords",i._shouldInvertMouseCoords())("mat-slider-sliding",i._isSliding)("mat-slider-thumb-label-showing",i.thumbLabel)("mat-slider-vertical",i.vertical)("mat-slider-min-value",i._isMinValue())("mat-slider-hide-last-tick",i.disabled||i._isMinValue()&&i._getThumbGap()&&i._shouldInvertAxis())("_mat-animation-noopable","NoopAnimations"===i._animationMode))},inputs:{disabled:"disabled",color:"color",tabIndex:"tabIndex",invert:"invert",max:"max",min:"min",step:"step",thumbLabel:"thumbLabel",tickInterval:"tickInterval",value:"value",displayWith:"displayWith",valueText:"valueText",vertical:"vertical"},outputs:{change:"change",input:"input",valueChange:"valueChange"},exportAs:["matSlider"],features:[Ct([$X]),ke],decls:13,vars:6,consts:[[1,"mat-slider-wrapper"],["sliderWrapper",""],[1,"mat-slider-track-wrapper"],[1,"mat-slider-track-background",3,"ngStyle"],[1,"mat-slider-track-fill",3,"ngStyle"],[1,"mat-slider-ticks-container",3,"ngStyle"],[1,"mat-slider-ticks",3,"ngStyle"],[1,"mat-slider-thumb-container",3,"ngStyle"],[1,"mat-slider-focus-ring"],[1,"mat-slider-thumb"],[1,"mat-slider-thumb-label"],[1,"mat-slider-thumb-label-text"]],template:function(t,i){1&t&&(ue(0,"div",0,1),ue(2,"div",2),rt(3,"div",3),rt(4,"div",4),de(),ue(5,"div",5),rt(6,"div",6),de(),ue(7,"div",7),rt(8,"div",8),rt(9,"div",9),ue(10,"div",10),ue(11,"span",11),Ei(12),de(),de(),de(),de()),2&t&&(Fe(3),He("ngStyle",i._getTrackBackgroundStyles()),Fe(1),He("ngStyle",i._getTrackFillStyles()),Fe(1),He("ngStyle",i._getTicksContainerStyles()),Fe(1),He("ngStyle",i._getTicksStyles()),Fe(1),He("ngStyle",i._getThumbContainerStyles()),Fe(5),rs(i.displayValue))},directives:[Dv],styles:['.mat-slider{display:inline-block;position:relative;box-sizing:border-box;padding:8px;outline:none;vertical-align:middle}.mat-slider:not(.mat-slider-disabled):active,.mat-slider.mat-slider-sliding:not(.mat-slider-disabled){cursor:grabbing}.mat-slider-wrapper{-webkit-print-color-adjust:exact;color-adjust:exact;position:absolute}.mat-slider-track-wrapper{position:absolute;top:0;left:0;overflow:hidden}.mat-slider-track-fill{position:absolute;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-track-background{position:absolute;transform-origin:100% 100%;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-ticks-container{position:absolute;left:0;top:0;overflow:hidden}.mat-slider-ticks{-webkit-background-clip:content-box;background-clip:content-box;background-repeat:repeat;box-sizing:border-box;opacity:0;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-thumb-container{position:absolute;z-index:1;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-focus-ring{position:absolute;width:30px;height:30px;border-radius:50%;transform:scale(0);opacity:0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider.cdk-keyboard-focused .mat-slider-focus-ring,.mat-slider.cdk-program-focused .mat-slider-focus-ring{transform:scale(1);opacity:1}.mat-slider:not(.mat-slider-disabled):not(.mat-slider-sliding) .mat-slider-thumb-label,.mat-slider:not(.mat-slider-disabled):not(.mat-slider-sliding) .mat-slider-thumb{cursor:grab}.mat-slider-thumb{position:absolute;right:-10px;bottom:-10px;box-sizing:border-box;width:20px;height:20px;border:3px solid transparent;border-radius:50%;transform:scale(0.7);transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),border-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-thumb-label{display:none;align-items:center;justify-content:center;position:absolute;width:28px;height:28px;border-radius:50%;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),border-radius 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.cdk-high-contrast-active .mat-slider-thumb-label{outline:solid 1px}.mat-slider-thumb-label-text{z-index:1;opacity:0;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-sliding .mat-slider-track-fill,.mat-slider-sliding .mat-slider-track-background,.mat-slider-sliding .mat-slider-thumb-container{transition-duration:0ms}.mat-slider-has-ticks .mat-slider-wrapper::after{content:"";position:absolute;border-width:0;border-style:solid;opacity:0;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-has-ticks.cdk-focused:not(.mat-slider-hide-last-tick) .mat-slider-wrapper::after,.mat-slider-has-ticks:hover:not(.mat-slider-hide-last-tick) .mat-slider-wrapper::after{opacity:1}.mat-slider-has-ticks.cdk-focused:not(.mat-slider-disabled) .mat-slider-ticks,.mat-slider-has-ticks:hover:not(.mat-slider-disabled) .mat-slider-ticks{opacity:1}.mat-slider-thumb-label-showing .mat-slider-focus-ring{display:none}.mat-slider-thumb-label-showing .mat-slider-thumb-label{display:flex}.mat-slider-axis-inverted .mat-slider-track-fill{transform-origin:100% 100%}.mat-slider-axis-inverted .mat-slider-track-background{transform-origin:0 0}.mat-slider:not(.mat-slider-disabled).cdk-focused.mat-slider-thumb-label-showing .mat-slider-thumb{transform:scale(0)}.mat-slider:not(.mat-slider-disabled).cdk-focused .mat-slider-thumb-label{border-radius:50% 50% 0}.mat-slider:not(.mat-slider-disabled).cdk-focused .mat-slider-thumb-label-text{opacity:1}.mat-slider:not(.mat-slider-disabled).cdk-mouse-focused .mat-slider-thumb,.mat-slider:not(.mat-slider-disabled).cdk-touch-focused .mat-slider-thumb,.mat-slider:not(.mat-slider-disabled).cdk-program-focused .mat-slider-thumb{border-width:2px;transform:scale(1)}.mat-slider-disabled .mat-slider-focus-ring{transform:scale(0);opacity:0}.mat-slider-disabled .mat-slider-thumb{border-width:4px;transform:scale(0.5)}.mat-slider-disabled .mat-slider-thumb-label{display:none}.mat-slider-horizontal{height:48px;min-width:128px}.mat-slider-horizontal .mat-slider-wrapper{height:2px;top:23px;left:8px;right:8px}.mat-slider-horizontal .mat-slider-wrapper::after{height:2px;border-left-width:2px;right:0;top:0}.mat-slider-horizontal .mat-slider-track-wrapper{height:2px;width:100%}.mat-slider-horizontal .mat-slider-track-fill{height:2px;width:100%;transform:scaleX(0)}.mat-slider-horizontal .mat-slider-track-background{height:2px;width:100%;transform:scaleX(1)}.mat-slider-horizontal .mat-slider-ticks-container{height:2px;width:100%}.cdk-high-contrast-active .mat-slider-horizontal .mat-slider-ticks-container{height:0;outline:solid 2px;top:1px}.mat-slider-horizontal .mat-slider-ticks{height:2px;width:100%}.mat-slider-horizontal .mat-slider-thumb-container{width:100%;height:0;top:50%}.mat-slider-horizontal .mat-slider-focus-ring{top:-15px;right:-15px}.mat-slider-horizontal .mat-slider-thumb-label{right:-14px;top:-40px;transform:translateY(26px) scale(0.01) rotate(45deg)}.mat-slider-horizontal .mat-slider-thumb-label-text{transform:rotate(-45deg)}.mat-slider-horizontal.cdk-focused .mat-slider-thumb-label{transform:rotate(45deg)}.cdk-high-contrast-active .mat-slider-horizontal.cdk-focused .mat-slider-thumb-label,.cdk-high-contrast-active .mat-slider-horizontal.cdk-focused .mat-slider-thumb-label-text{transform:none}.mat-slider-vertical{width:48px;min-height:128px}.mat-slider-vertical .mat-slider-wrapper{width:2px;top:8px;bottom:8px;left:23px}.mat-slider-vertical .mat-slider-wrapper::after{width:2px;border-top-width:2px;bottom:0;left:0}.mat-slider-vertical .mat-slider-track-wrapper{height:100%;width:2px}.mat-slider-vertical .mat-slider-track-fill{height:100%;width:2px;transform:scaleY(0)}.mat-slider-vertical .mat-slider-track-background{height:100%;width:2px;transform:scaleY(1)}.mat-slider-vertical .mat-slider-ticks-container{width:2px;height:100%}.cdk-high-contrast-active .mat-slider-vertical .mat-slider-ticks-container{width:0;outline:solid 2px;left:1px}.mat-slider-vertical .mat-slider-focus-ring{bottom:-15px;left:-15px}.mat-slider-vertical .mat-slider-ticks{width:2px;height:100%}.mat-slider-vertical .mat-slider-thumb-container{height:100%;width:0;left:50%}.mat-slider-vertical .mat-slider-thumb{-webkit-backface-visibility:hidden;backface-visibility:hidden}.mat-slider-vertical .mat-slider-thumb-label{bottom:-14px;left:-40px;transform:translateX(26px) scale(0.01) rotate(-45deg)}.mat-slider-vertical .mat-slider-thumb-label-text{transform:rotate(45deg)}.mat-slider-vertical.cdk-focused .mat-slider-thumb-label{transform:rotate(-45deg)}[dir=rtl] .mat-slider-wrapper::after{left:0;right:auto}[dir=rtl] .mat-slider-horizontal .mat-slider-track-fill{transform-origin:100% 100%}[dir=rtl] .mat-slider-horizontal .mat-slider-track-background{transform-origin:0 0}[dir=rtl] .mat-slider-horizontal.mat-slider-axis-inverted .mat-slider-track-fill{transform-origin:0 0}[dir=rtl] .mat-slider-horizontal.mat-slider-axis-inverted .mat-slider-track-background{transform-origin:100% 100%}.mat-slider._mat-animation-noopable .mat-slider-track-fill,.mat-slider._mat-animation-noopable .mat-slider-track-background,.mat-slider._mat-animation-noopable .mat-slider-ticks,.mat-slider._mat-animation-noopable .mat-slider-thumb-container,.mat-slider._mat-animation-noopable .mat-slider-focus-ring,.mat-slider._mat-animation-noopable .mat-slider-thumb,.mat-slider._mat-animation-noopable .mat-slider-thumb-label,.mat-slider._mat-animation-noopable .mat-slider-thumb-label-text,.mat-slider._mat-animation-noopable .mat-slider-has-ticks .mat-slider-wrapper::after{transition:none}\n'],encapsulation:2,changeDetection:0}),n})();function WO(n){return!isNaN(n)&&isFinite(n)}function Pd(n){return"t"===n.type[0]}function qO(n,e){let t;return t=Pd(n)?"number"==typeof e?j0(n.touches,e)||j0(n.changedTouches,e):n.touches[0]||n.changedTouches[0]:n,t?{x:t.clientX,y:t.clientY}:void 0}function j0(n,e){for(let t=0;t<n.length;t++)if(n[t].identifier===e)return n[t]}let KX=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Ai,Ne],Ne]}),n})(),QX=(()=>{class n{constructor(t,i,r){this.router=t,this.routing=i,this.mapState=r,this.overlayChange=new Oe}setOpacity(t){if(t.value>=0){this.overlay.opacity=t.value/100;const i={};i[this.overlay.id+"_o"]=this.overlay.opacity,this.overlay.visible&&(this.mapState.removeOverlay(this.overlay),this.mapState.setOverlay(this.overlay)),this.routing.updateUrlParams(i)}}ngOnInit(){const t=this.router.parseUrl(this.router.url).queryParams;this.overlay.opacity=parseFloat(t[this.overlay.id+"_o"])||this.overlay.opacity||.6,this.overlay.visible&&this.mapState.setOverlay(this.overlay)}}return n.\u0275fac=function(t){return new(t||n)(T(Vn),T(Sa),T(ac))},n.\u0275cmp=Ot({type:n,selectors:[["app-opacity-control"]],inputs:{overlay:"overlay"},outputs:{overlayChange:"overlayChange"},decls:1,vars:2,consts:[["name","opacity","thumbLabel","","tickInterval","1","min","0","max","100","step","1",3,"value","disabled","change"]],template:function(t,i){1&t&&(ue(0,"mat-slider",0),At("change",function(s){return i.setOpacity(s)}),de()),2&t&&He("value",i.overlay&&100*i.overlay.opacity)("disabled",!i.overlay.visible)},directives:[GO],styles:["[_nghost-%COMP%]{display:inline-block}"]}),n})();const JX=function(n){return{background:n}};function eK(n,e){if(1&n&&(ue(0,"div"),ue(1,"div",2),Ei(2),de(),ue(3,"div",3),ue(4,"div",4),Ei(5),de(),rt(6,"div",5),ue(7,"div",6),Ei(8),de(),de(),de()),2&n){const t=ei();Fe(2),rs(null==t.overlay.type||null==t.overlay.type.legend?null:t.overlay.type.legend.label),Fe(3),rs(null==t.overlay.type||null==t.overlay.type.legend?null:t.overlay.type.legend.min),Fe(1),He("ngStyle",Vu(4,JX,"linear-gradient(to right, "+(null==t.overlay.type||null==t.overlay.type.legend||null==t.overlay.type.legend.palette?null:t.overlay.type.legend.palette.join(","))+")")),Fe(2),rs(null==t.overlay.type||null==t.overlay.type.legend?null:t.overlay.type.legend.max)}}const tK=function(n){return{"background-color":n}};function nK(n,e){if(1&n&&(ue(0,"div",9),ue(1,"div",10),Ei(2),de(),rt(3,"div",11),de()),2&n){const t=e.$implicit;Fe(2),rs(t.label),Fe(1),He("ngStyle",Vu(2,tK,t.color))}}function iK(n,e){if(1&n&&(ue(0,"div",7),Jn(1,nK,4,4,"div",8),de()),2&n){const t=ei();Fe(1),He("ngForOf",null==t.overlay.type||null==t.overlay.type.legend?null:t.overlay.type.legend.categories)}}let rK=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Ot({type:n,selectors:[["app-overlay-legend"]],inputs:{overlay:"overlay"},decls:2,vars:2,consts:[[4,"ngIf"],["class","categorical-legend",4,"ngIf"],[1,"legend-label"],[1,"legend-container"],[1,"min-label"],[1,"legend",3,"ngStyle"],[1,"max-label"],[1,"categorical-legend"],["class","category",4,"ngFor","ngForOf"],[1,"category"],[1,"category-label"],[1,"category-color",3,"ngStyle"]],template:function(t,i){1&t&&(Jn(0,eK,9,6,"div",0),Jn(1,iK,2,1,"div",1)),2&t&&(He("ngIf",!(null!=i.overlay&&null!=i.overlay.type&&null!=i.overlay.type.legend&&i.overlay.type.legend.categories)),Fe(1),He("ngIf",null==i.overlay||null==i.overlay.type||null==i.overlay.type.legend?null:i.overlay.type.legend.categories))},directives:[Xl,Dv,Sv],styles:["[_nghost-%COMP%]{width:205px;display:inline-block;padding:5px;font-size:small}.legend[_ngcontent-%COMP%]{flex:3;width:250px;height:20px;border:1pt solid darkgrey}.legend-container[_ngcontent-%COMP%]{display:flex}.min-label[_ngcontent-%COMP%], .max-label[_ngcontent-%COMP%]{flex:1;padding:5px;white-space:nowrap}.legend-label[_ngcontent-%COMP%]{white-space:nowrap}.categorical-legend[_ngcontent-%COMP%]{display:flex;flex-direction:row}.category[_ngcontent-%COMP%]{flex:1}.category-label[_ngcontent-%COMP%]{width:100%;white-space:nowrap;overflow-x:hidden;height:20px}.category-color[_ngcontent-%COMP%]{width:100%;height:20px;border:1pt solid darkgrey}.legend[_ngcontent-%COMP%]{min-width:140px}"]}),n})();function sK(n,e){if(1&n&&(ue(0,"app-popover",6),Ei(1),ue(2,"a",7),Ei(3,"More information"),de(),de()),2&n){const t=ei(2).$implicit;Fe(1),Ef(" ",t.help," ")}}function oK(n,e){if(1&n&&(ue(0,"tr"),ue(1,"td",2),Jn(2,sK,4,1,"app-popover",3),de(),ue(3,"td",2),rt(4,"app-overlay-toggle-control",4),de(),ue(5,"td",2),Ei(6),de(),ue(7,"td",2),rt(8,"app-opacity-control",4),de(),ue(9,"td",5),rt(10,"app-year-selector",4),de(),de()),2&n){const t=ei().$implicit;Fe(2),He("ngIf",t.help),Fe(2),He("overlay",t),Fe(2),rs(t.name),Fe(2),He("overlay",t),Fe(2),He("overlay",t)}}function aK(n,e){if(1&n&&(ue(0,"tr"),ue(1,"td",8),rt(2,"app-overlay-legend",4),de(),de()),2&n){const t=ei().$implicit;Fe(2),He("overlay",t)}}function lK(n,e){if(1&n&&(function ky(n,e,t){const i=U(),r=_t(),s=n+20,o=r.firstCreatePass?function UU(n,e,t,i,r){const s=e.consts,o=po(s,i),a=vl(e,n,8,"ng-container",o);return null!==o&&_f(a,o,!0),hy(e,t,a,po(s,r)),null!==e.queries&&e.queries.elementStart(e,a),a}(s,r,i,e,t):r.data[s];Yr(o,!0);const a=i[s]=i[11].createComment("");uf(r,i,a,o),Kn(a,i),Bh(o)&&(uy(r,i,o),aT(r,o,i)),null!=t&&dy(i,o)}(0),Jn(1,oK,11,5,"tr",1),Jn(2,aK,3,1,"tr",1),function Oy(){let n=An();const e=_t();u_()?d_():(n=n.parent,Yr(n,!1)),e.firstCreatePass&&(Gh(e,n),n_(n)&&e.queries.elementEnd(n))}()),2&n){const t=e.$implicit;Fe(1),He("ngIf",t.showControl),Fe(1),He("ngIf",(null==t||null==t.type?null:t.type.legend)&&t.visible)}}let cK=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Ot({type:n,selectors:[["app-layer-group"]],inputs:{overlays:"overlays"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"control-cell"],["class","help",4,"ngIf"],[3,"overlay"],[1,"year-cell"],[1,"help"],["href","https://rangelands.app/products/"],["colspan","6",1,"legend-cell"]],template:function(t,i){1&t&&(ue(0,"table"),Jn(1,lK,3,2,"ng-container",0),de()),2&t&&(Fe(1),He("ngForOf",i.overlays))},directives:[Sv,Xl,SX,jX,QX,rK],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;text-align:center;padding:10px}app-year-selector[_ngcontent-%COMP%]{flex:1}table[_ngcontent-%COMP%]{margin:auto}.control-cell[_ngcontent-%COMP%]{text-align:left;width:-moz-fit-content;width:fit-content;height:35px}.legend-cell[_ngcontent-%COMP%]{text-align:center}"]}),n})(),uK=(()=>{class n{constructor(t,i,r,s,o){this.router=t,this.mapState=i,this.http=r,this.routing=s,this.snackBar=o,this.featureLayers={},this.overlays=[new qp({id:"montana-historical-imagery",name:"Montana Historical Imagery",opacity:1,visible:!0,help:"Historic imagery",mapIds:["right"],type:{format:"XYZ",name:"1950",id:"mt-hist",tileurl:"https://storage.googleapis.com/montana-historical-imagery/v1/{z}/{x}/{y}.png"},bounds:new google.maps.LatLngBounds(new google.maps.LatLng(41.005779201292384,-120.60604051826046),new google.maps.LatLng(55.12908567856297,-96.300538948688))}),new qp({id:"montana-historical-imagery-outlines",name:"Montana Historical Imagery Outlines",opacity:1,visible:!0,showControl:!1,help:"Historic imagery",mapIds:["right","left"],type:{name:"1950",id:"mt-hist",format:"MVT",tileurl:"https://storage.googleapis.com/montana-historical-imagery/seamlines/{z}/{x}/{y}.pbf"},bounds:new google.maps.LatLngBounds(new google.maps.LatLng(41.005779201292384,-120.60604051826046),new google.maps.LatLng(55.12908567856297,-96.300538948688))})],this.router.parseUrl(this.router.url)}updateOverlays(){this.overlays.forEach(t=>{t instanceof qp&&t.visible&&(this.mapState.removeOverlay(t),this.mapState.setOverlay(t))})}ngOnInit(){this.updateOverlays()}}return n.\u0275fac=function(t){return new(t||n)(T(Vn),T(ac),T(dp),T(Sa),T(uX))},n.\u0275cmp=Ot({type:n,selectors:[["app-landcover-control"]],decls:1,vars:1,consts:[["tourAnchor","select-cover-type",3,"overlays"]],template:function(t,i){1&t&&rt(0,"app-layer-group",0),2&t&&He("overlays",i.overlays)},directives:[cK],styles:["[_nghost-%COMP%]{text-align:center;overflow:hidden;flex:1}.veg-help[_ngcontent-%COMP%]{margin-right:25px}.mat-select-panel[_ngcontent-%COMP%]{max-height:500px}.year-select[_ngcontent-%COMP%]{width:55px}.saveCheckbox[_ngcontent-%COMP%]{font-size:11pt}.overlay-switcher[_ngcontent-%COMP%]{white-space:nowrap}.overlay-switcher[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin:5px}.year-select[_ngcontent-%COMP%]{width:60px}.year-select[_ngcontent-%COMP%]   mat-select[_ngcontent-%COMP%]{width:60px!important}div.mat-form-field-infix[_ngcontent-%COMP%]{width:60px!important}.help[_ngcontent-%COMP%]{width:22px}.toggles[_ngcontent-%COMP%]{margin-left:35px;padding:4px;text-align:left;width:535px}.opacity-container[_ngcontent-%COMP%]{width:100%;padding:5px;text-align:center}.allNoneToggle[_ngcontent-%COMP%]{display:inline-block;border:1pt solid gray;padding:3pt 1.5pt;margin:2pt;color:gray;cursor:pointer;cursor:hand;text-align:center}.years[_ngcontent-%COMP%]{margin-left:40px}.year.active[_ngcontent-%COMP%]{border-color:#cf9c00!important;color:#cf9c00!important}.year.selected[_ngcontent-%COMP%]{border-color:#cf9c00!important;color:#fff!important;background-color:#cf9c00!important}.hide[_ngcontent-%COMP%]{display:none}.progress-bar[_ngcontent-%COMP%]{text-align:center;margin-left:120px}.landcover-analysis-buttons[_ngcontent-%COMP%]{text-align:center;margin:10pt}.landcover-analysis-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10pt 2pt}.chart-container[_ngcontent-%COMP%]{padding:5pt}app-landcover-trend-chart[_ngcontent-%COMP%]{min-height:300px;max-width:300px}.legend-container[_ngcontent-%COMP%]{width:100%;text-align:center}"],data:{animation:[eY,tY]}}),n})(),dK=(()=>{class n{constructor(){this.style=[{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#fffefe"}]},{featureType:"poi.park",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#46bcec"}]},{featureType:"road.highway",stylers:[{visibility:"simplified"}]},{featureType:"road",stylers:[{saturation:-25}]}]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();function g(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function $O(n){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||"undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,t=n||e;return!!(t&&t.indexOf("Electron")>=0)}function ds(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||$O()}const YO="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source";ds();class fK{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";g(this,"storage",void 0),g(this,"id",void 0),g(this,"config",{}),this.storage=function hK(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch(e){return null}}(i),this.id=e,this.config={},Object.assign(this.config,t),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function U0(n,e,t){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const r=n.src.replace(/\(/g,"%28").replace(/\)/g,"%29");n.width>i&&(t=Math.min(t,i/n.width));const s=n.width*t,o=n.height*t,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let cm;var n;function ZO(n){return"string"==typeof n?cm[n.toUpperCase()]||cm.WHITE:n}function um(n,e){if(!n)throw new Error(e||"Assertion failed")}(n=cm||(cm={}))[n.BLACK=30]="BLACK",n[n.RED=31]="RED",n[n.GREEN=32]="GREEN",n[n.YELLOW=33]="YELLOW",n[n.BLUE=34]="BLUE",n[n.MAGENTA=35]="MAGENTA",n[n.CYAN=36]="CYAN",n[n.WHITE=37]="WHITE",n[n.BRIGHT_BLACK=90]="BRIGHT_BLACK",n[n.BRIGHT_RED=91]="BRIGHT_RED",n[n.BRIGHT_GREEN=92]="BRIGHT_GREEN",n[n.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",n[n.BRIGHT_BLUE=94]="BRIGHT_BLUE",n[n.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",n[n.BRIGHT_CYAN=96]="BRIGHT_CYAN",n[n.BRIGHT_WHITE=97]="BRIGHT_WHITE";const Ro={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:"undefined"!=typeof global&&global,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},dm=(globalThis,Ro.window||Ro.self||Ro.global),kd=Ro.process||{};function gc(){let n;var e,t;if(ds&&"performance"in dm)n=null==dm||null===(e=dm.performance)||void 0===e||null===(t=e.now)||void 0===t?void 0:t.call(e);else if("hrtime"in kd){var i;const r=null==kd||null===(i=kd.hrtime)||void 0===i?void 0:i.call(kd);n=1e3*r[0]+r[1]/1e6}else n=Date.now();return n}console;var bK=Re(249);const _c={debug:ds&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},wK={enabled:!0,level:0};function vr(){}const XO={},KO={once:!0};class Od{constructor(){let{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};g(this,"id",void 0),g(this,"VERSION",YO),g(this,"_startTs",gc()),g(this,"_deltaTs",gc()),g(this,"_storage",void 0),g(this,"userData",{}),g(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this._storage=new fK("__probe-".concat(this.id,"__"),wK),this.userData={},this.timeStamp("".concat(this.id," started")),function vK(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const t=Object.getPrototypeOf(n),i=Object.getOwnPropertyNames(t);for(const r of i)"function"==typeof n[r]&&(e.find(s=>r===s)||(n[r]=n[r].bind(n)))}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((gc()-this._startTs).toPrecision(10))}getDelta(){return Number((gc()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){return this._storage.updateConfiguration({enabled:!(arguments.length>0&&void 0!==arguments[0])||arguments[0]}),this}setLevel(e){return this._storage.updateConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.updateConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){um(e,t)}warn(e){return this._getLogFunction(0,e,_c.warn,arguments,KO)}error(e){return this._getLogFunction(0,e,_c.error,arguments)}deprecated(e,t){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(t,"` instead"))}removed(e,t){return this.error("`".concat(e,"` has been removed. Use `").concat(t,"` instead"))}probe(e,t){return this._getLogFunction(e,t,_c.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,_c.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];return this._getLogFunction(e,t,_c.debug||_c.info,arguments,KO)}table(e,t,i){return t?this._getLogFunction(e,t,console.table||vr,i&&[i],{tag:MK(t)}):vr}image(e){let{logLevel:t,priority:i,image:r,message:s="",scale:o=1}=e;return this._shouldLog(t||i)?ds?function EK(n){let{image:e,message:t="",scale:i=1}=n;if("string"==typeof e){const s=new Image;return s.onload=()=>{const o=U0(s,t,i);console.log(...o)},s.src=e,vr}const r=e.nodeName||"";if("img"===r.toLowerCase())return console.log(...U0(e,t,i)),vr;if("canvas"===r.toLowerCase()){const s=new Image;return s.onload=()=>console.log(...U0(s,t,i)),s.src=e.toDataURL(),vr}return vr}({image:r,message:s,scale:o}):function CK(n){let{image:e,message:t="",scale:i=1}=n;return bK.nodeAsciifyImage({image:e,message:t,scale:i}),vr}({image:r,message:s,scale:o}):vr}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||vr)}group(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const r=JO({logLevel:e,message:t,opts:i}),{collapsed:s}=i;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,t){return this.group(e,t,Object.assign({},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||vr)}withGroup(e,t,i){this.group(e,t)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=QO(e)}_getLogFunction(e,t,i,r,s){if(this._shouldLog(e)){s=JO({logLevel:e,message:t,args:r,opts:s}),um(i=i||s.method),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=gc();const o=s.tag||s.message;if(s.once){if(XO[o])return vr;XO[o]=gc()}return t=function xK(n,e,t){if("string"==typeof e){const i=t.time?function mK(n){const t=Math.max((arguments.length>1&&void 0!==arguments[1]?arguments[1]:8)-n.length,0);return"".concat(" ".repeat(t)).concat(n)}(function pK(n){let e;return e=n<10?"".concat(n.toFixed(2),"ms"):n<100?"".concat(n.toFixed(1),"ms"):n<1e3?"".concat(n.toFixed(0),"ms"):"".concat((n/1e3).toFixed(2),"s"),e}(t.total)):"";e=t.time?"".concat(n,": ").concat(i,"  ").concat(e):"".concat(n,": ").concat(e),e=function yK(n,e,t){return!ds&&"string"==typeof n&&(e&&(e=ZO(e),n="\x1b[".concat(e,"m").concat(n,"\x1b[39m")),t&&(e=ZO(t),n="\x1b[".concat(t+10,"m").concat(n,"\x1b[49m"))),n}(e,t.color,t.background)}return e}(this.id,s.message,s),i.bind(console,t,...s.args)}return vr}}function QO(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return um(Number.isFinite(e)&&e>=0),e}function JO(n){const{logLevel:e,message:t}=n;n.logLevel=QO(e);const i=n.args?Array.from(n.args):[];for(;i.length&&i.shift()!==t;);switch(typeof e){case"string":case"function":void 0!==t&&i.unshift(t),n.message=e;break;case"object":Object.assign(n,e)}"function"==typeof n.message&&(n.message=n.message());const r=typeof n.message;return um("string"===r||"object"===r),Object.assign(n,{args:i},n.opts)}function MK(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}g(Od,"VERSION",YO);const ge=new Od({id:"luma.gl"});function mi(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function hm(n){return"undefined"!=typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&Number.isFinite(n._version))}function lt(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}function fm(n){return mi(hm(n),"Invalid WebGLRenderingContext"),n}function ni(n){return mi(lt(n),"Requires WebGL2"),n}const Rd={};const Ld=function n(e){const t=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new n.VertexAttrib(t);this.attribs[i]=r}this.maxAttrib=0};(Ld.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const ka=function(e){const t=this;this.gl=e,function kK(n){const e=n.getError;n.getError=function(){let i;do{i=e.apply(n),0!==i&&(Rd[i]=!0)}while(0!==i);for(i in Rd)if(Rd[i])return delete Rd[i],parseInt(i,10);return 0}}(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===t.VERTEX_ARRAY_BINDING_OES?t.currentVertexArrayObject===t.defaultVertexArrayObject?null:t.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=t.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:t.currentArrayBuffer=o;break;case 34963:t.currentVertexArrayObject.elementArrayBuffer=o}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=t.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,c,u){const d=t.currentVertexArrayObject;d.maxAttrib=Math.max(d.maxAttrib,s);const h=d.attribs[s];return h.buffer=t.currentArrayBuffer,h.size=o,h.type=a,h.normalized=l,h.stride=c,h.offset=u,h.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{(function IK(n){globalThis.console&&globalThis.console.log&&globalThis.console.log(n)})("OESVertexArrayObject emulation library context restored"),t.reset_()},!0),this.reset_()};ka.prototype.VERTEX_ARRAY_BINDING_OES=34229,ka.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;this.maxVertexAttribs=this.gl.getParameter(34921),this.defaultVertexArrayObject=new Ld(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},ka.prototype.createVertexArrayOES=function(){const e=new Ld(this);return this.vertexArrayObjects.push(e),e},ka.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)},ka.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Ld&&e.hasBeenBound&&e.ext===this)},ka.prototype.bindVertexArrayOES=function(e){const t=this.gl;if(e&&!e.isAlive)return void function PK(n,e){Rd[n]=!0,void 0!==e&&function DK(n){globalThis.console&&globalThis.console.error&&globalThis.console.error(n)}(e)}(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(t,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const c=s.attribs[l],u=r?r.attribs[l]:null;if((!r||c.enabled!==u.enabled)&&(c.enabled?i.enableVertexAttribArray.call(t,l):i.disableVertexAttribArray.call(t,l)),c.enabled){let d=!1;(!r||c.buffer!==u.buffer)&&(o!==c.buffer&&(i.bindBuffer.call(t,34962,c.buffer),o=c.buffer),d=!0),(d||c.cached!==u.cached)&&i.vertexAttribPointer.call(t,l,c.size,c.type,c.normalized,c.stride,c.offset)}}this.currentArrayBuffer!==o&&i.bindBuffer.call(t,34962,this.currentArrayBuffer)};const eR="OES_element_index",tR="WEBGL_draw_buffers",nR="WEBGL_debug_renderer_info",Ut=n=>lt(n)?void 0:0,HK={3074:n=>lt(n)?void 0:36064,35723:n=>lt(n)?void 0:4352,35977:Ut,32937:Ut,36795:(n,e)=>{const t=lt(n)?n.getExtension("EXT_disjoint_timer_query_webgl2"):n.getExtension("EXT_disjoint_timer_query");return t&&t.GPU_DISJOINT_EXT?e(t.GPU_DISJOINT_EXT):0},37445:(n,e)=>{const t=n.getExtension(nR);return e(t&&t.UNMASKED_VENDOR_WEBGL||7936)},37446:(n,e)=>{const t=n.getExtension(nR);return e(t&&t.UNMASKED_RENDERER_WEBGL||7937)},34047:(n,e)=>{const t=n.luma.extensions.EXT_texture_filter_anisotropic;return t?e(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:Ut,35071:Ut,37447:Ut,36063:(n,e)=>{if(!lt(n)){const t=n.getExtension(tR);return t?e(t.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:Ut,35374:Ut,35377:Ut,34852:n=>{if(!lt(n)){const e=n.getExtension(tR);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:n=>n.getExtension(eR)?2147483647:65535,33001:n=>n.getExtension(eR)?16777216:65535,33e3:n=>16777216,37157:Ut,35373:Ut,35657:Ut,36183:Ut,37137:Ut,34045:Ut,35978:Ut,35979:Ut,35968:Ut,35376:Ut,35375:Ut,35659:Ut,37154:Ut,35371:Ut,35658:Ut,35076:Ut,35077:Ut,35380:Ut},iR="ANGLE_instanced_arrays",rR={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{mi(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[iR]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(n,e){mi(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{mi(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{mi(!1)},deleteQuery:()=>{mi(!1)},beginQuery:()=>{mi(!1)},endQuery:()=>{},getQuery(n,e){return this.getQueryObject(n,e)},getQueryParameter(n,e){return this.getQueryObject(n,e)},getQueryObject:()=>{}}},H0={readBuffer:(n,e,t)=>{lt(n)&&e(t)},getVertexAttrib:(n,e,t,i)=>{const{webgl2:r,ext:s}=function XK(n,e){return{webgl2:lt(n),ext:n.getExtension(e)}}(n,iR);let o;switch(i){case 35069:o=!!r&&void 0;break;case 35070:o=r||s?void 0:0}return void 0!==o?o:e(t,i)},getProgramParameter:(n,e,t,i)=>{if(!lt(n))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(t,i)},getInternalformatParameter:(n,e,t,i,r)=>lt(n)||32937!==r?n.getInternalformatParameter(t,i,r):new Int32Array([0]),getTexParameter(n,e,t,i){if(34046===i){const{extensions:r}=n.luma,s=r.EXT_texture_filter_anisotropic;i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(t,i)},getParameter:function GK(n,e,t){const i=HK[t],r="function"==typeof i?i(n,e,t):i;return void 0!==r?r:e(t)},hint:(n,e,t,i)=>e(t,i)};function tQ(n,e){let{extension:t,target:i,target2:r}=e;const s=rR[t];mi(s);const{meta:o={}}=s,{suffix:a=""}=o,l=n.getExtension(t);for(const c of Object.keys(s)){const u="".concat(c).concat(a);let d=null;"meta"===c||"function"==typeof n[c]||(l&&"function"==typeof l[u]?d=function(){return l[u](...arguments)}:"function"==typeof s[c]&&(d=s[c].bind(i))),d&&(i[c]=d,r[c]=d)}}globalThis.polyfillContext=function KK(n){n.luma=n.luma||{};const{luma:e}=n;return e.polyfilled||(function OK(n){if("function"==typeof n.createVertexArray)return;const e=n.getSupportedExtensions;n.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const t=n.getExtension;n.getExtension=function(r){return t.call(this,r)||("OES_vertex_array_object"!==r?null:(n.__OESVertexArrayObject||(this.__OESVertexArrayObject=new ka(this)),this.__OESVertexArrayObject))}}(n),function QK(n){n.luma.extensions={};const e=n.getSupportedExtensions()||[];for(const t of e)n.luma[t]=n.getExtension(t)}(n),function eQ(n,e){for(const t of Object.getOwnPropertyNames(e))"overrides"!==t&&tQ(n,{extension:t,target:n.luma,target2:n})}(n,rR),function JK(n,e){let{target:t,target2:i}=e;Object.keys(H0).forEach(r=>{if("function"==typeof H0[r]){const s=n[r]?n[r].bind(n):()=>{},o=H0[r].bind(null,n,s);t[r]=o,i[r]=o}})}(n,{target:e,target2:n}),e.polyfilled=!0),n};const G0={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Lo=(n,e,t)=>e?n.enable(t):n.disable(t),sR=(n,e,t)=>n.hint(t,e),$i=(n,e,t)=>n.pixelStorei(t,e);function Fd(n){return Array.isArray(n)||ArrayBuffer.isView(n)}const rQ={3042:Lo,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:Lo,2885:(n,e)=>n.cullFace(e),2929:Lo,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:Lo,35723:sR,36006:(n,e)=>{const t=lt(n)?36009:36160;return n.bindFramebuffer(t,e)},2886:(n,e)=>n.frontFace(e),33170:sR,2849:(n,e)=>n.lineWidth(e),32823:Lo,32824:"polygonOffset",10752:"polygonOffset",35977:Lo,32938:"sampleCoverage",32939:"sampleCoverage",3089:Lo,3088:(n,e)=>n.scissor(...e),2960:Lo,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),3333:$i,3317:$i,37440:$i,37441:$i,37443:$i,3330:$i,3332:$i,3331:$i,36010:(n,e)=>n.bindFramebuffer(36008,e),3314:$i,32878:$i,3316:$i,3315:$i,32877:$i,framebuffer:(n,e)=>n.bindFramebuffer(36160,e&&"handle"in e?e.handle:e),blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{e=Fd(e)?e:[e,e],n.blendEquationSeparate(...e)},blendFunc:(n,e)=>{e=Fd(e)&&2===e.length?[...e,...e]:e,n.blendFuncSeparate(...e)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(...e),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=Fd(e)?e:[e,e];const[t,i]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,i)},stencilFunc:(n,e)=>{e=Fd(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilFuncSeparate(1028,t,i,r),n.stencilFuncSeparate(1029,s,o,a)},stencilOp:(n,e)=>{e=Fd(e)&&3===e.length?[...e,...e]:e;const[t,i,r,s,o,a]=e;n.stencilOpSeparate(1028,t,i,r),n.stencilOpSeparate(1029,s,o,a)},viewport:(n,e)=>n.viewport(...e)};function ln(n,e,t){return void 0!==e[n]?e[n]:t[n]}const sQ={blendEquation:(n,e,t)=>n.blendEquationSeparate(ln(32777,e,t),ln(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(ln(32969,e,t),ln(32968,e,t),ln(32971,e,t),ln(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(ln(32824,e,t),ln(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(ln(32938,e,t),ln(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,ln(2962,e,t),ln(2967,e,t),ln(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,ln(34816,e,t),ln(36003,e,t),ln(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,ln(2964,e,t),ln(2965,e,t),ln(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,ln(34817,e,t),ln(34818,e,t),ln(34819,e,t))},oR={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},blendColor:(n,e,t,i,r)=>n({32773:new Float32Array([e,t,i,r])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,i,r)=>n({32969:e,32968:t,32971:i,32970:r}),clearColor:(n,e,t,i,r)=>n({3106:new Float32Array([e,t,i,r])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,i,r)=>n({3107:[e,t,i,r]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,i,r)=>n({3088:new Int32Array([e,t,i,r])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[1028===e?2968:36005]:t}),stencilFunc:(n,e,t,i)=>n({2962:e,2967:t,2963:i,34816:e,36003:t,36004:i}),stencilFuncSeparate:(n,e,t,i,r)=>n({[1028===e?2962:34816]:t,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(n,e,t,i)=>n({2964:e,2965:t,2966:i,34817:e,34818:t,34819:i}),stencilOpSeparate:(n,e,t,i,r)=>n({[1028===e?2964:34817]:t,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(n,e,t,i,r)=>n({2978:[e,t,i,r]})},hs=(n,e)=>n.isEnabled(e),aR={3042:hs,2884:hs,2929:hs,3024:hs,32823:hs,32926:hs,32928:hs,3089:hs,2960:hs,35977:hs};function lR(n){for(const e in n)return!1;return!0}function oQ(n,e){if(n===e)return!0;const t=Array.isArray(n)||ArrayBuffer.isView(n),i=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&i&&n.length===e.length){for(let r=0;r<n.length;++r)if(n[r]!==e[r])return!1;return!0}return!1}function cR(n,e){const t=n[e].bind(n);n[e]=function(){const r=arguments.length<=0?void 0:arguments[0];return r in n.state.cache&&n.state.enable?n.state.cache[r]:t(...arguments)},Object.defineProperty(n[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function aQ(n,e,t){const i=n[e].bind(n);n[e]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const{valueChanged:l,oldValue:c}=t(n.state._updateCache,...o);return l&&i(...o),c},Object.defineProperty(n[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function lQ(n){const e=n.useProgram.bind(n);n.useProgram=function(i){n.state.program!==i&&(e(i),n.state.program=i)}}class cQ{constructor(e){let{copyState:t=!1,log:i=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=t?hR(e):Object.assign({},G0),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){mi(this.stateStack.length>0),fs(this.gl,this.stateStack[this.stateStack.length-1]),this.stateStack.pop()}_updateCache(e){let i,t=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){mi(void 0!==s);const o=e[s],a=this.cache[s];oQ(o,a)||(t=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=o)}return{valueChanged:t,oldValue:i}}}function uR(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{enable:t=!0,copyState:i}=e;if(mi(void 0!==i),!n.state){const{polyfillContext:r}=globalThis;r&&r(n),n.state=new cQ(n,{copyState:i}),lQ(n);for(const s in oR)aQ(n,s,oR[s]);cR(n,"getParameter"),cR(n,"isEnabled")}return n.state.enable=t,n}function dR(n){mi(n.state),n.state.pop()}function fs(n,e){if(mi(hm(n),"setParameters requires a WebGL context"),lR(e))return;const t={};for(const r in e){const s=Number(r),o=rQ[r];o&&("string"==typeof o?t[o]=!0:o(n,e[r],s))}const i=n.state&&n.state.cache;if(i)for(const r in t)sQ[r](n,e,i)}function hR(n,e){if("number"==typeof(e=e||G0)){const r=e,s=aR[r];return s?s(n,r):n.getParameter(r)}const t=Array.isArray(e)?e:Object.keys(e),i={};for(const r of t){const s=aR[r];i[r]=s?s(n,Number(r)):n.getParameter(Number(r))}return i}function Ii(n,e,t){if(lR(e))return t(n);const{nocatch:i=!0}=e;let r;if(function uQ(n){n.state||uR(n,{copyState:!1}),n.state.push()}(n),fs(n,e),i)r=t(n),dR(n);else try{r=t(n)}finally{dR(n)}return r}function yc(n){const{luma:e}=n;if(n.canvas&&e){const{clientWidth:t}=e.canvasSizeInfo;return t?n.drawingBufferWidth/t:1}return 1}function W0(n,e){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const i=yc(n),r=n.drawingBufferWidth,s=n.drawingBufferHeight;return fQ(e,i,r,s,t)}function hQ(n){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(n)?n<=0?1:n:n?e:1}function fQ(n,e,t,i,r){const s=fR(n[0],e,t);let o=pR(n[1],e,i,r),a=fR(n[0]+1,e,t);const l=a===t-1?a:a-1;let c;return a=pR(n[1]+1,e,i,r),r?(a=0===a?a:a+1,c=o,o=a):c=a===i-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(c-o+1,1)}}function fR(n,e,t){return Math.min(Math.round(n*e),t-1)}function pR(n,e,t,i){return i?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}const q0=ds(),pQ=q0&&"undefined"!=typeof document,mR={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function gR(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};mi(q0,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),n=Object.assign({},mR,n);const{width:e,height:t}=n;function i(a){if(n.throwOnError)throw new Error(a);return console.error(a),null}let r;n.onError=i;const{canvas:s}=n,o=yQ({canvas:s,width:e,height:t,onError:i});return r=_Q(o,n),r?(r=$0(r,n),vQ(r),r):null}function $0(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!n||n._instrumented)return n;n._version=n._version||bQ(n),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{},e=Object.assign({},mR,e);const{manageState:t,debug:i}=e;return t&&uR(n,{copyState:!1,log:function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return ge.log(1,...s)()}}),q0&&i&&(globalThis.makeDebugContext?(n=globalThis.makeDebugContext(n,e),ge.level=Math.max(ge.level,1)):ge.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),n._instrumented=!0,n}function _Q(n,e){const{onError:t}=e;let i=null;const r=l=>i=l.statusMessage||i;n.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||n.getContext("webgl2",e),a=a||n.getContext("experimental-webgl2",e)),s&&(a=a||n.getContext("webgl",e),a=a||n.getContext("experimental-webgl",e)),n.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&n.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&n.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):t("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"))}function yQ(n){let s,{canvas:e,width:t=800,height:i=600,onError:r}=n;return"string"==typeof e?(pQ&&"complete"===document.readyState||r("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(t)?"".concat(t,"px"):"100%",s.style.height=Number.isFinite(i)?"".concat(i,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function vQ(n){const e=lt(n)?"WebGL2":"WebGL1",t=function mQ(n){const e=n.getParameter(7936),t=n.getParameter(7937),i=n.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&n.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&n.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||t,vendorMasked:e,rendererMasked:t,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n),i=t?"(".concat(t.vendor,",").concat(t.renderer,")"):"",r=n.debug?" debug":"";ge.info(1,"".concat(e).concat(r," context ").concat(i))()}function bQ(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext?2:1}function wQ(n,e,t){let i="width"in t?t.width:n.canvas.clientWidth,r="height"in t?t.height:n.canvas.clientHeight;(!i||!r)&&(ge.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=n.canvas.width||1,r=n.canvas.height||1),n.luma=n.luma||{},n.luma.canvasSizeInfo=n.luma.canvasSizeInfo||{};const s=n.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let o=e;const a=Math.floor(i*o),l=Math.floor(r*o);n.canvas.width=a,n.canvas.height=l,(n.drawingBufferWidth!==a||n.drawingBufferHeight!==l)&&(ge.warn("Device pixel ratio clamped")(),o=Math.min(n.drawingBufferWidth/i,n.drawingBufferHeight/r),n.canvas.width=Math.floor(i*o),n.canvas.height=Math.floor(r*o)),Object.assign(n.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}let xQ=1,CQ=1;class _R{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:t=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,o=xQ++,a={time:0,delay:t,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[t,i]of this.animations)i.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return void 0!==t&&this.time>=t.delay+t.duration*t.repeat}getTime(e){if(void 0===e)return this.time;const t=this.channels.get(e);return void 0===t?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const r of t)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:o}=r;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const i=CQ++;return this.animations.set(i,{animation:e,channel:t}),e.setTime(this.getTime(t)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const i=t-e.delay;i>=e.duration*e.repeat?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}const pm=Symbol.for("component"),bc=Symbol.for("asyncPropDefaults"),Oa=Symbol.for("asyncPropOriginal"),Fo=Symbol.for("asyncPropResolved"),Ye=new Od({id:"deck"});let Y0={};function ii(n,e,t,i){Ye.level>0&&Y0[n]&&Y0[n].call(null,e,t,i)}function mm(n,e=(()=>!0)){return Array.isArray(n)?yR(n,e,[]):e(n)?[n]:[]}function yR(n,e,t){let i=-1;for(;++i<n.length;){const r=n[i];Array.isArray(r)?yR(r,e,t):e(r)&&t.push(r)}return t}function MQ({target:n,source:e,start:t=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=t;o<r;o++)n[a++]=e[o];for(;o<s;)o<s-o?(n.copyWithin(t+o,t,t+o),o*=2):(n.copyWithin(t+o,t,t+s-o),o=s);return n}function vR(){let n;if("undefined"!=typeof window&&window.performance)n=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();n=1e3*e[0]+e[1]/1e6}else n=Date.now();return n}class bR{constructor(e,t){g(this,"name",void 0),g(this,"type",void 0),g(this,"sampleSize",1),g(this,"time",void 0),g(this,"count",void 0),g(this,"samples",void 0),g(this,"lastTiming",void 0),g(this,"lastSampleTime",void 0),g(this,"lastSampleCount",void 0),g(this,"_count",0),g(this,"_time",0),g(this,"_samples",0),g(this,"_startTime",0),g(this,"_timerPending",!1),this.name=e,this.type=t,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=vR(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(vR()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class gm{constructor(e){g(this,"id",void 0),g(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){return this._getOrCreate({name:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count"})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const t in this.stats)e(this.stats[t])}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(t=>this._getOrCreate(t))}_getOrCreate(e){if(!e||!e.name)return null;const{name:t,type:i}=e;return this.stats[t]||(this.stats[t]=e instanceof bR?e:new bR(t,i)),this.stats[t]}}function wR(n,e,t,i,r,s,o){try{var a=n[s](o),l=a.value}catch(c){return void t(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function Bt(n){return function(){var e=this,t=arguments;return new Promise(function(i,r){var s=n.apply(e,t);function o(l){wR(s,i,r,o,a,"next",l)}function a(l){wR(s,i,r,o,a,"throw",l)}o(void 0)})}}const zr=n=>"function"==typeof n,No=n=>null!==n&&"object"==typeof n,CR=n=>No(n)&&n.constructor==={}.constructor,TQ=n=>n&&"function"==typeof n[Symbol.iterator],SQ=n=>n&&"function"==typeof n[Symbol.asyncIterator],wc=n=>"undefined"!=typeof Response&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,xc=n=>"undefined"!=typeof Blob&&n instanceof Blob,ER=n=>(n=>"undefined"!=typeof ReadableStream&&n instanceof ReadableStream||No(n)&&zr(n.tee)&&zr(n.cancel)&&zr(n.getReader))(n)||(n=>No(n)&&zr(n.read)&&zr(n.pipe)&&(n=>"boolean"==typeof n)(n.readable))(n);function _m(n,e){if(!n)throw new Error(e||"loader assertion failed.")}function Z0(n){var e;return!!n&&(Array.isArray(n)&&(n=n[0]),Array.isArray(null===(e=n)||void 0===e?void 0:e.extensions))}function X0(n){var e,t;let i;return _m(n,"null loader"),_m(Z0(n),"invalid loader"),Array.isArray(n)&&(i=n[1],n=X(k({},n=n[0]),{options:k(k({},n.options),i)})),(null!==(e=n)&&void 0!==e&&e.parseTextSync||null!==(t=n)&&void 0!==t&&t.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}const Q0={};function OQ(n){for(const e in Q0)n.startsWith(e)&&(n=n.replace(e,Q0[e]));return!n.startsWith("http://")&&!n.startsWith("https://")&&(n="".concat("").concat(n)),n}const RQ=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,LQ=/^([-\w.]+\/[-\w.+]+)/;function FQ(n){const e=LQ.exec(n);return e?e[1]:n}function MR(n){const e=RQ.exec(n);return e?e[1]:""}const NQ=/\?.*/;function ym(n){if(wc(n)){const e=J0(n.url||"");return{url:e,type:FQ(n.headers.get("content-type")||"")||MR(e)}}return xc(n)?{url:J0(n.name||""),type:n.type||""}:"string"==typeof n?{url:J0(n),type:MR(n)}:{url:"",type:""}}function BQ(n){return wc(n)?n.headers["content-length"]||-1:xc(n)?n.size:"string"==typeof n?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}function J0(n){return n.replace(NQ,"")}function TR(n){return ew.apply(this,arguments)}function ew(){return ew=Bt(function*(n){if(wc(n))return n;const e={},t=BQ(n);t>=0&&(e["content-length"]=String(t));const{url:i,type:r}=ym(n);r&&(e["content-type"]=r);const s=yield jQ(n);s&&(e["x-first-bytes"]=s),"string"==typeof n&&(n=(new TextEncoder).encode(n));const o=new Response(n,{headers:e});return Object.defineProperty(o,"url",{value:i}),o}),ew.apply(this,arguments)}function VQ(n){return tw.apply(this,arguments)}function tw(){return tw=Bt(function*(n){if(!n.ok){const e=yield zQ(n);throw new Error(e)}}),tw.apply(this,arguments)}function zQ(n){return nw.apply(this,arguments)}function nw(){return nw=Bt(function*(n){let e="Failed to fetch resource ".concat(n.url," (").concat(n.status,"): ");try{const t=n.headers.get("Content-Type");let i=n.statusText;t.includes("application/json")&&(i+=" ".concat(yield n.text())),e+=i,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch(t){}return e}),nw.apply(this,arguments)}function jQ(n){return iw.apply(this,arguments)}function iw(){return iw=Bt(function*(n){if("string"==typeof n)return"data:,".concat(n.slice(0,5));if(n instanceof Blob){const t=n.slice(0,5);return yield new Promise(i=>{const r=new FileReader;r.onload=s=>{var o;return i(null==s||null===(o=s.target)||void 0===o?void 0:o.result)},r.readAsDataURL(t)})}if(n instanceof ArrayBuffer){const i=UQ(n.slice(0,5));return"data:base64,".concat(i)}return null}),iw.apply(this,arguments)}function UQ(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.byteLength;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function SR(n,e){return rw.apply(this,arguments)}function rw(){return rw=Bt(function*(n,e){if("string"==typeof n){n=OQ(n);let t=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(t=e.fetch),yield fetch(n,t)}return yield TR(n)}),rw.apply(this,arguments)}const AR=new Od({id:"loaders.gl"});class HQ{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof global&&global,"undefined"!=typeof document&&document;const sw=Boolean("object"!=typeof process||"[object process]"!==String(process)||process.browser),DR="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),IR=(DR&&parseFloat(DR[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class GQ{constructor(){g(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:sw,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),WQ={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function ow(){globalThis.loaders=globalThis.loaders||{};const{loaders:n}=globalThis;return n._state=n._state||{},n._state}const aw=()=>{const n=ow();return n.globalOptions=n.globalOptions||k({},IR),n.globalOptions};function qQ(n,e,t,i){return t=t||[],function $Q(n,e){kR(n,null,IR,WQ,e);for(const t of e)kR(n&&n[t.id]||{},t.id,t.options&&t.options[t.id]||{},t.deprecatedOptions&&t.deprecatedOptions[t.id]||{},e)}(n,t=Array.isArray(t)?t:[t]),function OR(n,e,t){const r=k({},n.options||{});return function ZQ(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}(r,t),null===r.log&&(r.log=new HQ),RR(r,aw()),RR(r,e),r}(e,n,i)}function PR(n,e){const t=aw(),i=n||t;return"function"==typeof i.fetch?i.fetch:No(i.fetch)?r=>SR(r,i):null!=e&&e.fetch?null==e?void 0:e.fetch:SR}function kR(n,e,t,i,r){const s=e||"Top level",o=e?"".concat(e,"."):"";for(const a in n){const l=!e&&No(n[a]),c="baseUri"===a&&!e,u="workerUrl"===a&&e;if(!(a in t)&&!c&&!u)if(a in i)AR.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(i[a],"'"))();else if(!l){const d=YQ(a,r);AR.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(d))()}}}function YQ(n,e){const t=n.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(n===s)return"Did you mean '".concat(r.id,".").concat(s,"'?");const o=s.toLowerCase();(t.startsWith(o)||o.startsWith(t))&&(i=i||"Did you mean '".concat(r.id,".").concat(s,"'?"))}return i}function RR(n,e){for(const t in e)t in e&&(n[t]=CR(e[t])&&CR(n[t])?k(k({},n[t]),e[t]):e[t])}function Zs(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}function KQ(n,e="3.2.9"){return Zs(n,"no worker provided"),!(!e||!n.version)}"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof global&&global,"undefined"!=typeof document&&document;const vm="object"!=typeof process||"[object process]"!==String(process)||process.browser,QQ="undefined"!=typeof window&&void 0!==window.orientation,LR="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);LR&&parseFloat(LR[1]);class lw{}const cw=new Map;function FR(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function NR(n,e=!0,t){const i=t||new Set;if(n)if(BR(n))i.add(n);else if(BR(n.buffer))i.add(n.buffer);else if(!ArrayBuffer.isView(n)&&e&&"object"==typeof n)for(const r in n)NR(n[r],e,i);return void 0===t?Array.from(i):[]}function BR(n){return!!n&&(n instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&n instanceof MessagePort||"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&n instanceof OffscreenCanvas)}const uw=()=>{};class dw{static isSupported(){return"undefined"!=typeof Worker&&vm||void 0!==lw&&!vm}constructor(e){g(this,"name",void 0),g(this,"source",void 0),g(this,"url",void 0),g(this,"terminated",!1),g(this,"worker",void 0),g(this,"onMessage",void 0),g(this,"onError",void 0),g(this,"_loadableURL","");const{name:t,source:i,url:r}=e;Zs(i||r),this.name=t,this.source=i,this.url=r,this.onMessage=uw,this.onError=s=>console.log(s),this.worker=vm?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=uw,this.onError=uw,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||NR(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(t+="".concat(e.message," in ")),e.lineno&&(t+=":".concat(e.lineno,":").concat(e.colno)),new Error(t)}_createBrowserWorker(){this._loadableURL=function JQ(n){Zs(n.source&&!n.url||!n.source&&n.url);let e=cw.get(n.source||n.url);return e||(n.url&&(e=function eJ(n){return n.startsWith("http")?FR(function tJ(n){return"try {\n  importScripts('".concat(n,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")}(n)):n}(n.url),cw.set(n.url,e)),n.source&&(e=FR(n.source),cw.set(n.source,e))),Zs(e),e}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}_createNodeWorker(){let e;if(this.url){const i=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new lw(i,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new lw(this.source,{eval:!0})}return e.on("message",t=>{this.onMessage(t)}),e.on("error",t=>{this.onError(t)}),e.on("exit",t=>{}),e}}class iJ{constructor(e,t){g(this,"name",void 0),g(this,"workerThread",void 0),g(this,"isRunning",!0),g(this,"result",void 0),g(this,"_resolve",()=>{}),g(this,"_reject",()=>{}),this.name=e,this.workerThread=t,this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){Zs(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Zs(this.isRunning),this.isRunning=!1,this._reject(e)}}class rJ{static isSupported(){return dw.isSupported()}constructor(e){g(this,"name","unnamed"),g(this,"source",void 0),g(this,"url",void 0),g(this,"maxConcurrency",1),g(this,"maxMobileConcurrency",1),g(this,"onDebug",()=>{}),g(this,"reuseWorkers",!0),g(this,"props",{}),g(this,"jobQueue",[]),g(this,"idleQueue",[]),g(this,"count",0),g(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props=k(k({},this.props),e),void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}startJob(e,t=((r,s,o)=>r.done(o)),i=((r,s)=>r.error(s))){var r=this;return Bt(function*(){const s=new Promise(o=>(r.jobQueue.push({name:e,onMessage:t,onError:i,onStart:o}),r));return r._startQueuedJob(),yield s})()}_startQueuedJob(){var e=this;return Bt(function*(){if(!e.jobQueue.length)return;const t=e._getAvailableWorker();if(!t)return;const i=e.jobQueue.shift();if(i){e.onDebug({message:"Starting job",name:i.name,workerThread:t,backlog:e.jobQueue.length});const r=new iJ(i.name,t);t.onMessage=s=>i.onMessage(r,s.type,s.payload),t.onError=s=>i.onError(r,s),i.onStart(r);try{yield r.result}finally{e.returnWorkerToQueue(t)}}})()}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new dw({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return QQ?this.maxMobileConcurrency:this.maxConcurrency}}const sJ={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Xs{static isSupported(){return dw.isSupported()}static getWorkerFarm(e={}){return Xs._workerFarm=Xs._workerFarm||new Xs({}),Xs._workerFarm.setProps(e),Xs._workerFarm}constructor(e){g(this,"props",void 0),g(this,"workerPools",new Map),this.props=k({},sJ),this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props=k(k({},this.props),e);for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:i,url:r}=e;let s=this.workerPools.get(t);return s||(s=new rJ({name:t,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function aJ(n,e={}){const t=e[n.id]||{},i="".concat(n.id,"-worker.js");let r=t.workerUrl;if(!r&&"compression"===n.id&&(r=e.workerUrl),"test"===e._workerType&&(r="modules/".concat(n.module,"/dist/").concat(i)),!r){let s=n.version;"latest"===s&&(s="latest");const o=s?"@".concat(s):"";r="https://unpkg.com/@loaders.gl/".concat(n.module).concat(o,"/dist/").concat(i)}return Zs(r),r}function lJ(n,e){return!(!Xs.isSupported()||!(vm||null!=e&&e._nodeWorkers))&&n.worker&&(null==e?void 0:e.worker)}function cJ(n,e,t,i,r){return hw.apply(this,arguments)}function hw(){return hw=Bt(function*(n,e,t,i,r){const s=n.id,o=aJ(n,t),l=Xs.getWorkerFarm(t).getWorkerPool({name:s,url:o});t=JSON.parse(JSON.stringify(t)),i=JSON.parse(JSON.stringify(i||{}));const c=yield l.startJob("process-on-worker",uJ.bind(null,r));return c.postMessage("process",{input:e,options:t,context:i}),yield(yield c.result).result}),hw.apply(this,arguments)}function uJ(n,e,t,i){return fw.apply(this,arguments)}function fw(){return fw=Bt(function*(n,e,t,i){switch(t){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:r,input:s,options:o}=i;try{const a=yield n(s,o);e.postMessage("done",{id:r,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:l})}break;default:console.warn("parse-with-worker unknown message ".concat(t))}}),fw.apply(this,arguments)}function pw(n){var e,t,i,r=2;for("undefined"!=typeof Symbol&&(t=Symbol.asyncIterator,i=Symbol.iterator);r--;){if(t&&null!=(e=n[t]))return e.call(n);if(i&&null!=(e=n[i]))return new bm(e.call(n));t="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}function bm(n){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var i=t.done;return Promise.resolve(t.value).then(function(r){return{value:r,done:i}})}return(bm=function(i){this.s=i,this.n=i.next}).prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(i){var r=this.s.return;return void 0===r?Promise.resolve({value:i,done:!0}):e(r.apply(this.s,arguments))},throw:function(i){var r=this.s.return;return void 0===r?Promise.reject(i):e(r.apply(this.s,arguments))}},new bm(n)}function zR(n){return n&&"object"==typeof n&&n.isBuffer}function jR(n){if(zR(n))return function dJ(n){return zR(n)?new Uint8Array(n.buffer,n.byteOffset,n.length).slice().buffer:n}(n);if(n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return 0===n.byteOffset&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if("string"==typeof n){const e=n;return(new TextEncoder).encode(e).buffer}if(n&&"object"==typeof n&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function fJ(...n){const e=n.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),t=e.reduce((s,o)=>s+o.byteLength,0),i=new Uint8Array(t);let r=0;for(const s of e)i.set(s,r),r+=s.byteLength;return i.buffer}function pJ(n){return gw.apply(this,arguments)}function gw(){return gw=Bt(function*(n){const e=[];var r,t=!1,i=!1;try{for(var o,s=pw(n);t=!(o=yield s.next()).done;t=!1)e.push(o.value)}catch(a){i=!0,r=a}finally{try{t&&null!=s.return&&(yield s.return())}finally{if(i)throw r}}return fJ(...e)}),gw.apply(this,arguments)}g(Xs,"_workerFarm",void 0),Re(521);const _J=262144;function UR(n){this.wrapped=n}function wm(n){return new UR(n)}function Nd(n){var e,t;function r(o,a){try{var l=n[o](a),c=l.value,u=c instanceof UR;Promise.resolve(u?c.wrapped:c).then(function(d){u?r("return"===o?"return":"next",d):s(l.done?"return":"normal",d)},function(d){r("throw",d)})}catch(d){s("throw",d)}}function s(o,a){switch(o){case"return":e.resolve({value:a,done:!0});break;case"throw":e.reject(a);break;default:e.resolve({value:a,done:!1})}(e=e.next)?r(e.key,e.arg):t=null}this._invoke=function i(o,a){return new Promise(function(l,c){var u={key:o,arg:a,resolve:l,reject:c,next:null};t?t=t.next=u:(e=t=u,r(o,a))})},"function"!=typeof n.return&&(this.return=void 0)}function yw(n){return function(){return new Nd(n.apply(this,arguments))}}function vw(){return vw=yw(function*(n,e){const t=(null==e?void 0:e.chunkSize)||1048576;let i=0;for(;i<n.size;){const r=i+t,s=yield wm(n.slice(i,r).arrayBuffer());i=r,yield s}}),vw.apply(this,arguments)}function HR(n,e){return sw?function wJ(n,e){return bw.apply(this,arguments)}(n,e):function xJ(n,e){return ww.apply(this,arguments)}(n,e)}function bw(){return bw=yw(function*(n,e){const t=n.getReader();let i;try{for(;;){const r=i||t.read();null!=e&&e._streamReadAhead&&(i=t.read());const{done:s,value:o}=yield wm(r);if(s)return;yield jR(o)}}catch(r){t.releaseLock()}}),bw.apply(this,arguments)}function ww(){return ww=yw(function*(n,e){var r,t=!1,i=!1;try{for(var o,s=pw(n);t=!(o=yield wm(s.next())).done;t=!1){const a=o.value;yield jR(a)}}catch(a){i=!0,r=a}finally{try{t&&null!=s.return&&(yield wm(s.return()))}finally{if(i)throw r}}}),ww.apply(this,arguments)}function CJ(n,e){if("string"==typeof n)return function*gJ(n,e){const t=(null==e?void 0:e.chunkSize)||262144;let i=0;const r=new TextEncoder;for(;i<n.length;){const s=Math.min(n.length-i,t),o=n.slice(i,i+s);i+=s,yield r.encode(o)}}(n,e);if(n instanceof ArrayBuffer)return function*yJ(n,e={}){const{chunkSize:t=_J}=e;let i=0;for(;i<n.byteLength;){const r=Math.min(n.byteLength-i,t),s=new ArrayBuffer(r),o=new Uint8Array(n,i,r);new Uint8Array(s).set(o),i+=r,yield s}}(n,e);if(xc(n))return function bJ(n,e){return vw.apply(this,arguments)}(n,e);if(ER(n))return HR(n,e);if(wc(n))return HR(n.body,e);throw new Error("makeIterator")}Nd.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Nd.prototype.next=function(n){return this._invoke("next",n)},Nd.prototype.throw=function(n){return this._invoke("throw",n)},Nd.prototype.return=function(n){return this._invoke("return",n)};const xw="Cannot convert supplied data type";function EJ(n,e,t){if(e.text&&"string"==typeof n)return n;if((n=>n&&"object"==typeof n&&n.isBuffer)(n)&&(n=n.buffer),n instanceof ArrayBuffer){const i=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let i=n.buffer;const r=n.byteLength||n.length;return(0!==n.byteOffset||r!==i.byteLength)&&(i=i.slice(n.byteOffset,n.byteOffset+r)),i}throw new Error(xw)}function MJ(n,e,t){return Cw.apply(this,arguments)}function Cw(){return Cw=Bt(function*(n,e,t){const i=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if("string"==typeof n||i)return EJ(n,e);if(xc(n)&&(n=yield TR(n)),wc(n)){const r=n;return yield VQ(r),e.binary?yield r.arrayBuffer():yield r.text()}if(ER(n)&&(n=CJ(n,t)),TQ(n)||SQ(n))return pJ(n);throw new Error(xw)}),Cw.apply(this,arguments)}function SJ(n,e,t=null){if(t)return t;const i=k({fetch:PR(e,n)},n);return Array.isArray(i.loaders)||(i.loaders=null),i}function AJ(n,e){if(!e&&n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...i]:i}return t&&t.length?t:null}const IJ=new Od({id:"loaders.gl"}),GR=()=>{const n=ow();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry},OJ=/\.([^.]+)$/;function RJ(n){return Tw.apply(this,arguments)}function Tw(){return Tw=Bt(function*(n,e=[],t,i){if(!qR(n))return null;let r=WR(n,e,X(k({},t),{nothrow:!0}),i);if(r)return r;if(xc(n)&&(r=WR(n=yield n.slice(0,10).arrayBuffer(),e,t,i)),!(r||null!=t&&t.nothrow))throw new Error($R(n));return r}),Tw.apply(this,arguments)}function WR(n,e=[],t,i){if(!qR(n))return null;if(e&&!Array.isArray(e))return X0(e);let r=[];e&&(r=r.concat(e)),null!=t&&t.ignoreRegisteredLoaders||r.push(...function kJ(){return GR()}()),function FJ(n){for(const e of n)X0(e)}(r);const s=function LJ(n,e,t,i){const{url:r,type:s}=ym(n),o=r||(null==i?void 0:i.url);let a=null,l="";var c;return null!=t&&t.mimeType&&(a=Sw(e,null==t?void 0:t.mimeType),l="match forced by supplied MIME type ".concat(null==t?void 0:t.mimeType)),a=a||function NJ(n,e){const t=e&&OJ.exec(e),i=t&&t[1];return i?function BJ(n,e){e=e.toLowerCase();for(const t of n)for(const i of t.extensions)if(i.toLowerCase()===e)return t;return null}(n,i):null}(e,o),l=l||(a?"matched url ".concat(o):""),a=a||Sw(e,s),l=l||(a?"matched MIME type ".concat(s):""),a=a||function VJ(n,e){if(!e)return null;for(const t of n)if("string"==typeof e){if(zJ(e,t))return t}else if(ArrayBuffer.isView(e)){if(YR(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&YR(e,0,t))return t;return null}(e,n),l=l||(a?"matched initial data ".concat(ZR(n)):""),a=a||Sw(e,null==t?void 0:t.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(s):""),l&&IJ.log(1,"selectLoader selected ".concat(null===(c=a)||void 0===c?void 0:c.name,": ").concat(l,".")),a}(n,r,t,i);if(!(s||null!=t&&t.nothrow))throw new Error($R(n));return s}function qR(n){return!(n instanceof Response&&204===n.status)}function $R(n){const{url:e,type:t}=ym(n);let i="No valid loader found (";i+=e?"".concat(function DJ(n){const e=n&&n.lastIndexOf("/");return e>=0?n.substr(e+1):""}(e),", "):"no url provided, ",i+="MIME type: ".concat(t?'"'.concat(t,'"'):"not provided",", ");const r=n?ZR(n):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function Sw(n,e){for(const t of n)if(t.mimeTypes&&t.mimeTypes.includes(e)||e==="application/x.".concat(t.id))return t;return null}function zJ(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>n.startsWith(i))}function YR(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(r=>function jJ(n,e,t,i){if(i instanceof ArrayBuffer)return function hJ(n,e,t){if(n.byteLength<(t=t||n.byteLength)||e.byteLength<t)return!1;const i=new Uint8Array(n),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(i,n,i.byteLength);switch(typeof i){case"function":return i(n,t);case"string":return i===Aw(n,e,i.length);default:return!1}}(n,e,t,r))}function ZR(n,e=5){return"string"==typeof n?n.slice(0,e):ArrayBuffer.isView(n)?Aw(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?Aw(n,0,e):""}function Aw(n,e,t){if(n.byteLength<e+t)return"";const i=new DataView(n);let r="";for(let s=0;s<t;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function Dw(n,e,t,i){return Iw.apply(this,arguments)}function Iw(){return Iw=Bt(function*(n,e,t,i){Zs(!i||"object"==typeof i),e&&!Array.isArray(e)&&!Z0(e)&&(i=void 0,t=e,e=void 0),n=yield n,t=t||{};const{url:r}=ym(n),o=AJ(e,i),a=yield RJ(n,o,t);return a?(i=SJ({url:r,parse:Dw,loaders:o},t=qQ(t,a,o,r),i),yield UJ(a,n,t,i)):null}),Iw.apply(this,arguments)}function UJ(n,e,t,i){return Pw.apply(this,arguments)}function Pw(){return Pw=Bt(function*(n,e,t,i){if(KQ(n),wc(e)){const r=e,{ok:s,redirected:o,status:a,statusText:l,type:c,url:u}=r,d=Object.fromEntries(r.headers.entries());i.response={headers:d,ok:s,redirected:o,status:a,statusText:l,type:c,url:u}}if(e=yield MJ(e,n,t),n.parseTextSync&&"string"==typeof e)return t.dataType="text",n.parseTextSync(e,t,i,n);if(lJ(n,t))return yield cJ(n,e,t,i,Dw);if(n.parseText&&"string"==typeof e)return yield n.parseText(e,t,i,n);if(n.parse)return yield n.parse(e,t,i,n);throw Zs(!n.parseSync),new Error("".concat(n.id," loader - no parser found and worker is disabled"))}),Pw.apply(this,arguments)}function xm(n,e,t,i){return kw.apply(this,arguments)}function kw(){return kw=Bt(function*(n,e,t,i){!Array.isArray(e)&&!Z0(e)&&(t=e,e=void 0);const r=PR(t);let s=n;return"string"==typeof n&&(s=yield r(n)),xc(n)&&(s=yield r(n)),yield Dw(s,e,t)}),kw.apply(this,arguments)}class HJ{constructor(e,t,i){g(this,"id",void 0),g(this,"context",void 0),g(this,"isLoaded",void 0),g(this,"persistent",void 0),g(this,"_loadCount",0),g(this,"_subscribers",new Set),g(this,"_data",void 0),g(this,"_loader",void 0),g(this,"_error",void 0),g(this,"_content",void 0),this.id=e,this.context=i,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const i=++this._loadCount;let r=e;"string"==typeof e&&(r=xm(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class GJ{constructor({gl:e,protocol:t}){g(this,"protocol",void 0),g(this,"_context",void 0),g(this,"_resources",void 0),g(this,"_consumers",void 0),g(this,"_pruneRequest",void 0),this.protocol=t||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return!!e.startsWith(this.protocol)||e in this._resources}add({resourceId:e,data:t,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(t,i):(s=new HJ(e,t,this._context),this._resources[e]=s),s.persistent=r}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const i in t){const r=t[i],s=this._resources[r.resourceId];s&&s.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(s[e=e.replace(o,"")]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,t),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,i,r){const s=this._consumers,o=s[e]=s[e]||{},a=o[t]||{},l=a.resourceId&&this._resources[a.resourceId];l&&(l.unsubscribe(a),this.prune()),i&&(o[t]=a,a.onChange=r,a.resourceId=i.id,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const Cc=new class WJ{constructor(e={}){g(this,"_pool",[]),g(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,{size:i=1,type:r,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=r||e&&e.constructor||Float32Array,u=t*i+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let d=1/0;l&&(d=l*i+s);const h=this._allocate(c,u,a,d);return e&&o?h.set(e):a||h.fill(0,0,4),this._release(e),h}release(e){this._release(e)}_allocate(e,t,i,r){let s=Math.max(Math.ceil(t*this.opts.overAlloc),1);s>r&&(s=r);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return i&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:i}=e,{byteLength:r}=i,s=t.findIndex(o=>o.byteLength>=r);s<0?t.push(i):(s>0||t.length<this.opts.poolSize)&&t.splice(s,0,i),t.length>this.opts.poolSize&&t.shift()}},en=(Math,Math,{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0});function YJ(n,{precision:e=en.precision}={}){return n=function QJ(n){return Math.round(n/en.EPSILON)*en.EPSILON}(n),"".concat(parseFloat(n.toPrecision(e)))}function gs(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Gn(n,e,t){return function Qs(n,e,t){if(gs(n)){const i=n;t=t||function JJ(n){return n.clone?n.clone():new Array(n.length)}(i);for(let r=0;r<t.length&&r<i.length;++r)t[r]=e(n[r],r,t);return t}return e(n)}(n,i=>Math.max(e,Math.min(t,i)))}function Ks(n,e,t){return gs(n)?n.map((i,r)=>Ks(i,e[r],t)):t*e+(1-t)*n}function _s(n,e,t){const i=en.EPSILON;t&&(en.EPSILON=t);try{if(n===e)return!0;if(gs(n)&&gs(e)){if(n.length!==e.length)return!1;for(let r=0;r<n.length;++r)if(!_s(n[r],e[r]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):"number"==typeof n&&"number"==typeof e&&Math.abs(n-e)<=en.EPSILON*Math.max(1,Math.abs(n),Math.abs(e))}finally{en.EPSILON=i}}class Ow extends(function eee(n){function e(){var t=Reflect.construct(n,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return e.prototype=Object.create(n.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n,e}(Array)){clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:gs(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(en)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+YJ(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(t,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!_s(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){if(void 0===i)return this.lerp(this,e,t);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(t[r]-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if("number"==typeof e)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(en.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}get elements(){return this}}function Dt(n){if(!Number.isFinite(n))throw new Error("Invalid number ".concat(n));return n}function Bd(n,e,t=""){if(en.debug&&!function tee(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n,e))throw new Error("math.gl: ".concat(t," some fields set to invalid numbers'"));return n}function Vd(n,e){if(!n)throw new Error("math.gl assertion ".concat(e))}class Rw extends Ow{get x(){return this[0]}set x(e){this[0]=Dt(e)}get y(){return this[1]}set y(e){this[1]=Dt(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];t+=r*r}return Dt(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return Dt(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Vd(e>=0&&e<this.ELEMENTS,"index is out of range"),Dt(this[e])}setComponent(e,t){return Vd(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}var ys=1e-6,Pi="undefined"!=typeof Float32Array?Float32Array:Array;function KR(){var n=new Pi(3);return Pi!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function QR(n,e,t){var i=new Pi(3);return i[0]=n,i[1]=e,i[2]=t,i}function JR(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function Cm(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2];return n[0]=r*l-s*a,n[1]=s*o-i*l,n[2]=i*a-r*o,n}function Lw(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s+t[15];return n[0]=(t[0]*i+t[4]*r+t[8]*s+t[12])/(o=o||1),n[1]=(t[1]*i+t[5]*r+t[9]*s+t[13])/o,n[2]=(t[2]*i+t[6]*r+t[10]*s+t[14])/o,n}function eL(n,e,t){var i=e[0],r=e[1],s=e[2];return n[0]=i*t[0]+r*t[3]+s*t[6],n[1]=i*t[1]+r*t[4]+s*t[7],n[2]=i*t[2]+r*t[5]+s*t[8],n}function tL(n,e,t){var i=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2],u=r*c-s*l,d=s*a-i*c,h=i*l-r*a,f=r*h-s*d,p=s*u-i*h,m=i*d-r*u,_=2*t[3];return d*=_,h*=_,p*=2,m*=2,n[0]=a+(u*=_)+(f*=2),n[1]=l+d+p,n[2]=c+h+m,n}Math,Math,Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var nL=function ree(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n},iL=function iee(n){return Math.hypot(n[0],n[1],n[2])},Fw=function see(n){var e=n[0],t=n[1],i=n[2];return e*e+t*t+i*i};function rL(n,e,t){const i=e[0],r=e[1],s=t[3]*i+t[7]*r||1;return n[0]=(t[0]*i+t[4]*r)/s,n[1]=(t[1]*i+t[5]*r)/s,n}function sL(n,e,t){const i=e[0],r=e[1],s=e[2],o=t[3]*i+t[7]*r+t[11]*s||1;return n[0]=(t[0]*i+t[4]*r+t[8]*s)/o,n[1]=(t[1]*i+t[5]*r+t[9]*s)/o,n[2]=(t[2]*i+t[6]*r+t[10]*s)/o,n}function oL(n,e,t){const i=e[0],r=e[1],s=e[2];return n[0]=t[0]*i+t[3]*r+t[6]*s,n[1]=t[1]*i+t[4]*r+t[7]*s,n[2]=t[2]*i+t[5]*r+t[8]*s,n[3]=e[3],n}KR();const Nw=[0,0,0];let Em;class le extends Rw{static get ZERO(){return Em||(Em=new le(0,0,0),Object.freeze(Em)),Em}constructor(e=0,t=0,i=0){super(-0,-0,-0),1===arguments.length&&gs(e)?this.copy(e):(en.debug&&(Dt(e),Dt(t),Dt(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return en.debug&&(Dt(e.x),Dt(e.y),Dt(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Dt(e)}angle(e){return function hee(n,e){var t=n[0],i=n[1],r=n[2],s=e[0],o=e[1],a=e[2],u=Math.sqrt(t*t+i*i+r*r)*Math.sqrt(s*s+o*o+a*a),d=u&&JR(n,e)/u;return Math.acos(Math.min(Math.max(d,-1),1))}(this,e)}cross(e){return Cm(this,this,e),this.check()}rotateX({radians:e,origin:t=Nw}){return function cee(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}rotateY({radians:e,origin:t=Nw}){return function uee(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=Nw}){return function dee(n,e,t,i){var r=[],s=[];r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],n[0]=s[0]+t[0],n[1]=s[1]+t[1],n[2]=s[2]+t[2]}(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Lw(this,this,e),this.check()}transformAsVector(e){return sL(this,this,e),this.check()}transformByMatrix3(e){return eL(this,this,e),this.check()}transformByMatrix2(e){return function fee(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2]}(this,this,e),this.check()}transformByQuaternion(e){return tL(this,this,e),this.check()}}const aL=new le;function Ec(n,e,t,i){aL.set(n,e,t);const r=aL.len();return{distance:i/r,normal:new le(-n/r,-e/r,-t/r)}}function yee(n){return n-Math.fround(n)}let jd;function Bw(n,e){const{size:t=1,startIndex:i=0}=e,r=void 0!==e.endIndex?e.endIndex:n.length,s=(r-i)/t;jd=Cc.allocate(jd,s,{type:Float32Array,size:2*t});let o=i,a=0;for(;o<r;){for(let l=0;l<t;l++){const c=n[o++];jd[a+l]=c,jd[a+l+t]=yee(c)}a+=2*t}return jd.subarray(0,s*t*2)}class lL extends Ow{toString(){let e="[";if(en.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+t])}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=" ".concat(this[t])}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=Dt(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)t[r]=this[i+r];return t}setColumn(e,t){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=t[r];return this}}function Vw(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],p=e[12],m=e[13],_=e[14],y=e[15],v=t*a-i*o,E=t*l-r*o,M=t*c-s*o,R=i*l-r*a,B=i*c-s*a,V=r*c-s*l,Z=u*m-d*p,Y=u*_-h*p,$=u*y-f*p,fe=d*_-h*m,ye=d*y-f*m,he=h*y-f*_,Ee=v*he-E*ye+M*fe+R*$-B*Y+V*Z;return Ee?(n[0]=(a*he-l*ye+c*fe)*(Ee=1/Ee),n[1]=(r*ye-i*he-s*fe)*Ee,n[2]=(m*V-_*B+y*R)*Ee,n[3]=(h*B-d*V-f*R)*Ee,n[4]=(l*$-o*he-c*Y)*Ee,n[5]=(t*he-r*$+s*Y)*Ee,n[6]=(_*M-p*V-y*E)*Ee,n[7]=(u*V-h*M+f*E)*Ee,n[8]=(o*ye-a*$+c*Z)*Ee,n[9]=(i*$-t*ye-s*Z)*Ee,n[10]=(p*B-m*M+y*v)*Ee,n[11]=(d*M-u*B-f*v)*Ee,n[12]=(a*Y-o*fe-l*Z)*Ee,n[13]=(t*fe-i*Y+r*Z)*Ee,n[14]=(m*E-p*R-_*v)*Ee,n[15]=(u*R-d*E+h*v)*Ee,n):null}function Ra(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8],h=e[9],f=e[10],p=e[11],m=e[12],_=e[13],y=e[14],v=e[15],E=t[0],M=t[1],R=t[2],B=t[3];return n[0]=E*i+M*a+R*d+B*m,n[1]=E*r+M*l+R*h+B*_,n[2]=E*s+M*c+R*f+B*y,n[3]=E*o+M*u+R*p+B*v,n[4]=(E=t[4])*i+(M=t[5])*a+(R=t[6])*d+(B=t[7])*m,n[5]=E*r+M*l+R*h+B*_,n[6]=E*s+M*c+R*f+B*y,n[7]=E*o+M*u+R*p+B*v,n[8]=(E=t[8])*i+(M=t[9])*a+(R=t[10])*d+(B=t[11])*m,n[9]=E*r+M*l+R*h+B*_,n[10]=E*s+M*c+R*f+B*y,n[11]=E*o+M*u+R*p+B*v,n[12]=(E=t[12])*i+(M=t[13])*a+(R=t[14])*d+(B=t[15])*m,n[13]=E*r+M*l+R*h+B*_,n[14]=E*s+M*c+R*f+B*y,n[15]=E*o+M*u+R*p+B*v,n}function Mm(n,e,t){var o,a,l,c,u,d,h,f,p,m,_,y,i=t[0],r=t[1],s=t[2];return e===n?(n[12]=e[0]*i+e[4]*r+e[8]*s+e[12],n[13]=e[1]*i+e[5]*r+e[9]*s+e[13],n[14]=e[2]*i+e[6]*r+e[10]*s+e[14],n[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(a=e[1],l=e[2],c=e[3],u=e[4],d=e[5],h=e[6],f=e[7],p=e[8],m=e[9],_=e[10],y=e[11],n[0]=o=e[0],n[1]=a,n[2]=l,n[3]=c,n[4]=u,n[5]=d,n[6]=h,n[7]=f,n[8]=p,n[9]=m,n[10]=_,n[11]=y,n[12]=o*i+u*r+p*s+e[12],n[13]=a*i+d*r+m*s+e[13],n[14]=l*i+h*r+_*s+e[14],n[15]=c*i+f*r+y*s+e[15]),n}function zw(n,e,t){var i=t[0],r=t[1],s=t[2];return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*s,n[9]=e[9]*s,n[10]=e[10]*s,n[11]=e[11]*s,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function cL(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],d=e[10],h=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=s*r+c*i,n[5]=o*r+u*i,n[6]=a*r+d*i,n[7]=l*r+h*i,n[8]=c*r-s*i,n[9]=u*r-o*i,n[10]=d*r-a*i,n[11]=h*r-l*i,n}function uL(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],d=e[6],h=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r+c*i,n[1]=o*r+u*i,n[2]=a*r+d*i,n[3]=l*r+h*i,n[4]=c*r-s*i,n[5]=u*r-o*i,n[6]=d*r-a*i,n[7]=h*r-l*i,n}function Tm(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function hL(n,e){return n[0]=-e[0],n[1]=-e[1],n}function fL(n,e,t,i){var r=e[0],s=e[1];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n}function pL(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[3]*r+t[6],n[1]=t[1]*i+t[4]*r+t[7],n}function mL(n,e,t){var i=e[0],r=e[1];return n[0]=t[0]*i+t[4]*r+t[12],n[1]=t[1]*i+t[5]*r+t[13],n}function jw(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function Mc(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3];return n[0]=t[0]*i+t[4]*r+t[8]*s+t[12]*o,n[1]=t[1]*i+t[5]*r+t[9]*s+t[13]*o,n[2]=t[2]*i+t[6]*r+t[10]*s+t[14]*o,n[3]=t[3]*i+t[7]*r+t[11]*s+t[15]*o,n}!function kee(){var n=new Pi(2);Pi!=Float32Array&&(n[0]=0,n[1]=0)}(),function Lee(){var n=new Pi(4);Pi!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0)}();var Sm=(()=>(function(n){n[n.COL0ROW0=0]="COL0ROW0",n[n.COL0ROW1=1]="COL0ROW1",n[n.COL0ROW2=2]="COL0ROW2",n[n.COL0ROW3=3]="COL0ROW3",n[n.COL1ROW0=4]="COL1ROW0",n[n.COL1ROW1=5]="COL1ROW1",n[n.COL1ROW2=6]="COL1ROW2",n[n.COL1ROW3=7]="COL1ROW3",n[n.COL2ROW0=8]="COL2ROW0",n[n.COL2ROW1=9]="COL2ROW1",n[n.COL2ROW2=10]="COL2ROW2",n[n.COL2ROW3=11]="COL2ROW3",n[n.COL3ROW0=12]="COL3ROW0",n[n.COL3ROW1=13]="COL3ROW1",n[n.COL3ROW2=14]="COL3ROW2",n[n.COL3ROW3=15]="COL3ROW3"}(Sm||(Sm={})),Sm))();const Zee=45*Math.PI/180,Xee=1,Uw=.1,Hw=500,Kee=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class zn extends lL{static get IDENTITY(){return function Jee(){return Dm||(Dm=new zn,Object.freeze(Dm)),Dm}()}static get ZERO(){return function Qee(){return Am||(Am=new zn([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Am)),Am}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Sm}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,i,r,s,o,a,l,c,u,d,h,f,p,m,_){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=u,this[10]=d,this[11]=h,this[12]=f,this[13]=p,this[14]=m,this[15]=_,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c,u,d,h,f,p,m,_){return this[0]=e,this[1]=s,this[2]=c,this[3]=f,this[4]=t,this[5]=o,this[6]=u,this[7]=p,this[8]=i,this[9]=a,this[10]=d,this[11]=m,this[12]=r,this[13]=l,this[14]=h,this[15]=_,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Kee)}fromObject(e){return this.check()}fromQuaternion(e){return function Mee(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,u=i*o,d=i*a,h=r*o,f=r*a,p=r*l,m=s*o,_=s*a,y=s*l;n[0]=1-d-p,n[1]=u+y,n[2]=h-_,n[3]=0,n[4]=u-y,n[5]=1-c-p,n[6]=f+m,n[7]=0,n[8]=h+_,n[9]=f-m,n[10]=1-c-d,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(this,e),this.check()}frustum(e){const{left:t,right:i,bottom:r,top:s,near:o=Uw,far:a=Hw}=e;return a===1/0?function ete(n,e,t,i,r,s){const a=2*s/(r-i),l=(t+e)/(t-e),c=(r+i)/(r-i),h=-2*s;n[0]=2*s/(t-e),n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a,n[6]=0,n[7]=0,n[8]=l,n[9]=c,n[10]=-1,n[11]=-1,n[12]=0,n[13]=0,n[14]=h,n[15]=0}(this,t,i,r,s,o):function Tee(n,e,t,i,r,s,o){var a=1/(t-e),l=1/(r-i),c=1/(s-o);n[0]=2*s*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=2*s*l,n[6]=0,n[7]=0,n[8]=(t+e)*a,n[9]=(r+i)*l,n[10]=(o+s)*c,n[11]=-1,n[12]=0,n[13]=0,n[14]=o*s*2*c,n[15]=0}(this,t,i,r,s,o,a),this.check()}lookAt(e){const{eye:t,center:i=[0,0,0],up:r=[0,1,0]}=e;return function Pee(n,e,t,i){var r,s,o,a,l,c,u,d,h,f,p=e[0],m=e[1],_=e[2],y=i[0],v=i[1],E=i[2],M=t[0],R=t[1],B=t[2];Math.abs(p-M)<ys&&Math.abs(m-R)<ys&&Math.abs(_-B)<ys?function vee(n){n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1}(n):(u=p-M,d=m-R,h=_-B,r=v*(h*=f=1/Math.hypot(u,d,h))-E*(d*=f),s=E*(u*=f)-y*h,o=y*d-v*u,(f=Math.hypot(r,s,o))?(r*=f=1/f,s*=f,o*=f):(r=0,s=0,o=0),a=d*o-h*s,l=h*r-u*o,c=u*s-d*r,(f=Math.hypot(a,l,c))?(a*=f=1/f,l*=f,c*=f):(a=0,l=0,c=0),n[0]=r,n[1]=a,n[2]=u,n[3]=0,n[4]=s,n[5]=l,n[6]=d,n[7]=0,n[8]=o,n[9]=c,n[10]=h,n[11]=0,n[12]=-(r*p+s*m+o*_),n[13]=-(a*p+l*m+c*_),n[14]=-(u*p+d*m+h*_),n[15]=1)}(this,t,i,r),this.check()}ortho(e){const{left:t,right:i,bottom:r,top:s,near:o=Uw,far:a=Hw}=e;return function Dee(n,e,t,i,r,s,o){var a=1/(e-t),l=1/(i-r),c=1/(s-o);n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*l,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*c,n[11]=0,n[12]=(e+t)*a,n[13]=(r+i)*l,n[14]=(o+s)*c,n[15]=1}(this,t,i,r,s,o,a),this.check()}orthographic(e){const{fovy:t=Zee,aspect:i=Xee,focalDistance:r=1,near:s=Uw,far:o=Hw}=e;gL(t);const l=r*Math.tan(t/2),c=l*i;return this.ortho({left:-c,right:c,bottom:-l,top:l,near:s,far:o})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}=e;return gL(t),function See(n,e,t,i,r){var o,s=1/Math.tan(e/2);n[0]=s/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,null!=r&&r!==1/0?(n[10]=(r+i)*(o=1/(i-r)),n[14]=2*r*i*o):(n[10]=-1,n[14]=-2*i)}(this,t,i,r,s),this.check()}determinant(){return function wee(n){var e=n[0],t=n[1],i=n[2],r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8],u=n[9],d=n[10],h=n[11],f=n[12],p=n[13],m=n[14],_=n[15];return(e*o-t*s)*(d*_-h*m)-(e*a-i*s)*(u*_-h*p)+(e*l-r*s)*(u*m-d*p)+(t*a-i*o)*(c*_-h*f)-(t*l-r*o)*(c*m-d*f)+(i*l-r*a)*(c*p-u*f)}(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0];const i=this.getScale(t=t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0];const i=this.getScale(t=t||[-0,-0,-0]),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return function bee(n,e){if(n===e){var t=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=i,n[9]=s,n[11]=e[14],n[12]=r,n[13]=o,n[14]=a}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15]}(this,this),this.check()}invert(){return Vw(this,this),this.check()}multiplyLeft(e){return Ra(this,e,this),this.check()}multiplyRight(e){return Ra(this,this,e),this.check()}rotateX(e){return cL(this,this,e),this.check()}rotateY(e){return function Cee(n,e,t){var i=Math.sin(t),r=Math.cos(t),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],d=e[10],h=e[11];e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=s*r-c*i,n[1]=o*r-u*i,n[2]=a*r-d*i,n[3]=l*r-h*i,n[8]=s*i+c*r,n[9]=o*i+u*r,n[10]=a*i+d*r,n[11]=l*i+h*r}(this,this,e),this.check()}rotateZ(e){return uL(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return function xee(n,e,t,i){var l,c,u,d,h,f,p,m,_,y,v,E,M,R,B,V,Z,Y,$,fe,ye,he,Ee,Mn,r=i[0],s=i[1],o=i[2],a=Math.hypot(r,s,o);a<ys||(r*=a=1/a,s*=a,o*=a,l=Math.sin(t),c=Math.cos(t),h=e[1],f=e[2],p=e[3],_=e[5],y=e[6],v=e[7],M=e[9],R=e[10],B=e[11],$=r*s*(u=1-c)-o*l,fe=s*s*u+c,ye=o*s*u+r*l,he=r*o*u+s*l,Ee=s*o*u-r*l,Mn=o*o*u+c,n[0]=(d=e[0])*(V=r*r*u+c)+(m=e[4])*(Z=s*r*u+o*l)+(E=e[8])*(Y=o*r*u-s*l),n[1]=h*V+_*Z+M*Y,n[2]=f*V+y*Z+R*Y,n[3]=p*V+v*Z+B*Y,n[4]=d*$+m*fe+E*ye,n[5]=h*$+_*fe+M*ye,n[6]=f*$+y*fe+R*ye,n[7]=p*$+v*fe+B*ye,n[8]=d*he+m*Ee+E*Mn,n[9]=h*he+_*Ee+M*Mn,n[10]=f*he+y*Ee+R*Mn,n[11]=p*he+v*Ee+B*Mn,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]))}(this,this,e,t),this.check()}scale(e){return zw(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Mm(this,this,e),this.check()}transform(e,t){return 4===e.length?(Bd(t=Mc(t||[-0,-0,-0,-0],e,this),4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:i}=e;let r;switch(i){case 2:r=mL(t||[-0,-0],e,this);break;case 3:r=Lw(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Bd(r,e.length),r}transformAsVector(e,t){let i;switch(e.length){case 2:i=rL(t||[-0,-0],e,this);break;case 3:i=sL(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Bd(i,e.length),i}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,i){return this.identity().translate([e,t,i])}}let Am,Dm;function gL(n){if(n>2*Math.PI)throw Error("expected radians")}function Tc(n,e){const t=Mc([],e,n);return jw(t,t,1/t[3]),t}function _L(n,e){const t=n%e;return t<0?e+t:t}function Gw(n,e,t){return n<e?e:n>t?t:n}const Ww=Math.log2||function nte(n){return Math.log(n)*Math.LOG2E};function Js(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const jr=Math.PI,yL=jr/4,br=jr/180,qw=180/jr,Im=4003e4,Pm=85.051129,ite=1.5;function Bo(n){const[e,t]=n;return Js(Number.isFinite(e)),Js(Number.isFinite(t)&&t>=-90&&t<=90,"invalid latitude"),[512*(e*br+jr)/(2*jr),512*(jr+Math.log(Math.tan(yL+t*br*.5)))/(2*jr)]}function Ac(n){const[e,t]=n,i=e/512*(2*jr)-jr,r=2*(Math.atan(Math.exp(t/512*(2*jr)-jr))-yL);return[i*qw,r*qw]}function $w(n){const{latitude:e,longitude:t,highPrecision:i=!1}=n;Js(Number.isFinite(e)&&Number.isFinite(t));const s=Math.cos(e*br),o=512/360,a=o/s,l=512/Im/s,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[1/o,1/a,1/l]};if(i){const u=br*Math.tan(e*br)/s,h=512/Im*u,f=h/a*l;c.unitsPerDegree2=[0,o*u/2,h],c.unitsPerMeter2=[f,0,f]}return c}function vL(n,e){const[t,i,r]=n,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=$w({longitude:t,latitude:i,highPrecision:!0}),u=Bo(n);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const d=Ac(u),h=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[d[0],d[1],h]:d}function km(n){return 2*Math.atan(.5/n)*qw}function wL(n){return.5/Math.tan(.5*n*br)}function xL(n,e){const[t,i,r=0]=n;return Js(Number.isFinite(t)&&Number.isFinite(i)&&Number.isFinite(r)),Tc(e,[t,i,r,1])}function Om(n,e,t=0){const[i,r,s]=n;if(Js(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return Tc(e,[i,r,s,1]);const o=Tc(e,[i,r,0,1]),a=Tc(e,[i,r,1,1]),l=o[2],c=a[2];return fL([],o,a,l===c?0:((t||0)-l)/(c-l))}function CL(n){const{width:e,height:t,bounds:i,minExtent:r=0,maxZoom:s=24,offset:o=[0,0]}=n,[[a,l],[c,u]]=i,d=function ate(n=0){return"number"==typeof n?{top:n,bottom:n,left:n,right:n}:(Js(Number.isFinite(n.top)&&Number.isFinite(n.bottom)&&Number.isFinite(n.left)&&Number.isFinite(n.right)),n)}(n.padding),h=Bo([a,Gw(u,-Pm,Pm)]),f=Bo([c,Gw(l,-Pm,Pm)]),p=[Math.max(Math.abs(f[0]-h[0]),r),Math.max(Math.abs(f[1]-h[1]),r)],m=[e-d.left-d.right-2*Math.abs(o[0]),t-d.top-d.bottom-2*Math.abs(o[1])];Js(m[0]>0&&m[1]>0);const _=m[0]/p[0],y=m[1]/p[1],R=Ac([(f[0]+h[0])/2+(d.right-d.left)/2/_,(f[1]+h[1])/2+(d.top-d.bottom)/2/y]),B=Math.min(s,Ww(Math.abs(Math.min(_,y))));return Js(Number.isFinite(B)),{longitude:R[0],latitude:R[1],zoom:B}}const EL=Math.PI/180;function ML(n,e,t){const{pixelUnprojectionMatrix:i}=n,r=Tc(i,[e,0,1,1]),s=Tc(i,[e,n.height,1,1]),c=Ac(fL([],r,s,(t*n.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2])));return c.push(t),c}const gt={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(gt,"IDENTITY",{get:()=>(Ye.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Ur={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},La={common:0,meters:1,pixels:2},IL={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},dte=Math.PI/180,hte=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],PL=[0,0,0],fte={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class Vo{constructor(e={}){g(this,"id",void 0),g(this,"x",void 0),g(this,"y",void 0),g(this,"width",void 0),g(this,"height",void 0),g(this,"isGeospatial",void 0),g(this,"zoom",void 0),g(this,"focalDistance",void 0),g(this,"position",void 0),g(this,"modelMatrix",void 0),g(this,"distanceScales",void 0),g(this,"scale",void 0),g(this,"center",void 0),g(this,"cameraPosition",void 0),g(this,"projectionMatrix",void 0),g(this,"viewMatrix",void 0),g(this,"viewMatrixUncentered",void 0),g(this,"viewMatrixInverse",void 0),g(this,"viewProjectionMatrix",void 0),g(this,"pixelProjectionMatrix",void 0),g(this,"pixelUnprojectionMatrix",void 0),g(this,"resolution",void 0),g(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.distanceScales=e.distanceScales||fte,this.focalDistance=e.focalDistance||1,this.position=e.position||PL,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:i}=e;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Ur.WEB_MERCATOR:Ur.WEB_MERCATOR_AUTO_OFFSET:Ur.IDENTITY}equals(e){return e instanceof Vo&&(this===e||e.width===this.width&&e.height===this.height&&e.scale===this.scale&&_s(e.projectionMatrix,this.projectionMatrix)&&_s(e.viewMatrix,this.viewMatrix))}project(e,{topLeft:t=!0}={}){const r=xL(this.projectPosition(e),this.pixelProjectionMatrix),[s,o]=r,a=t?o:this.height-o;return 2===e.length?[s,a]:[s,a,r[2]]}unproject(e,{topLeft:t=!0,targetZ:i}={}){const[r,s,o]=e,c=Om([r,t?s:this.height-s,o],this.pixelUnprojectionMatrix,i&&i*this.distanceScales.unitsPerMeter[2]),[u,d,h]=this.unprojectPosition(c);return Number.isFinite(o)?[u,d,h]:Number.isFinite(i)?[u,d,i]:[u,d]}projectPosition(e){const[t,i]=this.projectFlat(e);return[t,i,(e[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(e){const[t,i]=this.unprojectFlat(e);return[t,i,(e[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(e){if(this.isGeospatial){const t=Bo(e);return t[1]=Gn(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?Ac(e):e}getBounds(e={}){const t={targetZ:e.z||0},i=this.unproject([0,0],t),r=this.unproject([this.width,0],t),s=this.unproject([0,this.height],t),o=this.unproject([this.width,this.height],t);return[Math.min(i[0],r[0],s[0],o[0]),Math.min(i[1],r[1],s[1],o[1]),Math.max(i[0],r[0],s[0],o[0]),Math.max(i[1],r[1],s[1],o[1])]}getDistanceScales(e){return e?$w({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:t,width:i=1,height:r=1}){return e<this.x+this.width&&this.x<e+i&&t<this.y+this.height&&this.y<t+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,function _ee(n){return{left:Ec(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),right:Ec(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),bottom:Ec(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),top:Ec(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),near:Ec(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),far:Ec(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14])}}(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,i=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=function ste(n){const{latitude:e}=n;Js(Number.isFinite(e));const t=Math.cos(e*br);return function rte(n){return Ww(n)}(Im*t)-9}({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||$w({latitude:i,longitude:t}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:s,modelMatrix:o}=e;let a=PL;if(s&&(a=o?new zn(o).transformAsVector(s,[]):s),this.isGeospatial){const l=this.projectPosition([t,i,0]);this.center=new le(a).scale(this.distanceScales.unitsPerMeter).add(l)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:t=hte,projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,padding:c=null,focalDistance:u=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=(new zn).multiplyRight(t).translate(new le(this.center).negate()),this.projectionMatrix=i||function pte({width:n,height:e,orthographic:t,fovyRadians:i,focalDistance:r,padding:s,near:o,far:a}){const l=n/e,c=t?(new zn).orthographic({fovy:i,aspect:l,focalDistance:r,near:o,far:a}):(new zn).perspective({fovy:i,aspect:l,near:o,far:a});if(s){const{left:u=0,right:d=0,top:h=0,bottom:f=0}=s,p=Gn((u+n-d)/2,0,n)-n/2,m=Gn((h+e-f)/2,0,e)-e/2;c[8]-=2*p/n,c[9]+=2*m/e}return c}({width:this.width,height:this.height,orthographic:r,fovyRadians:s||o*dte,focalDistance:u,padding:c,near:a,far:l});const d=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Ra(d,d,this.projectionMatrix),Ra(d,d,this.viewMatrix),this.viewProjectionMatrix=d,this.viewMatrixInverse=Vw([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=function gee(n){return[n[12],n[13],n[14]]}(this.viewMatrixInverse);const h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];zw(h,h,[this.width/2,-this.height/2,1]),Mm(h,h,[1,-1,0]),Ra(f,h,this.viewProjectionMatrix),this.pixelProjectionMatrix=f,this.pixelUnprojectionMatrix=Vw([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Ye.warn("Pixel project matrix not invertible")()}}g(Vo,"displayName","Viewport");const Hd="vs";function Yi(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const Xw={number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},array:{validate:(n,e)=>Array.isArray(n)||ArrayBuffer.isView(n)}};function gte(n){let e=kL(n);return"object"===e?n?"type"in n?Object.assign({},n,Xw[n.type]):"value"in n?(e=kL(n.value),Object.assign({type:e},n,Xw[e])):{type:"object",value:n}:{type:"object",value:null}:Object.assign({type:e,value:n},Xw[e])}function kL(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}class Kw{constructor(e){let{name:t,vs:i,fs:r,dependencies:s=[],uniforms:o,getUniforms:a,deprecations:l=[],defines:c={},inject:u={},vertexShader:d,fragmentShader:h}=e;Yi("string"==typeof t),this.name=t,this.vs=i||d,this.fs=r||h,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(l),this.defines=c,this.injections=function vte(n){const e={vs:{},fs:{}};for(const t in n){let i=n[t];const r=t.slice(0,2);"string"==typeof i&&(i={order:0,injection:i}),e[r][t]=i}return e}(u),o&&(this.uniforms=function mte(n){const e={};for(const t in n){const r=gte(n[t]);e[t]=r}return e}(o))}getModuleSource(e){let t;switch(e){case"vs":t=this.vs||"";break;case"fs":t=this.fs||"";break;default:Yi(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(t,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(e,t){return this.getModuleUniforms?this.getModuleUniforms(e,t):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,t){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?t.deprecated(i.old,i.new)():t.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(t=>{t.regex="function"===t.type?new RegExp("\\b".concat(t.old,"\\(")):new RegExp("".concat(t.type," ").concat(t.old,";"))}),e}_defaultGetUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&Yi(s.validate(e[r],s),"".concat(this.name,": invalid ").concat(r)),t[r]=e[r]):t[r]=s.value}return t}}function bte(n){return function OL(n){const e={},t={};return Qw({modules:n,level:0,moduleMap:e,moduleDepth:t}),Object.keys(t).sort((i,r)=>t[r]-t[i]).map(i=>e[i])}(RL(n))}function Qw(n){let{modules:e,level:t,moduleMap:i,moduleDepth:r}=n;if(t>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)i[s.name]=s,(void 0===r[s.name]||r[s.name]<t)&&(r[s.name]=t);for(const s of e)s.dependencies&&Qw({modules:s.dependencies,level:t+1,moduleMap:i,moduleDepth:r})}function RL(n,e){return n.map(t=>(t instanceof Kw||(Yi("string"!=typeof t,"Shader module use by name is deprecated. Import shader module '".concat(t,"' and use it directly.")),Yi(t.name,"shader module has no name"),(t=new Kw(t)).dependencies=RL(t.dependencies)),t))}function wte(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e="undefined"!=typeof window&&window.navigator||{},t=n.userAgent||e.userAgent||"",i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r}const Jw={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Fa={};function Ate(n,e){return n.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":n.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":n.match(/AMD/i)||e.match(/AMD/i)||n.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}Object.keys(Jw).forEach(n=>{Fa[n]=n});const ex={};function LL(n,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=Jw[e];if(Yi(i,e),!wte(t))return!0;if(e in ex)return ex[e];const r=i[0],s=t.behavior||"enable",o="#extension GL_".concat(r," : ").concat(s,"\nvoid main(void) {}"),a=n.createShader(35633);n.shaderSource(a,o),n.compileShader(a);const l=n.getShaderParameter(a,35713);return n.deleteShader(a),ex[e]=l,l}function Rm(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>function Dte(n,e){const t=Jw[e];Yi(t,e);const i=function Tte(n){return"undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||Boolean(n&&2===n._version)}(n)&&t[1]||t[0],r="string"==typeof i?Boolean(n.getExtension(i)):i;return Yi(!1===r||!0===r),r}(n,t))}const Rte={[Hd]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",fs:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},Lm="__LUMA_INJECT_DECLARATIONS__",FL=/void\s+main\s*\([^)]*\)\s*\{\n?/,NL=/}\n?[^{}]*$/,tx=[];function BL(n,e,t){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=e===Hd;for(const s in t){const o=t[s];o.sort((l,c)=>l.order-c.order),tx.length=o.length;for(let l=0,c=o.length;l<c;++l)tx[l]=o[l].injection;const a="".concat(tx.join("\n"),"\n");switch(s){case"vs:#decl":r&&(n=n.replace(Lm,a));break;case"vs:#main-start":r&&(n=n.replace(FL,l=>l+a));break;case"vs:#main-end":r&&(n=n.replace(NL,l=>a+l));break;case"fs:#decl":r||(n=n.replace(Lm,a));break;case"fs:#main-start":r||(n=n.replace(FL,l=>l+a));break;case"fs:#main-end":r||(n=n.replace(NL,l=>a+l));break;default:n=n.replace(s,l=>l+a)}}return n=n.replace(Lm,""),i&&(n=n.replace(/\}\s*$/,s=>s+Rte[e])),n}function nx(n){const e={};return Yi(Array.isArray(n)&&n.length>1),n.forEach(t=>{for(const i in t)e[i]=e[i]?"".concat(e[i],"\n").concat(t[i]):t[i]}),e}function Dc(n){return new RegExp("\\b".concat(n,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const VL=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Lte=[...VL,[Dc("attribute"),"in $1"],[Dc("varying"),"out $1"]],Fte=[...VL,[Dc("varying"),"in $1"]],zL=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],Nte=[...zL,[Dc("in"),"attribute $1"],[Dc("out"),"varying $1"]],Bte=[...zL,[Dc("in"),"varying $1"]],ix="gl_FragColor",rx=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Vte=/void\s+main\s*\([^)]*\)\s*\{\n?/;function Fm(n,e){for(const[t,i]of e)n=n.replace(t,i);return n}const Hte="\n\n".concat(Lm,"\n\n"),jL={[Hd]:"vertex",fs:"fragment"};function UL(n,e){let{id:t,source:i,type:r,modules:s,defines:o={},hookFunctions:a=[],inject:l={},transpileToGLSL100:c=!1,prologue:u=!0,log:d}=e;Yi("string"==typeof i,"shader source must be a string");const h=r===Hd,f=i.split("\n");let p=100,m="",_=i;0===f[0].indexOf("#version ")?(p=300,m=f[0],_=f.slice(1).join("\n")):m="#version ".concat(p);const y={};s.forEach(V=>{Object.assign(y,V.getDefines())}),Object.assign(y,o);let v=u?"".concat(m,"\n").concat(function Yte(n){let{id:e,source:t,type:i}=n;return e&&"string"==typeof e&&-1===t.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(e,"_").concat(jL[i],"\n\n"):""}({id:t,source:i,type:r}),"\n").concat(function $te(n){let{type:e}=n;return"\n#define SHADER_TYPE_".concat(jL[e].toUpperCase(),"\n")}({type:r}),"\n").concat(function Ite(n){switch(function Ste(n){const e=n.getExtension("WEBGL_debug_renderer_info"),t=n.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),i=n.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:Ate(t,i),vendor:t,renderer:i,version:n.getParameter(7938),shadingLanguageVersion:n.getParameter(35724)}}(n).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(n),"\n").concat(function Pte(n,e,t){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return Rm(n,Fa.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),Rm(n,Fa.GLSL_DERIVATIVES)&&LL(n,Fa.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),Rm(n,Fa.GLSL_FRAG_DATA)&&LL(n,Fa.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),Rm(n,Fa.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(n),"\n").concat(function Zte(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=0,t="";for(const i in n){0===e&&(t+="\n// APPLICATION DEFINES\n"),e++;const r=n[i];(r||Number.isFinite(r))&&(t+="#define ".concat(i.toUpperCase()," ").concat(n[i],"\n"))}return 0===e&&(t+="\n"),t}(y),"\n").concat(h?"":"precision highp float;\n\n","\n"):"".concat(m,"\n");const E=function Kte(n){const e={vs:{},fs:{}};return n.forEach(t=>{let i;"string"!=typeof t?(i=t,t=i.hook):i={},t=t.trim();const[r,s]=t.split(":"),o=t.replace(/\(.+/,"");e[r][o]=Object.assign(i,{signature:s})}),e}(a),M={},R={},B={};for(const V in l){const Z="string"==typeof l[V]?{injection:l[V],order:0}:l[V],Y=V.match(/^(v|f)s:(#)?([\w-]+)$/);if(Y){const fe=Y[3];Y[2]?"decl"===fe?R[V]=[Z]:B[V]=[Z]:M[V]=[Z]}else B[V]=[Z]}for(const V of s){d&&V.checkDeprecations(_,d),v+=V.getModuleSource(r,p);const Y=V.injections[r];for(const $ in Y){const fe=$.match(/^(v|f)s:#([\w-]+)$/);if(fe){const he="decl"===fe[2]?R:B;he[$]=he[$]||[],he[$].push(Y[$])}else M[$]=M[$]||[],M[$].push(Y[$])}}return v+=Hte,v=BL(v,r,R),v+=function Xte(n,e){let t="";for(const i in n){const r=n[i];if(t+="void ".concat(r.signature," {\n"),r.header&&(t+="  ".concat(r.header)),e[i]){const s=e[i];s.sort((o,a)=>o.order-a.order);for(const o of s)t+="  ".concat(o.injection,"\n")}r.footer&&(t+="  ".concat(r.footer)),t+="}\n"}return t}(E[r],M),v+=_,v=BL(v,r,B),v=function zte(n,e,t){switch(e){case 300:return t?Fm(n,Lte):function jte(n){const e=(n=Fm(n,Fte)).match(rx);if(e){const t=e[1];n=n.replace(new RegExp("\\b".concat(ix,"\\b"),"g"),t)}else{const t="fragmentColor";n=n.replace(Vte,i=>"out vec4 ".concat(t,";\n").concat(i)).replace(new RegExp("\\b".concat(ix,"\\b"),"g"),t)}return n}(n);case 100:return t?Fm(n,Nte):function Ute(n){const e=(n=Fm(n,Bte)).match(rx);if(e){const t=e[1];n=n.replace(rx,"").replace(new RegExp("\\b".concat(t,"\\b"),"g"),ix)}return n}(n);default:throw new Error("unknown GLSL version ".concat(e))}}(v,c?100:p,h),v}function qte(n){return function(t){const i={};for(const r of n){const s=r.getUniforms(t,i);Object.assign(i,s)}return i}}const Gd="8.5.16";class HL{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new gm({id:e})),this.stats.get(e)}}const Na=new HL;if(globalThis.luma&&globalThis.luma.VERSION!==Gd)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Gd));function oe(n,e){if(!n)throw new Error(e||"luma.gl: assertion failed.")}function sx(n,e){if("string"!=typeof e)return e;const t=Number(e);if(!isNaN(t))return t;const i=n[e=e.replace(/^.*\./,"")];return oe(void 0!==i,"Accessing undefined constant GL.".concat(e)),i}function zo(n,e){e=Number(e);for(const t in n)if(n[t]===e)return"GL.".concat(t);return String(e)}globalThis.luma||(ds()&&ge.log(1,"luma.gl ".concat(Gd," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),globalThis.luma=globalThis.luma||{VERSION:Gd,version:Gd,log:ge,stats:Na,globals:{modules:{},nodeIO:{}}}),globalThis;const ox={};function jo(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";ox[n]=ox[n]||1;const e=ox[n]++;return"".concat(n,"-").concat(e)}function GL(n){return oe("number"==typeof n,"Input must be a number"),n&&0==(n&n-1)}function Ic(n){let e=!0;for(const t in n){e=!1;break}return e}function WL(n,e,t,i){const r="See luma.gl ".concat(t," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(n);i.forEach(o=>{s.methodName||(s[o]=()=>{throw ge.removed("Calling removed method ".concat(e,".").concat(o,": "),r)(),new Error(o)})})}const Pc="Resource subclass must define virtual methods";class eo{get[Symbol.toStringTag](){return"Resource"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};fm(e);const{id:i,userData:r={}}=t;this.gl=e,this.gl2=e,this.id=i||jo(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=t.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._initStats(),this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,t&&e&&t.filter(Boolean).forEach(i=>i.delete()),this}bind(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!=typeof e?(this._bindHandle(e),this):(this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t)}unbind(){this.bind(null)}getParameter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};oe(e=sx(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=lt(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension)){const a=r.webgl1,l="webgl2"in r?r.webgl2:r.webgl1;return s?l:a}}return this._getParameter(e,t)}getParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{parameters:t,keys:i}=e,r=this.constructor.PARAMETERS||{},s=lt(this.gl),o={},a=t||Object.keys(r);for(const l of a){const c=r[l];if(c&&(!("webgl2"in c)||s)&&(!("extension"in c)||this.gl.getExtension(c.extension))){const d=i?zo(this.gl,l):l;o[d]=this.getParameter(l,e),i&&"GLenum"===c.type&&(o[d]=zo(this.gl,o[d]))}}return o}setParameter(e,t){oe(e=sx(this.gl,e));const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=lt(this.gl);if("webgl2"in r&&!s||"extension"in r&&!this.gl.getExtension(r.extension))throw new Error("Parameter not available on this platform");"GLenum"===r.type&&(t=sx(t))}return this._setParameter(e,t),this}setParameters(e){for(const t in e)this.setParameter(t,e[t]);return this}stubRemovedMethods(e,t,i){return WL(this,e,t,i)}initialize(e){}_createHandle(){throw new Error(Pc)}_deleteHandle(){throw new Error(Pc)}_bindHandle(e){throw new Error(Pc)}_getOptsFromHandle(){throw new Error(Pc)}_getParameter(e,t){throw new Error(Pc)}_setParameter(e,t){throw new Error(Pc)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_initStats(){this.gl.stats=this.gl.stats||new HL}_addStats(){const e=this[Symbol.toStringTag],t=Na.get("Resource Counts");t.get("Resources Created").incrementCount(),t.get("".concat(e,"s Created")).incrementCount(),t.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Na.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];this._doTrackAllocatedMemory(e,t),this._doTrackAllocatedMemory(e,t,this.gl.stats.get("Memory Usage"))}_doTrackAllocatedMemory(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Na.get("Memory Usage");i.get("GPU Memory").addCount(e),i.get("".concat(t," Memory")).addCount(e),this.byteLength=e}_trackDeallocatedMemory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];this._doTrackDeallocatedMemory(e),this._doTrackDeallocatedMemory(e,this.gl.stats.get("Memory Usage"))}_doTrackDeallocatedMemory(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Na.get("Memory Usage");t.get("GPU Memory").subtractCount(this.byteLength),t.get("".concat(e," Memory")).subtractCount(this.byteLength),this.byteLength=0}}function ax(n){switch(ArrayBuffer.isView(n)?n.constructor:n){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function Wd(n){let{clamped:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(n){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function ene(n){let{data:e,width:t,height:i,bytesPerPixel:r=4,temp:s}=n;const o=t*r;s=s||new Uint8Array(o);for(let a=0;a<i/2;++a){const l=a*o,c=(i-a-1)*o;s.set(e.subarray(l,l+o)),e.copyWithin(l,c,c+o),e.set(s,c)}}function tne(n){let{data:e,width:t,height:i}=n;const r=Math.round(t/2),s=Math.round(i/2),o=new Uint8Array(r*s*4);for(let a=0;a<s;a++)for(let l=0;l<r;l++)for(let c=0;c<4;c++)o[4*(a*r+l)+c]=e[4*(2*a*t+2*l)+c];return{data:o,width:r,height:s}}function lx(n,e,t){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=t;for(const a in i)if(a in e){const c=i[a]?"".concat(n,".").concat(i[a]):"N/A";ge.removed("".concat(n,".").concat(a),c)()}for(const a in r)if(a in e){const l=r[a];ge.deprecated("".concat(n,".").concat(a),"".concat(n,".").concat(l))()}let o=null;for(const a in s)if(a in e){const l=s[a];ge.deprecated("".concat(n,".").concat(a),"".concat(n,".").concat(l))(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const nne={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},ine={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Zi{static getBytesPerElement(e){return Wd(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return oe(e.size),Wd(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return new Zi(...[nne,...t])}constructor(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(r=>this._assign(r)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Zi.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Zi.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e=lx("Accessor",e,ine),void 0!==e.type&&(this.type=e.type,(5124===e.type||5125===e.type)&&(this.integer=!0)),void 0!==e.size&&(this.size=e.size),void 0!==e.offset&&(this.offset=e.offset),void 0!==e.stride&&(this.stride=e.stride),void 0!==e.normalized&&(this.normalized=e.normalized),void 0!==e.integer&&(this.integer=e.integer),void 0!==e.divisor&&(this.divisor=e.divisor),void 0!==e.buffer&&(this.buffer=e.buffer),void 0!==e.index&&(this.index="boolean"==typeof e.index?e.index?1:0:e.index),void 0!==e.instanced&&(this.divisor=e.instanced?1:0),void 0!==e.isInstanced&&(this.divisor=e.isInstanced?1:0),this}}const $L={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},rne={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:$L},sne={removedProps:$L};class Rt extends eo{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=t.target||(this.gl.webgl2?36662:34962),this.initialize(t),Object.seal(this)}getElementCount(){return Math.round(this.byteLength/Zi.getBytesPerElement(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor))}getVertexCount(){return Math.round(this.byteLength/Zi.getBytesPerVertex(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor))}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=lx("Buffer",e,rne),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return"accessor"in(e=lx("Buffer",e,sne))&&this.setAccessor(e.accessor),this}setAccessor(e){return delete(e=Object.assign({},e)).buffer,this.accessor=new Zi(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:t,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;oe(t);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==s?(ni(this.gl),this.gl.bufferSubData(this.target,i,t,r,s)):this.gl.bufferSubData(o,i,t),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(t),this}copyData(e){let{sourceBuffer:t,readOffset:i=0,writeOffset:r=0,size:s}=e;const{gl:o}=this;return ni(o),o.bindBuffer(36662,t.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,i,r,s),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:t=0,dstOffset:i=0,length:r=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ni(this.gl);const s=Wd(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(t),a=i;let l,c;e?(c=e.length,l=c-a):(l=Math.min(o,r||o),c=a+l);const u=Math.min(o,l);return r=r||u,oe(r<=u),e=e||new s(c),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,e,i,r),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:t=this.accessor&&this.accessor.index,offset:i=0,size:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===e||35982===e?void 0!==r?this.gl.bindBufferRange(e,t,this.handle,i,r):(oe(0===i),this.gl.bindBufferBase(e,t,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:t=this.accessor&&this.accessor.index}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===e||35982===e?this.gl.bindBufferBase(e,t,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength+t;oe(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,t,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,10),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=ax(e);return oe(s),this.setAccessor(new Zi(this.accessor,{type:s})),this}_setByteLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;oe(e>=0),this._trackDeallocatedMemory();let i=e;0===e&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,t),this.gl.bindBuffer(r,null),this.usage=t,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const i=e/Wd(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new Zi(this.accessor,{type:ax(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const t=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),t}get type(){return ge.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return ge.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return ge.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return ge.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Zi(this.accessor,e),this}}const cx={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},YL={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},ZL={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},lne=[9729,9728],XL=globalThis.WebGLBuffer||function(){};class Ba extends eo{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{format:i,linearFiltering:r}=t;let s=!0;return i&&(s=s&&function one(n,e){const t=cx[e];if(!t)return!1;if(void 0===t.gl1&&void 0===t.gl2)return!0;const i=lt(n)&&t.gl2||t.gl1;return"string"==typeof i?n.getExtension(i):i}(e,i),s=s&&(!r||function ane(n,e){const t=cx[e];switch(t&&t.types[0]){case 5126:return n.getExtension("OES_texture_float_linear");case 5131:return n.getExtension("OES_texture_half_float_linear");default:return!0}}(e,i))),s}constructor(e,t){const{id:i=jo("texture"),handle:r,target:s}=t;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data;if(t instanceof Promise)return t.then(v=>this.initialize(Object.assign({},e,{pixels:v,data:v}))),this;const i="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(i&&t.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,t.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:c={},textureUnit:u}=e;t||(t=r);let{width:d,height:h,dataFormat:f,type:p,compressed:m=!1,mipmaps:_=!0}=e;const{depth:y=0}=e;return({width:d,height:h,compressed:m,dataFormat:f,type:p}=this._deduceParameters({format:s,type:p,dataFormat:f,compressed:m,data:t,width:d,height:h})),this.width=d,this.height=h,this.depth=y,this.format=s,this.type=p,this.dataFormat=f,this.border=o,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),_&&this._isNPOT()&&(ge.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),_=!1,this._updateForNPOT(l)),this.mipmaps=_,this.setImageData({data:t,width:d,height:h,depth:y,format:s,type:p,dataFormat:f,border:o,mipmaps:_,parameters:c,compressed:m}),_&&this.generateMipmap(),this.setParameters(l),a&&(this.data=t),i&&(this._video={video:t,parameters:l,lastTime:t.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?t.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:t,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:t}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:t,width:i,mipmaps:r=!1}=e;return i!==this.width||t!==this.height?this.initialize({width:i,height:t,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:r}):this}generateMipmap(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isNPOT()?(ge.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Ii(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:t=this.target,pixels:i=null,level:r=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:c=null,type:u=this.type,width:d=this.width,height:h=this.height,dataFormat:f=this.dataFormat,compressed:p=!1}=e;c||(c=i),({type:u,dataFormat:f,compressed:p,width:d,height:h}=this._deduceParameters({format:s,type:u,dataFormat:f,compressed:p,data:c,width:d,height:h}));const{gl:m}=this;m.bindTexture(this.target,this.handle);let _=null;({data:c,dataType:_}=this._getDataType({data:c,compressed:p}));let y,v=0;return Ii(this.gl,l,()=>{switch(_){case"null":m.texImage2D(t,r,s,d,h,o,f,u,c);break;case"typed-array":m.texImage2D(t,r,s,d,h,o,f,u,c,a);break;case"buffer":y=ni(m),y.bindBuffer(35052,c.handle||c),y.texImage2D(t,r,s,d,h,o,f,u,a),y.bindBuffer(35052,null);break;case"browser-object":lt(m)?m.texImage2D(t,r,s,d,h,o,f,u,c):m.texImage2D(t,r,s,f,u,c);break;case"compressed":for(const[E,M]of c.entries())m.compressedTexImage2D(t,E,M.format,M.width,M.height,o,M.data),v+=M.levelSize;break;default:oe(!1,"Unknown image data type")}}),this._trackAllocatedMemory("compressed"===_?v:c&&c.byteLength?c.byteLength:this.width*this.height*(YL[this.dataFormat]||4)*(ZL[this.type]||1),"Texture"),this.loaded=!0,this}setSubImageData(e){let{target:t=this.target,pixels:i=null,data:r=null,x:s=0,y:o=0,width:a=this.width,height:l=this.height,level:c=0,format:u=this.format,type:d=this.type,dataFormat:h=this.dataFormat,compressed:f=!1,offset:p=0,border:m=this.border,parameters:_={}}=e;if(({type:d,dataFormat:h,compressed:f,width:a,height:l}=this._deduceParameters({format:u,type:d,dataFormat:h,compressed:f,data:r,width:a,height:l})),oe(0===this.depth,"texSubImage not supported for 3D textures"),r||(r=i),r&&r.data){const y=r;r=y.data,a=y.shape[0],l=y.shape[1]}r instanceof Rt&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),Ii(this.gl,_,()=>{if(f)this.gl.compressedTexSubImage2D(t,c,s,o,a,l,u,r);else if(null===r)this.gl.texSubImage2D(t,c,s,o,a,l,h,d,null);else if(ArrayBuffer.isView(r))this.gl.texSubImage2D(t,c,s,o,a,l,h,d,r,p);else if(r instanceof XL){const y=ni(this.gl);y.bindBuffer(35052,r),y.texSubImage2D(t,c,s,o,a,l,h,d,p),y.bindBuffer(35052,null)}else lt(this.gl)?ni(this.gl).texSubImage2D(t,c,s,o,a,l,h,d,r):this.gl.texSubImage2D(t,c,s,o,h,d,r)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return ge.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:t}=this;return void 0!==e&&(this.textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.target,null),e}_getDataType(e){let{data:t,compressed:i=!1}=e;return i?{data:t,dataType:"compressed"}:null===t?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof Rt?{data:t.handle,dataType:"buffer"}:t instanceof XL?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(e){const{format:t,data:i}=e;let{width:r,height:s,dataFormat:o,type:a,compressed:l}=e;const c=cx[t];return o=o||c&&c.dataFormat,a=a||c&&c.types[0],l=l||c&&c.compressed,({width:r,height:s}=this._deduceImageSize(i,r,s)),{dataFormat:o,type:a,compressed:l,width:r,height:s,format:t,data:i}}_deduceImageSize(e,t,i){let r;return r="undefined"!=typeof ImageData&&e instanceof ImageData?{width:e.width,height:e.height}:"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement?{width:e.naturalWidth,height:e.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?{width:e.width,height:e.height}:"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e?{width:t,height:i}:{width:t>=0?t:1,height:i>=0?i:1},oe(r,"Could not deduced texture size"),oe(void 0===t||r.width===t,"Deduced texture width does not match supplied width"),oe(void 0===i||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const t=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),t}}_setParameter(e,t){switch(this.gl.bindTexture(this.target,this.handle),t=this._getNPOTParam(e,t),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,t);break;case 4096:case 4097:oe(!1);break;default:this.gl.texParameteri(this.target,e,t)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(lt(this.gl)||!this.width||!this.height||GL(this.width)&&GL(this.height))}_updateForNPOT(e){void 0===e[this.gl.TEXTURE_MIN_FILTER]&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===e[this.gl.TEXTURE_WRAP_S]&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===e[this.gl.TEXTURE_WRAP_T]&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,t){if(this._isNPOT())switch(e){case 10241:-1===lne.indexOf(t)&&(t=9729);break;case 10242:case 10243:33071!==t&&(t=33071)}return t}}function cne(n,e){return oe("string"==typeof n),n=""+n,new Promise((t,i)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>i(new Error("Could not load image ".concat(n,"."))),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=n}catch(r){i(r)}})}class gi extends Ba{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,t){return Ba.isSupported(e,t)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};fm(e),(t instanceof Promise||"string"==typeof t)&&(t={data:t}),"string"==typeof t.data&&(t=Object.assign({},t,{data:cne(t.data)})),super(e,Object.assign({},t,{target:3553})),this.initialize(t),Object.seal(this)}}const Va="EXT_color_buffer_float",KL={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Va,bpp:2},33327:{gl2:Va,bpp:4},34842:{gl2:Va,bpp:8},33326:{gl2:Va,bpp:4},33328:{gl2:Va,bpp:8},34836:{gl2:Va,bpp:16},35898:{gl2:Va,bpp:4}};class kc extends eo{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:null};return!t||function une(n,e,t){const i=t[e];if(!i)return!1;const r=lt(n)&&i.gl2||i.gl1;return"string"==typeof r?n.getExtension(r):r}(e,t,KL)}static getSamplesForFormat(e,t){let{format:i}=t;return e.getInternalformatParameter(36161,i,32937)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.initialize(t),Object.seal(this)}initialize(e){let{format:t,width:i=1,height:r=1,samples:s=0}=e;return oe(t,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==s&&lt(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,t,i,r):this.gl.renderbufferStorage(36161,t,i,r),this.format=t,this.width=i,this.height=r,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*KL[this.format].bpp),this}resize(e){let{width:t,height:i}=e;return t!==this.width||i!==this.height?this.initialize({width:t,height:i,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const QL=6144,tF=34041,nF="clear: bad arguments";function dx(n){let{framebuffer:e=null,color:t=null,depth:i=null,stencil:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s={};e&&(s.framebuffer=e);let o=0;t&&(o|=16384,!0!==t&&(s.clearColor=t)),i&&(o|=256,!0!==i&&(s.clearDepth=i)),r&&(o|=1024,!0!==i&&(s.clearStencil=i)),oe(0!==o,nF),Ii(n,s,()=>{n.clear(o)})}const hx=[34069,34070,34071,34072,34073,34074];let gne=(()=>{class n extends Ba{get[Symbol.toStringTag](){return"TextureCube"}constructor(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};fm(t),super(t,Object.assign({},i,{target:34067})),this.initialize(i),Object.seal(this)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mipmaps:i=!0,parameters:r={}}=t;return this.opts=t,this.setCubeMapImageData(t).then(()=>{this.loaded=!0,i&&this.generateMipmap(t),this.setParameters(r)}),this}subImage(t){let{face:i,data:r,x:s=0,y:o=0,mipmapLevel:a=0}=t;return this._subImage({target:i,data:r,x:s,y:o,mipmapLevel:a})}setCubeMapImageData(t){var i=this;return Bt(function*(){let{width:r,height:s,pixels:o,data:a,border:l=0,format:c=6408,type:u=5121}=t;const{gl:d}=i,h=o||a,f=yield Promise.all(hx.map(p=>{const m=h[p];return Promise.all(Array.isArray(m)?m:[m])}));i.bind(),hx.forEach((p,m)=>{f[m].length>1&&!1!==i.opts.mipmaps&&ge.warn("".concat(i.id," has mipmap and multiple LODs."))(),f[m].forEach((_,y)=>{r&&s?d.texImage2D(p,y,c,r,s,l,c,u,_):d.texImage2D(p,y,c,c,u,_)})}),i.unbind()})()}setImageDataForFace(t){const{face:i,width:r,height:s,pixels:o,data:a,border:l=0,format:c=6408,type:u=5121}=t,{gl:d}=this,h=o||a;return this.bind(),h instanceof Promise?h.then(f=>this.setImageDataForFace(Object.assign({},t,{face:i,data:f,pixels:f}))):this.width||this.height?d.texImage2D(i,0,c,r,s,l,c,u,h):d.texImage2D(i,0,c,c,u,h),this}}return n.FACES=hx,n})();class _ne extends Ba{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return lt(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ni(e),t=Object.assign({depth:1},t,{target:32879,unpackFlipY:!1}),super(e,t),this.initialize(t),Object.seal(this)}setImageData(e){let{level:t=0,dataFormat:i=6408,width:r,height:s,depth:o=1,border:a=0,format:l,type:c=5121,offset:u=0,data:d,parameters:h={}}=e;return this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Ii(this.gl,h,()=>{ArrayBuffer.isView(d)&&this.gl.texImage3D(this.target,t,i,r,s,o,a,l,c,d),d instanceof Rt&&(this.gl.bindBuffer(35052,d.handle),this.gl.texImage3D(this.target,t,i,r,s,o,a,l,c,u))}),this._trackAllocatedMemory(d&&d.byteLength?d.byteLength:this.width*this.height*this.depth*(YL[this.dataFormat]||4)*(ZL[this.type]||1),"Texture"),this.loaded=!0,this}}function vne(n,e){const{gl:t,width:i,height:r,id:s}=n;return new En(t,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:i,height:r,attachments:{36064:n}}))}function Nm(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sourceX:t=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e;const{framebuffer:u,deleteFramebuffer:d}=qd(n);oe(u);const{gl:h,handle:f,attachments:p}=u;a=a||u.width,l=l||u.height,36064===s&&null===f&&(s=1028),oe(p[s]),c=c||p[s].type,o=wne(o,c,r,a,l),c=c||ax(o);const m=h.bindFramebuffer(36160,f);return h.readPixels(t,i,a,l,r,c,o),h.bindFramebuffer(36160,m||null),d&&u.delete(),o}function fx(n){let{sourceAttachment:e=36064,targetMaxHeight:t=Number.MAX_SAFE_INTEGER}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=Nm(n,{sourceAttachment:e}),{width:r,height:s}=n;for(;s>t;)({data:i,width:r,height:s}=tne({data:i,width:r,height:s}));ene({data:i,width:r,height:s});const o=document.createElement("canvas");o.width=r,o.height=s;const a=o.getContext("2d"),l=a.createImageData(r,s);return l.data.set(i),a.putImageData(l,0,0),o.toDataURL()}function qd(n){return n instanceof En?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:vne(n),deleteFramebuffer:!0}}function wne(n,e,t,i,r){if(n)return n;const s=Wd(e=e||5121,{clamped:!1}),o=function mne(n){switch(n){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return oe(!1),0}}(t);return new s(i*r*o)}const iF={WEBGL2:[!1,!0],VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],TIMER_QUERY:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],ELEMENT_INDEX_UINT32:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],FLOAT_BLEND:["EXT_float_blend"],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:[function xne(n){const e=new gi(n,{format:6408,type:5126,dataFormat:6408}),t=new En(n,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=t.getStatus();return e.delete(),t.delete(),36053===i},"EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:["EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]};function px(n,e){return(e=Array.isArray(e)?e:[e]).every(t=>rF(n,t))}function rF(n,e){return n.luma=n.luma||{},n.luma.caps=n.luma.caps||{},void 0===n.luma.caps[e]&&(n.luma.caps[e]=function Tne(n,e){const t=iF[e];let i;oe(t,e);const r=lt(n)&&t[1]||t[0];if("function"==typeof r)i=r(n);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&Boolean(n.getExtension(s))}else"string"==typeof r?i=Boolean(n.getExtension(r)):"boolean"==typeof r?i=r:oe(!1);return i}(n,e)),n.luma.caps[e]||ge.log(2,"Feature: ".concat(e," not supported"))(),n.luma.caps[e]}const sF="Multiple render targets not supported";class En extends eo{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{colorBufferFloat:i,colorBufferHalfFloat:r}=t;let s=!0;return i&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new En(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=ni(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=ni(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(t),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:t=1,height:i=1,attachments:r=null,color:s=!0,depth:o=!0,stencil:a=!1,check:l=!0,readBuffer:c,drawBuffers:u}=e;if(oe(t>=0&&i>=0,"Width and height need to be integers"),this.width=t,this.height=i,r)for(const d in r){const h=r[d];(Array.isArray(h)?h[0]:h).resize({width:t,height:i})}else r=this._createDefaultAttachments(s,o,a,t,i);this.update({clearAttachments:!0,attachments:r,readBuffer:c,drawBuffers:u}),r&&l&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:t={},readBuffer:i,drawBuffers:r,clearAttachments:s=!1,resizeAttachments:o=!0}=e;this.attach(t,{clearAttachments:s,resizeAttachments:o});const{gl:a}=this,l=a.bindFramebuffer(36160,this.handle);return i&&this._setReadBuffer(i),r&&this._setDrawBuffers(r),a.bindFramebuffer(36160,l||null),this}resize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{width:t,height:i}=e;if(null===this.handle)return oe(void 0===t&&void 0===i),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===t&&(t=this.gl.drawingBufferWidth),void 0===i&&(i=this.gl.drawingBufferHeight),t!==this.width&&i!==this.height&&ge.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(t,"x").concat(i))();for(const r in this.attachments)this.attachments[r].resize({width:t,height:i});return this.width=t,this.height=i,this}attach(e){let{clearAttachments:t=!1,resizeAttachments:i=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={};t&&Object.keys(this.attachments).forEach(o=>{r[o]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){oe(void 0!==o,"Misspelled framebuffer binding point?");const a=Number(o),l=r[a];let c=l;if(c)if(c instanceof kc)this._attachRenderbuffer({attachment:a,renderbuffer:c});else if(Array.isArray(l)){const[u,d=0,h=0]=l;c=u,this._attachTexture({attachment:a,texture:u,layer:d,level:h})}else this._attachTexture({attachment:a,texture:c,layer:0,level:0});else this._unattach(a);i&&c&&c.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const t=this.getStatus();if(36053!==t)throw new Error(function Ane(n){return(En.STATUS||{})[n]||"Framebuffer error ".concat(n)}(t));return this}getStatus(){const{gl:e}=this,t=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,t||null),i}clear(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:t,depth:i,stencil:r,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(t||i||r)&&dx(this.gl,{color:t,depth:i,stencil:r}),s.forEach((a,l)=>{!function pne(n){let{framebuffer:e=null,buffer:t=QL,drawBuffer:i=0,value:r=[0,0,0,0]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ni(n),Ii(n,{framebuffer:e},()=>{switch(t){case QL:switch(r.constructor){case Int32Array:n.clearBufferiv(t,i,r);break;case Uint32Array:n.clearBufferuiv(t,i,r);break;case Float32Array:default:n.clearBufferfv(t,i,r)}break;case 6145:n.clearBufferfv(6145,0,[r]);break;case 6146:n.clearBufferiv(6146,0,[r]);break;case tF:const[s,o]=r;n.clearBufferfi(tF,0,s,o);break;default:oe(!1,nF)}})}(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return ge.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return ge.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return ge.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return ge.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return ge.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return ge.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:t=[],x:i=0,y:r=0,width:s,height:o}=e;const a=ni(this.gl),l=a.bindFramebuffer(36008,this.handle);return 0===i&&0===r&&void 0===s&&void 0===o?a.invalidateFramebuffer(36008,t):a.invalidateFramebuffer(36008,t,i,r,s,o),a.bindFramebuffer(36008,l),this}getAttachmentParameter(e,t,i){let r=this._getAttachmentParameterFallback(t);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,t),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=zo(this.gl,r)),r}getAttachmentParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const r={};for(const s of i)r[t?zo(this.gl,s):s]=this.getAttachmentParameter(e,s,t);return r}getParameters(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=Object.keys(this.attachments),i={};for(const r of t){const s=Number(r);i[e?zo(this.gl,s):s]=this.getAttachmentParameters(s,e)}return i}show(){return"undefined"!=typeof window&&window.open(fx(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e>ge.level||"undefined"==typeof window)return this;t=t||"Framebuffer ".concat(this.id);const i=fx(this,{targetMaxHeight:100});return ge.image({logLevel:e,message:t,image:i},t)(),this}bind(){let{target:e=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,t,i,r,s){let o=null;return e&&(o=o||{},o[36064]=new gi(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),t&&i?(o=o||{},o[33306]=new kc(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}),this.ownResources.push(o[33306])):t?(o=o||{},o[36096]=new kc(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:s}),this.ownResources.push(o[36096])):i&&oe(!1),o}_unattach(e){const t=this.attachments[e];!t||(t instanceof kc?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:t=36064,renderbuffer:i}=e;const{gl:r}=this;r.framebufferRenderbuffer(36160,t,36161,i.handle),this.attachments[t]=i}_attachTexture(e){let{attachment:t=36064,texture:i,layer:r,level:s}=e;const{gl:o}=this;switch(o.bindTexture(i.target,i.handle),i.target){case 35866:case 32879:ni(o).framebufferTextureLayer(36160,t,i.target,s,r);break;case 34067:const l=function Sne(n){return n<34069?n+34069:n}(r);o.framebufferTexture2D(36160,t,l,i.handle,s);break;case 3553:o.framebufferTexture2D(36160,t,3553,i.handle,s);break;default:oe(!1,"Illegal texture type")}o.bindTexture(i.target,null),this.attachments[t]=i}_setReadBuffer(e){const t=function AK(n){return lt(n)?n:null}(this.gl);t?t.readBuffer(e):oe(36064===e||1029===e,sF),this.readBuffer=e}_setDrawBuffers(e){const{gl:t}=this,i=ni(t);if(i)i.drawBuffers(e);else{const r=t.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):oe(1===e.length&&(36064===e[0]||1029===e[0]),sF)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const t=function Mne(n){n.luma=n.luma||{},n.luma.caps=n.luma.caps||{};for(const e in iF)void 0===n.luma.caps[e]&&(n.luma.caps[e]=rF(n,e));return n.luma.caps}(this.gl);switch(e){case 36052:return t.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return t.WEBGL2?null:8;case 33297:return t.WEBGL2?null:5125;case 33296:return t.WEBGL2||t.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}En.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const Ine={5126:Zt.bind(null,"uniform1fv",Xi,1,ri),35664:Zt.bind(null,"uniform2fv",Xi,2,ri),35665:Zt.bind(null,"uniform3fv",Xi,3,ri),35666:Zt.bind(null,"uniform4fv",Xi,4,ri),5124:Zt.bind(null,"uniform1iv",Uo,1,ri),35667:Zt.bind(null,"uniform2iv",Uo,2,ri),35668:Zt.bind(null,"uniform3iv",Uo,3,ri),35669:Zt.bind(null,"uniform4iv",Uo,4,ri),35670:Zt.bind(null,"uniform1iv",Uo,1,ri),35671:Zt.bind(null,"uniform2iv",Uo,2,ri),35672:Zt.bind(null,"uniform3iv",Uo,3,ri),35673:Zt.bind(null,"uniform4iv",Uo,4,ri),35674:Zt.bind(null,"uniformMatrix2fv",Xi,4,to),35675:Zt.bind(null,"uniformMatrix3fv",Xi,9,to),35676:Zt.bind(null,"uniformMatrix4fv",Xi,16,to),35678:Wn,35680:Wn,5125:Zt.bind(null,"uniform1uiv",Bm,1,ri),36294:Zt.bind(null,"uniform2uiv",Bm,2,ri),36295:Zt.bind(null,"uniform3uiv",Bm,3,ri),36296:Zt.bind(null,"uniform4uiv",Bm,4,ri),35685:Zt.bind(null,"uniformMatrix2x3fv",Xi,6,to),35686:Zt.bind(null,"uniformMatrix2x4fv",Xi,8,to),35687:Zt.bind(null,"uniformMatrix3x2fv",Xi,6,to),35688:Zt.bind(null,"uniformMatrix3x4fv",Xi,12,to),35689:Zt.bind(null,"uniformMatrix4x2fv",Xi,8,to),35690:Zt.bind(null,"uniformMatrix4x3fv",Xi,12,to),35678:Wn,35680:Wn,35679:Wn,35682:Wn,36289:Wn,36292:Wn,36293:Wn,36298:Wn,36299:Wn,36300:Wn,36303:Wn,36306:Wn,36307:Wn,36308:Wn,36311:Wn},Pne={},kne={},One={},oF=[0];function mx(n,e,t,i){1===e&&"boolean"==typeof n&&(n=n?1:0),Number.isFinite(n)&&(oF[0]=n,n=oF);const r=n.length;if(r%e&&ge.warn("Uniform size should be multiples of ".concat(e),n)(),n instanceof t)return n;let s=i[r];s||(s=new t(r),i[r]=s);for(let o=0;o<r;o++)s[o]=n[o];return s}function Xi(n,e){return mx(n,e,Float32Array,Pne)}function Uo(n,e){return mx(n,e,Int32Array,kne)}function Bm(n,e){return mx(n,e,Uint32Array,One)}function aF(n,e,t){const i=Ine[t.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(t.type));return i().bind(null,n,e)}function Rne(n){if("]"!==n[n.length-1])return{name:n,length:1,isArray:!1};const t=n.match(/([^[]*)(\[[0-9]+\])?/);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(n));return{name:t[1],length:t[2]||1,isArray:Boolean(t[2])}}function Fne(n){return Array.isArray(n)||ArrayBuffer.isView(n)?function Bne(n){if(0===n.length)return!1;const e=Math.min(n.length,16);for(let t=0;t<e;++t)if(!Number.isFinite(n[t]))return!1;return!0}(n):!!(isFinite(n)||!0===n||!1===n||n instanceof Ba||n instanceof kc)||n instanceof En&&Boolean(n.texture)}function Nne(n,e,t){if(Array.isArray(t)||ArrayBuffer.isView(t))if(n[e]){const i=n[e];for(let r=0,s=t.length;r<s;++r)i[r]=t[r]}else n[e]=t.slice();else n[e]=t}function Wn(){let n=null;return(e,t,i)=>{const r=n!==i;return r&&(e.uniform1i(t,i),n=i),r}}function Zt(n,e,t,i){let r=null,s=null;return(o,a,l)=>{const c=e(l,t),u=c.length;let d=!1;if(null===r)r=new Float32Array(u),s=u,d=!0;else{oe(s===u,"Uniform length cannot change.");for(let h=0;h<u;++h)if(c[h]!==r[h]){d=!0;break}}return d&&(i(o,n,a,c),r.set(c)),d}}function ri(n,e,t,i){n[e](t,i)}function to(n,e,t,i){n[e](t,!1,i)}function Vm(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const t=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,i=n.match(t);return i?i[1]:e}function cF(n,e){let t="";for(let i=0;i<e.length;i++){const r=e[i];if((n[i+3]||n[i+2]||n[i+1])&&(t+="".concat(r,"\n"),n[i+1])){const s=n[i+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0,c=s.substring(o.join(":").length+1).trim();t+=uF("^^^ ".concat(a,": ").concat(c,"\n\n"),l)}}return t}function uF(n,e){let t="";for(let i=0;i<e;++i)t+=" ";return"".concat(t).concat(n)}class $d extends eo{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return oe(!1),"unknown"}}constructor(e,t){fm(e),oe("string"==typeof t.source,"Shader: GLSL source code must be a JavaScript string"),super(e,{id:Vm(t.source,null)||t.id||jo("unnamed ".concat($d.getTypeName(t.shaderType)))}),this.shaderType=t.shaderType,this.source=t.source,this.initialize(t)}initialize(e){let{source:t}=e;const i=Vm(t,null);i&&(this.id=jo(i)),this._compile(t)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat($d.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Vm(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.source;if(e.startsWith("#version ")||(e="#version 100\n".concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:o}=function lF(n,e,t,i){const r=n.split(/\r?\n/),s={},o={},a=i||Vm(e)||"(unnamed)",l="".concat(function jne(n){switch(n){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(t)," shader ").concat(a);for(let u=0;u<r.length;u++){const d=r[u];if(d.length<=1)continue;const h=d.split(":"),f=h[0],p=parseInt(h[2],10);if(isNaN(p))throw new Error("GLSL compilation error in ".concat(l,": ").concat(n));"WARNING"!==f?s[p]=d:o[p]=d}const c=function Une(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ";const i=n.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,o)=>{const a=String(o+e);return uF(a,r-a.length)+t+s})}(e);return{shaderName:l,errors:cF(s,c),warnings:cF(o,c)}}(i,this.source,this.shaderType,this.id);throw ge.error("GLSL compilation errors in ".concat(r,"\n").concat(s))(),ge.warn("GLSL compilation warnings in ".concat(r,"\n").concat(o))(),new Error("GLSL compilation errors in ".concat(r))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class gx extends $d{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class _x extends $d{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,t){"string"==typeof t&&(t={source:t}),super(e,Object.assign({},t,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const On=5126,Yd=5124,Zd=5125,yx={[On]:[On,1,"float"],35664:[On,2,"vec2"],35665:[On,3,"vec3"],35666:[On,4,"vec4"],[Yd]:[Yd,1,"int"],35667:[Yd,2,"ivec2"],35668:[Yd,3,"ivec3"],35669:[Yd,4,"ivec4"],[Zd]:[Zd,1,"uint"],36294:[Zd,2,"uvec2"],36295:[Zd,3,"uvec3"],36296:[Zd,4,"uvec4"],35670:[On,1,"bool"],35671:[On,2,"bvec2"],35672:[On,3,"bvec3"],35673:[On,4,"bvec4"],35674:[On,8,"mat2"],35685:[On,8,"mat2x3"],35686:[On,8,"mat2x4"],35675:[On,12,"mat3"],35687:[On,12,"mat3x2"],35688:[On,12,"mat3x4"],35676:[On,16,"mat4"],35689:[On,16,"mat4x2"],35690:[On,16,"mat4x3"]};function gF(n){const e=yx[n];if(!e)return null;const[t,i]=e;return{type:t,components:i}}function _F(n,e){switch(n){case 5120:case 5121:case 5122:case 5123:n=On}for(const t in yx){const[i,r,s]=yx[t];if(i===n&&r===e)return{glType:t,name:s}}return null}class _ie{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const t=Number(e);return Number.isFinite(t)?this.attributeInfosByLocation[t]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const t=this.getAttributeInfo(e);return t?t.location:-1}getAttributeAccessor(e){const t=this.getAttributeInfo(e);return t?t.accessor:null}getVaryingInfo(e){const t=Number(e);return Number.isFinite(t)?this.varyingInfos[t]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const t=this.getVaryingInfo();return t?t.location:-1}getVaryingAccessor(e){const t=this.getVaryingInfo();return t?t.accessor:null}_readAttributesFromProgram(e){const{gl:t}=e,i=t.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getActiveAttrib(e.handle,r),l=t.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:t}=e;if(!lt(t))return;const i=t.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=t.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,o,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,t,i,r){const{type:s,components:o}=gF(i),a={type:s,size:r*o};this._inferProperties(e,t,a);const l={location:e,name:t,accessor:new Zi(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,t,i){/instance/i.test(t)&&(i.divisor=1)}_addVarying(e,t,i,r){const{type:s,components:o}=gF(i),l={location:e,name:t,accessor:new Zi({type:s,size:r*o})};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const yie=35981,vie=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class vF extends eo{get[Symbol.toStringTag](){return"Program"}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,t),this.stubRemovedMethods("Program","v6.0",vie),this._isCached=!1,this.initialize(t),Object.seal(this),this._setId(t.id)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hash:t,vs:i,fs:r,varyings:s,bufferMode:o=yie}=e;return this.hash=t||"",this.vs="string"==typeof i?new gx(this.gl,{id:"".concat(e.id,"-vs"),source:i}):i,this.fs="string"==typeof r?new _x(this.gl,{id:"".concat(e.id,"-fs"),source:r}):r,oe(this.vs instanceof gx),oe(this.fs instanceof _x),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(ni(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new _ie(this),this.setProps(e)}delete(){return this._isCached?this:super.delete(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:t,drawMode:i=4,vertexCount:r,offset:s=0,start:o,end:a,isIndexed:l=!1,indexType:c=5123,instanceCount:u=0,isInstanced:d=u>0,vertexArray:h=null,transformFeedback:f,framebuffer:p,parameters:m={},uniforms:_,samplers:y}=e;if((_||y)&&(ge.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(_||{})),ge.priority>=t){const v=p?p.id:"default",E="mode=".concat(zo(this.gl,i)," verts=").concat(r," ")+"instances=".concat(u," indexType=").concat(zo(this.gl,c)," ")+"isInstanced=".concat(d," isIndexed=").concat(l," ")+"Framebuffer=".concat(v);ge.log(t,E)()}return oe(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===r||d&&0===u||(h.bindForDraw(r,u,()=>{if(void 0!==p&&(m=Object.assign({},m,{framebuffer:p})),f){const v=function mF(n){switch(n){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return oe(!1),0}}(i);f.begin(v)}this._bindTextures(),Ii(this.gl,m,()=>{l&&d?this.gl2.drawElementsInstanced(i,r,c,s,u):l&&lt(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(i,o,a,r,c,s):l?this.gl.drawElements(i,r,c,s):d?this.gl2.drawArraysInstanced(i,s,r,u):this.gl.drawArrays(i,s,r)}),f&&f.end()}),0))}setUniforms(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};ge.priority>=2&&function Lne(n,e,t){for(const i in n){const r=n[i];if((!t||Boolean(t[i]))&&!Fne(r))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(i),r),new Error("".concat(e," Bad uniform ").concat(i))}}(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const t in e){const i=e[t],r=this._uniformSetters[t];if(r){let s=i,o=!1;if(s instanceof En&&(s=s.texture),s instanceof Ba)if(o=this.uniforms[t]!==i,o){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=r;a.bind(l),s=l,this._textureUniforms[t]=a}else s=r.textureIndex;else this._textureUniforms[t]&&delete this._textureUniforms[t];(r(s)||o)&&Nne(this.uniforms,t,i)}}return this}_areTexturesRenderable(){let e=!0;for(const t in this._textureUniforms){const i=this._textureUniforms[t];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms)this._textureUniforms[e].bind(this._uniformSetters[e].textureIndex)}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const t=this.gl.getAttachedShaders(e),i={};for(const r of t)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new gx({handle:r});break;case 35632:i.fs=new _x({handle:r})}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const t=this._getName();this.id=jo(t)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),ge.time(4,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),ge.timeEnd(4,"linkProgram for ".concat(this._getName()))(),e.debug||ge.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let t=0;t<this._uniformCount;t++){const i=this.gl.getActiveUniform(this.handle,t),{name:r}=Rne(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=aF(e,s,i),i.size>1)for(let o=0;o<i.size;o++)s=e.getUniformLocation(this.handle,"".concat(r,"[").concat(o,"]")),this._uniformSetters["".concat(r,"[").concat(o,"]")]=aF(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,t){return this.gl2.getActiveUniforms(this.handle,e,t)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,t){return this.gl2.getActiveUniformBlockParameter(this.handle,e,t)}uniformBlockBinding(e,t){this.gl2.uniformBlockBinding(this.handle,e,t)}}class Xd{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new Xd(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(t=>t.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const t="string"==typeof e?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==t),this.stateHash++}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{vs:t="",fs:i="",defines:r={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,c=this._getModuleList(e.modules),u=this._getHash(t),d=this._getHash(i),h=c.map(E=>this._getHash(E.name)).sort(),f=o.map(E=>this._getHash(E)),p=Object.keys(r).sort(),m=Object.keys(s).sort(),_=[],y=[];for(const E of p)_.push(this._getHash(E)),_.push(this._getHash(r[E]));for(const E of m)y.push(this._getHash(E)),y.push(this._getHash(s[E]));const v="".concat(u,"/").concat(d,"D").concat(_.join("/"),"M").concat(h.join("/"),"I").concat(y.join("/"),"V").concat(f.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(l?"T":"");if(!this._programCache[v]){const E=function Wte(n,e){const{vs:t,fs:i}=e,r=bte(e.modules||[]);return{gl:n,vs:UL(n,Object.assign({},e,{source:t,type:Hd,modules:r})),fs:UL(n,Object.assign({},e,{source:i,type:"fs",modules:r})),getUniforms:qte(r)}}(this.gl,{vs:t,fs:i,modules:c,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[v]=new vF(this.gl,{hash:v,vs:E.vs,fs:E.fs,varyings:o,bufferMode:a}),this._getUniforms[v]=E.getUniforms||(M=>{}),this._useCounts[v]=0}return this._useCounts[v]++,this._programCache[v]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const t=e.hash;this._useCounts[t]--,0===this._useCounts[t]&&(this._programCache[t].delete(),delete this._programCache[t],delete this._getUniforms[t],delete this._useCounts[t])}_getHash(e){return void 0===this._hashes[e]&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;t[r++]=a,i[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;i[l]||(t[r++]=a,i[l]=!0)}return t.length=r,t}}const bF="#define SMOOTH_EDGE_RADIUS 0.5",Cie={name:"geometry",vs:"\n".concat(bF,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(bF,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")},Eie=Object.keys(gt).map(n=>"const int COORDINATE_SYSTEM_".concat(n," = ").concat(gt[n],";")).join(""),Mie=Object.keys(Ur).map(n=>"const int PROJECTION_MODE_".concat(n," = ").concat(Ur[n],";")).join(""),Tie=Object.keys(La).map(n=>"const int UNIT_".concat(n.toUpperCase()," = ").concat(La[n],";")).join(""),Sie="".concat(Eie,"\n").concat(Mie,"\n").concat(Tie,'\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0; // meters\nconst float GLOBE_RADIUS = 256.0;\n\n// returns an adjustment factor for uCommonUnitsPerMeter\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n\n    // uCommonUnitsPerMeter in low-zoom Web Mercator is non-linear\n    // Adjust by 1 / cos(latitude)\n    // If geometry.position (vertex in common space) is populated, use it\n    // Otherwise use geometry.worldPosition (anchor in world space)\n    \n    if (geometry.position.w == 0.0) {\n      float y = clamp(geometry.worldPosition.y, -89.9, 89.9);\n      return 1.0 / cos(radians(y));\n    }\n\n    // latitude from common y: 2.0 * (atan(exp(y / TILE_SIZE * 2.0 * PI - PI)) - PI / 4.0)\n    // Taylor series of 1 / cos(latitude)\n    // Max error < 0.003\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n//\n// Scaling offsets - scales meters to "world distance"\n// Note the scalar version of project_size is for scaling the z component only\n//\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\n\n// Get rotation matrix that aligns the z axis with the given up vector\n// Find 3 unit vectors ux, uy, uz that are perpendicular to each other and uz == up\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  // Tangent on XY plane\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n\n//\n// Projecting normal - transform deltas from current coordinate system to\n// normals in the worldspace\n//\nvec3 project_normal(vec3 vector) {\n  // Apply model matrix\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\n\n//\n// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]\n//\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\n\n//\n// Projects positions (defined by project_uCoordinateSystem) to common space (defined by project_uProjectionMode)\n//\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n\n  // Work around for a Mac+NVIDIA bug https://github.com/visgl/deck.gl/issues/4145\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        // Too far from the projection center for offset mode to be accurate\n        // Only use high parts\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n\n  // Translation is already added to the high parts\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\n\n//\n// Projects from common space coordinates to clip space.\n// Uses project_uViewProjectionMatrix\n//\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\n\n// Returns a clip space offset that corresponds to a given number of screen pixels\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  // UNIT_PIXELS\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n');function Aie(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}return!1}function Kd(n){let t,e={};return i=>{for(const r in i)if(!Aie(i[r],e[r])){t=n(i),e=i;break}return t}}const wF=[0,0,0,0],Die=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],xF=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Iie=[0,0,0],CF=[0,0,0],Pie=Kd(function Rie({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=function kie(n,e,t){const{viewMatrixUncentered:i,projectionMatrix:r}=n;let{viewMatrix:s,viewProjectionMatrix:o}=n,a=wF,l=wF,c=n.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:d,offsetMode:h}=EF(n,e,t);return h&&(l=n.projectPosition(u||d),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=Mc([],l,o),s=i||s,o=Ra([],r,s),o=Ra([],o,Die)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:d,geospatialOrigin:u}}(n,t,i),u=n.getDistanceScales(),d=[n.width*e,n.height*e],h=Mc([],[0,0,-n.focalDistance,1],n.projectionMatrix)[3]||1,f={project_uCoordinateSystem:t,project_uProjectionMode:n.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:r,project_uPseudoMeters:Boolean(n._pseudoMeters),project_uViewportSize:d,project_uDevicePixelRatio:e,project_uFocalDistance:h,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Iie,project_uScale:n.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:xF,project_uCameraPosition:a};if(c){const p=n.getDistanceScales(c);switch(t){case gt.METER_OFFSETS:f.project_uCommonUnitsPerWorldUnit=p.unitsPerMeter,f.project_uCommonUnitsPerWorldUnit2=p.unitsPerMeter2;break;case gt.LNGLAT:case gt.LNGLAT_OFFSETS:n._pseudoMeters||(f.project_uCommonUnitsPerMeter=p.unitsPerMeter),f.project_uCommonUnitsPerWorldUnit=p.unitsPerDegree,f.project_uCommonUnitsPerWorldUnit2=p.unitsPerDegree2;break;case gt.CARTESIAN:f.project_uCommonUnitsPerWorldUnit=[1,1,p.unitsPerMeter[2]],f.project_uCommonUnitsPerWorldUnit2=[0,0,p.unitsPerMeter2[2]]}}return f});function EF(n,e,t=CF){t.length<3&&(t=[t[0],t[1],0]);let r,i=t,s=!0;switch(r=e===gt.LNGLAT_OFFSETS||e===gt.METER_OFFSETS?t:n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case Ur.WEB_MERCATOR:(e===gt.LNGLAT||e===gt.CARTESIAN)&&(r=[0,0,0],s=!1);break;case Ur.WEB_MERCATOR_AUTO_OFFSET:e===gt.LNGLAT?i=r:e===gt.CARTESIAN&&(i=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],r=n.unprojectPosition(i),i[0]-=t[0],i[1]-=t[1],i[2]-=t[2]);break;case Ur.IDENTITY:i=n.position.map(Math.fround),i[2]=i[2]||0;break;case Ur.GLOBE:s=!1,r=null;break;default:s=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}const Lie={},vx={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null},Cie],vs:Sie,getUniforms:function Fie(n=Lie){return"viewport"in n?function Oie({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:i=gt.DEFAULT,coordinateOrigin:r=CF,autoWrapLongitude:s=!1}){i===gt.DEFAULT&&(i=n.isGeospatial?gt.LNGLAT:gt.CARTESIAN);const o=Pie({viewport:n,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return o.project_uWrapLongitude=s,o.project_uModelMatrix=t||xF,o}(n):{}}},Nie=[vx],Bie=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Vie(n){const e=Xd.getDefaultProgramManager(n);for(const t of Nie)e.addDefaultModule(t);for(const t of Bie)e.addShaderHook(t);return e}class Uie{constructor(e,{deck:t,stats:i,viewport:r,timeline:s}={}){g(this,"layers",void 0),g(this,"context",void 0),g(this,"resourceManager",void 0),g(this,"_lastRenderedLayers",[]),g(this,"_needsRedraw",!1),g(this,"_needsUpdate",!1),g(this,"_nextLayers",null),g(this,"_debug",!1),g(this,"activateViewport",o=>{ii("layerManager.activateViewport",this,o),o&&(this.context.viewport=o)}),this.layers=[],this.resourceManager=new GJ({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:t,programManager:e&&Vie(e),stats:i||new gm({id:"deck.gl"}),viewport:r||new Vo({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new _R,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);t=t||r}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(t=>e.find(i=>0===t.id.indexOf(i))):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){ii("layerManager.setLayers",this,t,e),this._lastRenderedLayers=e;const i=mm(e,Boolean);for(const r of i)r.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,t,i){i.raiseError(t,"".concat(e," of ").concat(i))}_updateLayers(e,t){const i={};for(const o of e)i[o.id]?Ye.warn("Multiple old layers with same id ".concat(o.id))():i[o.id]=o;const r=[];this._updateSublayersRecursively(t,i,r),this._finalizeOldLayers(i);let s=!1;for(const o of r)if(o.hasUniformTransition()){s="Uniform transition in ".concat(o);break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,t,i){for(const r of e){r.context=this.context;const s=t[r.id];null===s&&Ye.warn("Multiple new layers with same id ".concat(r.id))(),t[r.id]=null;let o=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),o=r.isComposite?r.getSubLayers():null}catch(a){this._handleError("matching",a,r)}o&&this._updateSublayersRecursively(o,t,i)}}_finalizeOldLayers(e){for(const t in e){const i=e[t];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle="Initialized"}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle="Matched. State transferred from previous layer",t!==e&&(e.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle="No longer matched. Awaiting garbage collection";try{e._finalize(),e.lifecycle="Finalized! Awaiting garbage collection"}catch(t){this._handleError("finalization",t,e)}}}function za(n,e){if(n===e)return!0;if(!n||!e)return!1;for(const t in n){const i=n[t],r=e[t];if(!(i===r||Array.isArray(i)&&Array.isArray(r)&&za(i,r)))return!1}return!0}class Hie{constructor(e){g(this,"width",void 0),g(this,"height",void 0),g(this,"views",void 0),g(this,"viewState",void 0),g(this,"controllers",void 0),g(this,"timeline",void 0),g(this,"_viewports",void 0),g(this,"_viewportMap",void 0),g(this,"_isUpdating",void 0),g(this,"_needsRedraw",void 0),g(this,"_needsUpdate",void 0),g(this,"_eventManager",void 0),g(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return this.views.find(t=>t.id===e)}getViewState(e){const t="string"==typeof e?this.getView(e):e,i=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,t){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const o=i[s];if(o.containsPixel(r)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=mm(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!za(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Ye.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,t){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(X(k({},t),{viewId:e}))}_createController(e,t){return new(0,t.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,t.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return null===(o=this.getView(e.id))||void 0===o?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,t,i,r){const s=e.controller;if(s){const o=X(k(k({},t),s),{id:e.id,x:i.x,y:i.y,width:i.width,height:i.height});return r||(r=this._createController(e,o)),r&&r.setProps(o),r}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let r=e.length;r--;){const s=e[r],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let l=t[s.id];const c=Boolean(s.controller);c&&!l&&(i=!0),(i||!c)&&l&&(l.finalize(),l=null),this.controllers[s.id]=this._updateController(s,o,a,l),this._viewports.unshift(a)}for(const r in t){const s=t[r];s&&!this.controllers[r]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length||e.some((i,r)=>!e[r].equals(t[r]))}}const Gie=/([0-9]+\.?[0-9]*)(%|px)/;function Ho(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=Gie.exec(n);if(e&&e.length>=3){const t="%"===e[2],i=parseFloat(e[1]);return{position:t?i/100:i,relative:t}}default:throw new Error("Could not parse position string ".concat(n))}}function Go(n,e){return n.relative?Math.round(n.position*e):n.position}function jn(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}class MF{constructor(e){g(this,"id",void 0),g(this,"viewportInstance",void 0),g(this,"_x",void 0),g(this,"_y",void 0),g(this,"_width",void 0),g(this,"_height",void 0),g(this,"_padding",void 0),g(this,"props",void 0);const{id:t,x:i=0,y:r=0,width:s="100%",height:o="100%",padding:a=null,viewportInstance:l}=e||{};jn(!l||l instanceof Vo),this.viewportInstance=l,this.id=t||this.constructor.displayName||"view",this.props=X(k({},e),{id:this.id}),this._x=Ho(i),this._y=Ho(r),this._width=Ho(s),this._height=Ho(o),this._padding=a&&{left:Ho(a.left||0),right:Ho(a.right||0),top:Ho(a.top||0),bottom:Ho(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e||(this.viewportInstance?!!e.viewportInstance&&this.viewportInstance.equals(e.viewportInstance):this.ViewportType===e.ViewportType&&za(this.props,e.props))}makeViewport({width:e,height:t,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:t});return new this.ViewportType(k(k(k({},i),this.props),r))}getViewStateId(){const{viewState:e}=this.props;return"string"==typeof e?e:(null==e?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const t=k({},e);for(const i in this.props.viewState)"id"!==i&&(t[i]=this.props.viewState[i]);return t}return e}getDimensions({width:e,height:t}){const i={x:Go(this._x,e),y:Go(this._y,t),width:Go(this._width,e),height:Go(this._height,t)};return this._padding&&(i.padding={left:Go(this._padding.left,e),top:Go(this._padding.top,t),right:Go(this._padding.right,e),bottom:Go(this._padding.bottom,t)}),i}get controller(){const e=this.props.controller;return e?!0===e?{type:this.ControllerType}:"function"==typeof e?{type:e}:k({type:this.ControllerType},e):null}}const $ie=Math.PI/180;function TF(n){return 512/4003e4/Math.cos(n*$ie)}class vs extends Vo{constructor(e={}){const{latitude:t=0,longitude:i=0,zoom:r=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:l=1.01,orthographic:c=!1,projectionMatrix:u,repeat:d=!1,worldOffset:h=0,legacyMeterSizes:f=!1}=e;let{width:p,height:m,altitude:_=1.5}=e;const y=Math.pow(2,r);p=p||1,m=m||1;let v,E=null;u?(_=u[5]/2,v=km(_)):(e.fovy?(v=e.fovy,_=wL(v)):v=km(_),E=function bL(n){const{width:e,height:t,altitude:i,pitch:r=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=n;let{fovy:u=km(ite)}=n;void 0!==i&&(u=km(i));const d=u*br,h=r*br,f=wL(u);let p=f;o&&(p+=o[2]*a/Math.cos(h)/t);const m=d*(.5+(s?s[1]:0)/t),_=Math.sin(m)*p/Math.sin(Gw(Math.PI/2-h-m,.01,Math.PI-.01)),y=Math.sin(h)*_+p;return{fov:d,aspect:e/t,focalDistance:f,near:l,far:Math.min(y*c,10*p)}}({width:p,height:m,pitch:s,fovy:v,nearZMultiplier:a,farZMultiplier:l}));let M=function ote(n){const{height:e,pitch:t,bearing:i,altitude:r,scale:s,center:o}=n,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Mm(a,a,[0,0,-r]),cL(a,a,-t*br),uL(a,a,i*br);const l=s/e;return zw(a,a,[l,l,l]),o&&Mm(a,a,function oee(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}([],o)),a}({height:m,pitch:s,bearing:o,scale:y,altitude:_});h&&(M=(new zn).translate([512*h,0,0]).multiplyLeft(M)),super(X(k(X(k({},e),{width:p,height:m,viewMatrix:M,longitude:i,latitude:t,zoom:r}),E),{fovy:v,focalDistance:_})),g(this,"longitude",void 0),g(this,"latitude",void 0),g(this,"pitch",void 0),g(this,"bearing",void 0),g(this,"altitude",void 0),g(this,"fovy",void 0),g(this,"orthographic",void 0),g(this,"_subViewports",void 0),g(this,"_pseudoMeters",void 0),this.latitude=t,this.longitude=i,this.zoom=r,this.pitch=s,this.bearing=o,this.altitude=_,this.fovy=v,this.orthographic=c,this._subViewports=d?[]:null,this._pseudoMeters=f,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),i=Math.ceil((e[2]-180)/360);for(let r=t;r<=i;r++){const s=r?new vs(X(k({},this),{worldOffset:r})):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,i]=this.projectFlat(e);return[t,i,(e[2]||0)*TF(e[1])]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,i]=this.unprojectFlat(e);return[t,i,(e[2]||0)/TF(i)]}addMetersToLngLat(e,t){return vL(e,t)}panByPosition(e,t){const i=Om(t,this.pixelUnprojectionMatrix),s=Tm([],this.projectFlat(e),hL([],i)),o=Tm([],this.center,s),[a,l]=this.unprojectFlat(o);return{longitude:a,latitude:l}}getBounds(e={}){const t=function lte(n,e=0){const{width:t,height:i,unproject:r}=n,s={targetZ:e},o=r([0,i],s),a=r([t,i],s);let l,c;return(n.fovy?.5*n.fovy*EL:Math.atan(.5/n.altitude))>(90-n.pitch)*EL-.01?(l=ML(n,0,e),c=ML(n,t,e)):(l=r([0,0],s),c=r([t,0],s)),[o,a,c,l]}(this,e.z||0);return[Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),Math.min(t[0][1],t[1][1],t[2][1],t[3][1]),Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),Math.max(t[0][1],t[1][1],t[2][1],t[3][1])]}fitBounds(e,t={}){const{width:i,height:r}=this,{longitude:s,latitude:o,zoom:a}=CL(k({width:i,height:r,bounds:e},t));return new vs({width:i,height:r,longitude:s,latitude:o,zoom:a})}}g(vs,"displayName","WebMercatorViewport");class Qd{constructor(e){g(this,"_inProgress",void 0),g(this,"_handle",void 0),g(this,"_timeline",void 0),g(this,"time",void 0),g(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var t,i;this.cancel(),this.settings=e,this._inProgress=!0,null===(t=(i=this.settings).onStart)||void 0===t||t.call(i,this)}end(){var e,t;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(e=(t=this.settings).onEnd)||void 0===e||e.call(t,this))}cancel(){var e,t;this._inProgress&&(null===(e=(t=this.settings).onInterrupt)||void 0===e||e.call(t,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var e,t;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:i,settings:r}=this;this._handle=i.addChannel({delay:i.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(e=(t=this.settings).onUpdate)||void 0===e||e.call(t,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const SF=()=>{},Yie=n=>n;class Xie{constructor(e){g(this,"getControllerState",void 0),g(this,"props",void 0),g(this,"propsInTransition",void 0),g(this,"transition",void 0),g(this,"onViewStateChange",void 0),g(this,"onStateChange",void 0),g(this,"_onTransitionUpdate",t=>{const{time:i,settings:{interpolator:r,startProps:s,endProps:o,duration:a,easing:l}}=t,c=l(i/a),u=r.interpolateProps(s,o,c);this.propsInTransition=this.getControllerState(k(k({},this.props),u)).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Qd(e.timeline),this.onViewStateChange=e.onViewStateChange||SF,this.onStateChange=e.onStateChange||SF}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const i=this.props;if(this.props=e,!i||this._shouldIgnoreViewportChange(i,e))return!1;if(this._isTransitionEnabled(e)){let r=i;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;r=k(k({},i),2===s?o:this.propsInTransition||i)}this._triggerTransition(r,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:i}=e;return(t>0||"auto"===t)&&Boolean(i)}_isUpdateDueToCurrentTransition(e){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition)}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(t):!this._isTransitionEnabled(t)||t.transitionInterpolator.arePropsEqual(e,t)}_triggerTransition(e,t){const i=this.getControllerState(e),r=this.getControllerState(t).shortestPathFrom(i),s=t.transitionInterpolator,o=s.getDuration?s.getDuration(e,t):t.transitionDuration;if(0===o)return;const a=s.initializeProps(e,r);this.propsInTransition={};const l={duration:o,easing:t.transitionEasing||Yie,interpolator:s,interruption:t.transitionInterruption||1,startProps:a.start,endProps:a.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),null==e||e(t)}}}const Qie=["longitude","latitude","zoom","bearing","pitch"],Jie=["longitude","latitude","zoom"];class wx extends class Kie{constructor(e){g(this,"_propsToCompare",void 0),g(this,"_propsToExtract",void 0),g(this,"_requiredProps",void 0);const{compare:t,extract:i,required:r}=e;this._propsToCompare=t,this._propsToExtract=i||t,this._requiredProps=r}arePropsEqual(e,t){for(const i of this._propsToCompare)if(!(i in e)||!(i in t)||!_s(e[i],t[i]))return!1;return!0}initializeProps(e,t){const i={},r={};for(const s of this._propsToExtract)(s in e||s in t)&&(i[s]=e[s],r[s]=t[s]);return this._checkRequiredProps(i),this._checkRequiredProps(r),{start:i,end:r}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){!this._requiredProps||this._requiredProps.forEach(t=>{const i=e[t];jn(Number.isFinite(i)||Array.isArray(i),"".concat(t," is required for transition"))})}}{constructor(e={}){const t=Array.isArray(e)?e:e.transitionProps,i=Array.isArray(e)?{}:e;i.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:Qie,required:Jie},super(i.transitionProps),g(this,"opts",void 0),this.opts=i}initializeProps(e,t){const i=super.initializeProps(e,t),{makeViewport:r,around:s}=this.opts;if(r&&s){const o=r(e),a=r(t),l=o.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(l),aroundPosition:l,width:t.width,height:t.height})}return i}interpolateProps(e,t,i){const r={};for(const s of this._propsToExtract)r[s]=Ks(e[s]||0,t[s]||0,i);if(t.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport(k(k({},t),r));Object.assign(r,s.panByPosition(t.aroundPosition,Ks(e.around,t.around,i)))}return r}}const Wo={transitionDuration:0},jm=n=>1-(1-n)*(1-n),Lc_WHEEL=["wheel"],Lc_PAN=["panstart","panmove","panend"],Lc_PINCH=["pinchstart","pinchmove","pinchend"],Lc_TRIPLE_PAN=["tripanstart","tripanmove","tripanend"],Lc_DOUBLE_TAP=["doubletap"],Lc_KEYBOARD=["keydown"],ja={};class AF{constructor(e){g(this,"props",void 0),g(this,"state",{}),g(this,"transitionManager",void 0),g(this,"eventManager",void 0),g(this,"onViewStateChange",void 0),g(this,"onStateChange",void 0),g(this,"makeViewport",void 0),g(this,"_controllerState",void 0),g(this,"_events",{}),g(this,"_interactionState",{isDragging:!1}),g(this,"_customEvents",[]),g(this,"_eventStartBlocked",null),g(this,"_panMove",!1),g(this,"invertPan",!1),g(this,"dragMode","rotate"),g(this,"inertia",0),g(this,"scrollZoom",!0),g(this,"dragPan",!0),g(this,"dragRotate",!0),g(this,"doubleClickZoom",!0),g(this,"touchZoom",!0),g(this,"touchRotate",!1),g(this,"keyboard",!0),this.transitionManager=new Xie(X(k({},e),{getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)})),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const t in this._events)if(this._events[t]){var e;null===(e=this.eventManager)||void 0===e||e.off(t,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return!t&&this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return!t&&this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return!t&&this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState(k(k({makeViewport:this.makeViewport},this.props),this.state)),this._controllerState}getCenter(e){const{x:t,y:i}=this.props,{offsetCenter:r}=e;return[r.x-t,r.y-i]}isPointInBounds(e,t){const{width:i,height:r}=this.props;if(t&&t.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&t&&t.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:t}=e;return Boolean(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:!0===t?300:0;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,u=Boolean(this.onViewStateChange);this.toggleEvents(Lc_WHEEL,u&&i),this.toggleEvents(Lc_PAN,u&&(r||s)),this.toggleEvents(Lc_PINCH,u&&(a||l)),this.toggleEvents(Lc_TRIPLE_PAN,u&&l),this.toggleEvents(Lc_DOUBLE_TAP,u&&o),this.toggleEvents(Lc_KEYBOARD,u&&c),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(i=>{this._events[i]!==t&&(this._events[i]=t,t?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,t=null,i={}){const r=k(k({},e.getViewportProps()),t),s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(i),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange(X(k({},e),{interactionState:this._interactionState}))}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:t});return this._panMove=i,this.updateViewport(r,Wo,{isDragging:!0}),!0}_onPan(e){return!!this.isDragging()&&(this._panMove?this._onPanMove(e):this._onPanRotate(e))}_onPanEnd(e){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e))}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),i=this.controllerState.pan({pos:t});return this.updateViewport(i,Wo,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.pan({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).panEnd();this.updateViewport(s,X(k({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:jm}),{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),i=this.controllerState.rotate({pos:t});return this.updateViewport(i,Wo,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const i=this.getCenter(e),s=this.controllerState.rotate({pos:[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2]}).rotateEnd();this.updateViewport(s,X(k({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:jm}),{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const{speed:i=.01,smooth:r=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*i)));s<0&&0!==o&&(o=1/o);const a=this.controllerState.zoom({pos:t,scale:o});return this.updateViewport(a,X(k({},this._getTransitionProps({around:t})),{transitionDuration:r?250:1}),{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.rotateStart({pos:t});return this.updateViewport(i,Wo,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const i=this.controllerState.rotate({pos:t});return this.updateViewport(i,Wo,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*t/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,X(k({},this._getTransitionProps()),{transitionDuration:t,transitionEasing:jm}),{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return ja._startPinchRotation=e.rotation,ja._lastPinchEvent=e,this.updateViewport(i,Wo,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);t=t.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;t=t.rotate({deltaAngleX:ja._startPinchRotation-i})}return this.updateViewport(t,Wo,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),ja._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:i}=ja;if(this.touchZoom&&t&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),l=Math.pow(2,o+a*t/2);s=s.zoom({pos:r,scale:l}).zoomEnd(),this.updateViewport(s,X(k({},this._getTransitionProps({around:r})),{transitionDuration:t,transitionEasing:jm}),{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return ja._startPinchRotation=null,ja._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:t,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:o}=!0===this.keyboard?{}:this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=t?a.zoomOut(i).zoomOut(i):a.zoomOut(i),c.isZooming=!0;break;case"Equal":l=t?a.zoomIn(i).zoomIn(i):a.zoomIn(i),c.isZooming=!0;break;case"ArrowLeft":t?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(r),c.isPanning=!0);break;case"ArrowRight":t?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(r),c.isPanning=!0);break;case"ArrowUp":t?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(r),c.isPanning=!0);break;case"ArrowDown":t?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(r),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{transition:t}=this;return t&&t.transitionInterpolator?e?X(k({},t),{transitionInterpolator:new wx(X(k(k({},e),t.transitionInterpolator.opts),{makeViewport:this.controllerState.makeViewport}))}):t:Wo}}class DF{constructor(e,t){g(this,"_viewportProps",void 0),g(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}class nre extends DF{constructor(e){const{width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,position:u=[0,0,0],maxZoom:d=20,minZoom:h=0,maxPitch:f=60,minPitch:p=0,startPanLngLat:m,startZoomLngLat:_,startRotatePos:y,startBearing:v,startPitch:E,startZoom:M,normalize:R=!0}=e;jn(Number.isFinite(s)),jn(Number.isFinite(r)),jn(Number.isFinite(o)),super({width:t,height:i,latitude:r,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:d,minZoom:h,maxPitch:f,minPitch:p,normalize:R,position:u},{startPanLngLat:m,startZoomLngLat:_,startRotatePos:y,startBearing:v,startPitch:E,startZoom:M}),g(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const i=this.getState().startPanLngLat||this._unproject(t);if(!i)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:o}=this.getState();if(!r||void 0===s||void 0===o)return this;let a;return a=e?this._getNewRotation(e,r,o,s):{bearing:s+t,pitch:o+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:t,scale:i}){let{startZoom:r,startZoomLngLat:s}=this.getState();if(s||(r=this.getViewportProps().zoom,s=this._unproject(t)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let l=r+Math.log2(i);l=Gn(l,a,o);const c=this.makeViewport(X(k({},this.getViewportProps()),{zoom:l}));return this._getUpdatedState(k({zoom:l},c.panByPosition(s,e)))}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),i=k({},this.getViewportProps()),{bearing:r,longitude:s}=i;return Math.abs(r-t.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-t.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r}=e;e.zoom=Gn(r,i,t);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=Gn(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,function cte(n){const{width:e,height:t,pitch:i=0}=n;let{longitude:r,latitude:s,zoom:o,bearing:a=0}=n;(r<-180||r>180)&&(r=_L(r+180,360)-180),(a<-180||a>180)&&(a=_L(a+180,360)-180);const l=Ww(t/512);if(o<=l)o=l,s=0;else{const c=t/2/Math.pow(2,o),u=Ac([0,c])[1];if(s<u)s=u;else{const d=Ac([0,512-c])[1];s>d&&(s=d)}}return{width:e,height:t,longitude:r,latitude:s,zoom:o,pitch:i,bearing:a}}(e)),e}_zoomFromCenter(e){const{width:t,height:i}=this.getViewportProps();return this.zoom({pos:[t/2,i/2],scale:e})}_panFromCenter(e){const{width:t,height:i}=this.getViewportProps();return this.pan({startPos:[t/2,i/2],pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor(k(k(k({makeViewport:this.makeViewport},this.getViewportProps()),this.getState()),e))}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,i,r){const s=e[0]-t[0],o=e[1]-t[1],a=e[1],l=t[1],{width:c,height:u}=this.getViewportProps(),d=s/c;let h=0;o>0?Math.abs(u-l)>5&&(h=o/(l-u)*1.2):o<0&&l>5&&(h=1-a/l),h=Gn(h,-1,1);const{minPitch:f,maxPitch:p}=this.getViewportProps();let _=i;return h>0?_=i+h*(p-i):h<0&&(_=i-h*(f-i)),{pitch:_,bearing:r+180*d}}}class ire extends AF{constructor(...e){super(...e),g(this,"ControllerState",nre),g(this,"transition",{transitionDuration:300,transitionInterpolator:new wx({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),g(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState(k(k({makeViewport:this.makeViewport},e),this.state)))}}class PF extends MF{get ViewportType(){return vs}get ControllerType(){return ire}}g(PF,"displayName","MapView");const rre=[255,255,255],sre=1;let ore=0;class are{constructor(e={}){g(this,"id",void 0),g(this,"color",void 0),g(this,"intensity",void 0),g(this,"type","ambient");const{color:t=rre}=e,{intensity:i=sre}=e;this.id=e.id||"ambient-".concat(ore++),this.color=t,this.intensity=i}}const lre=[255,255,255],cre=1,ure=[0,0,-1];let dre=0;class kF{constructor(e={}){g(this,"id",void 0),g(this,"color",void 0),g(this,"intensity",void 0),g(this,"type","directional"),g(this,"direction",void 0),g(this,"shadow",void 0);const{color:t=lre}=e,{intensity:i=cre}=e,{direction:r=ure}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(dre++),this.color=t,this.intensity=i,this.type="directional",this.direction=new le(r).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class Um extends class hre{constructor(e,t={id:"pass"}){g(this,"id",void 0),g(this,"gl",void 0),g(this,"props",void 0);const{id:i}=t;this.id=i,this.gl=e,this.props=k({},t)}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}{constructor(...e){super(...e),g(this,"_lastRenderIndex",-1)}render(e){return fs(this.gl,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:t,moduleParameters:i,viewports:r,views:s,onViewportActive:o,clearStack:a=!0,clearCanvas:l=!0}=e;e.pass=e.pass||"unknown";const c=this.gl;l&&function pre(n){fs(n,{viewport:[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}),n.clear(16640)}(c),a&&(this._lastRenderIndex=-1);const u=[];for(const d of r){const h=s&&s[d.id];o(d);const f=this._getDrawLayerParams(d,e),p=d.subViewports||[d];for(const m of p){const _=this._drawLayersInViewport(c,{target:t,moduleParameters:i,viewport:m,view:h,pass:e.pass,layers:e.layers},f);u.push(_)}}return u}_getDrawLayerParams(e,{layers:t,pass:i,layerFilter:r,cullRect:s,effects:o,moduleParameters:a}){const l=[],c=OF(this._lastRenderIndex+1),u={layer:t[0],viewport:e,isPicking:i.startsWith("picking"),renderPass:i,cullRect:s},d={};for(let h=0;h<t.length;h++){const f=t[h],p=this._shouldDrawLayer(f,u,r,d),m={shouldDrawLayer:p};p&&(m.layerRenderIndex=c(f,p),m.moduleParameters=this._getModuleParameters(f,o,i,a),m.layerParameters=this.getLayerParameters(f,h,e)),l[h]=m}return l}_drawLayersInViewport(e,{layers:t,moduleParameters:i,pass:r,target:s,viewport:o,view:a},l){const c=function fre(n,{moduleParameters:e,target:t,viewport:i}){const r=t&&"default-framebuffer"!==t.id,s=e&&e.devicePixelRatio||yc(n);return[i.x*s,(r?t.height:n.drawingBufferHeight)-(i.y+i.height)*s,i.width*s,i.height*s]}(e,{moduleParameters:i,target:s,viewport:o});if(a&&a.props.clear){const d=!0===a.props.clear?{color:!0,depth:!0}:a.props.clear;Ii(e,{scissorTest:!0,scissor:c},()=>dx(e,d))}const u={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};fs(e,{viewport:c});for(let d=0;d<t.length;d++){const h=t[d],{shouldDrawLayer:f,layerRenderIndex:p,moduleParameters:m,layerParameters:_}=l[d];if(f&&h.props.pickable&&u.pickableCount++,h.isComposite)u.compositeCount++;else if(f){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,p),m.viewport=o;try{h._drawLayer({moduleParameters:m,uniforms:{layerIndex:p},parameters:_})}catch(y){h.raiseError(y,"drawing ".concat(h," to ").concat(r))}}}return u}shouldDrawLayer(e){return!0}getModuleParameters(e,t){return null}getLayerParameters(e,t,i){return e.props.parameters}_shouldDrawLayer(e,t,i,r){if(!e.props.visible||!this.shouldDrawLayer(e))return!1;t.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(t))return!1;t.layer=o,o=o.parent}if(i){const a=t.layer.id;if(a in r||(r[a]=i(t)),!r[a])return!1}return e.activateViewport(t.viewport),!0}_getModuleParameters(e,t,i,r){var s;const o=Object.assign(Object.create((null===(s=e.internalState)||void 0===s?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:yc(this.gl)});if(t)for(const l of t){var a;Object.assign(o,null===(a=l.getModuleParameters)||void 0===a?void 0:a.call(l,e))}return Object.assign(o,this.getModuleParameters(e,t),r)}}function OF(n=0,e={}){const t={},i=(r,s)=>{const o=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let c;if(l&&!(l in e)&&i(r.parent,!1),l in t){const u=t[l]=t[l]||OF(e[l],e);c=u(r,s),t[a]=u}else Number.isFinite(o)?(c=o+(e[l]||0),t[a]=null):c=n;return s&&c>=n&&(n=c+1),e[a]=c,c};return i}class mre extends Um{constructor(e,t){super(e,t),g(this,"shadowMap",void 0),g(this,"depthBuffer",void 0),g(this,"fbo",void 0),this.shadowMap=new gi(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new kc(e,{format:33189,width:1,height:1}),this.fbo=new En(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const t=this.fbo;Ii(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=yc(this.gl),s=i.width*r,o=i.height*r;(s!==t.width||o!==t.height)&&t.resize({width:s,height:o}),super.render(X(k({},e),{target:t,pass:"shadow"}))})}shouldDrawLayer(e){return!1!==e.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const yre=Kd(function Cre({viewport:n,center:e}){return new zn(n.viewProjectionMatrix).invert().transform(e)}),vre=Kd(function Ere({viewport:n,shadowMatrices:e}){const t=[],i=n.pixelUnprojectionMatrix,r=n.isGeospatial?void 0:1,s=[[0,0,r],[n.width,0,r],[0,n.height,r],[n.width,n.height,r],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(o=>function xre(n,e){const[t,i,r]=n,s=Om([t,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}(o,i));for(const o of e){const a=o.clone().translate(new le(n.center).negate()),l=s.map(u=>a.transform(u)),c=(new zn).ortho({left:Math.min(...l.map(u=>u[0])),right:Math.max(...l.map(u=>u[0])),bottom:Math.min(...l.map(u=>u[1])),top:Math.max(...l.map(u=>u[1])),near:Math.min(...l.map(u=>-u[2])),far:Math.max(...l.map(u=>-u[2]))});t.push(c.multiplyRight(o))}return t}),bre=[0,0,0,1],wre=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],xx={name:"shadow",dependencies:[vx],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(n={},e={})=>"viewport"in n&&(n.drawToShadowMap||n.shadowMaps&&n.shadowMaps.length>0)?function Mre(n,e){const{shadowEnabled:t=!0}=n;if(!t||!n.shadowMatrices||!n.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:Boolean(n.drawToShadowMap),shadow_uUseShadowMap:!!n.shadowMaps&&n.shadowMaps.length>0,shadow_uColor:n.shadowColor||bre,shadow_uLightId:n.shadowLightId||0,shadow_uLightCount:n.shadowMatrices.length},r=yre({viewport:n.viewport,center:e.project_uCenter}),s=[],o=vre({shadowMatrices:n.shadowMatrices,viewport:n.viewport}).slice();for(let a=0;a<n.shadowMatrices.length;a++){const l=o[a],c=l.clone().translate(new le(n.viewport.center).negate());e.project_uCoordinateSystem===gt.LNGLAT&&e.project_uProjectionMode===Ur.WEB_MERCATOR?(o[a]=c,s[a]=r):(o[a]=l.clone().multiplyRight(wre),s[a]=c.transform(r))}for(let a=0;a<o.length;a++)i["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],i["shadow_uProjectCenters[".concat(a,"]")]=s[a],i["shadow_uShadowMap".concat(a)]=n.shadowMaps&&n.shadowMaps.length>0?n.shadowMaps[a]:n.dummyShadowMap;return i}(n,e):{}},Tre={color:[255,255,255],intensity:1},RF=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Sre=[0,0,0,200/255];class LF{constructor(e={}){g(this,"id","lighting-effect"),g(this,"props",null),g(this,"shadowColor",Sre),g(this,"shadow",void 0),g(this,"ambientLight",null),g(this,"directionalLights",[]),g(this,"pointLights",[]),g(this,"shadowPasses",[]),g(this,"shadowMaps",[]),g(this,"dummyShadowMap",null),g(this,"programManager",void 0),g(this,"shadowMatrices",void 0);for(const t in e){const i=e[t];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow)}preRender(e,{layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(e),this.programManager||(this.programManager=Xd.getDefaultProgramManager(e),xx&&this.programManager.addDefaultModule(xx)),this.dummyShadowMap||(this.dummyShadowMap=new gi(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const t=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return t.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},t}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(xx),this.programManager=null)}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const i=(new zn).lookAt({eye:new le(t.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const i=new mre(e);this.shadowPasses[t]=i,this.shadowMaps[t]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:i}=this;!e&&0===t.length&&0===i.length&&(this.ambientLight=new are(Tre),this.directionalLights.push(new kF(RF[0]),new kF(RF[1])))}}class Are extends Um{constructor(e,t){super(e,t),g(this,"maskMap",void 0),g(this,"fbo",void 0);const{mapSize:i=2048}=t;this.maskMap=new gi(e,{width:i,height:i,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.fbo=new En(e,{id:"maskmap",width:i,height:i,attachments:{36064:this.maskMap}})}render(e){const t=this.gl,i=[!1,!1,!1,!1];return i[e.channel]=!0,Ii(t,{clearColor:[255,255,255,255],blend:!0,blendFunc:[0,1],blendEquation:32778,colorMask:i,depthTest:!1},()=>super.render(X(k({},e),{target:this.fbo,pass:"mask"})))}shouldDrawLayer(e){return"mask"===e.props.operation}delete(){this.fbo.delete(),this.maskMap.delete()}}const Dre=(new zn).lookAt({eye:[0,0,1]});function Ire({width:n,height:e,near:t,far:i,padding:r}){let s=-n/2,o=n/2,a=-e/2,l=e/2;if(r){const{left:c=0,right:u=0,top:d=0,bottom:h=0}=r,f=Gn((c+n-u)/2,0,n)-n/2,p=Gn((d+e-h)/2,0,e)-e/2;s-=f,o-=f,a+=p,l+=p}return(new zn).ortho({left:s,right:o,bottom:a,top:l,near:t,far:i})}class Pre extends Vo{constructor(e){const{width:t,height:i,near:r=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],padding:l=null,flipY:c=!0}=e,u=Array.isArray(o)?o[0]:o,d=Array.isArray(o)?o[1]:o,h=Math.min(u,d),f=Math.pow(2,h);let p;if(u!==d){const m=Math.pow(2,u),_=Math.pow(2,d);p={unitsPerMeter:[m/f,_/f,1],metersPerUnit:[f/m,f/_,1]}}super(X(k({},e),{longitude:void 0,position:a,viewMatrix:Dre.clone().scale([f,f*(c?-1:1),f]),projectionMatrix:Ire({width:t||1,height:i||1,padding:l,near:r,far:s}),zoom:h,distanceScales:p}))}projectFlat([e,t]){const{unitsPerMeter:i}=this.distanceScales;return[e*i[0],t*i[1]]}unprojectFlat([e,t]){const{metersPerUnit:i}=this.distanceScales;return[e*i[0],t*i[1]]}panByPosition(e,t){const i=Om(t,this.pixelUnprojectionMatrix),s=Tm([],this.projectFlat(e),hL([],i)),o=Tm([],this.center,s);return{target:this.unprojectFlat(o)}}}class FF extends DF{constructor(e){const{width:t,height:i,rotationX:r=0,rotationOrbit:s=0,target:o=[0,0,0],zoom:a=0,minRotationX:l=-90,maxRotationX:c=90,minZoom:u=-1/0,maxZoom:d=1/0,startPanPosition:h,startRotatePos:f,startRotationX:p,startRotationOrbit:m,startZoomPosition:_,startZoom:y}=e;super({width:t,height:i,rotationX:r,rotationOrbit:s,target:o,zoom:a,minRotationX:l,maxRotationX:c,minZoom:u,maxZoom:d},{startPanPosition:h,startRotatePos:f,startRotationX:p,startRotationOrbit:m,startZoomPosition:_,startZoom:y}),g(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:t}){const i=this.getState().startPanPosition||t;if(!i)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:r,startRotationX:s,startRotationOrbit:o}=this.getState(),{width:a,height:l}=this.getViewportProps();if(!r||void 0===s||void 0===o)return this;let c;if(e){let u=(e[0]-r[0])/a;(s<-90||s>90)&&(u*=-1),c={rotationX:s+(e[1]-r[1])/l*180,rotationOrbit:o+180*u}}else c={rotationX:s+i,rotationOrbit:o+t};return this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const t=e.getViewportProps(),i=k({},this.getViewportProps()),{rotationOrbit:r}=i;return Math.abs(r-t.rotationOrbit)>180&&(i.rotationOrbit=r<0?r+360:r-360),i}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:t,scale:i}){let{startZoom:r,startZoomPosition:s}=this.getState();if(s||(r=this.getViewportProps().zoom,s=this._unproject(t)||this._unproject(e)),!s)return this;const o=this._calculateNewZoom({scale:i,startZoom:r}),a=this.makeViewport(X(k({},this.getViewportProps()),{zoom:o}));return this._getUpdatedState(k({zoom:o},a.panByPosition(s,e)))}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this.getViewportProps();return void 0===t&&(t=this.getViewportProps().zoom),Gn(t+Math.log2(e),r,i)}_panFromCenter(e){const{width:t,height:i,target:r}=this.getViewportProps();return this.pan({startPosition:r,pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor(k(k(k({makeViewport:this.makeViewport},this.getViewportProps()),this.getState()),e))}applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:r,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=Array.isArray(r)?[Gn(r[0],i,t),Gn(r[1],i,t)]:Gn(r,i,t),e.rotationX=Gn(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=function mee(n,e){const t=n%e;return t<0?e+t:t}(a+180,360)-180),e}}class kre extends FF{constructor(e){super(e),g(this,"zoomAxis",void 0),this.zoomAxis=e.zoomAxis||"all"}_calculateNewZoom({scale:e,startZoom:t}){const{maxZoom:i,minZoom:r}=this.getViewportProps();void 0===t&&(t=this.getViewportProps().zoom);let s=Math.log2(e);if(Array.isArray(t)){let[o,a]=t;switch(this.zoomAxis){case"X":o=Gn(o+s,r,i);break;case"Y":a=Gn(a+s,r,i);break;default:let l=Math.min(o+s,a+s);l<r&&(s+=r-l),l=Math.max(o+s,a+s),l>i&&(s+=i-l),o+=s,a+=s}return[o,a]}return Gn(t+s,r,i)}}class Ore extends AF{constructor(...e){super(...e),g(this,"ControllerState",kre),g(this,"transition",{transitionDuration:300,transitionInterpolator:new wx(["target","zoom"])}),g(this,"dragMode","pan")}_onPanRotate(){return!1}}class NF extends MF{get ViewportType(){return Pre}get ControllerType(){return Ore}}g(NF,"displayName","OrthographicView");class Nre{constructor(){g(this,"id","mask-effect"),g(this,"props",null),g(this,"useInPicking",!0),g(this,"dummyMaskMap",void 0),g(this,"channels",[]),g(this,"masks",null),g(this,"maskPass",void 0),g(this,"maskMap",void 0),g(this,"lastViewport",void 0)}preRender(e,{layers:t,layerFilter:i,viewports:r,onViewportActive:s,views:o}){this.dummyMaskMap||(this.dummyMaskMap=new gi(e,{width:1,height:1}));const a=t.filter(d=>d.props.visible&&"mask"===d.props.operation);if(0===a.length)return this.masks=null,void(this.channels.length=0);this.masks={},this.maskPass||(this.maskPass=new Are(e,{id:"default-mask"}),this.maskMap=this.maskPass.maskMap);const l=this._sortMaskChannels(a),c=r[0],u=!this.lastViewport||!this.lastViewport.equals(c);for(const d in l)this._renderChannel(l[d],{layerFilter:i,onViewportActive:s,views:o,viewport:c,viewportChanged:u})}_renderChannel(e,{layerFilter:t,onViewportActive:i,views:r,viewport:s,viewportChanged:o}){const a=this.channels[e.index];if(!a)return;const l=e===a||a.layers.length!==e.layers.length||e.layerBounds.some((c,u)=>c!==a.layerBounds[u]);if(e.bounds=a.bounds,e.maskBounds=a.maskBounds,this.channels[e.index]=e,(l||o)&&(this.lastViewport=s,e.bounds=function Rre({layers:n,viewport:e}){let t=null;for(const s of n){const o=s.getBounds();o&&(t?(t[0]=Math.min(t[0],o[0][0]),t[1]=Math.min(t[1],o[0][1]),t[2]=Math.max(t[2],o[1][0]),t[3]=Math.max(t[3],o[1][1])):t=[o[0][0],o[0][1],o[1][0],o[1][1]])}const i=e.getBounds();if(!t)return i;const r=function Fre(n){const e_x=n[2]-n[0],e_y=n[3]-n[1],t_x=n[0]+.5*e_x,t_y=n[1]+.5*e_y;return[t_x-e_x,t_y-e_y,t_x+e_x,t_y+e_y]}(i);return t[2]-t[0]<r[2]-r[0]||t[3]-t[1]<r[3]-r[1]||(t[0]=Math.max(t[0],r[0]),t[1]=Math.max(t[1],r[1]),t[2]=Math.min(t[2],r[2]),t[3]=Math.min(t[3],r[3])),t}({layers:e.layers,viewport:s}),l||!_s(e.bounds,a.bounds))){const{maskPass:c,maskMap:u}=this,d=function Lre({bounds:n,viewport:e,width:t,height:i}){if(n[2]<=n[0]||n[3]<=n[1])return null;if(t-=2,i-=2,e instanceof vs){const{longitude:a,latitude:l,zoom:c}=CL({width:t,height:i,bounds:[[n[0],n[1]],[n[2],n[3]]],maxZoom:20});return new vs({longitude:a,latitude:l,zoom:c,x:1,y:1,width:t,height:i})}const s=[(n[0]+n[2])/2,(n[1]+n[3])/2,0],o=Math.min(20,t/(n[2]-n[0]),i/(n[3]-n[1]));return new NF({x:1,y:1}).makeViewport({width:t,height:i,viewState:{target:s,zoom:Math.log2(o)}})}({bounds:e.bounds,viewport:s,width:u.width,height:u.height});e.maskBounds=d?d.getBounds():[0,0,1,1],c.render({pass:"mask",channel:e.index,layers:e.layers,layerFilter:t,viewports:d?[d]:[],onViewportActive:i,views:r,moduleParameters:{devicePixelRatio:1}})}this.masks[e.id]={index:e.index,bounds:e.maskBounds,coordinateOrigin:e.coordinateOrigin,coordinateSystem:e.coordinateSystem}}_sortMaskChannels(e){const t={};let i=0;for(const r of e){const{id:s}=r.root;let o=t[s];if(!o){if(++i>4){Ye.warn("Too many mask layers. The max supported is 4")();continue}o={id:s,index:this.channels.findIndex(a=>(null==a?void 0:a.id)===s),layers:[],layerBounds:[],coordinateOrigin:r.root.props.coordinateOrigin,coordinateSystem:r.root.props.coordinateSystem},t[s]=o}o.layers.push(r),o.layerBounds.push(r.getBounds())}for(let r=0;r<4;r++){const s=this.channels[r];(!s||!(s.id in t))&&(this.channels[r]=null)}for(const r in t){const s=t[r];s.index<0&&(s.index=this.channels.findIndex(o=>!o),this.channels[s.index]=s)}return t}getModuleParameters(){return{maskMap:this.masks?this.maskMap:this.dummyMaskMap,maskChannels:this.masks}}cleanup(){this.dummyMaskMap&&(this.dummyMaskMap.delete(),this.dummyMaskMap=void 0),this.maskPass&&(this.maskPass.delete(),this.maskPass=void 0,this.maskMap=void 0),this.lastViewport=void 0,this.masks=null,this.channels.length=0}}const Bre=new LF;class Vre{constructor(){g(this,"effects",void 0),g(this,"_internalEffects",void 0),g(this,"_needsRedraw",void 0),this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!za(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._internalEffects=e.slice(),this._internalEffects.push(new Nre),e.some(t=>t instanceof LF)||this._internalEffects.push(Bre)}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}}class zre extends Um{shouldDrawLayer(e){return"draw"===e.props.operation}}const BF={blendFunc:[1,0,32771,0],blendEquation:32774};class VF extends Um{constructor(...e){super(...e),g(this,"pickZ",void 0),g(this,"_colors",null)}render(e){return e.pickingFBO?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},cullRect:d,effects:h,pass:f="picking",pickZ:p}){const m=this.gl;this.pickZ=p;const _=p?null:{byLayer:new Map,byAlpha:[]};this._colors=_;const y=Ii(m,X(k({scissorTest:!0,scissor:[a,l,c,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0]},BF),{blend:!p}),()=>super.render({target:o,layers:e,layerFilter:t,views:i,viewports:r,onViewportActive:s,cullRect:d,effects:null==h?void 0:h.filter(E=>E.useInPicking),pass:f}));return this._colors=null,{decodePickingColor:_&&Ure.bind(null,_),stats:y}}shouldDrawLayer(e){return e.props.pickable&&"draw"===e.props.operation}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,t,i){const r=k({},e.props.parameters);return this._colors?(Object.assign(r,BF),r.blend=!0,r.blendColor=function jre(n,e,t){const{byLayer:i,byAlpha:r}=n;let s,o=i.get(e);return o?(o.viewports.push(t),s=o.a):(s=i.size+1,s<=255?(o={a:s,layer:e,viewports:[t]},i.set(e,o),r[s]=o):(Ye.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}(this._colors,e,i)):r.blend=!1,r}}function Ure(n,e){const t=n.byAlpha[e[3]];return t&&{pickedLayer:t.layer,pickedViewports:t.viewports,pickedObjectIndex:t.layer.decodePickingColor(e)}}class Gre{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new zre(e),this.pickLayersPass=new VF(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=e.layerFilter||this.layerFilter,e.effects=e.effects||[],e.target=e.target||En.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const i=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,r=t.render(X(k({},e),{target:i}));this._postRender(e.effects,e),this.renderCount++,ii("deckRenderer.renderLayers",this,r,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){let i=null;for(const r of e)r.preRender(this.gl,t),r.postRender&&(i=r);i&&this._resizeRenderBuffers(),this.lastPostProcessEffect=i}_resizeRenderBuffers(){const{renderBuffers:e}=this;0===e.length&&e.push(new En(this.gl),new En(this.gl));for(const t of e)t.resize()}_postRender(e,t){const{renderBuffers:i}=this,r={inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){r.target=t.target,s.postRender(this.gl,r);break}const o=s.postRender(this.gl,r);r.inputBuffer=o,r.swapBuffer=o===i[0]?i[1]:i[0]}}}const Wre={pickedColor:null,pickedObjectIndex:-1};function qre({pickedColors:n,decodePickingColor:e,deviceX:t,deviceY:i,deviceRadius:r,deviceRect:s}){const{x:o,y:a,width:l,height:c}=s;let u=r*r,d=-1,h=0;for(let f=0;f<c;f++){const p=f+a-i,m=p*p;if(m>u)h+=4*l;else for(let _=0;_<l;_++){if(n[h+3]-1>=0){const v=_+o-t,E=v*v+m;E<=u&&(u=E,d=h)}h+=4}}if(d>=0){const f=n.slice(d,d+4),p=e(f);if(p){const m=Math.floor(d/4/l),_=d/4-m*l;return X(k({},p),{pickedColor:f,pickedX:o+_,pickedY:a+m})}Ye.error("Picked non-existent layer. Is picking buffer corrupt?")()}return Wre}function zF({pickInfo:n,viewports:e,pixelRatio:t,x:i,y:r,z:s}){let a,o=e[0];if(e.length>1&&(o=function Zre(n,e){for(let t=n.length-1;t>=0;t--){const i=n[t];if(i.containsPixel(e))return i}return n[0]}((null==n?void 0:n.pickedViewports)||e,{x:i,y:r})),o){const l=[i-o.x,r-o.y];void 0!==s&&(l[2]=s),a=o.unproject(l)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:a,devicePixel:n&&"pickedX"in n?[n.pickedX,n.pickedY]:void 0,pixelRatio:t}}function Yre(n){const{pickInfo:e,lastPickedInfo:t,mode:i,layers:r}=n,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if("hover"===i){const d=t.index,h=t.layerId,f=o?o.props.id:null;if(f!==h||a!==d){if(f!==h){const p=r.find(m=>m.props.id===h);p&&l.unshift(p)}t.layerId=f,t.index=a,t.info=null}}const c=zF(n),u=new Map;return u.set(null,c),l.forEach(d=>{let h=k({},c);d===o&&(h.color=s,h.index=a,h.picked=!0),h=jF({layer:d,info:h,mode:i});const f=h.layer;d===o&&"hover"===i&&(t.info=h),u.set(f.id,h),"hover"===i&&f.updateAutoHighlight(h)}),u}function jF({layer:n,info:e,mode:t}){for(;n&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:i}),n=n.parent}return e}class Xre{constructor(e){g(this,"gl",void 0),g(this,"pickingFBO",void 0),g(this,"depthFBO",void 0),g(this,"pickLayersPass",void 0),g(this,"layerFilter",void 0),g(this,"lastPickedInfo",void 0),g(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new VF(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:i,viewports:r},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?i.find(h=>h.id===o):null,c=a&&r.find(h=>h.id===a)||r[0],u=c&&c.unproject([e-c.x,t-c.y]),d={x:e,y:t,viewport:c,coordinate:u,layer:l};return k(k({},s),d)}_resizeBuffer(){var e,t;const{gl:i}=this;if(!this.pickingFBO&&(this.pickingFBO=new En(i),En.isSupported(i,{colorBufferFloat:!0}))){const r=new En(i);r.attach({36064:new gi(i,{format:lt(i)?34836:6408,type:5126})}),this.depthFBO=r}null===(e=this.pickingFBO)||void 0===e||e.resize({width:i.canvas.width,height:i.canvas.height}),null===(t=this.depthFBO)||void 0===t||t.resize({width:i.canvas.width,height:i.canvas.height})}_getPickable(e){if(!1===this._pickable)return null;const t=e.filter(i=>i.isPickable()&&!i.isComposite);return t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:i,x:r,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u,effects:d}){const h=this._getPickable(e),f=yc(this.gl);if(!h)return{result:[],emptyInfo:zF({viewports:i,x:r,y:s,pixelRatio:f})};this._resizeBuffer();const p=W0(this.gl,[r,s],!0),m=[p.x+Math.floor(p.width/2),p.y+Math.floor(p.height/2)],_=Math.round(o*f),{width:y,height:v}=this.pickingFBO,E=this._getPickingRect({deviceX:m[0],deviceY:m[1],deviceRadius:_,deviceWidth:y,deviceHeight:v}),M={x:r-o,y:s-o,width:2*o+1,height:2*o+1};let R;const B=[],V=new Set;for(let Z=0;Z<a;Z++){let Y,$;if(E){const fe=this._drawAndSample({layers:h,views:t,viewports:i,onViewportActive:u,deviceRect:E,cullRect:M,effects:d,pass:"picking:".concat(l)});Y=qre(X(k({},fe),{deviceX:m[0],deviceY:m[1],deviceRadius:_,deviceRect:E}))}else Y={pickedColor:null,pickedObjectIndex:-1};Y.pickedLayer&&c&&this.depthFBO&&($=this._drawAndSample({layers:[Y.pickedLayer],views:t,viewports:i,onViewportActive:u,deviceRect:{x:Y.pickedX,y:Y.pickedY,width:1,height:1},cullRect:M,effects:d,pass:"picking:".concat(l,":z")},!0).pickedColors[0]),Y.pickedLayer&&Z+1<a&&(V.add(Y.pickedLayer),Y.pickedLayer.disablePickingIndex(Y.pickedObjectIndex)),R=Yre({pickInfo:Y,lastPickedInfo:this.lastPickedInfo,mode:l,layers:h,viewports:i,x:r,y:s,z:$,pixelRatio:f});for(const fe of R.values())fe.layer&&B.push(fe);if(!Y.pickedColor)break}for(const Z of V)Z.restorePickingColors();return{result:B,emptyInfo:R.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:i,x:r,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u,effects:d}){const h=this._getPickable(e);if(!h)return[];this._resizeBuffer();const f=yc(this.gl),p=W0(this.gl,[r,s],!0),m=p.x,_=p.y+p.height,y=W0(this.gl,[r+o,s+a],!0),E=y.y,B=function $re({pickedColors:n,decodePickingColor:e}){const t=new Map;if(n)for(let i=0;i<n.length;i+=4)if(n[i+3]-1>=0){const s=n.slice(i,i+4),o=s.join(",");if(!t.has(o)){const a=e(s);a?t.set(o,X(k({},a),{color:s})):Ye.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(t.values())}(this._drawAndSample({layers:h,views:t,viewports:i,onViewportActive:u,deviceRect:{x:m,y:E,width:y.x+y.width-m,height:_-E},cullRect:{x:r,y:s,width:o,height:a},effects:d,pass:"picking:".concat(l)})),V=new Map,Z=Number.isFinite(c);for(let Y=0;Y<B.length&&!(Z&&c&&V.size>=c);Y++){const $=B[Y];let fe={color:$.pickedColor,layer:null,index:$.pickedObjectIndex,picked:!0,x:r,y:s,pixelRatio:f};fe=jF({layer:$.pickedLayer,info:fe,mode:l}),V.has(fe.object)||V.set(fe.object,fe)}return Array.from(V.values())}_drawAndSample({layers:e,views:t,viewports:i,onViewportActive:r,deviceRect:s,cullRect:o,effects:a,pass:l},c=!1){const u=c?this.depthFBO:this.pickingFBO,{decodePickingColor:d}=this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:t,viewports:i,onViewportActive:r,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:c}),{x:h,y:f,width:p,height:m}=s,_=new(c?Float32Array:Uint8Array)(p*m*4);return Nm(u,{sourceX:h,sourceY:f,sourceWidth:p,sourceHeight:m,target:_}),{pickedColors:_,decodePickingColor:d}}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const o=Math.max(0,e-i),a=Math.max(0,t-i),l=Math.min(r,e+i+1)-o,c=Math.min(s,t+i+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const Kre={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class Qre{constructor(e){g(this,"el",null),g(this,"isVisible",!1);const t=e.parentElement;t&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,Kre),t.appendChild(this.el))}setTooltip(e,t,i){const r=this.el;if(r){if("string"==typeof e)r.innerText=e;else{if(!e)return this.isVisible=!1,void(r.style.display="none");e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className),Object.assign(r.style,e.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(t,"px, ").concat(i,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}const{_parseImageNode:ese}=globalThis,Cx="undefined"!=typeof Image,Ex="undefined"!=typeof ImageBitmap,tse=Boolean(ese),Mx=!!sw||tse;function UF(n){const e=function GF(n){return"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&n instanceof Image?"image":n&&"object"==typeof n&&n.data&&n.width&&n.height?"data":null}(n);if(!e)throw new Error("Not an image");return e}function HF(n){switch(UF(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}const rse=/^data:image\/svg\+xml/,sse=/\.svg((\?|#).*)?$/;function Tx(n){return n&&(rse.test(n)||sse.test(n))}function ose(n,e){if(Tx(e)){let i=(new TextDecoder).decode(n);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(i))}return WF(n,e)}function WF(n,e){if(Tx(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}function qF(n,e,t){return Sx.apply(this,arguments)}function Sx(){return Sx=Bt(function*(n,e,t){const i=ose(n,t),r=self.URL||self.webkitURL,s="string"!=typeof i&&r.createObjectURL(i);try{return yield ase(s||i,e)}finally{s&&r.revokeObjectURL(s)}}),Sx.apply(this,arguments)}function ase(n,e){return Ax.apply(this,arguments)}function Ax(){return Ax=Bt(function*(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(yield t.decode(),t):yield new Promise((i,r)=>{try{t.onload=()=>i(t),t.onerror=s=>r(new Error("Could not load image ".concat(n,": ").concat(s)))}catch(s){r(s)}})}),Ax.apply(this,arguments)}const lse={};let $F=!0;function cse(n,e,t){return Dx.apply(this,arguments)}function Dx(){return Dx=Bt(function*(n,e,t){let i;i=Tx(t)?yield qF(n,e,t):WF(n,t);const r=e&&e.imagebitmap;return yield use(i,r)}),Dx.apply(this,arguments)}function use(n){return Ix.apply(this,arguments)}function Ix(){return Ix=Bt(function*(n,e=null){if((dse(e)||!$F)&&(e=null),e)try{return yield createImageBitmap(n,e)}catch(t){console.warn(t),$F=!1}return yield createImageBitmap(n)}),Ix.apply(this,arguments)}function dse(n){for(const e in n||lse)return!1;return!0}const bs=!1,Jd=!0;function YF(n){const e=eh(n);return function hse(n){const e=eh(n);return e.byteLength>=24&&2303741511===e.getUint32(0,bs)?{mimeType:"image/png",width:e.getUint32(16,bs),height:e.getUint32(20,bs)}:null}(e)||function mse(n){const e=eh(n);if(!(e.byteLength>=3&&65496===e.getUint16(0,bs)&&255===e.getUint8(2)))return null;const{tableMarkers:i,sofMarkers:r}=function gse(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,bs);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,bs),width:e.getUint16(s+7,bs)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,bs)}return null}(e)||function fse(n){const e=eh(n);return e.byteLength>=10&&1195984440===e.getUint32(0,bs)?{mimeType:"image/gif",width:e.getUint16(6,Jd),height:e.getUint16(8,Jd)}:null}(e)||function pse(n){const e=eh(n);return e.byteLength>=14&&16973===e.getUint16(0,bs)&&e.getUint32(2,Jd)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Jd),height:e.getUint32(22,Jd)}:null}(e)}function eh(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}function _se(n,e){return Px.apply(this,arguments)}function Px(){return Px=Bt(function*(n,e){const{mimeType:t}=YF(n)||{},i=globalThis._parseImageNode;return _m(i),yield i(n,t)}),Px.apply(this,arguments)}function kx(){return kx=Bt(function*(n,e,t){const r=((e=e||{}).image||{}).type||"auto",{url:s}=t||{};let a;switch(vse(r)){case"imagebitmap":a=yield cse(n,e,s);break;case"image":a=yield qF(n,e,s);break;case"data":a=yield _se(n,e);break;default:_m(!1)}return"data"===r&&(a=HF(a)),a}),kx.apply(this,arguments)}function vse(n){switch(n){case"auto":case"data":return function ise(){if(Ex)return"imagebitmap";if(Cx)return"image";if(Mx)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function nse(n){switch(n){case"auto":return Ex||Cx||Mx;case"imagebitmap":return Ex;case"image":return Cx;case"data":return Mx;default:throw new Error("@loaders.gl/images: image ".concat(n," not supported in this environment"))}}(n),n}}const ZF={id:"image",module:"images",name:"Images",version:"3.2.9",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:function yse(n,e,t){return kx.apply(this,arguments)},tests:[n=>Boolean(YF(new DataView(n)))],options:{image:{type:"auto",decode:!0}}},wse={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function bse(n){const e=n[0],t=n[n.length-1];return"{"===e&&"}"===t||"["===e&&"]"===t},parseTextSync:JSON.parse},th="8.8.11",Hm=globalThis.deck&&globalThis.deck.VERSION;if(Hm&&Hm!==th)throw new Error("deck.gl - multiple versions detected: ".concat(Hm," vs ").concat(th));Hm||(Ye.log(1,"deck.gl ".concat(th))(),globalThis.deck=X(k({},globalThis.deck),{VERSION:th,version:th,log:Ye,_registerLoggers:function EQ(n){Y0=n}}),function PJ(n){const e=GR();n=Array.isArray(n)?n:[n];for(const t of n){const i=X0(t);e.find(r=>i===r)||e.unshift(i)}}([wse,[ZF,{imagebitmap:{premultiplyAlpha:"none"}}]]));const xse=globalThis.deck,Gm=globalThis;function XF(n){if(!n&&!ds())return"Node";if($O(n))return"Electron";const t=n||("undefined"!=typeof navigator?navigator:{}).userAgent||"";if(t.indexOf("Edge")>-1)return"Edge";const i=-1!==t.indexOf("MSIE "),r=-1!==t.indexOf("Trident/");return i||r?"IE":Gm.chrome?"Chrome":Gm.safari?"Safari":Gm.mozInnerScreenX?"Firefox":"Unknown"}class Wm extends eo{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const i=lt(e),r=px(e,"TIMER_QUERY");let s=i||r;for(const o of t)switch(o){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:oe(!1)}return s}constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.begin(e?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(e){return this._queryPending||(this.target=e,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):t++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return Wm.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const KF=ds()&&"undefined"!=typeof document;let kse=0;class Ose{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{onCreateContext:t=(_=>gR(_)),onAddHTML:i=null,onInitialize:r=(()=>{}),onRender:s=(()=>{}),onFinalize:o=(()=>{}),onError:a,gl:l=null,glOptions:c={},debug:u=!1,createFramebuffer:d=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:f=!0,stats:p=Na.get("animation-loop-".concat(kse++))}=e;let{useDevicePixels:m=!0}=e;"useDevicePixelRatio"in e&&(ge.deprecated("useDevicePixelRatio","useDevicePixels")(),m=e.useDevicePixelRatio),this.props={onCreateContext:t,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:c,debug:u,createFramebuffer:d},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=p,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:f,useDevicePixels:m}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return oe("string"==typeof e),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._running)return this;this._running=!0;const t=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Wm.isSupported(this.gl,["timers"])?new Wm(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),!1!==i&&this._startLoop())});return this.props.onError&&t.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}toDataURL(){var e=this;return Bt(function*(){return e.setNeedsRedraw("toDataURL"),yield e.waitForRender(),e.gl.canvas.toDataURL()})()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const i=document.getElementById(e);return i?Number(i.value):t}setViewParameters(){return ge.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{!this._running||(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=KF?new Promise((e,t)=>{KF&&"complete"===document.readyState?e(document):window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):function Pse(n){return"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):function Ise(n){return"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}(e)}_renderFrame(){this.display?this.display._renderFrame(...arguments):this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:t,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){"object"==typeof e&&null!==e&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&"undefined"!=typeof OffscreenCanvas&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?$0(this.props.gl,e):this.onCreateContext(e),!hm(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(function dQ(n){fs(n,G0)})(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(t);const i=this.props.onAddHTML(t);i&&(t.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,t=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&t>0&&(i=e/t),{width:e,height:t,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function gQ(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n.canvas)return void wQ(n,hQ(e.useDevicePixels),e);const t=n.getExtension("STACKGL_resize_drawingbuffer");t&&"width"in e&&"height"in e&&t.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new En(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}var qm=Re(386);const Rse={mousedown:1,mousemove:2,mouseup:4};(function Fse(n){const e=n.prototype.handler;n.prototype.handler=function(i){const r=this.store;i.button>0&&"pointerdown"===i.type&&(function Lse(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return!0;return!1}(r,s=>s.pointerId===i.pointerId)||r.push(i)),e.call(this,i)}})(qm.PointerEventInput),function Nse(n){n.prototype.handler=function(t){let i=Rse[t.type];1&i&&t.button>=0&&(this.pressed=!0),2&i&&0===t.which&&(i=4),this.pressed&&(4&i&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}}(qm.MouseInput);const Bse=qm.Manager,ws=qm;class $m{constructor(e,t,i){this.element=e,this.callback=t,this.options=k({enable:!0},i)}}const Vse=ws?[[ws.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[ws.Rotate,{enable:!1}],[ws.Pinch,{enable:!1}],[ws.Swipe,{enable:!1}],[ws.Pan,{threshold:0,enable:!1}],[ws.Press,{enable:!1}],[ws.Tap,{event:"doubletap",taps:2,enable:!1}],[ws.Tap,{event:"anytap",enable:!1}],[ws.Tap,{enable:!1}]]:null,e2={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},zse={doubletap:["tap"]},jse={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Rx={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Use={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},t2={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Hse="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Fc="undefined"!=typeof window?window:global;"undefined"!=typeof global?global:window,"undefined"!=typeof document&&document;let Lx=!1;try{Fc.addEventListener("test",null,{get passive(){return Lx=!0,!0}}),Fc.removeEventListener("test",null)}catch(n){Lx=!1}const Gse=-1!==Hse.indexOf("firefox"),{WHEEL_EVENTS:Wse}=Rx,r2=4.000244140625;class Yse extends $m{constructor(e,t,i){super(e,t,i),this.handleEvent=r=>{if(!this.options.enable)return;let s=r.deltaY;Fc.WheelEvent&&(Gse&&r.deltaMode===Fc.WheelEvent.DOM_DELTA_PIXEL&&(s/=Fc.devicePixelRatio),r.deltaMode===Fc.WheelEvent.DOM_DELTA_LINE&&(s*=40)),0!==s&&s%r2==0&&(s=Math.floor(s/r2)),r.shiftKey&&s&&(s*=.25),this.callback({type:"wheel",center:{x:r.clientX,y:r.clientY},delta:-s,srcEvent:r,pointerType:"mouse",target:r.target})},this.events=(this.options.events||[]).concat(Wse),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,!!Lx&&{passive:!1}))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){"wheel"===e&&(this.options.enable=t)}}const{MOUSE_EVENTS:Zse}=Rx,s2="pointermove",o2="pointerover",a2="pointerout",l2="pointerenter",c2="pointerleave";class Xse extends $m{constructor(e,t,i){super(e,t,i),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,this.events=(this.options.events||[]).concat(Zse),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===s2&&(this.enableMoveEvent=t),e===o2&&(this.enableOverEvent=t),e===a2&&(this.enableOutEvent=t),e===l2&&(this.enableEnterEvent=t),e===c2&&(this.enableLeaveEvent=t)}handleOverEvent(e){this.enableOverEvent&&"mouseover"===e.type&&this._emit(o2,e)}handleOutEvent(e){this.enableOutEvent&&"mouseout"===e.type&&this._emit(a2,e)}handleEnterEvent(e){this.enableEnterEvent&&"mouseenter"===e.type&&this._emit(l2,e)}handleLeaveEvent(e){this.enableLeaveEvent&&"mouseleave"===e.type&&this._emit(c2,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":0===e.which&&(this.pressed=!1),this.pressed||this._emit(s2,e);break;case"mouseup":this.pressed=!1}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const{KEY_EVENTS:Kse}=Rx,u2="keydown";class Qse extends $m{constructor(e,t,i){super(e,t,i),this.handleEvent=r=>{const s=r.target||r.srcElement;"INPUT"===s.tagName&&"text"===s.type||"TEXTAREA"===s.tagName||(this.enableDownEvent&&"keydown"===r.type&&this.callback({type:u2,srcEvent:r,key:r.key,target:r.target}),this.enableUpEvent&&"keyup"===r.type&&this.callback({type:"keyup",srcEvent:r,key:r.key,target:r.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Kse),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e===u2&&(this.enableDownEvent=t),"keyup"===e&&(this.enableUpEvent=t)}}const h2="contextmenu";class Jse extends $m{constructor(e,t,i){super(e,t,i),this.handleEvent=r=>{!this.options.enable||this.callback({type:h2,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e===h2&&(this.options.enable=t)}}const eoe={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},Bx={srcElement:"root",priority:0};class hoe{constructor(e){this.handleEvent=t=>{if(this.isEmpty())return;const i=this._normalizeEvent(t);let r=t.srcEvent.target;for(;r&&r!==i.rootElement;){if(this._emit(i,r),i.handled)return;r=r.parentNode}this._emit(i,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,i,r=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let l=Bx;"string"==typeof i||i&&i.addEventListener?l=X(k({},Bx),{srcElement:i}):i&&(l=k(k({},Bx),i));let c=a.get(l.srcElement);c||(c=[],a.set(l.srcElement,c));const u={type:e,handler:t,srcElement:l.srcElement,priority:l.priority};r&&(u.once=!0),s&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let d=c.length-1;for(;d>=0&&!(c[d].priority>=u.priority);)d--;c.splice(d+1,0,u)}remove(e,t){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.type===e&&o.handler===t){i.splice(s,1);const a=r.get(o.srcElement);a.splice(a.indexOf(o),1),0===a.length&&r.delete(o.srcElement)}}this._active=i.some(s=>!s.passive)}_emit(e,t){const i=this.handlersByElement.get(t);if(i){let r=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,r=!0},a=[];for(let l=0;l<i.length;l++){const{type:c,handler:u,once:d}=i[l];if(u(X(k({},e),{type:c,stopPropagation:s,stopImmediatePropagation:o})),d&&a.push(i[l]),r)break}for(let l=0;l<a.length;l++){const{type:c,handler:u}=a[l];this.remove(c,u)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return X(k(k(k({},e),function uoe(n){const e=eoe[n.srcEvent.type];if(!e)return null;const{buttons:t,button:i,which:r}=n.srcEvent;let s=!1,o=!1,a=!1;return 4===e||2===e&&!Number.isFinite(t)?(s=1===r,o=2===r,a=3===r):2===e?(s=Boolean(1&t),o=Boolean(4&t),a=Boolean(2&t)):1===e&&(s=0===i,o=1===i,a=2===i),{leftButton:s,middleButton:o,rightButton:a}}(e)),function doe(n,e){const t=n.center;if(!t)return null;const i=e.getBoundingClientRect();return{center:t,offsetCenter:{x:(t.x-i.left-e.clientLeft)/(i.width/e.offsetWidth||1),y:(t.y-i.top-e.clientTop)/(i.height/e.offsetHeight||1)}}}(e,t)),{preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t})}}const foe={events:null,recognizers:null,recognizerOptions:{},Manager:Bse,touchAction:"none",tabIndex:0};class poe{constructor(e=null,t){this._onBasicInput=r=>{const{srcEvent:s}=r,o=jse[s.type];o&&this.manager.emit(o,r)},this._onOtherEvent=r=>{this.manager.emit(r.type,r)},this.options=k(k({},foe),t),this.events=new Map,this.setElement(e);const{events:i}=this.options;i&&this.on(i)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:t}=this;this.manager=new(0,t.Manager)(e,{touchAction:t.touchAction,recognizers:t.recognizers||Vse}).on("hammer.input",this._onBasicInput),t.recognizers||Object.keys(e2).forEach(r=>{const s=this.manager.get(r);s&&e2[r].forEach(o=>{s.recognizeWith(o)})});for(const r in t.recognizerOptions){const s=this.manager.get(r);if(s){const o=t.recognizerOptions[r];delete o.enable,s.set(o)}}this.wheelInput=new Yse(e,this._onOtherEvent,{enable:!1}),this.moveInput=new Xse(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Qse(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new Jse(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,t,i){this._addEventHandler(e,t,i,!1)}once(e,t,i){this._addEventHandler(e,t,i,!0)}watch(e,t,i){this._addEventHandler(e,t,i,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==t){r.set({enable:t});const s=zse[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=i.get(o);t?(a.requireFailure(e),r.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,t),this.moveInput.enableEventType(e,t),this.keyInput.enableEventType(e,t),this.contextmenuInput.enableEventType(e,t)}_addEventHandler(e,t,i,r,s){if("string"!=typeof e){i=t;for(const u in e)this._addEventHandler(u,e[u],i,r,s);return}const{manager:o,events:a}=this,l=t2[e]||e;let c=a.get(l);c||(c=new hoe(this),a.set(l,c),c.recognizerName=Use[l]||l,o&&o.on(l,c.handleEvent)),c.add(e,t,i,r,s),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,t){if("string"!=typeof e){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:i}=this,s=i.get(t2[e]||e);if(s&&(s.remove(e,t),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of i.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function Ua(){}const f2={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Ua,onResize:Ua,onViewStateChange:Ua,onInteractionStateChange:Ua,onBeforeRender:Ua,onAfterRender:Ua,onLoad:Ua,onError:n=>Ye.error(n.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:({isDragging:n})=>n?"grabbing":"grab",getTooltip:null,debug:!1,drawPickingColors:!1};class Vx{constructor(e){g(this,"props",void 0),g(this,"width",0),g(this,"height",0),g(this,"userData",{}),g(this,"canvas",null),g(this,"viewManager",null),g(this,"layerManager",null),g(this,"effectManager",null),g(this,"deckRenderer",null),g(this,"deckPicker",null),g(this,"eventManager",null),g(this,"tooltip",null),g(this,"metrics",void 0),g(this,"animationLoop",void 0),g(this,"stats",void 0),g(this,"viewState",void 0),g(this,"cursorState",void 0),g(this,"_needsRedraw",void 0),g(this,"_pickRequest",void 0),g(this,"_lastPointerDownInfo",null),g(this,"_metricsCounter",void 0),g(this,"_onPointerMove",t=>{const{_pickRequest:i}=this;if("pointerleave"===t.type)i.x=-1,i.y=-1,i.radius=0;else{if(t.leftButton||t.rightButton)return;{const r=t.offsetCenter;if(!r)return;i.x=r.x,i.y=r.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=t}),g(this,"_onEvent",t=>{const i=IL[t.type],r=t.offsetCenter;if(!i||!r||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:r.x,y:r.y,layers:s,viewports:this.getViewports(r)},this._lastPointerDownInfo),{layer:a}=o,l=a&&(a[i.handler]||a.props[i.handler]),c=this.props[i.handler];let u=!1;l&&(u=l.call(a,o,t)),!u&&c&&c(o,t)}),g(this,"_onPointerDown",t=>{const i=t.offsetCenter,r=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=r.result[0]||r.emptyInfo}),this.props=k(k({},f2),e),e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Ye.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===XF()&&Ye.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new gm({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Cc.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,t,i,r,s,o,a,l;this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(e=this.layerManager)||void 0===e||e.finalize(),this.layerManager=null,null===(t=this.viewManager)||void 0===t||t.finalize(),this.viewManager=null,null===(i=this.effectManager)||void 0===i||i.finalize(),this.effectManager=null,null===(r=this.deckRenderer)||void 0===r||r.finalize(),this.deckRenderer=null,null===(s=this.deckPicker)||void 0===s||s.finalize(),this.deckPicker=null,null===(o=this.eventManager)||void 0===o||o.destroy(),this.eventManager=null,null===(a=this.tooltip)||void 0===a||a.remove(),this.tooltip=null,this.props.canvas||this.props.gl||!this.canvas||(null===(l=this.canvas.parentElement)||void 0===l||l.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Ye.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Ye.removed("onLayerClick","onClick")(),e.initialViewState&&!za(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return t=t||i||r||s||o,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return null!==this.viewManager}getViews(){return jn(this.viewManager),this.viewManager.views}getViewports(e){return jn(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_pick(e,t,i){jn(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(t).timeStart();const s=this.deckPicker[e](k({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects()},i));return r.get(t).timeEnd(),s}_createCanvas(e){let t=e.canvas;return"string"==typeof t&&(t=document.getElementById(t),jn(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:i}=e;if(t||0===t){const s=Number.isFinite(t)?"".concat(t,"px"):t;this.canvas.style.width=s}if(i||0===i){var r;const s=Number.isFinite(i)?"".concat(i,"px"):i;this.canvas.style.position=(null===(r=e.style)||void 0===r?void 0:r.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const t=e.clientWidth||e.width,i=e.clientHeight||e.height;var r;t===this.width&&i===this.height||(this.width=t,this.height=i,null===(r=this.viewManager)||void 0===r||r.setProps({width:t,height:i}),this.props.onResize({width:t,height:i}))}_createAnimationLoop(e){const{width:t,height:i,gl:r,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:c,useDevicePixels:u}=e;return new Ose({width:t,height:i,useDevicePixels:u,autoResizeViewport:!1,gl:r,onCreateContext:d=>gR(X(k(k({},s),d),{canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()})),onInitialize:d=>this._setGLContext(d.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:c,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new PF({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:i,emptyInfo:r}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=i.length>0;let s=r,o=!1;for(const a of i){var t;s=a,o=(null===(t=a.layer)||void 0===t?void 0:t.onHover(a,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,$0(e,{enable:!0,copyState:!0})),this.tooltip=new Qre(this.canvas),fs(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const t=new _R;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new poe(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in IL)this.eventManager.on(r,this._onEvent);this.viewManager=new Hie({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new Uie(e,{deck:this,stats:this.stats,viewport:i,timeline:t}),this.effectManager=new Vre,this.deckRenderer=new Gre(e),this.deckPicker=new Xre(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{gl:i}=this.layerManager.context;fs(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers(k({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects()},t)),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),Ye.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState=X(k({},this.viewState),{[e.viewId]:t}),this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const i=Na.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}g(Vx,"defaultProps",f2),g(Vx,"VERSION",xse.VERSION);class zx extends Rw{constructor(e=0,t=0){super(2),gs(e)&&1===arguments.length?this.copy(e):(en.debug&&(Dt(e),Dt(t)),this[0]=e,this[1]=t)}set(e,t){return this[0]=e,this[1]=t,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this.check()}fromObject(e){return en.debug&&(Dt(e.x),Dt(e.y)),this[0]=e.x,this[1]=e.y,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return mL(this,this,e),this.check()}transformAsVector(e){return rL(this,this,e),this.check()}transformByMatrix3(e){return pL(this,this,e),this.check()}transformByMatrix2x3(e){return function Ree(n,e,t){var i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r+t[4],n[1]=t[1]*i+t[3]*r+t[5]}(this,this,e),this.check()}transformByMatrix2(e){return function Oee(n,e,t){var i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r}(this,this,e),this.check()}}const jx=85.05113;function p2(n,e,t,i){if(t){if(t.userData._googleMap===n)return t;Ux(t)}const r={click:null,dblclick:null,mousemove:null,mouseout:null},s=new Vx(X(k({},i),{useDevicePixels:!!i.interleaved||i.useDevicePixels,style:i.interleaved?null:{pointerEvents:"none"},parent:moe(e,i.style),initialViewState:{longitude:0,latitude:0,zoom:1},controller:!1}));for(const o in r)r[o]=n.addListener(o,a=>yoe(s,o,a));return s.userData._googleMap=n,s.userData._eventListeners=r,s}function moe(n,e){const t=document.createElement("div");var i,r;return t.style.position="absolute",Object.assign(t.style,e),"getPanes"in n?null===(i=n.getPanes())||void 0===i||i.overlayLayer.appendChild(t):null===(r=n.getMap())||void 0===r||r.getDiv().appendChild(t),t}function Ux(n){const{_eventListeners:e}=n.userData;for(const t in e)e[t]&&e[t].remove();n.finalize()}function m2(n,e){const{width:t,height:i}=g2(n),{center:r,heading:s,tilt:o,zoom:a}=e.getCameraParams(),c=i?t/i:1,h=(new zn).perspective({fovy:25*Math.PI/180,aspect:c,near:.75,far:3e14});return{width:t,height:i,viewState:{altitude:.5*h[5],bearing:s,latitude:r.lat(),longitude:r.lng(),pitch:o,projectionMatrix:h,repeat:!0,zoom:a-1}}}function g2(n){const e=n.getDiv().firstChild;return{width:e.offsetWidth,height:e.offsetHeight}}function Hx(n,e,t){const i=new google.maps.Point(e,t),r=n.fromContainerPixelToLatLng(i);return[r.lng(),r.lat()]}function _oe(n,e){if(n.pixel)return n.pixel;const t=e.getViewports()[0].project([n.latLng.lng(),n.latLng.lat()]);return{x:t[0],y:t[1]}}function yoe(n,e,t){const i={type:e,offsetCenter:_oe(t,n),srcEvent:t};switch(e){case"click":i.tapCount=1,n._onPointerDown(i),n._onEvent(i);break;case"dblclick":i.type="click",i.tapCount=2,n._onEvent(i);break;case"mousemove":i.type="pointermove",n._onPointerMove(i);break;case"mouseout":i.type="pointerleave",n._onPointerMove(i);break;default:return}}const voe=()=>!1,boe={depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],blendEquation:32774};function _2(){}const woe={interleaved:!0};class xoe{constructor(e){g(this,"props",{}),g(this,"_map",null),g(this,"_deck",null),g(this,"_overlay",null),this.setProps(k(k({},woe),e))}setMap(e){var t;if(e!==this._map&&(this._map&&(null===(t=this._overlay)||void 0===t||t.setMap(null),this._map=null),e)){this._map=e;const{UNINITIALIZED:i}=google.maps.RenderingType;e.getRenderingType()!==i?this._createOverlay(e):e.addListener("renderingtype_changed",()=>{this._createOverlay(e)})}}setProps(e){Object.assign(this.props,e),this._deck&&(e.style&&(Object.assign(this._deck.canvas.parentElement.style,e.style),e.style=null),this._deck.setProps(e))}pickObject(e){return this._deck&&this._deck.pickObject(e)}pickMultipleObjects(e){return this._deck&&this._deck.pickMultipleObjects(e)}pickObjects(e){return this._deck&&this._deck.pickObjects(e)}finalize(){this.setMap(null),this._deck&&(Ux(this._deck),this._deck=null)}_createOverlay(e){const{interleaved:t}=this.props,{VECTOR:i,UNINITIALIZED:r}=google.maps.RenderingType,s=e.getRenderingType();if(s===r)return;const l=new(s===i&&google.maps.WebGLOverlayView?google.maps.WebGLOverlayView:google.maps.OverlayView);l instanceof google.maps.WebGLOverlayView?(t?(l.onAdd=_2,l.onContextRestored=this._onContextRestored.bind(this),l.onDraw=this._onDrawVectorInterleaved.bind(this)):(l.onAdd=this._onAdd.bind(this),l.onContextRestored=_2,l.onDraw=this._onDrawVectorOverlay.bind(this)),l.onContextLost=this._onContextLost.bind(this)):(l.onAdd=this._onAdd.bind(this),l.draw=this._onDrawRaster.bind(this)),l.onRemove=this._onRemove.bind(this),this._overlay=l,this._overlay.setMap(e)}_onAdd(){this._deck=p2(this._map,this._overlay,this._deck,this.props)}_onContextRestored({gl:e}){if(!this._map||!this._overlay)return;const i=p2(this._map,this._overlay,this._deck,k({gl:e,_customRender:()=>{this._overlay&&this._overlay.requestRedraw()}},this.props));this._deck=i;const{animationLoop:r}=i;r._renderFrame=()=>{const s=e.getParameter(34964);Ii(e,{},()=>{r.onRender()}),e.bindBuffer(34962,s)}}_onContextLost(){this._deck&&(Ux(this._deck),this._deck=null)}_onRemove(){var e;null===(e=this._deck)||void 0===e||e.setProps({layerFilter:voe})}_onDrawRaster(){if(!this._deck||!this._map)return;const e=this._deck,c=function goe(n,e){const{width:t,height:i}=g2(n),r=e.getProjection(),s=n.getBounds();if(!s)return{width:t,height:i,left:0,top:0};const o=s.getNorthEast(),a=s.getSouthWest(),l=r.fromLatLngToDivPixel(o),c=r.fromLatLngToDivPixel(a),u=Hx(r,t/2,i/2),d=new google.maps.LatLng(0,u[0]),h=r.fromLatLngToContainerPixel(d),f=r.fromLatLngToDivPixel(d);if(!(l&&c&&f&&h))return{width:t,height:i,left:0,top:0};const p=Math.round(f.x-h.x);let m=f.y-h.y;const _=Hx(r,t/2,0),y=Hx(r,t/2,i);let v=u[1];const E=u[0];if(Math.abs(v)>jx){v=v>0?jx:-jx;const Y=new google.maps.LatLng(v,E);m+=r.fromLatLngToContainerPixel(Y).y-i/2}m=Math.round(m);let R=180*new zx(_).sub(y).verticalAngle()/Math.PI;R<0&&(R+=360);const B=n.getHeading()||0;let Z,V=n.getZoom()-1;if(0===R)Z=i?(c.y-l.y)/i:1;else if(R===B){const Y=new zx([l.x,l.y]).sub([c.x,c.y]).len(),$=new zx([t,-i]).len();Z=$?Y/$:1}return V+=Math.log2(Z||1),{width:t,height:i,left:p,top:m,zoom:V,bearing:R,pitch:n.getTilt(),latitude:v,longitude:E}}(this._map,this._overlay),{width:t,height:i,left:r,top:s}=c,o=XC(c,["width","height","left","top"]),a=e.canvas.parentElement.style;a.left="".concat(r,"px"),a.top="".concat(s,"px"),e.setProps({width:t,height:i,viewState:k({altitude:1e4,repeat:!0},o)}),e.redraw()}_onDrawVectorInterleaved({gl:e,transformer:t}){if(!this._deck||!this._map)return;const i=this._deck;if(i.setProps(X(k({},m2(this._map,t)),{width:null,height:null})),i.isInitialized){const r=hR(e,36006);i.setProps({_framebuffer:r}),i.needsRedraw({clearRedrawFlags:!0}),fs(e,{viewport:[0,0,e.canvas.width,e.canvas.height],scissor:[0,0,e.canvas.width,e.canvas.height],stencilFunc:[519,0,255,519,0,255]}),Ii(e,boe,()=>{i._drawLayers("google-vector",{clearCanvas:!1})})}}_onDrawVectorOverlay({transformer:e}){if(!this._deck||!this._map)return;const t=this._deck;t.setProps(k({},m2(this._map,e))),t.redraw()}}class Gx{constructor(e,t){g(this,"opts",void 0),g(this,"source",void 0),this.opts=t,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),t=this.getAccessor();if(e)return[e,t];const{value:i}=this.source,{size:r}=t;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const o=t.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[o+a]}return s}getAccessor(){return k(k({},this.source.getAccessor()),this.opts)}}function Zm(n){return n.stride||n.size*n.bytesPerElement}function y2(n,e){e.offset&&Ye.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=Zm(n),s=(void 0!==e.vertexOffset?e.vertexOffset:n.vertexOffset||0)*t+(e.elementOffset||0)*n.bytesPerElement+(n.offset||0);return X(k({},e),{offset:s,stride:t})}const v2=[],b2=[];function Xm(n,e=0,t=1/0){let i=v2;const r={index:-1,data:n,target:[]};return n?"function"==typeof n[Symbol.iterator]?i=n:n.length>0&&(b2.length=n.length,i=b2):i=v2,(e>0||Number.isFinite(t))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,t),r.index=e-1),{iterable:i,objectInfo:r}}function w2(n){return n&&n[Symbol.asyncIterator]}function x2(n,e){const{size:t,stride:i,offset:r,startIndices:s,nested:o}=e,a=n.BYTES_PER_ELEMENT,l=i?i/a:t,c=r?r/a:0,u=Math.floor((n.length-c)/l);return(d,{index:h,target:f})=>{if(!s){const y=h*l+c;for(let v=0;v<t;v++)f[v]=n[y+v];return f}const p=s[h],m=s[h+1]||u;let _;if(o){_=new Array(m-p);for(let y=p;y<m;y++){const v=y*l+c;f=new Array(t);for(let E=0;E<t;E++)f[E]=n[v+E];_[y-p]=f}}else if(l===t)_=n.subarray(p*t+c,m*t+c);else{_=new n.constructor((m-p)*t);let y=0;for(let v=p;v<m;v++){const E=v*l+c;for(let M=0;M<t;M++)_[y++]=n[E+M]}}return _}}const Toe=[],Km=[[0,1/0]];function Wx(n){const{source:e,target:t,start:i=0,size:r,getData:s}=n,a=e.length,l=(n.end||t.length)-i;if(a>l)return void t.set(e.subarray(0,l),i);if(t.set(e,i),!s)return;let c=a;for(;c<l;){const u=s(c,e);for(let d=0;d<r;d++)t[i+c]=u[d]||0,c++}}const Doe={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function C2(n,e){if(!n)return null;Number.isFinite(n)&&(n={type:"interpolation",duration:n});const t=n.type||"interpolation";return X(k(k(k({},Doe[t]),e),n),{type:t})}function E2(n,e){const t=e.getBuffer();return t?[t,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function M2(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(n,'"'))}}function T2(n){n.push(n.shift())}function qx(n,e){const{doublePrecision:t,settings:i,value:r,size:s}=n,o=t&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*o}function S2({buffer:n,numInstances:e,attribute:t,fromLength:i,fromStartIndices:r,getData:s=(o=>o)}){const o=t.doublePrecision&&t.value instanceof Float64Array?2:1,a=t.size*o,l=t.byteOffset,c=t.startIndices,u=r&&c,d=qx(t,e),h=t.isConstant;if(!u&&i>=d)return;const f=h?t.value:t.getBuffer().getData({srcByteOffset:l});if(t.settings.normalized&&!h){const y=s;s=(v,E)=>t.normalizeConstant(y(v,E))}const p=h?(y,v)=>s(f,v):(y,v)=>s(f.subarray(y,y+a),v),m=n.getData({length:i}),_=new Float32Array(d);(function Aoe({source:n,target:e,size:t,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return Wx({source:n,target:e,size:t,getData:i}),e;let o=0,a=0;const l=i&&((u,d)=>i(u+a,d)),c=Math.min(r.length,s.length);for(let u=1;u<c;u++){const d=r[u]*t,h=s[u]*t;Wx({source:n.subarray(o,d),target:e,start:a,end:h,size:t,getData:l}),o=d,a=h}a<e.length&&Wx({source:[],target:e,start:a,size:t,getData:l})})({source:m,target:_,sourceStartIndices:r,targetStartIndices:c,size:a,getData:p}),n.byteLength<_.byteLength+l&&n.reallocate(_.byteLength+l),n.subData({data:_,offset:l})}class $x extends class Moe{constructor(e,t,i){g(this,"gl",void 0),g(this,"id",void 0),g(this,"size",void 0),g(this,"settings",void 0),g(this,"value",void 0),g(this,"doublePrecision",void 0),g(this,"_buffer",void 0),g(this,"state",void 0),this.gl=e,this.id=t.id||"",this.size=t.size||1;const r=t.logicalType||t.type,s=5130===r;let a,{defaultValue:o}=t;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0),a=s?5126:!r&&t.isIndexed?e&&function Ene(n,e){return px(n,e)}(e,"ELEMENT_INDEX_UINT32")?5125:5123:r||5126;let l=function Coe(n){switch(n){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(r||a||5126);this.doublePrecision=s,s&&!1===t.fp64&&(l=Float32Array),this.value=null,this.settings=X(k({},t),{defaultType:l,defaultValue:o,logicalType:r,type:a,size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT}),this.state=X(k({},i),{externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}),this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:t}=this.settings;this._buffer=new Rt(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:t}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Zm(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Cc.release(this.state.allocatedValue)}getShaderAttributes(e,t){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=function Eoe(n,e){const t=y2(n,e);return{high:t,low:X(k({},t),{offset:t.offset+4*n.size})}}(this.getAccessor(),t||{});return i[e]=new Gx(this,s.high),i["".concat(e,"64Low")]=r?new Gx(this,s.low):new Float32Array(this.size),i}if(t){const i=y2(this.getAccessor(),t);return{[e]:new Gx(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:i,size:r}=this,s=i*r;if(t&&s&&t.length>=s){const o=new Array(r).fill(1/0),a=new Array(r).fill(-1/0);for(let l=0;l<s;)for(let c=0;c<r;c++){const u=t[l++];u<o[c]&&(o[c]=u),u>a[c]&&(a[c]=u)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let i;i=ArrayBuffer.isView(e)?{value:e}:e instanceof Rt?{buffer:e}:e;const r=k(k({},this.settings),i);if(t.bufferAccessor=r,t.bounds=null,i.constant){let s=i.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),t.constant&&this._areValuesEqual(s,this.value))return!1;t.externalBuffer=null,t.constant=!0,this.value=s}else if(i.buffer){const s=i.buffer;t.externalBuffer=s,t.constant=!1,this.value=i.value||null;const o=i.value instanceof Float64Array;r.type=i.type||s.accessor.type,r.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(o?2:1),r.stride=Zm(r)}else if(i.value){this._checkExternalBuffer(i);let s=i.value;t.externalBuffer=null,t.constant=!1,this.value=s,r.bytesPerElement=s.BYTES_PER_ELEMENT,r.stride=Zm(r);const{buffer:o,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=Bw(s,r));const l=s.byteLength+a+2*r.stride;o.byteLength<l&&o.reallocate(l),o.setAccessor(null),o.subData({data:s,offset:a}),r.type=i.type||o.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const t=this.value,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&t instanceof Float64Array?Bw(t,{size:this.size,startIndex:i,endIndex:r}):t.subarray(i,r),offset:i*t.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,t=!1){const{state:i}=this,r=i.allocatedValue,s=Cc.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),t&&r&&o.subData({data:r instanceof Float64Array?Bw(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const i=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=t.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(t.constructor.name));!(t instanceof i)&&this.settings.normalized&&!("normalized"in e)&&Ye.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(t=>(t+128)/255*2-1);case 5122:return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case 5121:return new Float32Array(e).map(t=>t/255);case 5123:return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return t[i]=e,t;if(!e)return t[i]=r[0],t;switch(s){case 4:t[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:t[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:t[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:t[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let o=s;for(;--o>=0;)t[i+o]=Number.isFinite(e[o])?e[o]:r[o]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==t[r])return!1;return!0}}{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:Km}),g(this,"constant",!1),this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat("function"!=typeof e&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,i=this.settings.transition;return C2(Array.isArray(t)?e[t.find(s=>e[s])]:e[t],i)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:i=0,endRow:r=1/0}=t;this.state.updateRanges=function Soe(n,e){if(n===Km||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],i=n.length;let r=0;for(let s=0;s<i;s++){const o=n[s];o[1]<e[0]?(t.push(o),r=s+1):o[0]>e[1]?t.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return t.splice(r,0,e),t}(this.state.updateRanges,[i,r])}else this.state.updateRanges=Km}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Toe}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:i}=this;return!i.noAlloc&&!!i.update&&(super.allocate(e,t.updateRanges!==Km),!0)}updateBuffer({numInstances:e,data:t,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,u]of s)o.call(r,this,{data:t,startRow:c,endRow:u,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[c,u]of s){const d=Number.isFinite(c)?this.getVertexOffset(c):0,h=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:d,endOffset:h})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return void 0!==e&&"function"!=typeof e&&(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:i,settings:r}=this;if(!e)return i.binaryValue=null,i.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(i.binaryValue===e)return this.clearNeedsUpdate(),!0;if(i.binaryValue=e,this.setNeedsRedraw(),r.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;jn(ArrayBuffer.isView(o.value),"invalid ".concat(r.accessor));const a=Boolean(o.size)&&o.size!==this.size;return i.binaryAccessor=x2(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:t,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?t[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},t={};for(const i in e)Object.assign(t,super.getShaderAttributes(i,e[i]));return t}_autoUpdater(e,{data:t,startRow:i,endRow:r,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:d}=e,{accessor:h,transform:f}=a,p=l.binaryAccessor||("function"==typeof h?h:s[h]);jn("function"==typeof p,'accessor "'.concat(h,'" is not a function'));let m=e.getVertexOffset(i);const{iterable:_,objectInfo:y}=Xm(t,i,r);for(const v of _){y.index++;let E=p(v,y);if(f&&(E=f.call(this,E)),d){const M=(y.index<d.length-1?d[y.index+1]:o)-d[y.index];if(E&&Array.isArray(E[0])){let R=m;for(const B of E)e._normalizeValue(B,c,R),R+=u}else E&&E.length>u?c.set(E,m):(e._normalizeValue(E,y.target,0),MQ({target:c,source:y.target,start:m,count:M}));m+=M*u}else e._normalizeValue(E,c,m),m+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!e.noAlloc&&"function"!=typeof e.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let i=!0;switch(t){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}const Ioe="void main() {gl_FragColor = vec4(0);}",A2="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",Poe="#version 300 es\n".concat(A2);function D2(n,e){e=Array.isArray(e)?e:[e];const t=n.replace(/^\s+/,"").split(/\s+/),[i,r,s]=t;return e.includes(i)&&r&&s?{qualifier:i,type:r,name:s.split(";")[0]}:null}function I2(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{version:e=100,input:t,inputType:i,output:r}=n;if(!t)return 300===e?Poe:e>300?"#version ".concat(e,"\n").concat(A2):Ioe;const s=Roe(t,i);return e>=300?"#version ".concat(e," ").concat(300===e?"es":"","\nin ").concat(i," ").concat(t,";\nout vec4 ").concat(r,";\nvoid main() {\n  ").concat(r," = ").concat(s,";\n}"):"varying ".concat(i," ").concat(t,";\nvoid main() {\n  gl_FragColor = ").concat(s,";\n}")}function Roe(n,e){switch(e){case"float":return"vec4(".concat(n,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(n,", 0.0, 1.0)");case"vec3":return"vec4(".concat(n,", 1.0)");case"vec4":return n;default:return Yi(!1),null}}class P2 extends eo{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return lt(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ni(e),super(e,t),this.initialize(t),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Ic(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])}),this}setBuffer(e,t){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:o}=this._getBufferParams(t);return i<0?(this.unused[e]=r,ge.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[i]=t,this.bindOnUse||this._bindBuffer(i,r,o,s),this)}begin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let t,i,r;return e instanceof Rt?r=e:(r=e.buffer,i=e.byteSize,t=e.byteOffset),(void 0!==t||void 0!==i)&&(t=t||0,i=i||r.byteLength-t),{buffer:r,byteOffset:t,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const t=Number(e);return Number.isFinite(t)?t:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:t,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,t,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,t){let r=arguments.length>3?arguments[3]:void 0;const s=t&&t.handle;return s&&void 0!==r?this.gl.bindBufferRange(35982,e,s,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r):this.gl.bindBufferBase(35982,e,s),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}class Loe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}setupResources(e){for(const t of this.bindings)this._setupTransformFeedback(t,e)}updateModelProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyings:t}=this;return t.length>0&&(e=Object.assign({},e,{varyings:t})),e}getDrawOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=t;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(){this._setupBuffers(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}getBuffer(e){const{feedbackBuffers:t}=this.bindings[this.currentIndex],i=e?t[e]:null;return i?i instanceof Rt?i:i.buffer:null}getData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyingName:t}=e,i=this.getBuffer(t);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&oe(lt(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:t={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const s=this.feedbackMap[r];r in t&&(i[s]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if("string"==typeof s){const o=t[s],{byteLength:a,usage:l,accessor:c}=o;i[r]=this._createNewBuffer(r,{byteLength:a,usage:l,accessor:c})}}return i}_setupBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:t,feedbackBuffers:i})}_setupTransformFeedback(e,t){let{model:i}=t;const{program:r}=i;e.transformFeedback=new P2(this.gl,{program:r,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:t,feedbackBuffers:i})}}_updateBinding(e,t){return e?(Object.assign(e.sourceBuffers,t.sourceBuffers),Object.assign(e.feedbackBuffers,t.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},t.sourceBuffers),feedbackBuffers:Object.assign({},t.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const t=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];t[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],oe(i[s]instanceof Rt)}return{sourceBuffers:t,feedbackBuffers:i}}_createNewBuffer(e,t){const i=new Rt(this.gl,t);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}function k2(n){let e=100;const t=n.match(/[^\s]+/g);if(t.length>=2&&"#version"===t[0]){const i=parseInt(t[1],10);Number.isFinite(i)&&(e=i)}return e}const Foe={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},Qm="transform_uSize_",O2="transform_position";const Goe={10241:9728,10240:9728,10242:33071,10243:33071};class qoe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(t),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this._processVertexShader(e);return Object.assign({},e,t)}getDrawOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},t,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let c=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const d in this.samplerTextureMap)a[d]=i[this.samplerTextureMap[d]];this._setSourceTextureParameters();const u=function Voe(n){let{sourceTextureMap:e,targetTextureVarying:t,targetTexture:i}=n;const r={};let s,o;t&&(({width:s,height:o}=i),r["".concat(Qm).concat(t)]=[s,o]);for(const a in e)({width:s,height:o}=e[a]),r["".concat(Qm).concat(a)]=[s,o];return r}({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,u)}return this.hasTargetTexture&&(c=!1,l.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:a,discard:c,parameters:l}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(){this._setupTextures(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{framebuffer:t}=this.bindings[this.currentIndex],i=Nm(t);if(!e)return i;const r=i.constructor,s=function Ooe(n){switch(n){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Yi(!1),null}}(this.targetTextureType),o=new r(i.length*s/4);let a=0;for(let l=0;l<i.length;l+=4)for(let c=0;c<s;c++)o[a++]=i[l+c];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{_targetTextureVarying:t,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=t,this.hasTargetTexture=t,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:t,textureOrReference:i}=e;if(i instanceof gi)return i;const r=t[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:t,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:t,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if("number"!=typeof e||this.elementCount>=e)return;const t=new Float32Array(e);t.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:t}):this.elementIDBuffer=new Rt(this.gl,{data:t,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:t,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:t,targetTexture:i})}}_updateBinding(e,t){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=t;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{36064:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new En(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:t}=this.bindings[e];for(const i in t)t[i].setParameters(Goe)}_swapTextures(e){if(!this._swapTexture)return null;const t=Object.assign({},e.sourceTextures);return t[this._swapTexture]=e.targetTexture,{sourceTextures:t,targetTexture:e.sourceTextures[this._swapTexture]}}_createNewTexture(e){const t=function yne(n,e){oe(n instanceof gi||n instanceof gne||n instanceof _ne);const t=n.constructor,{gl:i,width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u}=n;return new t(i,Object.assign({width:r,height:s,format:o,type:a,dataFormat:l,border:c,mipmaps:u},e))}(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=t,t}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceTextures:t,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=function Boe(n){let{vs:e,sourceTextureMap:t,targetTextureVarying:i,targetTexture:r}=n,o=Object.keys(t).length,a=null;const l={};let c=e,u={};if(o>0||i){const d=c.split("\n"),h=d.slice();if(d.forEach((f,p,m)=>{if(o>0){const _=function Hoe(n,e){const t={},i=function zoe(n){return D2(n,["attribute","in"])}(n);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const o="// ".concat(n," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:l,uniformDeclerations:c}=function joe(n){const e="".concat("transform_uSampler_").concat(n),t="".concat(Qm).concat(n);return{samplerName:e,sizeName:t,uniformDeclerations:"  uniform sampler2D ".concat(e,";\n  uniform vec2 ").concat(t,";")}}(s),u=function koe(n){switch(n){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Yi(!1),null}}(r),d="  ".concat(r," ").concat(s," = transform_getInput(").concat(a,", ").concat(l,").").concat(u,";\n");return t[a]=s,{updatedLine:o,inject:{"vs:#decl":c,"vs:#main-start":d},samplerTextureMap:t}}return null}(f,t);if(_){const{updatedLine:y,inject:v}=_;h[p]=y,u=nx([u,v]),Object.assign(l,_.samplerTextureMap),o--}}i&&!a&&(a=function Uoe(n,e){const t=D2(n,["varying","out"]);return t&&t.name===e?t.type:null}(f,i))}),i){oe(r);const f="".concat(Qm).concat(i),p="uniform vec2 ".concat(f,";\n"),m="     vec2 ".concat(O2," = transform_getPos(").concat(f,");\n     gl_Position = vec4(").concat(O2,", 0, 1.);\n");u=nx([u,{"vs:#decl":p,"vs:#main-start":m}])}c=h.join("\n")}return{vs:c,targetTextureType:a,inject:u,samplerTextureMap:l}}({vs:e.vs,sourceTextureMap:t,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),c=nx([e.inject||{},a]);return this.targetTextureType=o,this.samplerTextureMap=l,{vs:r,fs:e._fs||I2({version:k2(r),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[Foe].concat(e.modules||[]):e.modules,uniforms:s,inject:c}}}let Jm=null;class Ki extends eo{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero||lt(e)||"Chrome"===XF()}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Ki(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Ki.MAX_ATTRIBUTES=Ki.MAX_ATTRIBUTES||e.getParameter(34921),Ki.MAX_ATTRIBUTES}static setConstant(e,t,i){switch(i.constructor){case Float32Array:Ki._setConstantFloatArray(e,t,i);break;case Int32Array:Ki._setConstantIntArray(e,t,i);break;case Uint32Array:Ki._setConstantUintArray(e,t,i);break;default:oe(!1)}}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,Object.assign({},t,{id:t.id||t.program&&t.program.id})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=t.isDefaultArray||!1,this.gl2=e,this.initialize(t),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Ki.getMaxAttributes(this.gl)}initialize(){return this.setProps(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return oe(!e||34963===e.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,t,i){if(34963===t.target)return this.setElementBuffer(t,i);const{size:r,type:s,stride:o,offset:a,normalized:l,integer:c,divisor:u}=i,{gl:d,gl2:h}=this;return e=Number(e),this.bind(()=>{d.bindBuffer(34962,t.handle),c?(oe(lt(d)),h.vertexAttribIPointer(e,r,s,o,a)):d.vertexAttribPointer(e,r,s,l,o,a),d.enableVertexAttribArray(e),h.vertexAttribDivisor(e,u||0)}),this}enable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!t&&0===e&&!Ki.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>t?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,t){const i=this._normalizeConstantArrayValue(t),r=i.byteLength*e,s=i.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new Rt(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(i,this.bufferValue),o){const a=function Yoe(n,e){const t=function $oe(n){return(!Jm||Jm.byteLength<n)&&(Jm=new ArrayBuffer(n)),Jm}(n.BYTES_PER_ELEMENT*e);return new n(t,0,e)}(t.constructor,s);(function Zoe(n){let{target:e,source:t,start:i=0,count:r=1}=n;const s=t.length,o=r*s;let a=0;for(let l=i;a<s;a++)e[l++]=t[a];for(;a<o;)a<o-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+o-a),a=o)})({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=t}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}static _setConstantFloatArray(e,t,i){switch(i.length){case 1:e.vertexAttrib1fv(t,i);break;case 2:e.vertexAttrib2fv(t,i);break;case 3:e.vertexAttrib3fv(t,i);break;case 4:e.vertexAttrib4fv(t,i);break;default:oe(!1)}}static _setConstantIntArray(e,t,i){switch(oe(lt(e)),i.length){case 1:e.vertexAttribI1iv(t,i);break;case 2:e.vertexAttribI2iv(t,i);break;case 3:e.vertexAttribI3iv(t,i);break;case 4:e.vertexAttribI4iv(t,i);break;default:oe(!1)}}static _setConstantUintArray(e,t,i){switch(oe(lt(e)),i.length){case 1:e.vertexAttribI1uiv(t,i);break;case 2:e.vertexAttribI2uiv(t,i);break;case 3:e.vertexAttribI3uiv(t,i);break;case 4:e.vertexAttribI4uiv(t,i);break;default:oe(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,t){let{location:i}=t;return oe(Number.isFinite(i)),this.bind(()=>34373===e?this.gl.getVertexAttribOffset(i,e):this.gl.getVertexAttrib(i,e))}}const Qoe=/^(.+)__LOCATION_([0-9]+)$/,Joe=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class eae{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.id=t.id||t.program&&t.program.id,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Ki(e),WL(this,"VertexArray","v6.0",Joe),this.initialize(t),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const t in e)this._setAttribute(t,e[t]);this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=e,this.elementsAccessor=t,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,t),this}setBuffer(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===t.target)return this.setElementBuffer(t,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,t.accessor,i);return r>=0&&(this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,t,s)),this}setConstant(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,t,Object.assign({size:t.length},i));return r>=0&&(t=this.vertexArrayObject._normalizeConstantArrayValue(t),this.values[r]=t,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new Rt(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof Rt&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const t=this.values[e];t instanceof Rt&&this.setBuffer(e,t)}}),this}bindForDraw(e,t,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,t),r=i()}),r}_resolveLocationAndAccessor(e,t,i,r){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=t,ge.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const u=Zi.resolve(l.accessor,this.accessors[o]||{},i,r),{size:d,type:h}=u;return oe(Number.isFinite(d)&&Number.isFinite(h)),{location:o,accessor:u}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const t=Number(e);if(Number.isFinite(t))return{location:t};const i=Qoe.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,t){if(t instanceof Rt)this.setBuffer(e,t);else if(Array.isArray(t)&&t.length&&t[0]instanceof Rt)this.setBuffer(e,t[0],t[1]);else if(ArrayBuffer.isView(t)||Array.isArray(t))this.setConstant(e,t);else{if(!(t.buffer instanceof Rt))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");this.setBuffer(e,t.buffer,t)}}_setConstantAttributes(e,t){const i=Math.max(0|e,0|t);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,t){if(Ki.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,e);const i=this.vertexArrayObject.getConstantBuffer(t,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,t){Ki.setConstant(this.gl,e,t)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this._updateDrawParamsForLocation(e,t);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,t){const i=this.values[t],r=this.accessors[t];if(!i)return;const{divisor:s}=r,o=s>0;if(e.isInstanced=e.isInstanced||o,i instanceof Rt){const a=i;if(o){const l=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ge.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,t)}}function tae(n,e){const{maxElts:t=16,size:i=1}=e;let r="[";for(let o=0;o<n.length&&o<t;++o)o>0&&(r+=",".concat(o%i==0?" ":"")),r+=nh(n[o],e);const s=n.length>t?"...":"]";return"".concat(r).concat(s)}function nh(n){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const t=1e-16,{isInteger:i=!1}=e;if(Array.isArray(n)||ArrayBuffer.isView(n))return tae(n,e);if(!Number.isFinite(n))return String(n);if(Math.abs(n)<t)return i?"0":"0.";if(i||Math.abs(n)>100&&Math.abs(n)<1e4)return n.toFixed(0);const r=n.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function R2(n,e,t,i){const{gl:r}=n;if(!e)return{[i]:"null","Format ":"N/A"};let c,u,d,s="NOT PROVIDED",o=1,a=0,l=0;if(t&&(s=t.type,o=t.size,s=String(s).replace("Array",""),c=-1!==s.indexOf("nt")),e instanceof Rt){const h=e,{data:f,changed:p}=h.getDebugData();let m;return u=p?"*":"",d=f,l=h.byteLength,a=l/f.BYTES_PER_ELEMENT/o,t?m="".concat(t.divisor>0?"I ":"P "," ").concat(a," (x").concat(o,"=").concat(l," bytes ").concat(zo(r,s),")"):(c=!0,m="".concat(l," bytes")),{[i]:"".concat(u).concat(nh(d,{size:o,isInteger:c})),"Format ":m}}return d=e,o=e.length,s=String(e.constructor.name).replace("Array",""),c=-1!==s.indexOf("nt"),{[i]:"".concat(nh(d,{size:o,isInteger:c})," (constant)"),"Format ":"".concat(o,"x").concat(s," (constant)")}}function iae(n,e){const{type:t,size:i}=e,r=_F(t,i);return r?"".concat(n," (").concat(r.name,")"):n}function L2(n){let{header:e="Uniforms",program:t,uniforms:i,undefinedOnly:r=!1}=n;oe(t);const o=".*Matrix",l={},c=Object.keys(t._uniformSetters).sort();let u=0;for(const f of c)!f.match(".*_.*")&&!f.match(o)&&Yx({table:l,header:e,uniforms:i,uniformName:f,undefinedOnly:r})&&u++;for(const f of c)f.match(o)&&Yx({table:l,header:e,uniforms:i,uniformName:f,undefinedOnly:r})&&u++;for(const f of c)l[f]||Yx({table:l,header:e,uniforms:i,uniformName:f,undefinedOnly:r})&&u++;let d=0;const h={};if(!r)for(const f in i){const p=i[f];l[f]||(d++,h[f]={Type:"NOT USED: ".concat(p),[e]:nh(p)})}return{table:l,count:u,unusedTable:h,unusedCount:d}}function Yx(n){let{table:e,header:t,uniforms:i,uniformName:r,undefinedOnly:s}=n;const o=i[r],a=function rae(n){return null!=n}(o);return!(s&&a||(e[r]={[t]:a?nh(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},0))}function F2(n){const{type:e,size:t}=n.accessor,i=_F(e,t);return i?"".concat(i.name," ").concat(n.name):n.name}const oae={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function lae(n,e){const{attributeMap:t=oae}=e||{};return t&&t[n]||n}function cae(n,e){let t;switch(n){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":t="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":t="vectors"}switch(t){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}oe(Number.isFinite(e.size),"attribute ".concat(n," needs size"))}const N2=()=>{},hae={};class qo{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{id:i=jo("model")}=t;oe(hm(e)),this.id=i,this.gl=e,this.id=t.id||jo("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(t)}initialize(e){this.props={},this.programManager=e.programManager||Xd.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:t=null,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=void 0!==e.drawMode?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},oe(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=e;this.programProps={program:t,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:l,bufferMode:c,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return oe(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return oe(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function aae(n,e,t){const i={};let r=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=lae(s,t);if("indices"===s)r=o;else if(o.constant)i[a]=o.value;else{const l=o.value,c=k({},o);delete c.value,i[a]=[new Rt(n,l),c],cae(s,c)}}if(r){const s=r.value||r;oe(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new Rt(n,{data:s,target:34963}),o]}return i}(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Ic(e))return this;const t={};for(const i in e){const r=e[i];t[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(t),this}setUniforms(){return Object.assign(this.uniforms,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this}getModuleUniforms(e){this._checkProgram();const t=this.programManager.getUniforms(this.program);return t?t(e):{}}updateModuleSettings(e){const t=this.getModuleUniforms(e||{});return this.setUniforms(t)}clear(e){return dx(this.program.gl,e),this}draw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._checkProgram();const{moduleSettings:t=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;let c;this.setAttributes(s),this.updateModuleSettings(t),this.setUniforms(r),ge.priority>=2&&(c=this._logDrawCallStart(2));const u=this.vertexArray.getDrawParams(),{isIndexed:d=u.isIndexed,indexType:h=u.indexType,indexOffset:f=u.indexOffset,vertexArrayInstanced:p=u.isInstanced}=this.props;p&&!this.isInstanced&&ge.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:m,instanceCount:_}=this,{onBeforeRender:y=N2,onAfterRender:v=N2}=this.props;y(),this.program.setUniforms(this.uniforms);const E=this.program.draw(Object.assign(hae,e,{logPriority:c,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:d,indexType:h,isInstanced:m,instanceCount:_,offset:d?f:0}));return v(),ge.priority>=2&&this._logDrawCallEnd(c,l,i),E}transform(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{discard:t=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),t&&(s=Object.assign({},s,{35977:t})),r.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(o=>o.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ge.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}=this.programProps;t=this.programManager.get({vs:i,fs:r,modules:s,inject:o,defines:a,varyings:l,bufferMode:c,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}oe(t instanceof vF,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new eae(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const t=this.geometryBuffers[e][0]||this.geometryBuffers[e];t instanceof Rt&&t.delete()}}_setAnimationProps(e){this.animated&&oe(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Ic(e))return this;const{gl:t}=this.program;return this.transformFeedback=this.transformFeedback||new P2(t,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const t=e>3?0:1e4;if(!(Date.now()-this.lastLogTime<t))return this.lastLogTime=Date.now(),ge.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:ge.level<=2})(),e}_logDrawCallEnd(e,t,i,r){if(void 0===e)return;const s=function nae(n){let{vertexArray:e,header:t="Attributes"}=n;if(!e.configuration)return{};const i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=R2(e,e.elements,null,t));const r=e.values;for(const s in r){const o=e._getAttributeInfo(s);if(o){let a="".concat(s,": ").concat(o.name);const l=e.accessors[o.location];l&&(a="".concat(s,": ").concat(iae(o.name,l))),i[a]=R2(e,r[s],l,t)}}return i}({vertexArray:t,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=L2({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:c,count:u}=L2({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});u>0&&ge.log("MISSING UNIFORMS",Object.keys(c))(),l>0&&ge.log("UNUSED UNIFORMS",Object.keys(a))();const d=function sae(n){const e={},t="Accessors for ".concat(n.id);for(const i of n.attributeInfos)if(i){const r=F2(i);e["in ".concat(r)]={[t]:JSON.stringify(i.accessor)}}for(const i of n.varyingInfos)if(i){const r=F2(i);e["out ".concat(r)]={[t]:JSON.stringify(i.accessor)}}return e}(this.vertexArray.configuration);ge.table(e,s)(),ge.table(e,o)(),ge.table(e+1,d)(),r&&r.log({logLevel:2,message:"Rendered to ".concat(r.id)}),ge.groupEnd(2)()}}class Zx{static isSupported(e){return lt(e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(t),Object.seal(this)}delete(){const{model:e,bufferTransform:t,textureTransform:i}=this;e&&e.delete(),t&&t.delete(),i&&i.delete()}run(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{clearRenderTarget:t=!0}=e,i=this._updateDrawOptions(e);t&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)e=e||i.swap();oe(e,"Nothing to swap")}getBuffer(){return this.bufferTransform&&this.bufferTransform.getBuffer(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)}getData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const t=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of t)i.update(e)}_initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{gl:t}=this;this._buildResourceTransforms(t,e),e=this._updateModelProps(e),this.model=new qo(t,Object.assign({},e,{fs:e.fs||I2({version:k2(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=r.updateModelProps(t);return t}_buildResourceTransforms(e,t){(function fae(n){return!(Ic(n.feedbackBuffers)&&Ic(n.feedbackMap)&&!(n.varyings&&n.varyings.length>0))})(t)&&(this.bufferTransform=new Loe(e,t)),function pae(n){return!(Ic(n._sourceTextures)&&!n._targetTexture&&!n._targetTextureVarying)}(t)&&(this.textureTransform=new qoe(e,t)),oe(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let t=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)t=Object.assign(t,r.getDrawOptions(t));return t}}const xae={interpolation:class mae{constructor({gl:e,attribute:t,timeline:i}){g(this,"gl",void 0),g(this,"type","interpolation"),g(this,"attributeInTransition",void 0),g(this,"settings",void 0),g(this,"attribute",void 0),g(this,"transition",void 0),g(this,"currentStartIndices",void 0),g(this,"currentLength",void 0),g(this,"transform",void 0),g(this,"buffers",void 0),this.gl=e,this.transition=new Qd(i),this.attribute=t,this.attributeInTransition=new $x(e,t.settings),this.currentStartIndices=t.startIndices,this.currentLength=0,this.transform=function _ae(n,e){const t=M2(e.size);return new Zx(n,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:t},varyings:["vCurrent"]})}(e,t);const r={byteLength:0,usage:35050};this.buffers=[new Rt(e,r),new Rt(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){if(e.duration<=0)return void this.transition.cancel();this.settings=e;const{buffers:r,attribute:s}=this;T2(r);const o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)S2(k({buffer:a},o));this.currentStartIndices=s.startIndices,this.currentLength=qx(s,t),this.attributeInTransition.setData({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:E2(0,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{duration:t,easing:i}=this.settings,{time:r}=this.transition;let s=r/t;i&&(s=i(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}},spring:class yae{constructor({gl:e,attribute:t,timeline:i}){g(this,"gl",void 0),g(this,"type","spring"),g(this,"attributeInTransition",void 0),g(this,"settings",void 0),g(this,"attribute",void 0),g(this,"transition",void 0),g(this,"currentStartIndices",void 0),g(this,"currentLength",void 0),g(this,"texture",void 0),g(this,"framebuffer",void 0),g(this,"transform",void 0),g(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Qd(i),this.attribute=t,this.attributeInTransition=new $x(e,X(k({},t.settings),{normalized:!1})),this.currentStartIndices=t.startIndices,this.currentLength=0,this.texture=function bae(n){return new gi(n,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(e),this.framebuffer=function wae(n,e){return new En(n,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(e,this.texture),this.transform=function vae(n,e,t){const i=M2(e.size);return new Zx(n,{framebuffer:t,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(e,t,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new Rt(e,r),new Rt(e,r),new Rt(e,r)]}get inProgress(){return this.transition.inProgress}start(e,t){const{buffers:r,attribute:s}=this,o={numInstances:t,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)S2(k({buffer:a},o));this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=qx(s,t),this.attributeInTransition.setData({buffer:r[1],value:s.value}),this.transition.start(X(k({},e),{duration:1/0})),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:E2(0,s)}})}update(){const{buffers:e,transform:t,framebuffer:i,transition:r}=this;if(!r.update())return!1;const o=this.settings;return t.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),t.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:o.stiffness,damping:o.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),T2(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),Nm(i)[0]>0||r.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}};class Cae{constructor(e,{id:t,timeline:i}){g(this,"id",void 0),g(this,"isSupported",void 0),g(this,"gl",void 0),g(this,"timeline",void 0),g(this,"transitions",void 0),g(this,"needsRedraw",void 0),g(this,"numInstances",void 0),this.id=t,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=Zx.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],o=s.getTransitionSetting(t);!o||this._updateAttribute(r,s,o)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(t))&&this._removeTransition(r)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const i=this.transitions[t];i.inProgress&&(e[t]=i.attributeInTransition)}return e}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,t,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported)return void Ye.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();r&&this._removeTransition(e);const o=xae[i.type];o?this.transitions[e]=new o({attribute:t,timeline:this.timeline,gl:this.gl}):(Ye.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const B2="attributeManager.invalidate";class Dae{constructor(e,{id:t="attribute-manager",stats:i,timeline:r}={}){g(this,"id",void 0),g(this,"gl",void 0),g(this,"attributes",void 0),g(this,"updateTriggers",void 0),g(this,"needsRedraw",void 0),g(this,"userData",void 0),g(this,"stats",void 0),g(this,"attributeTransitionManager",void 0),this.id=t,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new Cae(e,{id:"".concat(t,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const t of e)void 0!==this.attributes[t]&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const i=this._invalidateTrigger(e,t);ii(B2,this,e,i)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);ii(B2,this,"all")}update({data:e,numInstances:t,startIndices:i=null,transitions:r,props:s={},buffers:o={},context:a={}}){let l=!1;ii("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const u=this.attributes[c],d=u.settings.accessor;u.startIndices=i,u.numInstances=t,s[c]&&Ye.removed("props.".concat(c),"data.attributes.".concat(c))(),u.setExternalBuffer(o[c])||u.setBinaryValue("string"==typeof d?o[d]:void 0,e.startIndices)||"string"==typeof d&&!o[d]&&u.setConstantValue(s[d])||u.needsUpdate()&&(l=!0,this._updateAttribute({attribute:u,numInstances:t,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||u.needsRedraw()}l&&ii("attributeManager.updateEnd",this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:i}=this,r=k({},i.getAttributes());for(const s in t){const o=t[s];o.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=o)}return r}getShaderAttributes(e,t={}){e||(e=this.getAttributes());const i={};for(const r in e)t[r]||Object.assign(i,e[r].getShaderAttributes());return i}_add(e,t={}){for(const i in e)this.attributes[i]=this._createAttribute(i,e[i],t);this._mapUpdateTriggersToAttributes()}_createAttribute(e,t,i){const r=X(k({},t),{id:e,size:(t.isIndexed?1:t.size)||1,divisor:i.instanced?1:t.divisor||0});return new $x(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(o=>{const a=i[o];a&&a.setNeedsUpdate(a.id,t)}),s}_updateAttribute(e){const{attribute:t,numInstances:i}=e;ii("attribute.updateStart",t),t.constant?t.setConstantValue(t.value):(t.allocate(i)&&ii("attribute.allocate",t,i),t.updateBuffer(e)&&(this.needsRedraw=!0,ii("attribute.updateEnd",t,i)))}}function z2(n,e,t,i,r){const s=e-n;return(t-e)*r+-s*i+s+e}function j2(n,e){if(Array.isArray(n)){let t=0;for(let i=0;i<n.length;i++){const r=n[i]-e[i];t+=r*r}return Math.sqrt(t)}return Math.abs(n-e)}const Oae={interpolation:class Iae extends Qd{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:i,duration:r,easing:s}}=this,o=s(e/r);this._value=Ks(t,i,o)}},spring:class kae extends Qd{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=function Pae(n,e,t,i,r){if(Array.isArray(t)){const s=[];for(let o=0;o<t.length;o++)s[o]=z2(n[o],e[o],t[o],i,r);return s}return z2(n,e,t,i,r)}(s,o,t,i,r);const l=j2(a,t),c=j2(a,o);l<1e-5&&c<1e-5&&(a=t,this.end()),this._prevValue=o,this._currValue=a}}};class Rae{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,i,r){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;t=c,this.remove(e)}if(!(r=C2(r)))return;const o=Oae[r.type];if(!o)return void Ye.error("unsupported transition type '".concat(r.type,"'"))();const a=new o(this.timeline);a.start(X(k({},r),{fromValue:t,toValue:i})),s.set(e,a)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,i]of this.transitions)i.update(),e[t]=i.value,i.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function Nae(n,e){if(!n.transitions)return!1;const t={},i=Kx(n);let r=!1;for(const s in n.transitions){const o=i[s],a=o&&o.type;("number"===a||"color"===a||"array"===a)&&Xx(n[s],e[s],o)&&(t[s]=!0,r=!0)}return!!r&&t}function U2({newProps:n,oldProps:e,ignoreProps:t={},propTypes:i={},triggerName:r="props"}){if(e===n)return!1;if("object"!=typeof n||null===n||"object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const s of Object.keys(n))if(!(s in t)){if(!(s in e))return"".concat(r,".").concat(s," added");const o=Xx(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in t)){if(!(s in n))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(n,s)){const o=Xx(n[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}}return!1}function Xx(n,e,t){let i=t&&t.equal;return i&&!i(n,e,t)||!i&&(i=n&&e&&n.equals,i&&!i.call(n,e))?"changed deeply":i||e===n?null:"changed shallowly"}function zae(n,e){if(null===e)return!0;const t=e.extensions,{extensions:i}=n;if(i===t)return!1;if(!t||!i||i.length!==t.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(t[r]))return!0;return!1}function H2(n,e,t){let i=n.updateTriggers[t];i=null==i?{}:i;let r=e.updateTriggers[t];return r=null==r?{}:r,U2({oldProps:r,newProps:i,triggerName:t})}function Kx(n){const e=n[pm],t=e&&e.constructor;return t?t._propTypes:{}}function qae(n,e){if(!e)return n;const t=k(k({},n),e);if("defines"in e&&(t.defines=k(k({},n.defines),e.defines)),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(i=>"project64"===i.name))){const i=t.modules.findIndex(r=>"project32"===r.name);i>=0&&t.modules.splice(i,1)}if("inject"in e)if(n.inject){const i=k({},n.inject);for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];t.inject=i}else t.inject=e.inject;return t}function Qx(n,e,t=!1){const i=e.projectPosition(n);if(t&&e instanceof vs){const[r,s,o=0]=n,a=e.getDistanceScales([r,s]);i[2]=o*a.unitsPerMeter[2]}return i}function G2(n,{viewport:e,modelMatrix:t,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[o,a,l=0]=n;switch(t&&([o,a,l]=Mc([],[o,a,l,1],t)),i){case gt.LNGLAT:return Qx([o,a,l],e,s);case gt.LNGLAT_OFFSETS:return Qx([o+r[0],a+r[1],l+(r[2]||0)],e,s);case gt.METER_OFFSETS:return Qx(vL(r,[o,a,l]),e,s);default:return e.isGeospatial?[o+r[0],a+r[1],l+r[2]]:e.projectPosition([o,a,l])}}const Zae={10241:9987,10240:9729,10242:33071,10243:33071},Jx={},Qae={boolean:{validate:(n,e)=>!0,equal:(n,e,t)=>Boolean(n)===Boolean(e)},number:{validate:(n,e)=>Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)},color:{validate:(n,e)=>e.optional&&!n||rh(n)&&(3===n.length||4===n.length),equal:(n,e,t)=>eC(n,e)},accessor:{validate(n,e){const t=eg(n);return"function"===t||t===eg(e.value)},equal:(n,e,t)=>"function"==typeof e||eC(n,e)},array:{validate:(n,e)=>e.optional&&!n||rh(n),equal:(n,e,t)=>t.compare?eC(n,e):n===e},object:{equal:(n,e,t)=>t.compare?za(n,e):n===e},function:{validate:(n,e)=>e.optional&&!n||"function"==typeof n,equal:(n,e,t)=>!t.compare||n===e},data:{transform:(n,e,t)=>{const{dataTransform:i}=t.props;return i&&n?i(n):n}},image:{transform:(n,e,t)=>function Xae(n,e){const t=n.context&&n.context.gl;if(!t||!e)return null;if(e instanceof gi)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new gi(t,X(k({},e),{parameters:k(k(k({},Zae),i),n.props.textureParameters)}));return Jx[r.id]=!0,r}(t,n),release:n=>{!function Kae(n){!n||!(n instanceof gi)||Jx[n.id]&&(n.delete(),delete Jx[n.id])}(n)}}};function eC(n,e){if(n===e)return!0;if(!rh(n)||!rh(e))return!1;const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}function ele(n,e){switch(eg(e)){case"object":return ih(n,e);case"array":return ih(n,{type:"array",value:e,compare:!1});case"boolean":return ih(n,{type:"boolean",value:e});case"number":return ih(n,{type:"number",value:e});case"function":return ih(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function ih(n,e){return"type"in e?k(k({name:n},Qae[e.type]),e):"value"in e?k({name:n,type:eg(e.value)},e):{name:n,type:"object",value:e}}function rh(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function eg(n){return rh(n)?"array":null===n?"null":typeof n}function W2(n){return tg(n,"_mergedDefaultProps")||(function nle(n){if(!n.prototype)return;const t=Object.getPrototypeOf(n),i=W2(t),s=function Jae(n){const e={},t={},i={};for(const[r,s]of Object.entries(n)){const o=null==s?void 0:s.deprecatedFor;if(o)i[r]=Array.isArray(o)?o:[o];else{const a=ele(r,s);e[r]=a,t[r]=a.value}}return{propTypes:e,defaultProps:t,deprecatedProps:i}}(tg(n,"defaultProps")||{}),o=function ile(n,e,t){const i=Object.create(null);Object.assign(i,e,n);const r=function ale(n){const e=tg(n,"layerName")||tg(n,"componentName");return e||Ye.once(0,"".concat(n.name,".componentName not specified"))(),e||n.name}(t);return delete n.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}(s.defaultProps,i,n),a=k(k({},t._propTypes),s.propTypes);!function sle(n,e){const t={},i={};for(const r in e){const s=e[r],{name:o,value:a}=s;s.async&&(t[o]=a,i[o]=ole(o))}n[bc]=t,n[Oa]={},Object.defineProperties(n,i)}(o,a);const l=k(k({},t._deprecatedProps),s.deprecatedProps);(function rle(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(t);for(const s of e[t])q2(this,s)||(this[s]=i);Ye.deprecated(r,e[t].join("/"))()}})})(o,l),n._mergedDefaultProps=o,n._propTypes=a,n._deprecatedProps=l}(n),n._mergedDefaultProps)}function ole(n){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||w2(e)?this[Oa][n]=e:this[Fo][n]=e},get(){if(this[Fo]){if(n in this[Fo])return this[Fo][n]||this[bc][n];if(n in this[Oa]){const e=this[pm]&&this[pm].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[bc][n]}}return this[bc][n]}}}function q2(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function tg(n,e){return q2(n,e)&&n[e]}let lle=0;class tC{constructor(...e){g(this,"id",void 0),g(this,"props",void 0),g(this,"count",void 0),this.props=function tle(n,e){const t=W2(n.constructor),i=Object.create(t);i[pm]=n,i[Oa]={},i[Fo]={};for(let r=0;r<e.length;++r){const s=e[r];for(const o in s)i[o]=s[o]}return Object.freeze(i),i}(this,e),this.id=this.props.id,this.count=lle++}clone(e){const{props:t}=this,i={};for(const r in t[bc])r in t[Fo]?i[r]=t[Fo][r]:r in t[Oa]&&(i[r]=t[Oa][r]);return new this.constructor(k(k(k({},t),i),e))}}g(tC,"componentName","Component"),g(tC,"defaultProps",{});const cle=Object.freeze({});class dle extends class ule{constructor(e){g(this,"component",void 0),g(this,"onAsyncPropUpdated",void 0),g(this,"asyncProps",void 0),g(this,"oldProps",void 0),g(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps||cle}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return Boolean(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){const t=e[Fo]||{},i=e[Oa]||e,r=e[bc]||{};for(const s in t){const o=t[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o),t[s]=this.getAsyncProp(s)}for(const s in i){const o=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if("string"==typeof t&&(t=this._fetch(e,t)),t instanceof Promise)return void this._watchPromise(e,t);if(w2(t))return void this._resolveAsyncIterable(e,t);this._setPropValue(e,t)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const i=this.asyncProps[e];return t!==i.resolvedValue&&t!==i.lastValue&&(i.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const i=this.asyncProps[e];i&&(t=this._postProcessValue(i,t),i.resolvedValue=t,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(e,t,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&void 0!==t&&(this._freezeAsyncOldProps(),r.resolvedValue=t,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const i=this.asyncProps[e];if(i){i.pendingLoadCount++;const r=i.pendingLoadCount;t.then(s=>{s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r),this._onResolve(e,s)}).catch(s=>{this._onError(e,s)})}}_resolveAsyncIterable(e,t){var i=this;return Bt(function*(){if("data"!==e)return void i._setPropValue(e,t);const r=i.asyncProps[e];if(!r)return;r.pendingLoadCount++;const s=r.pendingLoadCount;let o=[],a=0;var u,l=!1,c=!1;try{for(var h,d=pw(t);l=!(h=yield d.next()).done;l=!1){const f=h.value,{dataTransform:p}=i.component.props;o=p?p(f,o):o.concat(f),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:a,endRow:o.length}]}),a=o.length,i._setAsyncPropValue(e,o,s)}}catch(f){c=!0,u=f}finally{try{l&&null!=d.return&&(yield d.return())}finally{if(c)throw u}}i._onResolve(e,o)})()}_postProcessValue(e,t){const i=e.type;return i&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(t,i,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const r=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}{constructor({attributeManager:e,layer:t}){super(t),g(this,"attributeManager",void 0),g(this,"needsRedraw",void 0),g(this,"needsUpdate",void 0),g(this,"subLayers",void 0),g(this,"usesPickingColorCache",void 0),g(this,"changeFlags",void 0),g(this,"viewport",void 0),g(this,"uniformTransitions",void 0),g(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}_fetch(e,t){const i=this.component.props.fetch;return i?i(t,{propName:e,layer:this.layer}):super._fetch(e,t)}_onResolve(e,t){const i=this.component.props.onDataLoad;"data"===e&&i&&i(t,{propName:e,layer:this.layer})}_onError(e,t){this.layer.raiseError(t,"loading ".concat(e," of ").concat(this.layer))}}const _le=Object.freeze([]),yle=Kd(({oldViewport:n,viewport:e})=>n.equals(e));let xs=new Uint8ClampedArray(0);const vle={data:{type:"data",value:_le,async:!0},dataComparator:{type:"function",value:null,compare:!1,optional:!0},_dataDiff:{type:"function",value:n=>n&&n.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:o}=t.context;var a;r=r||t.getLoadOptions(),i=i||t.props.loaders,s&&(r=X(k({},r),{fetch:X(k({},null===(a=r)||void 0===a?void 0:a.fetch),{signal:s})}));let l=o.contains(n);return!l&&!r&&(o.add({resourceId:n,data:xm(n,i),persistent:!1}),l=!0),l?o.subscribe({resourceId:n,onChange:c=>{var u;return null===(u=t.internalState)||void 0===u?void 0:u.reloadAsyncProp(e,c)},consumerId:t.id,requestId:e}):xm(n,i,r)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:gt.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,100*-n],compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class no extends tC{constructor(...e){super(...e),g(this,"internalState",null),g(this,"lifecycle","Awaiting state"),g(this,"context",void 0),g(this,"state",void 0),g(this,"parent",null)}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return"".concat(this.constructor.layerName||this.constructor.name,"({id: '").concat(this.props.id,"'})")}project(e){jn(this.internalState);const t=this.internalState.viewport||this.context.viewport,i=G2(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,s,o]=xL(i,t.pixelProjectionMatrix);return 2===e.length?[r,s]:[r,s,o]}unproject(e){return jn(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){return jn(this.internalState),function Yae(n,e){const{viewport:t,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=function $ae(n){const{viewport:e,modelMatrix:t,coordinateOrigin:i}=n;let{coordinateSystem:r,fromCoordinateSystem:s,fromCoordinateOrigin:o}=n;return r===gt.DEFAULT&&(r=e.isGeospatial?gt.LNGLAT:gt.CARTESIAN),void 0===s&&(s=r),void 0===o&&(o=i),{viewport:e,coordinateSystem:r,coordinateOrigin:i,modelMatrix:t,fromCoordinateSystem:s,fromCoordinateOrigin:o}}(e),{geospatialOrigin:l,shaderCoordinateOrigin:c,offsetMode:u}=EF(t,i,r),d=G2(n,{viewport:t,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:u});if(u){const h=t.projectPosition(l||c);nL(d,d,h)}return d}(e,k({viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem},t))}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const t of this.getModels())t.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===gt.DEFAULT||e===gt.LNGLAT||e===gt.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,t=[]){return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){jn(e instanceof Uint8Array);const[t,i,r]=e;return t+256*i+65536*r-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function Hae(n){if(!function Wae(n){return null!==n&&"object"==typeof n}(n))throw new Error("count(): argument not an object");if("function"==typeof n.count)return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(function Gae(n){return null!==n&&"object"==typeof n&&n.constructor===Object}(n))return Object.keys(n).length;throw new Error("count(): argument not a container")}(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;const t=this.getAttributeManager();if(!t)return null;const{positions:i,instancePositions:r}=t.attributes;return null===(e=i||r)||void 0===e?void 0:e.getBounds()}getShaders(e){for(const t of this.props.extensions)e=qae(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:i}=e.changeFlags;if(i&&t)if(Array.isArray(i))for(const l of i)t.invalidateAll(l);else t.invalidateAll();const{props:r,oldProps:s}=e,o=Number.isInteger(s.highlightedObjectIndex)||s.pickable,a=Number.isInteger(r.highlightedObjectIndex)||r.pickable;if(o!==a&&t){const{pickingColors:l,instancePickingColors:c}=t.attributes,u=l||c;u&&(a&&u.constant&&(u.constant=!1,t.invalidate(u.id)),!u.value&&!a&&(u.constant=!0,u.value=[0,0,0]))}}finalizeState(e){for(const i of this.getModels())i.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e)}getPickingInfo({info:e}){const{index:r}=e;return r>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[r]),e}raiseError(e,t){var i,r,s,o;t&&(e.message="".concat(t,": ").concat(e.message)),null!==(i=(r=this.props).onError)&&void 0!==i&&i.call(r,e)||null===(s=this.context)||void 0===s||null===(o=s.onError)||void 0===o||o.call(s,e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var e;return(null===(e=this.internalState)||void 0===e?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,(!t||!yle({oldViewport:t,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const t=this.getAttributeManager();!t||("all"===e?t.invalidateAll():t.invalidate(e))}updateAttributes(e){for(const t of this.getModels())this._setModelAttributes(t,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,i=this.getNumInstances(),r=this.getStartIndices();e.update({data:t.data,numInstances:i,startIndices:r,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),i=Object.create(this.props);for(const r in t)Object.defineProperty(i,r,{value:t[r]});return i}return this.props}calculateInstancePickingColors(e,{numInstances:t}){if(e.constant)return;const i=Math.floor(xs.length/3);if(this.internalState.usesPickingColorCache=!0,i<t){t>16777215&&Ye.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),xs=Cc.allocate(xs,t,{size:3,copy:!0,maxCount:Math.max(t,16777215)});const r=Math.floor(xs.length/3),s=[];for(let o=i;o<r;o++)this.encodePickingColor(o,s),xs[3*o+0]=s[0],xs[3*o+1]=s[1],xs[3*o+2]=s[2]}e.value=xs.subarray(0,3*t)}_setModelAttributes(e,t){const s=this.getAttributeManager().getShaderAttributes(t,e.userData.excludeAttributes||{});e.setAttributes(s)}disablePickingIndex(e){this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:i}=this.getAttributeManager().attributes,r=t||i;if(!r)return;const s=r.getVertexOffset(e),o=r.getVertexOffset(e+1);r.buffer.subData({data:new Uint8Array(o-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,i=e||t;!i||(this.internalState.usesPickingColorCache&&i.value.buffer!==xs.buffer&&(i.value=xs.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){jn(!this.internalState),jn(Number.isFinite(this.props.coordinateSystem)),ii("layer.initialize",this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new dle({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Ye.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.layer=this,this.internalState.uniformTransitions=new Rae(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){ii("layer.matched",this,this===e);const{state:t,internalState:i}=e;this!==e&&(this.internalState=i,this.internalState.layer=this,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(ii("layer.update",this,e),!e)return;const t=this.props,i=this.context,r=this.internalState,s=i.viewport,o=this._updateUniformTransition();r.propsInTransition=o,i.viewport=r.viewport||s,this.props=o;try{const a=this._getUpdateParams(),l=this.getModels();if(i.gl)this.updateState(a);else try{this.updateState(a)}catch(u){}for(const u of this.props.extensions)u.updateState.call(this,a,u);const c=this.getModels()[0]!==l[0];this._postUpdate(a,c)}finally{i.viewport=s,this.props=t,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){ii("layer.finalize",this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,e)}_drawLayer({moduleParameters:e=null,uniforms:t={},parameters:i={}}){this._updateAttributeTransition();const r=this.props,s=this.context;this.props=this.internalState.propsInTransition||r,t.opacity=Math.pow(this.props.opacity,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,l=a&&a(t)||[0,0];fs(s.gl,{polygonOffset:l}),Ii(s.gl,i,()=>{const c={moduleParameters:e,uniforms:t,parameters:i,context:s};for(const u of this.props.extensions)u.draw.call(this,c,u);this.draw(c)})}finally{this.props=r}}getChangeFlags(){var e;return null===(e=this.internalState)||void 0===e?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const r in e)if(e[r]){let s=!1;if("dataChanged"===r){const o=e[r],a=t[r];o&&Array.isArray(a)&&(t.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0)}t[r]||(t[r]=e[r],s=!0),s&&ii("layer.changeFlag",this,r,e)}const i=Boolean(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=i,t.somethingChanged=i||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){const i=function Fae(n,e){const t=U2({newProps:n,oldProps:e,propTypes:Kx(n),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function Bae(n,e){if(null===e)return"oldProps is null, initial diff";let t=!1;const{dataComparator:i,_dataDiff:r}=n;return i?i(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&r&&(t=r(n.data,e.data)||t),t}(n,e);let r=!1;return i||(r=function Vae(n,e){if(null===e)return{all:!0};if("all"in n.updateTriggers&&H2(n,e,"all"))return{all:!0};const t={};let i=!1;for(const r in n.updateTriggers)"all"!==r&&H2(n,e,r)&&(t[r]=!0,i=!0);return!!i&&t}(n,e)),{dataChanged:i,propsChanged:t,updateTriggersChanged:r,extensionsChanged:zae(n,e),transitionsChanged:Nae(n,e)}}(e,t);if(i.updateTriggersChanged)for(const s in i.updateTriggersChanged)i.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(i.transitionsChanged)for(const s in i.transitionsChanged){var r;this.internalState.uniformTransitions.add(s,t[s],e[s],null===(r=e.transitions)||void 0===r?void 0:r[s])}return this.setChangeFlags(i)}validateProps(){!function Lae(n){const e=Kx(n);for(const t in e){const i=e[t],{validate:r}=i;if(r&&!r(n[t],i))throw new Error("Invalid prop ".concat(t,": ").concat(n[t]))}}(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={pickingSelectedColor:e.picked?e.color:null},{highlightColor:i}=this.props;e.picked&&"function"==typeof i&&(t.pickingHighlightColor=i(e)),this.setModuleParameters(t),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new Dae(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:i,oldProps:r}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;null==s||s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:l}=i;if(t||r.autoHighlight!==o||r.highlightedObjectIndex!==a||r.highlightColor!==l){const c={};o||(c.pickingSelectedColor=null),Array.isArray(l)&&(c.pickingHighlightColor=l),Number.isInteger(a)&&(c.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(c)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags;const i=this.getAttributeManager(),r=!!i&&i.getNeedsRedraw(e);return t=t||r,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}g(no,"defaultProps",vle),g(no,"layerName","Layer");class ng extends no{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:t}=e;return t&&t.__source&&t.__source.parent&&t.__source.parent.id===this.id&&(e.object=t.__source.object,e.index=t.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:i}=this.props;return i&&i[e]&&i[e].type||t}getSubLayerRow(e,t,i){return e.__source={parent:this,object:t,index:i},e}getSubLayerAccessor(e){if("function"==typeof e){const t={index:-1,data:this.props.data,target:[]};return(i,r)=>i&&i.__source?(t.index=i.__source.index,e(i.__source.object,t)):e(i,r)}return e}getSubLayerProps(e={}){var t;const{opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:d,coordinateOrigin:h,wrapLongitude:f,positionFormat:p,modelMatrix:m,extensions:_,fetch:y,operation:v,_subLayerProps:E}=this.props,M={id:"",updateTriggers:{},opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:c,highlightColor:u,coordinateSystem:d,coordinateOrigin:h,wrapLongitude:f,positionFormat:p,modelMatrix:m,extensions:_,fetch:y,operation:v},R=E&&e.id&&E[e.id],B=R&&R.updateTriggers,V=e.id||"sublayer";if(R){const Z=this.constructor._propTypes,Y=e.type?e.type._propTypes:{};for(const $ in R){const fe=Y[$]||Z[$];fe&&"accessor"===fe.type&&(R[$]=this.getSubLayerAccessor(R[$]))}}Object.assign(M,e,R),M.id="".concat(this.props.id,"-").concat(V),M.updateTriggers=k(k({all:null===(t=this.props.updateTriggers)||void 0===t?void 0:t.all},e.updateTriggers),B);for(const Z of _){const Y=Z.getSubLayerProps.call(this,Z);Y&&Object.assign(M,Y,{updateTriggers:Object.assign(M.updateTriggers,Y.updateTriggers)})}return M}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let i=this.internalState.subLayers;const r=!i||this.needsUpdate();r&&(i=mm(this.renderLayers(),Boolean),this.internalState.subLayers=i),ii("compositeLayer.renderLayers",this,r,i);for(const s of i)s.parent=this}}function wle({data:n,getIndex:e,dataRange:t,replace:i}){const{startRow:r=0,endRow:s=1/0}=t,o=n.length;let a=o,l=o;for(let h=0;h<o;h++){const f=e(n[h]);if(a>h&&f>=r&&(a=h),f>=s){l=h;break}}let c=a;const d=l-a!==i.length?n.slice(l):void 0;for(let h=0;h<i.length;h++)n[c++]=i[h];if(d){for(let h=0;h<d.length;h++)n[c++]=d[h];n.length=c}return{startRow:a,endRow:a+i.length}}g(ng,"layerName","CompositeLayer");const Bc={name:"project32",dependencies:[vx],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},Tle={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},Vc=k({inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}}},{name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function Sle(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tle;const e={};if(void 0!==n.pickingSelectedColor)if(n.pickingSelectedColor){const t=n.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=t}else e.picking_uSelectedColorValid=0;if(n.pickingHighlightColor){const t=Array.from(n.pickingHighlightColor,i=>i/255);Number.isFinite(t[3])||(t[3]=1),e.picking_uHighlightColor=t}return void 0!==n.pickingActive&&(e.picking_uActive=Boolean(n.pickingActive),e.picking_uAttribute=Boolean(n.pickingAttribute)),e}}),Y2={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class zc{static get DRAW_MODE(){return Y2}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:t=jo("geometry"),drawMode:i=Y2.TRIANGLES,attributes:r={},indices:s=null,vertexCount:o=null}=e;this.id=t,this.drawMode=0|i,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?k({indices:this.indices},this.attributes):this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,t){t&&(this.indices=ArrayBuffer.isView(t)?{value:t,size:1}:t);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,oe(ArrayBuffer.isView(r.value),"".concat(this._print(i),": must be typed array or object with value as typed array")),("POSITION"===i||"positions"===i)&&!r.size&&(r.size=3),"indices"===i?(oe(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,t){if(t)return t.value.length;let i=1/0;for(const r in e){const s=e[r],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(i=Math.min(i,o.length/a))}return oe(Number.isFinite(i)),i}}const Z2=()=>{},X2={10241:9987,10240:9729,10242:33071,10243:33071};function kle(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function Ole(n,e,t,i){return t===e.width&&i===e.height?e:(n.canvas.height=i,n.canvas.width=t,n.clearRect(0,0,n.canvas.width,n.canvas.height),n.drawImage(e,0,0,e.width,e.height,0,0,t,i),n.canvas)}function sh(n){return n&&(n.id||n.url)}function K2(n,e,t){for(let i=0;i<e.length;i++){const{icon:r,xOffset:s}=e[i];n[sh(r)]=X(k({},r),{x:s,y:t})}}class Nle{constructor(e,{onUpdate:t=Z2,onError:i=Z2}){g(this,"gl",void 0),g(this,"onUpdate",void 0),g(this,"onError",void 0),g(this,"_loadOptions",null),g(this,"_texture",null),g(this,"_externalTexture",null),g(this,"_mapping",{}),g(this,"_textureParameters",null),g(this,"_pendingCount",0),g(this,"_autoPacking",!1),g(this,"_xOffset",0),g(this,"_yOffset",0),g(this,"_rowHeight",0),g(this,"_buffer",4),g(this,"_canvasWidth",1024),g(this,"_canvasHeight",0),g(this,"_canvas",null),this.gl=e,this.onUpdate=t,this.onError=i}finalize(){var e;null===(e=this._texture)||void 0===e||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?sh(e):e;return this._mapping[t]||{}}setProps({loadOptions:e,autoPacking:t,iconAtlas:i,iconMapping:r,textureParameters:s}){var o;e&&(this._loadOptions=e),void 0!==t&&(this._autoPacking=t),r&&(this._mapping=r),i&&(null===(o=this._texture)||void 0===o||o.delete(),this._texture=null,this._externalTexture=i),s&&(this._textureParameters=s)}get isLoaded(){return 0===this._pendingCount}packIcons(e,t){if(!this._autoPacking||"undefined"==typeof document)return;const i=Object.values(function Fle(n,e,t){if(!n||!e)return null;t=t||{};const i={},{iterable:r,objectInfo:s}=Xm(n);for(const o of r){s.index++;const a=e(o,s),l=sh(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!i[l]&&(!t[l]||a.url!==t[l].url)&&(i[l]=X(k({},a),{source:o,sourceIndex:s.index}))}return i}(e,t,this._mapping)||{});if(i.length>0){const{mapping:r,xOffset:s,yOffset:o,rowHeight:a,canvasHeight:l}=function Lle({icons:n,buffer:e,mapping:t={},xOffset:i=0,yOffset:r=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let l=0;l<n.length;l++){const c=n[l];if(!t[sh(c)]){const{height:d,width:h}=c;i+h+e>o&&(K2(t,a,r),i=0,r=s+r+e,s=0,a=[]),a.push({icon:c,xOffset:i}),i=i+h+e,s=Math.max(s,d)}}return a.length>0&&K2(t,a,r),{mapping:t,rowHeight:s,xOffset:i,yOffset:r,canvasWidth:o,canvasHeight:kle(s+r+e)}}({icons:i,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=r,this._xOffset=s,this._yOffset=o,this._canvasHeight=l,this._texture||(this._texture=new gi(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||X2})),this._texture.height!==this._canvasHeight&&(this._texture=function Rle(n,e,t,i){const r=n.width,s=n.height,o=new gi(n.gl,{width:e,height:t,parameters:i});return function bne(n,e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:s=0,targetInternalFormat:o=6408}=t;let{targetX:a,targetY:l,targetZ:c,width:u,height:d}=t;const{framebuffer:h,deleteFramebuffer:f}=qd(n);oe(h);const{gl:p,handle:m}=h,_=void 0!==a||void 0!==l||void 0!==c;a=a||0,l=l||0,c=c||0;const y=p.bindFramebuffer(36160,m);oe(e);let v=null;if(e instanceof Ba&&(v=e,u=Number.isFinite(u)?u:v.width,d=Number.isFinite(d)?d:v.height,v.bind(0),e=v.target),_)switch(e){case 3553:case 34067:p.copyTexSubImage2D(e,s,a,l,i,r,u,d);break;case 35866:case 32879:ni(p).copyTexSubImage3D(e,s,a,l,c,i,r,u,d)}else p.copyTexImage2D(e,s,o,i,r,u,d,0);v&&v.unbind(),p.bindFramebuffer(36160,y||null),f&&h.delete()}(n,o,{targetY:0,width:r,height:s}),n.delete(),o}(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||X2)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(i)}}_loadIcons(e){const t=this._canvas.getContext("2d");for(const i of e)this._pendingCount++,xm(i.url,ZF,this._loadOptions).then(r=>{const s=sh(i),{x:o,y:a,width:l,height:c}=this._mapping[s],u=Ole(t,r,l,c);this._texture.setSubImageData({data:u,x:o,y:a,width:l,height:c}),this._texture.generateMipmap(),this.onUpdate()}).catch(r=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:r})}).finally(()=>{this._pendingCount--})}}const Q2=[0,0,0,255],Ble={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:n=>n.position},getIcon:{type:"accessor",value:n=>n.icon},getColor:{type:"accessor",value:Q2},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class ig extends no{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){return super.getShaders({vs:'#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  // convert size in meters to pixels, then scaled and clamp\n \n  // project meters to pixels and clamp to limits \n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n\n  // scale icon height to match instanceSize\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n\n  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n',fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n\n  // if colorMode == 0, use pixel color from the texture\n  // if colorMode == 1 or rendering picking buffer, use texture as transparency mask\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  // Take the global opacity and the alpha from vColor into account for the alpha component\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[Bc,Vc]})}initializeState(){this.state={iconManager:new Nle(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:Q2},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:t,oldProps:i,changeFlags:r}=e,s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:l,getIcon:c,textureParameters:u}=t,{iconManager:d}=this.state,h=o||this.internalState.isAsyncPropLoading("iconAtlas");if(d.setProps({loadOptions:t.loadOptions,autoPacking:!h,iconAtlas:o,iconMapping:h?a:null,textureParameters:u}),h?i.iconMapping!==t.iconMapping&&s.invalidate("getIcon"):(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&d.packIcons(l,c),r.extensionsChanged){var f;const{gl:p}=this.context;null===(f=this.state.model)||void 0===f||f.delete(),this.state.model=this._getModel(p),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:t,sizeMinPixels:i,sizeMaxPixels:r,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:l}=this.state,c=l.getTexture();c&&this.state.model.setUniforms(e).setUniforms({iconsTexture:c,iconsTextureDim:[c.width,c.height],sizeUnits:La[s],sizeScale:t,sizeMinPixels:i,sizeMaxPixels:r,billboard:o,alphaCutoff:a}).draw()}_getModel(e){return new qo(e,X(k({},this.getShaders()),{id:this.props.id,geometry:new zc({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0}))}_onUpdate(){this.setNeedsRedraw()}_onError(e){var t;const i=null===(t=this.getCurrentLayer())||void 0===t?void 0:t.props.onIconError;i?i(e):Ye.error(e.error.message)()}getInstanceOffset(e){const{width:t,height:i,anchorX:r=t/2,anchorY:s=i/2}=this.state.iconManager.getIconMapping(e);return[t/2-r,i/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:t,y:i,width:r,height:s}=this.state.iconManager.getIconMapping(e);return[t,i,r,s]}}g(ig,"defaultProps",Ble),g(ig,"layerName","IconLayer");const J2=[0,0,0,255],jle={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:n=>n.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:J2},getLineColor:{type:"accessor",value:J2},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class nC extends no{getShaders(){return super.getShaders({vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n\n  // Multiply out radius and clamp to limits\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  \n  // Multiply out line width and clamp to limits\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n\n  // outer radius needs to offset by half stroke width\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n\n  // Expand geometry to accomodate edge smoothing\n  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\n\n  // position on the containing square in [-1, 1] space\n  unitPosition = edgePadding * positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = edgePadding * positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n  }\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Apply opacity to instance color, or return instance picking color\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[Bc,Vc]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var t;const{gl:i}=this.context;null===(t=this.state.model)||void 0===t||t.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:t,radiusScale:i,radiusMinPixels:r,radiusMaxPixels:s,stroked:o,filled:a,billboard:l,antialiasing:c,lineWidthUnits:u,lineWidthScale:d,lineWidthMinPixels:h,lineWidthMaxPixels:f}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:o?1:0,filled:a,billboard:l,antialiasing:c,radiusUnits:La[t],radiusScale:i,radiusMinPixels:r,radiusMaxPixels:s,lineWidthUnits:La[u],lineWidthScale:d,lineWidthMinPixels:h,lineWidthMaxPixels:f}).draw()}_getModel(e){return new qo(e,X(k({},this.getShaders()),{id:this.props.id,geometry:new zc({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0}))}}g(nC,"defaultProps",jle),g(nC,"layerName","ScatterplotLayer");const tN=[];class iC extends ig{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){return X(k({},super.getShaders()),{fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n\n    // if enable sdf (signed distance fields)\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n\n    // Take the global opacity and the alpha from color into account for the alpha component\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"})}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(t,{index:i,target:r})=>this.encodePickingColor(i,r)}})}updateState(e){super.updateState(e);const{props:t,oldProps:i}=e;let{outlineColor:r}=t;r!==i.outlineColor&&(r=r.map(s=>s/255),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!t.sdf&&t.outlineWidth&&Ye.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:t,smoothing:i,outlineWidth:r}=this.props,{outlineColor:s}=this.state;e.uniforms=X(k({},e.uniforms),{buffer:.75,outlineBuffer:r?Math.max(i,.75*(1-r)):-1,gamma:i,sdf:Boolean(t),outlineColor:s}),super.draw(e)}getInstanceOffset(e){return e?Array.from(e).flatMap(t=>super.getInstanceOffset(t)):tN}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(t=>super.getInstanceIconFrame(t)):tN}}g(iC,"defaultProps",{getIconOffsets:{type:"accessor",value:n=>n.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}}),g(iC,"layerName","MultiIconLayer");var Gle=Re(803),Wle=Re.n(Gle);const $le=[];function Yle(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function nN(n,e,t,i){let r=0;for(let o=e;o<t;o++){var s;r+=(null===(s=i[n[o]])||void 0===s?void 0:s.width)||0}return r}function iN(n,e,t,i,r,s){let o=e,a=0;for(let l=e;l<t;l++){const c=nN(n,l,l+1,r);a+c>i&&(o<l&&s.push(l),o=l,a=0),a+=c}return a}function Kle(n,e,t,i,r=0,s){void 0===s&&(s=n.length);const o=[];return"break-all"===e?iN(n,r,s,t,i,o):function Xle(n,e,t,i,r,s){let o=e,a=e,l=e,c=0;for(let u=e;u<t;u++)if((" "===n[u]||" "===n[u+1]||u+1===t)&&(l=u+1),l>a){let d=nN(n,a,l,r);c+d>i&&(o<a&&(s.push(a),o=a,c=0),d>i&&(d=iN(n,a,l,i,r,s),o=s[s.length-1])),a=l,c+=d}}(n,r,s,t,i,o),o}function Qle(n,e,t,i,r,s){let o=0,a=0;for(let l=e;l<t;l++){const c=n[l],u=i[c];u?(a||(a=u.height),r[l]=o+u.width/2,o+=u.width):(Ye.warn("Missing character: ".concat(c," (").concat(c.codePointAt(0),")"))(),r[l]=o,o+=32)}s[0]=o,s[1]=a}function rN(n,e,t,i,r){const s=Array.from(n),o=s.length,a=new Array(o),l=new Array(o),c=new Array(o),u=("break-word"===t||"break-all"===t)&&isFinite(i)&&i>0,d=[0,0],h=[0,0];let f=0,p=0,m=0;for(let _=0;_<=o;_++){const y=s[_];if(("\n"===y||_===o)&&(m=_),m>p){const v=u?Kle(s,t,i,r,p,m):$le;for(let E=0;E<=v.length;E++){const M=0===E?p:v[E-1],R=E<v.length?v[E]:m;Qle(s,M,R,r,a,h);for(let B=M;B<R;B++)l[B]=f+h[1]/2,c[B]=h[0];f+=h[1]*e,d[0]=Math.max(d[0],h[0])}p=m}"\n"===y&&(a[p]=0,l[p]=0,c[p]=0,p++)}return d[1]=f,{x:a,y:l,rowWidth:c,size:d}}class sN{constructor(e=5){g(this,"limit",void 0),g(this,"_cache",{}),g(this,"_order",[]),this.limit=e}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const t=this._order.indexOf(e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}const oh={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function ece(){const n=[];for(let e=32;e<128;e++)n.push(String.fromCharCode(e));return n}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1};let rg=new sN(3);function ice(n,e){for(let t=0;t<n.length;t++)e.data[4*t+3]=n[t]}function cN(n,e,t,i){n.font="".concat(i," ").concat(t,"px ").concat(e),n.fillStyle="#000",n.textBaseline="alphabetic",n.textAlign="left"}class sce{constructor(){g(this,"props",k({},oh)),g(this,"_key",void 0),g(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return 1.2}setProps(e={}){Object.assign(this.props,e);const t=this._key;this._key=this._getKey();const i=function nce(n,e){let t;t="string"==typeof e?new Set(Array.from(e)):new Set(e);const i=rg.get(n);if(!i)return t;for(const r in i.mapping)t.has(r)&&t.delete(r);return t}(this._key,this.props.characterSet),r=rg.get(this._key);if(r&&0===i.size)return void(this._key!==t&&(this._atlas=r));const s=this._generateFontAtlas(this._key,i,r);this._atlas=s,rg.set(this._key,s)}_generateFontAtlas(e,t,i){const{fontFamily:r,fontWeight:s,fontSize:o,buffer:a,sdf:l,radius:c,cutoff:u}=this.props;let d=i&&i.data;d||(d=document.createElement("canvas"),d.width=1024);const h=d.getContext("2d");cN(h,r,o,s);const{mapping:f,canvasHeight:p,xOffset:m,yOffset:_}=function Zle({characterSet:n,getFontWidth:e,fontHeight:t,buffer:i,maxCanvasWidth:r,mapping:s={},xOffset:o=0,yOffset:a=0}){let l=0,c=o;for(const d of n)if(!s[d]){const h=e(d);c+h+2*i>r&&(c=0,l++),s[d]={x:c+i,y:a+l*(t+2*i)+i,width:h,height:t},c+=h+2*i}const u=t+2*i;return{mapping:s,xOffset:c,yOffset:a+l*u,canvasHeight:Yle(a+(l+1)*u)}}(k({getFontWidth:y=>h.measureText(y).width,fontHeight:1.2*o,buffer:a,characterSet:t,maxCanvasWidth:1024},i&&{mapping:i.mapping,xOffset:i.xOffset,yOffset:i.yOffset}));if(d.height!==p){const y=h.getImageData(0,0,d.width,d.height);d.height=p,h.putImageData(y,0,0)}if(cN(h,r,o,s),l){const y=new(Wle())(o,a,c,u,r,s),v=h.getImageData(0,0,y.size,y.size);for(const E of t)ice(y.draw(E),v),h.putImageData(v,f[E].x-a,f[E].y+a)}else for(const y of t)h.fillText(y,f[y].x,f[y].y+.9*o);return{xOffset:m,yOffset:_,mapping:f,data:d,width:d.width,height:d.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:i,buffer:r,sdf:s,radius:o,cutoff:a}=this.props;return s?"".concat(e," ").concat(t," ").concat(i," ").concat(r," ").concat(o," ").concat(a):"".concat(e," ").concat(t," ").concat(i," ").concat(r)}}const lce={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:n=>n.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class rC extends no{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n\n  // convert size in meters to pixels, then scaled and clamp\n\n  // project meters to pixels and clamp to limits\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  // Apply opacity to instance color, or return instance picking color\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[Bc,Vc]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:t}=e;if(t.extensionsChanged){var i;const{gl:r}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:t,sizeScale:i,sizeUnits:r,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]),this.state.model.setUniforms(e).setUniforms({billboard:t,stroked:Boolean(a),padding:l,sizeUnits:La[r],sizeScale:i,sizeMinPixels:s,sizeMaxPixels:o}).draw()}_getModel(e){return new qo(e,X(k({},this.getShaders()),{id:this.props.id,geometry:new zc({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0}))}}g(rC,"defaultProps",lce),g(rC,"layerName","TextBackgroundLayer");const uN={start:1,middle:0,end:-1},dN={top:1,center:0,bottom:-1},sC=[0,0,0,255],uce={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:sC},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:oh.characterSet},fontFamily:oh.fontFamily,fontWeight:oh.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:sC},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:n=>n.text},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:sC},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class oC extends ng{constructor(...e){super(...e),g(this,"state",void 0),g(this,"getBoundingRect",(t,i)=>{const r=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:l,getTextAnchor:c,getAlignmentBaseline:u}=this.props,d=s(t,i)||"",{size:[h,f]}=rN(d,l,o,a,r);return[(uN["function"==typeof c?c(t,i):c]-1)*h/2,(dN["function"==typeof u?u(t,i):u]-1)*f/2,h,f]}),g(this,"getIconOffsets",(t,i)=>{const r=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:l,getTextAnchor:c,getAlignmentBaseline:u}=this.props,d=s(t,i)||"",{x:h,y:f,rowWidth:p,size:[m,_]}=rN(d,l,o,a,r),y=uN["function"==typeof c?c(t,i):c],v=dN["function"==typeof u?u(t,i):u],E=h.length,M=new Array(2*E);let R=0;for(let B=0;B<E;B++)M[R++]=(y-1)*m/2+(1-y)*(m-p[B])/2+h[B],M[R++]=(v-1)*_/2+f[B];return M})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new sce}}updateState(e){const{props:t,oldProps:i,changeFlags:r}=e;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||t.lineHeight!==i.lineHeight||t.wordBreak!==i.wordBreak||t.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:t,fontWeight:i}=this.props,{fontAtlasManager:r,characterSet:s}=this.state,o=X(k({},e),{characterSet:s,fontFamily:t,fontWeight:i});if(!r.mapping)return r.setProps(o),!0;for(const a in o)if(o[a]!==r.props[a])return r.setProps(o),!0;return!1}_updateText(){var e;const{data:t,characterSet:i}=this.props,r=null===(e=t.attributes)||void 0===e?void 0:e.getText;let a,{getText:s}=this.props,o=t.startIndices;const l="auto"===i&&new Set;if(r&&o){const{texts:c,characterCount:u}=function Jle({value:n,length:e,stride:t,offset:i,startIndices:r,characterSet:s}){const o=n.BYTES_PER_ELEMENT,a=t?t/o:1,l=i?i/o:0,c=r[e]||Math.ceil((n.length-l)/a),u=s&&new Set,d=new Array(e);let h=n;if(a>1||l>0){h=new(0,n.constructor)(c);for(let p=0;p<c;p++)h[p]=n[p*a+l]}for(let f=0;f<e;f++){const _=h.subarray(r[f],r[f+1]||c);d[f]=String.fromCodePoint.apply(null,_),u&&_.forEach(u.add,u)}if(u)for(const f of u)s.add(String.fromCodePoint(f));return{texts:d,characterCount:c}}(X(k({},ArrayBuffer.isView(r)?{value:r}:r),{length:t.length,startIndices:o,characterSet:l}));a=u,s=(d,{index:h})=>c[h]}else{const{iterable:c,objectInfo:u}=Xm(t);o=[0],a=0;for(const d of c){u.index++;const h=Array.from(s(d,u)||"");l&&h.forEach(l.add,l),a+=h.length,o.push(a)}}this.setState({getText:s,startIndices:o,numInstances:a,characterSet:l||i})}renderLayers(){const{startIndices:e,numInstances:t,getText:i,fontAtlasManager:{scale:r,texture:s,mapping:o},styleVersion:a}=this.state,{data:l,_dataDiff:c,getPosition:u,getColor:d,getSize:h,getAngle:f,getPixelOffset:p,getBackgroundColor:m,getBorderColor:_,getBorderWidth:y,backgroundPadding:v,background:E,billboard:M,fontSettings:R,outlineWidth:B,outlineColor:V,sizeScale:Z,sizeUnits:Y,sizeMinPixels:$,sizeMaxPixels:fe,transitions:ye,updateTriggers:he}=this.props,Ee=this.getSubLayerClass("characters",iC),Mn=this.getSubLayerClass("background",rC);return[E&&new Mn({getFillColor:m,getLineColor:_,getLineWidth:y,padding:v,getPosition:u,getSize:h,getAngle:f,getPixelOffset:p,billboard:M,sizeScale:Z/this.state.fontAtlasManager.props.fontSize,sizeUnits:Y,sizeMinPixels:$,sizeMaxPixels:fe,transitions:ye&&{getPosition:ye.getPosition,getAngle:ye.getAngle,getSize:ye.getSize,getFillColor:ye.getBackgroundColor,getLineColor:ye.getBorderColor,getLineWidth:ye.getBorderWidth,getPixelOffset:ye.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:he.getPosition,getAngle:he.getAngle,getSize:he.getSize,getFillColor:he.getBackgroundColor,getLineColor:he.getBorderColor,getLineWidth:he.getBorderWidth,getPixelOffset:he.getPixelOffset,getBoundingRect:{getText:he.getText,getTextAnchor:he.getTextAnchor,getAlignmentBaseline:he.getAlignmentBaseline,styleVersion:a}}}),{data:l.attributes&&l.attributes.background?{length:l.length,attributes:l.attributes.background}:l,_dataDiff:c,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new Ee({sdf:R.sdf,smoothing:Number.isFinite(R.smoothing)?R.smoothing:oh.smoothing,outlineWidth:B,outlineColor:V,iconAtlas:s,iconMapping:o,getPosition:u,getColor:d,getSize:h,getAngle:f,getPixelOffset:p,billboard:M,sizeScale:Z*r,sizeUnits:Y,sizeMinPixels:$*r,sizeMaxPixels:fe*r,transitions:ye&&{getPosition:ye.getPosition,getAngle:ye.getAngle,getColor:ye.getColor,getSize:ye.getSize,getPixelOffset:ye.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:he.getText,getPosition:he.getPosition,getAngle:he.getAngle,getColor:he.getColor,getSize:he.getSize,getPixelOffset:he.getPixelOffset,getIconOffsets:{getText:he.getText,getTextAnchor:he.getTextAnchor,getAlignmentBaseline:he.getAlignmentBaseline,styleVersion:a}}}),{data:l,_dataDiff:c,startIndices:e,numInstances:t,getIconOffsets:this.getIconOffsets,getIcon:i})]}static set fontAtlasCacheLimit(e){!function rce(n){Ye.assert(Number.isFinite(n)&&n>=3,"Invalid cache limit"),rg=new sN(n)}(e)}}g(oC,"defaultProps",uce),g(oC,"layerName","TextLayer");class hN{constructor(e){g(this,"opts",void 0),g(this,"typedArrayManager",void 0),g(this,"indexStarts",[0]),g(this,"vertexStarts",[0]),g(this,"vertexCount",0),g(this,"instanceCount",0),g(this,"attributes",void 0),g(this,"_attributeDefs",void 0),g(this,"data",void 0),g(this,"getGeometry",void 0),g(this,"geometryBuffer",void 0),g(this,"buffers",void 0),g(this,"positionSize",void 0),g(this,"normalize",void 0);const{attributes:t={}}=e;this.typedArrayManager=Cc,this.attributes={},this._attributeDefs=t,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:t,buffers:i={},getGeometry:r,geometryBuffer:s,positionFormat:o,dataChanged:a,normalize:l=!0}=this.opts;if(this.data=t,this.getGeometry=r,this.positionSize=s&&s.size||("XY"===o?2:3),this.buffers=i,this.normalize=l,s&&(jn(t.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),l||(i.positions=s)),this.geometryBuffer=i.positions,Array.isArray(a))for(const c of a)this._rebuildGeometry(c);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:t}){this._rebuildGeometry({startRow:e,endRow:t})}getGeometryFromBuffer(e){const t=e.value||e;return ArrayBuffer.isView(t)?x2(t,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,t){const{attributes:i,buffers:r,_attributeDefs:s,typedArrayManager:o}=this;for(const a in s)if(a in r)o.release(i[a]),i[a]=null;else{const l=s[a];l.copy=t,i[a]=o.allocate(i[a],e,l)}}_forEachGeometry(e,t,i){const{data:r,getGeometry:s}=this,{iterable:o,objectInfo:a}=Xm(r,t,i);for(const l of o)a.index++,e(s?s(l,a):null,a.index)}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:t,vertexStarts:i,instanceCount:r}=this;const{data:s,geometryBuffer:o}=this,{startRow:a=0,endRow:l=1/0}=e||{},c={};if(e||(t=[0],i=[0]),this.normalize||!o)this._forEachGeometry((d,h)=>{const f=d&&this.normalizeGeometry(d);c[h]=f,i[h+1]=i[h]+(f?this.getGeometrySize(f):0)},a,l),r=i[i.length-1];else if(i=s.startIndices,r=i[s.length]||0,ArrayBuffer.isView(o))r=r||o.length/this.positionSize;else if(o instanceof Rt){const d=o.accessor.stride||4*this.positionSize;r=r||o.byteLength/d}else if(o.buffer){const d=o.stride||4*this.positionSize;r=r||o.buffer.byteLength/d}else if(o.value){const d=o.value,h=o.stride/d.BYTES_PER_ELEMENT||this.positionSize;r=r||d.length/h}this._allocate(r,Boolean(e)),this.indexStarts=t,this.vertexStarts=i,this.instanceCount=r;const u={};this._forEachGeometry((d,h)=>{const f=c[h]||d;u.vertexStart=i[h],u.indexStart=t[h],u.geometrySize=(h<i.length-1?i[h+1]:r)-i[h],u.geometryIndex=h,this.updateGeometryAttributes(f,u)},a,l),this.vertexCount=t[t.length-1]}}function pN(n,e,t={}){return function dce(n,e={}){return Math.sign(sg(n,e))}(n,t)!==e&&(function hce(n,e){const{start:t=0,end:i=n.length,size:r=2}=e,s=(i-t)/r,o=Math.floor(s/2);for(let a=0;a<o;++a){const l=t+a*r,c=t+(s-1-a)*r;for(let u=0;u<r;++u){const d=n[l+u];n[l+u]=n[c+u],n[c+u]=d}}}(n,t),!0)}function sg(n,e={}){const{start:t=0,end:i=n.length}=e,r=e.size||2;let s=0;for(let o=t,a=i-r;o<i;o+=r)s+=(n[o]-n[a])*(n[o+1]+n[a+1]),a=o;return s/2}function mN(n,e,t,i,r,s){let o,a;if(void 0===s&&(s=sg(n,{start:e,end:t,size:i})),r===s<0)for(o=e;o<t;o+=i)a=yN(o,n[o],n[o+1],a);else for(o=t-i;o>=e;o-=i)a=yN(o,n[o],n[o+1],a);return a&&og(a,a.next)&&(ch(a),a=a.next),a}function $o(n,e){if(!n)return n;e||(e=n);let i,t=n;do{if(i=!1,t.steiner||!og(t,t.next)&&0!==tn(t.prev,t,t.next))t=t.next;else{if(ch(t),t=e=t.prev,t===t.next)break;i=!0}}while(i||t!==e);return e}function ah(n,e,t,i,r,s,o){if(!n)return;!o&&s&&function Mce(n,e,t,i){let r=n;do{null===r.z&&(r.z=aC(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,function Tce(n){let e,t,r,s,o,a,l,c,i=1;do{for(s=n,n=null,c=null,r=0;s;){for(r++,a=s,o=0,t=0;t<i&&(o++,a=a.nextZ,a);t++);for(l=i;o>0||l>0&&a;)0!==o&&(0===l||!a||s.z<=a.z)?(e=s,s=s.nextZ,o--):(e=a,a=a.nextZ,l--),c?c.nextZ=e:n=e,e.prevZ=c,c=e;s=a}c.nextZ=null,i*=2}while(r>1)}(r)}(n,i,r,s);let l,c,a=n;for(;n.prev!==n.next;)if(l=n.prev,c=n.next,s?_ce(n,i,r,s):gce(n))e.push(l.i/t),e.push(n.i/t),e.push(c.i/t),ch(n),n=c.next,a=c.next;else if((n=c)===a){o?1===o?ah(n=yce($o(n),e,t),e,t,i,r,s,2):2===o&&vce(n,e,t,i,r,s):ah($o(n),e,t,i,r,s,1);break}}function gce(n){const e=n.prev,t=n,i=n.next;if(tn(e,t,i)>=0)return!1;let r=n.next.next;for(;r!==n.prev;){if(jc(e.x,e.y,t.x,t.y,i.x,i.y,r.x,r.y)&&tn(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function _ce(n,e,t,i){const r=n.prev,s=n,o=n.next;if(tn(r,s,o)>=0)return!1;const c=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,u=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,d=aC(r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,e,t,i),h=aC(c,u,e,t,i);let f=n.prevZ,p=n.nextZ;for(;f&&f.z>=d&&p&&p.z<=h;){if(f!==n.prev&&f!==n.next&&jc(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&tn(f.prev,f,f.next)>=0||(f=f.prevZ,p!==n.prev&&p!==n.next&&jc(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&tn(p.prev,p,p.next)>=0))return!1;p=p.nextZ}for(;f&&f.z>=d;){if(f!==n.prev&&f!==n.next&&jc(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&tn(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=h;){if(p!==n.prev&&p!==n.next&&jc(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&tn(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function yce(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!og(r,s)&&gN(r,i,i.next,s)&&lh(r,s)&&lh(s,r)&&(e.push(r.i/t),e.push(i.i/t),e.push(s.i/t),ch(i),ch(i.next),i=n=s),i=i.next}while(i!==n);return $o(i)}function vce(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Ace(o,a)){let l=_N(o,a);return o=$o(o,o.next),l=$o(l,l.next),ah(o,e,t,i,r,s),void ah(l,e,t,i,r,s)}a=a.next}o=o.next}while(o!==n)}function wce(n,e){return n.x-e.x}function xce(n,e){if(e=function Cce(n,e){let t=e;const i=n.x,r=n.y;let o,s=-1/0;do{if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const h=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(h<=i&&h>s){if(s=h,h===i){if(r===t.y)return t;if(r===t.next.y)return t.next}o=t.x<t.next.x?t:t.next}}t=t.next}while(t!==e);if(!o)return null;if(i===s)return o;const a=o,l=o.x,c=o.y;let d,u=1/0;t=o;do{i>=t.x&&t.x>=l&&i!==t.x&&jc(r<c?i:s,r,l,c,r<c?s:i,r,t.x,t.y)&&(d=Math.abs(r-t.y)/(i-t.x),lh(t,n)&&(d<u||d===u&&(t.x>o.x||t.x===o.x&&Ece(o,t)))&&(o=t,u=d)),t=t.next}while(t!==a);return o}(n,e),e){const t=_N(e,n);$o(e,e.next),$o(t,t.next)}}function Ece(n,e){return tn(n.prev,n,e.prev)<0&&tn(e.next,n,n.next)<0}function aC(n,e,t,i,r){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-t)*r)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Sce(n){let e=n,t=n;do{(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next}while(e!==n);return t}function jc(n,e,t,i,r,s,o,a){return(r-o)*(e-a)-(n-o)*(s-a)>=0&&(n-o)*(i-a)-(t-o)*(e-a)>=0&&(t-o)*(s-a)-(r-o)*(i-a)>=0}function Ace(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function Dce(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&gN(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}(n,e)&&(lh(n,e)&&lh(e,n)&&function Ice(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do{t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next}while(t!==n);return i}(n,e)&&(tn(n.prev,n,e.prev)||tn(n,e.prev,e))||og(n,e)&&tn(n.prev,n,n.next)>0&&tn(e.prev,e,e.next)>0)}function tn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function og(n,e){return n.x===e.x&&n.y===e.y}function gN(n,e,t,i){const r=lg(tn(n,e,t)),s=lg(tn(n,e,i)),o=lg(tn(t,i,n)),a=lg(tn(t,i,e));return!!(r!==s&&o!==a||0===r&&ag(n,t,e)||0===s&&ag(n,i,e)||0===o&&ag(t,n,i)||0===a&&ag(t,e,i))}function ag(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function lg(n){return n>0?1:n<0?-1:0}function lh(n,e){return tn(n.prev,n,n.next)<0?tn(n,e,n.next)>=0&&tn(n,n.prev,e)>=0:tn(n,e,n.prev)<0||tn(n,n.next,e)<0}function _N(n,e){const t=new lC(n.i,n.x,n.y),i=new lC(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function yN(n,e,t,i){const r=new lC(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function ch(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function lC(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Uc(n,e,t,i,r=[]){let s,o;if(8&t)s=(i[3]-n[1])/(e[1]-n[1]),o=3;else if(4&t)s=(i[1]-n[1])/(e[1]-n[1]),o=1;else if(2&t)s=(i[2]-n[0])/(e[0]-n[0]),o=2;else{if(!(1&t))return null;s=(i[0]-n[0])/(e[0]-n[0]),o=0}for(let a=0;a<n.length;a++)r[a]=(1&o)===a?i[o]:s*(e[a]-n[a])+n[a];return r}function Cs(n,e){let t=0;return n[0]<e[0]?t|=1:n[0]>e[2]&&(t|=2),n[1]<e[1]?t|=4:n[1]>e[3]&&(t|=8),t}function Hr(n,e){const t=e.length,i=n.length;if(i>0){let r=!0;for(let s=0;s<t;s++)if(n[i-t+s]!==e[s]){r=!1;break}if(r)return!1}for(let r=0;r<t;r++)n[i+r]=e[r];return!0}function cC(n,e){const t=e.length;for(let i=0;i<t;i++)n[i]=e[i]}function uh(n,e,t,i,r=[]){const s=i+e*t;for(let o=0;o<t;o++)r[o]=n[s+o];return r}function vN(n,e){const{size:t=2,broken:i=!1,gridResolution:r=10,gridOffset:s=[0,0],startIndex:o=0,endIndex:a=n.length}=e||{},l=(a-o)/t;let c=[];const u=[c],d=uh(n,0,t,o);let h,f;const p=CN(d,r,s,[]),m=[];Hr(c,d);for(let _=1;_<l;_++){for(h=uh(n,_,t,o,h),f=Cs(h,p);f;){Uc(d,h,f,p,m);const y=Cs(m,p);y&&(Uc(d,m,y,p,m),f=y),Hr(c,m),cC(d,m),kce(p,r,f),i&&c.length>t&&(c=[],u.push(c),Hr(c,d)),f=Cs(h,p)}Hr(c,h),cC(d,h)}return i?u:u[0]}function cg(n,e){for(let t=0;t<e.length;t++)n.push(e[t]);return n}function wN(n,e=null,t){if(!n.length)return[];const{size:i=2,gridResolution:r=10,gridOffset:s=[0,0],edgeTypes:o=!1}=t||{},a=[],l=[{pos:n,types:o?new Array(n.length/i).fill(1):null,holes:e||[]}],c=[[],[]];let u=[];for(;l.length;){const{pos:d,types:h,holes:f}=l.shift();Oce(d,i,f[0]||d.length,c),u=CN(c[0],r,s,u);const p=Cs(c[1],u);if(p){let m=xN(d,h,i,0,f[0]||d.length,u,p);const _={pos:m[0].pos,types:m[0].types,holes:[]},y={pos:m[1].pos,types:m[1].types,holes:[]};l.push(_,y);for(let v=0;v<f.length;v++)m=xN(d,h,i,f[v],f[v+1]||d.length,u,p),m[0]&&(_.holes.push(_.pos.length),_.pos=cg(_.pos,m[0].pos),o&&(_.types=cg(_.types,m[0].types))),m[1]&&(y.holes.push(y.pos.length),y.pos=cg(y.pos,m[1].pos),o&&(y.types=cg(y.types,m[1].types)))}else{const m={positions:d};o&&(m.edgeTypes=h),f.length&&(m.holeIndices=f),a.push(m)}}return a}function xN(n,e,t,i,r,s,o){const a=(r-i)/t,l=[],c=[],u=[],d=[],h=[];let f,p,m;const _=uh(n,a-1,t,i);let y=Math.sign(8&o?_[1]-s[3]:_[0]-s[2]),v=e&&e[a-1],E=0,M=0;for(let R=0;R<a;R++)f=uh(n,R,t,i,f),p=Math.sign(8&o?f[1]-s[3]:f[0]-s[2]),m=e&&e[i/t+R],p&&y&&y!==p&&(Uc(_,f,o,s,h),Hr(l,h)&&u.push(v),Hr(c,h)&&d.push(v)),p<=0?(Hr(l,f)&&u.push(m),E-=p):u.length&&(u[u.length-1]=0),p>=0?(Hr(c,f)&&d.push(m),M+=p):d.length&&(d[d.length-1]=0),cC(_,f),y=p,v=m;return[E?{pos:l,types:e&&u}:null,M?{pos:c,types:e&&d}:null]}function CN(n,e,t,i){const r=Math.floor((n[0]-t[0])/e)*e+t[0],s=Math.floor((n[1]-t[1])/e)*e+t[1];return i[0]=r,i[1]=s,i[2]=r+e,i[3]=s+e,i}function kce(n,e,t){8&t?(n[1]+=e,n[3]+=e):4&t?(n[1]-=e,n[3]-=e):2&t?(n[0]+=e,n[2]+=e):1&t&&(n[0]-=e,n[2]-=e)}function Oce(n,e,t,i){let r=1/0,s=-1/0,o=1/0,a=-1/0;for(let l=0;l<t;l+=e){const c=n[l],u=n[l+1];r=c<r?c:r,s=c>s?c:s,o=u<o?u:o,a=u>a?u:a}return i[0][0]=r,i[0][1]=o,i[1][0]=s,i[1][1]=a,i}function Nce(n,e,t,i){let r=-1,s=-1;for(let o=t+1;o<i;o+=e){const a=Math.abs(n[o]);a>r&&(r=a,s=o-1)}return s}function Bce(n,e,t,i,r=85.051129){const s=n[t],o=n[i-e];if(Math.abs(s-o)>180){const a=uh(n,0,e,t);a[0]+=360*Math.round((o-s)/360),Hr(n,a),a[1]=Math.sign(a[1])*r,Hr(n,a),a[0]=s,Hr(n,a)}}function EN(n,e,t,i){let s,r=n[0];for(let o=t;o<i;o+=e){s=n[o];const a=s-r;(a>180||a<-180)&&(s-=360*Math.round(a/360)),n[o]=r=s}}function MN(n,e){let t;const i=n.length/e;for(let s=0;s<i&&(t=n[s*e],(t+180)%360==0);s++);const r=360*-Math.round(t/360);if(0!==r)for(let s=0;s<i;s++)n[s*e]+=r}class Uce extends hN{constructor(e){super(X(k({},e),{attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}}))}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?function Vce(n,e,t,i){let r;if(Array.isArray(n[0])){r=new Array(n.length*e);for(let o=0;o<n.length;o++)for(let a=0;a<e;a++)r[o*e+a]=n[o][a]||0}else r=n;return t?vN(r,{size:e,gridResolution:t}):i?function Lce(n,e){const{size:t=2,startIndex:i=0,endIndex:r=n.length,normalize:s=!0}=e||{},o=n.slice(i,r);EN(o,t,0,r-i);const a=vN(o,{size:t,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const l of a)MN(l,t);return a}(r,{size:e}):r}(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(TN(e)){let i=0;for(const r of e)i+=this.getGeometrySize(r);return i}const t=this.getPathLength(e);return t<2?0:this.isClosed(e)?t<3?0:t+2:t}updateGeometryAttributes(e,t){if(0!==t.geometrySize)if(e&&TN(e))for(const i of e){const r=this.getGeometrySize(i);t.geometrySize=r,this.updateGeometryAttributes(i,t),t.vertexStart+=r}else this._updateSegmentTypes(e,t),this._updatePositions(e,t)}_updateSegmentTypes(e,t){const i=this.attributes.segmentTypes,r=!!e&&this.isClosed(e),{vertexStart:s,geometrySize:o}=t;i.fill(0,s,s+o),r?(i[s]=4,i[s+o-2]=4):(i[s]+=1,i[s+o-2]+=2),i[s+o-1]=4}_updatePositions(e,t){const{positions:i}=this.attributes;if(!i||!e)return;const{vertexStart:r,geometrySize:s}=t,o=new Array(3);for(let a=r,l=0;l<s;a++,l++)this.getPointOnPath(e,l,o),i[3*a]=o[0],i[3*a+1]=o[1],i[3*a+2]=o[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,t,i=[]){const{positionSize:r}=this;t*r>=e.length&&(t+=1-e.length/r);const s=t*r;return i[0]=e[s],i[1]=e[s+1],i[2]=3===r&&e[s+2]||0,i}isClosed(e){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:t}=this,i=e.length-t;return e[0]===e[i]&&e[1]===e[i+1]&&(2===t||e[2]===e[i+2])}}function TN(n){return Array.isArray(n[0])}const SN=[0,0,0,255],Wce={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:n=>n.path},getColor:{type:"accessor",value:SN},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},dC={enter:(n,e)=>e.length?e.subarray(e.length-n.length):n};class hC extends no{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\n\n// calculate line join positions\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  // side of the segment - -1: left, 0: center, 1: right\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n\n  // tangent of the corner\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  // direction of the corner\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  // direction of the segment\n  vec2 dir = isEnd ? dirA : dirB;\n  // direction of the extrusion\n  vec2 perp = isEnd ? perpA : perpB;\n  // length of the segment\n  float L = isEnd ? lenA : lenB;\n\n  // A = angle of the corner\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n\n  // -1: right, 1: left\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n\n  // relative position to the corner:\n  // -1: inside (smaller side of the angle)\n  // 0: center\n  // 1: outside (bigger side of the angle)\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  // trim if inside corner extends further than the line segment\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n\n  // special treatment for start cap and end cap\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n\n  // extend out a triangle to envelope the round cap\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n\n  // Generate variables for fragment shader\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return currPoint + offset;\n}\n\n// In clipspace extrusion, if a line extends behind the camera, clip it to avoid visual artifacts\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    // Extrude in clipspace\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 pos = lineJoin(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    // Extrude in commonspace\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec4 pos = vec4(\n      lineJoin(prevPosition, currPosition, nextPosition, width.xy),\n      1.0);\n    geometry.position = pos;\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\n/*\n * vPathPosition represents the relative coordinates of the current fragment on the path segment.\n * vPathPosition.x - position along the width of the path, between [-1, 1]. 0 is the center line.\n * vPathPosition.y - position along the length of the path, between [0, L / width].\n */\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    // if joint is rounded, test distance from the corner\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    // trim miter\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[Bc,Vc]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:dC,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:dC,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:dC,defaultValue:SN},instancePickingColors:{size:3,type:5121,accessor:(i,{index:r,target:s})=>this.encodePickingColor(i&&i.__source?i.__source.index:r,s)}}),this.setState({pathTesselator:new Uce({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:t,changeFlags:i}=e,r=this.getAttributeManager();if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,l=t.data.attributes||{};a.updateGeometry({data:t.data,geometryBuffer:l.getPath,buffers:l,normalize:!t._pathType,loop:"loop"===t._pathType,getGeometry:t.getPath,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:i.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),i.dataChanged||r.invalidateAll()}if(i.extensionsChanged){var o;const{gl:a}=this.context;null===(o=this.state.model)||void 0===o||o.delete(),this.state.model=this._getModel(a),r.invalidateAll()}}getPickingInfo(e){const t=super.getPickingInfo(e),{index:i}=t,{data:r}=this.props;return r[0]&&r[0].__source&&(t.object=r.find(s=>s.__source.index===i)),t}disablePickingIndex(e){const{data:t}=this.props;if(t[0]&&t[0].__source)for(let i=0;i<t.length;i++)t[i].__source.index===e&&this._disablePickingIndex(i);else this._disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:t,capRounded:i,billboard:r,miterLimit:s,widthUnits:o,widthScale:a,widthMinPixels:l,widthMaxPixels:c}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(t),capType:Number(i),billboard:r,widthUnits:La[o],widthScale:a,miterLimit:s,widthMinPixels:l,widthMaxPixels:c}).draw()}_getModel(e){return new qo(e,X(k({},this.getShaders()),{id:this.props.id,geometry:new zc({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0}))}calculatePositions(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateSegmentTypes(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("segmentTypes")}}g(hC,"defaultProps",Wce),g(hC,"layerName","PathLayer");const AN="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",qce={lightSources:{}};function fC(){let{color:n=[0,0,0],intensity:e=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.map(t=>t*e/255)}function $ce(n){let{ambientLight:e,pointLights:t=[],directionalLights:i=[]}=n;const r={};return r["lighting_uAmbientLight.color"]=e?fC(e):[0,0,0],t.forEach((s,o)=>{r["lighting_uPointLight[".concat(o,"].color")]=fC(s),r["lighting_uPointLight[".concat(o,"].position")]=s.position,r["lighting_uPointLight[".concat(o,"].attenuation")]=s.attenuation||[1,0,0]}),r.lighting_uPointLightCount=t.length,i.forEach((s,o)=>{r["lighting_uDirectionalLight[".concat(o,"].color")]=fC(s),r["lighting_uDirectionalLight[".concat(o,"].direction")]=s.direction}),r.lighting_uDirectionalLightCount=i.length,r}const IN={name:"lights",vs:AN,fs:AN,getUniforms:function DN(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qce;if("lightSources"in n){const{ambientLight:e,pointLights:t,directionalLights:i}=n.lightSources||{};return e||t&&t.length>0||i&&i.length>0?Object.assign({},$ce({ambientLight:e,pointLights:t,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in n){const e={pointLights:[],directionalLights:[]};for(const t of n.lights||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights.push(t);break;case"point":e.pointLights.push(t)}return DN({lightSources:e})}return{}},defines:{MAX_LIGHTS:3}},Yce={};function Zce(n){const{ambient:e=.35,diffuse:t=.6,shininess:i=32,specularColor:r=[30,30,30]}=n;return{lighting_uAmbient:e,lighting_uDiffuse:t,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}const Xce={name:"gouraud-lighting",dependencies:[IN],vs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_VERTEX:1},getUniforms:function kN(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yce;if(!("material"in n))return{};const{material:e}=n;return e?Zce(e):{lighting_uEnabled:!1}}};var Kce=Re(469),Qce=Re.n(Kce);const Yo={isClosed:!0};function dh(n){return"positions"in n?n.positions:n}function dg(n){return"holeIndices"in n?n.holeIndices:null}function RN(n,e,t,i,r){let s=e;const o=t.length;for(let a=0;a<o;a++)for(let l=0;l<i;l++)n[s++]=t[a][l]||0;if(!function nue(n){const e=n[0],t=n[n.length-1];return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}(t))for(let a=0;a<i;a++)n[s++]=t[0][a]||0;return Yo.start=e,Yo.end=s,Yo.size=i,pN(n,r,Yo),s}function LN(n,e,t,i,r=0,s,o){const a=(s=s||t.length)-r;if(a<=0)return e;let l=e;for(let c=0;c<a;c++)n[l++]=t[r+c];if(!function iue(n,e,t,i){for(let r=0;r<e;r++)if(n[t+r]!==n[i-e+r])return!1;return!0}(t,i,r,s))for(let c=0;c<i;c++)n[l++]=t[r+c];return Yo.start=e,Yo.end=l,Yo.size=i,pN(n,o,Yo),l}class oue extends hN{constructor(e){const{fp64:t,IndexType:i=Uint32Array}=e;super(X(k({},e),{attributes:{positions:{size:3,type:t?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:i,size:1}}}))}get(e){const{attributes:t}=this;return"indices"===e?t.indices&&t.indices.subarray(0,this.vertexCount):t[e]}updateGeometry(e){super.updateGeometry(e);const t=this.buffers.indices;if(t)this.vertexCount=(t.value||t).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const t=function rue(n,e){!function Jce(n){if(n=n&&n.positions||n,!Array.isArray(n)&&!ArrayBuffer.isView(n))throw new Error("invalid polygon")}(n);const t=[],i=[];if("positions"in n){const{positions:r,holeIndices:s}=n;if(s){let o=0;for(let a=0;a<=s.length;a++)o=LN(t,o,r,e,s[a-1],s[a],0===a?1:-1),i.push(o);return i.pop(),{positions:t,holeIndices:i}}n=r}if(!function eue(n){return Array.isArray(n[0])}(n))return LN(t,0,n,e,0,t.length,1),t;if(!function tue(n){return n.length>=1&&n[0].length>=2&&Number.isFinite(n[0][0])}(n)){let r=0;for(const[s,o]of n.entries())r=RN(t,r,o,e,0===s?1:-1),i.push(r);return i.pop(),{positions:t,holeIndices:i}}return RN(t,0,n,e,1),t}(e,this.positionSize);return this.opts.resolution?wN(dh(t),dg(t),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?function Fce(n,e=null,t){const{size:i=2,normalize:r=!0,edgeTypes:s=!1}=t||{};e=e||[];const o=[],a=[];let l=0,c=0;for(let d=0;d<=e.length;d++){const h=e[d]||n.length,f=c,p=Nce(n,i,l,h);for(let m=p;m<h;m++)o[c++]=n[m];for(let m=l;m<p;m++)o[c++]=n[m];EN(o,i,f,c),Bce(o,i,f,c,null==t?void 0:t.maxLatitude),l=h,a[d]=c}a.pop();const u=wN(o,a,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(r)for(const d of u)MN(d.positions,i);return u}(dh(t),dg(t),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):t}return e}getGeometrySize(e){if(FN(e)){let t=0;for(const i of e)t+=this.getGeometrySize(i);return t}return dh(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,t){if(e&&FN(e))for(const i of e){const r=this.getGeometrySize(i);t.geometrySize=r,this.updateGeometryAttributes(i,t),t.vertexStart+=r,t.indexStart=this.indexStarts[t.geometryIndex+1]}else this._updateIndices(e,t),this._updatePositions(e,t),this._updateVertexValid(e,t)}_updateIndices(e,{geometryIndex:t,vertexStart:i,indexStart:r}){const{attributes:s,indexStarts:o,typedArrayManager:a}=this;let l=s.indices;if(!l||!e)return;let c=r;const u=function sue(n,e,t){let i=dg(n);i&&(i=i.map(s=>s/e));let r=dh(n);if(t){const s=r.length;r=r.slice();const o=[];for(let a=0;a<s;a+=e){o[0]=r[a],o[1]=r[a+1];const l=t(o);r[a]=l[0],r[a+1]=l[1]}}return Qce()(r,i,e)}(e,this.positionSize,this.opts.preproject);l=a.allocate(l,r+u.length,{copy:!0});for(let d=0;d<u.length;d++)l[c++]=u[d]+i;o[t+1]=r+u.length,s.indices=l}_updatePositions(e,{vertexStart:t,geometrySize:i}){const{attributes:{positions:r},positionSize:s}=this;if(!r||!e)return;const o=dh(e);for(let a=t,l=0;l<i;a++,l++){const u=o[l*s+1],d=s>2?o[l*s+2]:0;r[3*a]=o[l*s],r[3*a+1]=u,r[3*a+2]=d}}_updateVertexValid(e,{vertexStart:t,geometrySize:i}){const{positionSize:r}=this,s=this.attributes.vertexValid,o=e&&dg(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,t):s.fill(1,t,t+i),o)for(let a=0;a<o.length;a++)s[t+o[a]/r-1]=0;s[t+i-1]=0}}function FN(n){return Array.isArray(n)&&n.length>0&&!Number.isFinite(n[0])}const NN="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    // normals generated by the polygon tesselator are in lnglat offsets instead of meters\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n  }\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n  #ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n  #else\n    normal = project_normal(vec3(0.0, 0.0, 1.0));\n  #endif\n    geometry.normal = normal;\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",aue="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(NN,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),lue="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(NN,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n"),hg=[0,0,0,255],uue={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:n=>n.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:hg},getLineColor:{type:"accessor",value:hg},material:!0},fg={enter:(n,e)=>e.length?e.subarray(e.length-n.length):n};class pC extends no{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(e){return super.getShaders({vs:"top"===e?aue:lue,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[Bc,Xce,Vc]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:t}=this.context;let{coordinateSystem:i}=this.props;t.isGeospatial&&i===gt.DEFAULT&&(i=gt.LNGLAT),this.setState({numInstances:0,polygonTesselator:new oue({preproject:i===gt.LNGLAT&&t.projectFlat.bind(t),fp64:this.use64bitPositions(),IndexType:!e||px(e,"ELEMENT_INDEX_UINT32")?Uint32Array:Uint16Array})});const r=this.getAttributeManager(),s=!0;r.remove(["instancePickingColors"]),r.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:fg,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,transition:fg,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:fg,accessor:"getFillColor",defaultValue:hg,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:fg,accessor:"getLineColor",defaultValue:hg,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(o,{index:a,target:l})=>this.encodePickingColor(o&&o.__source?o.__source.index:a,l),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:i}=t,{data:r}=this.props;return r[0]&&r[0].__source&&(t.object=r.find(s=>s.__source.index===i)),t}disablePickingIndex(e){const{data:t}=this.props;if(t[0]&&t[0].__source)for(let i=0;i<t.length;i++)t[i].__source.index===e&&this._disablePickingIndex(i);else this._disablePickingIndex(e)}draw({uniforms:e}){const{extruded:t,filled:i,wireframe:r,elevationScale:s}=this.props,{topModel:o,sideModel:a,polygonTesselator:l}=this.state,c=X(k({},e),{extruded:Boolean(t),elevationScale:s});a&&(a.setInstanceCount(l.instanceCount-1),a.setUniforms(c),r&&(a.setDrawMode(3),a.setUniforms({isWireframe:!0}).draw()),i&&(a.setDrawMode(6),a.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(l.vertexCount),o.setUniforms(c).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:t,oldProps:i,changeFlags:r}=e,s=this.getAttributeManager();var a;(r.extensionsChanged||t.filled!==i.filled||t.extruded!==i.extruded)&&(null===(a=this.state.models)||void 0===a||a.forEach(l=>l.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll())}updateGeometry({props:e,changeFlags:i}){if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,o=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:o.getPolygon,buffers:o,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:t,filled:i,extruded:r}=this.props;let s,o;if(i){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1,s=new qo(e,X(k({},a),{id:"".concat(t,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0}))}return r&&(o=new qo(e,X(k({},this.getShaders("side")),{id:"".concat(t,"-side"),geometry:new zc({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1})),o.userData.excludeAttributes={indices:!0}),{models:[o,s].filter(Boolean),topModel:s,sideModel:o}}calculateIndices(e){const{polygonTesselator:t}=this.state;e.startIndices=t.indexStarts,e.value=t.get("indices")}calculatePositions(e){const{polygonTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}g(pC,"defaultProps",uue),g(pC,"layerName","SolidPolygonLayer");const pg={circle:{type:nC,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:ig,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:oC,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},mg={type:hC,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},mC={type:pC,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function hh({type:n,props:e}){const t={};for(const i in e)t[i]=n.defaultProps[e[i]];return t}function gC(n,e){const{transitions:t,updateTriggers:i}=n.props,r={updateTriggers:{},transitions:t&&{getPosition:t.geometry}};for(const s in e){const o=e[s];let a=n.props[s];s.startsWith("get")&&(a=n.getSubLayerAccessor(a),r.updateTriggers[o]=i[s],t&&(r.transitions[o]=t[s])),r[o]=a}return r}function BN(n,e,t={}){const i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:s=n.length}=t;for(let o=r;o<s;o++){const a=n[o];Ye.assert(a&&a.geometry,"GeoJSON does not have geometry");const{geometry:l}=a;if("GeometryCollection"===l.type){Ye.assert(Array.isArray(l.geometries),"GeoJSON does not have geometries array");const{geometries:c}=l;for(let u=0;u<c.length;u++)VN(c[u],i,e,a,o)}else VN(l,i,e,a,o)}return i}function VN(n,e,t,i,r){const{type:s,coordinates:o}=n,{pointFeatures:a,lineFeatures:l,polygonFeatures:c,polygonOutlineFeatures:u}=e;if(function fue(n,e){let t=hue[n];for(Ye.assert(t,"Unknown GeoJSON type ".concat(n));e&&--t>0;)e=e[0];return e&&Number.isFinite(e[0])}(s,o))switch(s){case"Point":a.push(t({geometry:n},i,r));break;case"MultiPoint":o.forEach(d=>{a.push(t({geometry:{type:"Point",coordinates:d}},i,r))});break;case"LineString":l.push(t({geometry:n},i,r));break;case"MultiLineString":o.forEach(d=>{l.push(t({geometry:{type:"LineString",coordinates:d}},i,r))});break;case"Polygon":c.push(t({geometry:n},i,r)),o.forEach(d=>{u.push(t({geometry:{type:"LineString",coordinates:d}},i,r))});break;case"MultiPolygon":o.forEach(d=>{c.push(t({geometry:{type:"Polygon",coordinates:d}},i,r)),d.forEach(h=>{u.push(t({geometry:{type:"LineString",coordinates:h}},i,r))})})}else Ye.warn("".concat(s," coordinates are malformed"))()}const hue={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function gg(n){return n.geometry.coordinates}const gue=["points","linestrings","polygons"],_ue=X(k(k(k(k(k({},hh(pg.circle)),hh(pg.icon)),hh(pg.text)),hh(mg)),hh(mC)),{stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:n=>n.properties.icon},getText:{type:"accessor",value:n=>n.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}});class fh extends ng{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:t}){if(!t.dataChanged)return;const{data:i}=this.props,r=i&&"points"in i&&"polygons"in i&&"lines"in i;this.setState({binary:r}),r?this._updateStateBinary({props:e,changeFlags:t}):this._updateStateJSON({props:e,changeFlags:t})}_updateStateBinary({props:e}){const i=function mue(n,e){const t={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:i,lines:r,polygons:s}=n,o=function Ele(n,e){const t={points:null,lines:null,polygons:null};for(const i in t){const r=n[i].globalFeatureIds.value;t[i]=new Uint8ClampedArray(3*r.length);const s=[];for(let o=0;o<r.length;o++)e(r[o],s),t[i][3*o+0]=s[0],t[i][3*o+1]=s[1],t[i][3*o+2]=s[2]}return t}(n,e);return t.points.data={length:i.positions.value.length/i.positions.size,attributes:X(k({},i.attributes),{getPosition:i.positions,instancePickingColors:{size:3,value:o.points}}),properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},t.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:X(k({},r.attributes),{getPath:r.positions,instancePickingColors:{size:3,value:o.lines}}),properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},t.lines._pathType="open",t.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:X(k({},s.attributes),{getPolygon:s.positions,pickingColors:{size:3,value:o.polygons}}),properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},t.polygons._normalize=!1,s.triangles&&(t.polygons.data.attributes.indices=s.triangles.value),t.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:X(k({},s.attributes),{getPath:s.positions,instancePickingColors:{size:3,value:o.polygons}}),properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},t.polygonsOutline._pathType="open",t}(e.data,this.encodePickingColor);this.setState({layerProps:i})}_updateStateJSON({props:e,changeFlags:t}){const i=function due(n){if(Array.isArray(n))return n;switch(Ye.assert(n.type,"GeoJSON does not have type"),n.type){case"Feature":return[n];case"FeatureCollection":return Ye.assert(Array.isArray(n.features),"GeoJSON does not have features array"),n.features;default:return[{geometry:n}]}}(e.data),r=this.getSubLayerRow.bind(this);let s={};const o={};if(Array.isArray(t.dataChanged)){const l=this.state.features;for(const c in l)s[c]=l[c].slice(),o[c]=[];for(const c of t.dataChanged){const u=BN(i,r,c);for(const d in l)o[d].push(wle({data:s[d],getIndex:h=>h.__source.index,dataRange:c,replace:u[d]}))}}else s=BN(i,r);const a=function pue(n,e){const t={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:i,lineFeatures:r,polygonFeatures:s,polygonOutlineFeatures:o}=n;return t.points.data=i,t.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),t.points.getPosition=gg,t.lines.data=r,t.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),t.lines.getPath=gg,t.polygons.data=s,t.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),t.polygons.getPolygon=gg,t.polygonsOutline.data=o,t.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),t.polygonsOutline.getPath=gg,t}(s,o);this.setState({features:s,featuresDiff:o,layerProps:a})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:i,sourceLayer:r}=t;return t.featureType=gue.find(s=>r.id.startsWith("".concat(this.id,"-").concat(s,"-"))),i>=0&&r.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(t.index=this.props.data.points.globalFeatureIds.value[i]),t}_updateAutoHighlight(e){const t="".concat(this.id,"-points-"),i="points"===e.featureType;for(const r of this.getSubLayers())r.id.startsWith(t)===i&&r.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:t}=this.props,{layerProps:i}=this.state,r="polygons-fill",s=this.shouldRenderSubLayer(r,i.polygons.data)&&this.getSubLayerClass(r,mC.type);if(s){const o=gC(this,mC.props),a=e&&t;return a||delete o.getLineColor,o.updateTriggers.lineColors=a,new s(o,this.getSubLayerProps({id:r,updateTriggers:o.updateTriggers}),i.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:t}=this.props,{layerProps:i}=this.state,r="polygons-stroke",s="linestrings",o=!e&&t&&this.shouldRenderSubLayer(r,i.polygonsOutline.data)&&this.getSubLayerClass(r,mg.type),a=this.shouldRenderSubLayer(s,i.lines.data)&&this.getSubLayerClass(s,mg.type);if(o||a){const l=gC(this,mg.props);return[o&&new o(l,this.getSubLayerProps({id:r,updateTriggers:l.updateTriggers}),i.polygonsOutline),a&&new a(l,this.getSubLayerProps({id:s,updateTriggers:l.updateTriggers}),i.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:t,binary:i}=this.state;let{highlightedObjectIndex:r}=this.props;!i&&Number.isFinite(r)&&(r=t.points.data.findIndex(l=>l.__source.index===r));const s=new Set(e.split("+")),o=[];for(const l of s){const c="points-".concat(l),u=pg[l],d=u&&this.shouldRenderSubLayer(c,t.points.data)&&this.getSubLayerClass(c,u.type);if(d){const h=gC(this,u.props);let f=t.points;if("text"===l&&i){const m=XC(f.data.attributes,["instancePickingColors"]);f=X(k({},f),{data:X(k({},f.data),{attributes:m})})}o.push(new d(h,this.getSubLayerProps({id:c,updateTriggers:h.updateTriggers,highlightedObjectIndex:r}),f))}}return o}renderLayers(){const{extruded:e}=this.props,t=this._renderPolygonLayer();return[!e&&t,this._renderLineLayers(),this._renderPointLayers(),e&&t]}getSubLayerAccessor(e){const{binary:t}=this.state;return t&&"function"==typeof e?(i,r)=>{const{data:s,index:o}=r,a=function xle(n,e){if(!n)return null;const t="startIndices"in n?n.startIndices[e]:e;return-1!==t?function Cle(n,e,t){const i={properties:k({},n.properties[e])};for(const r in n.numericProps)i.properties[r]=n.numericProps[r].value[t];return i}(n,n.featureIds.value[t],t):null}(s,o);return e(a,r)}:super.getSubLayerAccessor(e)}}function yue(n,e,t){const i=function jN(n){const e={};for(const t of n)if(t.properties)for(const i in t.properties)e[i]=Mue(t.properties[i],e[i]);return e}(n),r=Object.keys(i).filter(s=>i[s]!==Array);return function vue(n,e,t){const{pointPositionsCount:i,pointFeaturesCount:r,linePositionsCount:s,linePathsCount:o,lineFeaturesCount:a,polygonPositionsCount:l,polygonObjectsCount:c,polygonRingsCount:u,polygonFeaturesCount:d,propArrayTypes:h,coordLength:f}=e,{numericPropKeys:p=[],PositionDataType:m=Float32Array}=t,_=n[0]&&"id"in n[0],y=n.length>65535?Uint32Array:Uint16Array,v={type:"Point",positions:new m(i*f),globalFeatureIds:new y(i),featureIds:r>65535?new Uint32Array(i):new Uint16Array(i),numericProps:{},properties:[],fields:[]},E={type:"LineString",pathIndices:s>65535?new Uint32Array(o+1):new Uint16Array(o+1),positions:new m(s*f),globalFeatureIds:new y(s),featureIds:a>65535?new Uint32Array(s):new Uint16Array(s),numericProps:{},properties:[],fields:[]},M={type:"Polygon",polygonIndices:l>65535?new Uint32Array(c+1):new Uint16Array(c+1),primitivePolygonIndices:l>65535?new Uint32Array(u+1):new Uint16Array(u+1),positions:new m(l*f),triangles:[],globalFeatureIds:new y(l),featureIds:d>65535?new Uint32Array(l):new Uint16Array(l),numericProps:{},properties:[],fields:[]};for(const B of[v,E,M])for(const V of p)B.numericProps[V]=new(0,h[V])(B.positions.length/f);E.pathIndices[o]=s,M.polygonIndices[c]=l,M.primitivePolygonIndices[u]=l;const R={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(const B of n){const V=B.geometry,Z=B.properties||{};switch(V.type){case"Point":bue(V,v,R,f,Z),v.properties.push(vC(Z,p)),_&&v.fields.push({id:B.id}),R.pointFeature++;break;case"LineString":wue(V,E,R,f,Z),E.properties.push(vC(Z,p)),_&&E.fields.push({id:B.id}),R.lineFeature++;break;case"Polygon":xue(V,M,R,f,Z),M.properties.push(vC(Z,p)),_&&M.fields.push({id:B.id}),R.polygonFeature++;break;default:throw new Error("Invalid geometry type")}R.feature++}return function Eue(n,e,t,i){return{points:X(k({},n),{positions:{value:n.positions,size:i},globalFeatureIds:{value:n.globalFeatureIds,size:1},featureIds:{value:n.featureIds,size:1},numericProps:_C(n.numericProps,1)}),lines:X(k({},e),{positions:{value:e.positions,size:i},pathIndices:{value:e.pathIndices,size:1},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:_C(e.numericProps,1)}),polygons:X(k({},t),{positions:{value:t.positions,size:i},polygonIndices:{value:t.polygonIndices,size:1},primitivePolygonIndices:{value:t.primitivePolygonIndices,size:1},triangles:{value:new Uint32Array(t.triangles),size:1},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:_C(t.numericProps,1)})}}(v,E,M,f)}(n,k({propArrayTypes:i},e),{numericPropKeys:t&&t.numericPropKeys||r,PositionDataType:t?t.PositionDataType:Float32Array})}function bue(n,e,t,i,r){e.positions.set(n.data,t.pointPosition*i);const s=n.data.length/i;yC(e,r,t.pointPosition,s),e.globalFeatureIds.fill(t.feature,t.pointPosition,t.pointPosition+s),e.featureIds.fill(t.pointFeature,t.pointPosition,t.pointPosition+s),t.pointPosition+=s}function wue(n,e,t,i,r){e.positions.set(n.data,t.linePosition*i);const s=n.data.length/i;yC(e,r,t.linePosition,s),e.globalFeatureIds.fill(t.feature,t.linePosition,t.linePosition+s),e.featureIds.fill(t.lineFeature,t.linePosition,t.linePosition+s);for(let o=0,a=n.indices.length;o<a;++o){const l=n.indices[o],c=o===a-1?n.data.length:n.indices[o+1];e.pathIndices[t.linePath++]=t.linePosition,t.linePosition+=(c-l)/i}}function xue(n,e,t,i,r){e.positions.set(n.data,t.polygonPosition*i);const s=n.data.length/i;yC(e,r,t.polygonPosition,s),e.globalFeatureIds.fill(t.feature,t.polygonPosition,t.polygonPosition+s),e.featureIds.fill(t.polygonFeature,t.polygonPosition,t.polygonPosition+s);for(let o=0,a=n.indices.length;o<a;++o){const l=t.polygonPosition;e.polygonIndices[t.polygonObject++]=l;const c=n.areas[o],u=n.indices[o],d=n.indices[o+1];for(let f=0,p=u.length;f<p;++f){const m=u[f],_=f===p-1?void 0===d?n.data.length:d[0]:u[f+1];e.primitivePolygonIndices[t.polygonRing++]=t.polygonPosition,t.polygonPosition+=(_-m)/i}Cue(e,c,u,{startPosition:l,endPosition:t.polygonPosition,coordLength:i})}}function Cue(n,e,t,{startPosition:i,endPosition:r,coordLength:s}){const l=n.positions.subarray(i*s,r*s),c=t[0],d=function mce(n,e,t=2,i){const r=e&&e.length,s=r?e[0]*t:n.length;let o=mN(n,0,s,t,!0,i&&i[0]);const a=[];if(!o||o.next===o.prev)return a;let l,c,u,d,h,f,p;if(r&&(o=function bce(n,e,t,i,r){const s=[];let o,a,l,c,u;for(o=0,a=e.length;o<a;o++)l=e[o]*i,c=o<a-1?e[o+1]*i:n.length,u=mN(n,l,c,i,!1,r&&r[o+1]),u===u.next&&(u.steiner=!0),s.push(Sce(u));for(s.sort(wce),o=0;o<s.length;o++)xce(s[o],t),t=$o(t,t.next);return t}(n,e,o,t,i)),n.length>80*t){d=c=n[0],h=u=n[1];for(let m=t;m<s;m+=t)f=n[m],p=n[m+1],f<d&&(d=f),p<h&&(h=p),f>c&&(c=f),p>u&&(u=p);l=Math.max(c-d,u-h),l=0!==l?1/l:0}return ah(o,a,t,d,h,l),a}(l,t.slice(1).map(h=>(h-c)/s),s,e);for(let h=0,f=d.length;h<f;++h)n.triangles.push(i+d[h])}function _C(n,e){const t={};for(const i in n)t[i]={value:n[i],size:e};return t}function yC(n,e,t,i){for(const r in n.numericProps)r in e&&n.numericProps[r].fill(e[r],t,t+i)}function vC(n,e){const t={};for(const i in n)e.includes(i)||(t[i]=n[i]);return t}function Mue(n,e){return e!==Array&&Number.isFinite(n)?e===Float64Array||Math.fround(n)!==n?Float64Array:Float32Array:Array}g(fh,"layerName","GeoJsonLayer"),g(fh,"defaultProps",_ue);var Tue=Re(808),UN=Re.n(Tue);function Aue(n){let e=0;for(let r,s,t=0,i=n.length-1;t<n.length;i=t++)r=n[t],s=n[i],e+=(s[0]-r[0])*(r[1]+s[1]);return e}function Due(n,e,t){e&&t&&(1===n?e.id=t.readVarint():2===n?function Iue(n,e){const t=n.readVarint()+n.pos;for(;n.pos<t;){const i=e._keys[n.readVarint()],r=e._values[n.readVarint()];e.properties[i]=r}}(t,e):3===n?e.type=t.readVarint():4===n&&(e._geometry=t.pos))}class bC{static get types(){return["Unknown","Point","LineString","Polygon"]}constructor(e,t,i,r,s){g(this,"properties",void 0),g(this,"extent",void 0),g(this,"type",void 0),g(this,"id",void 0),g(this,"_pbf",void 0),g(this,"_geometry",void 0),g(this,"_keys",void 0),g(this,"_values",void 0),this.properties={},this.extent=i,this.type=0,this.id=null,this._pbf=e,this._geometry=-1,this._keys=r,this._values=s,e.readFields(Due,this,t)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const t=e.readVarint()+e.pos;let i=1,r=0,s=0,o=0;const a=[];let l;for(;e.pos<t;){if(r<=0){const c=e.readVarint();i=7&c,r=c>>3}if(r--,1===i||2===i)s+=e.readSVarint(),o+=e.readSVarint(),1===i&&(l&&a.push(l),l=[]),l&&l.push([s,o]);else{if(7!==i)throw new Error("unknown command ".concat(i));l&&l.push(l[0].slice())}}return l&&a.push(l),a}bbox(){const e=this._pbf;e.pos=this._geometry;const t=e.readVarint()+e.pos;let i=1,r=0,s=0,o=0,a=1/0,l=-1/0,c=1/0,u=-1/0;for(;e.pos<t;){if(r<=0){const d=e.readVarint();i=7&d,r=d>>3}if(r--,1===i||2===i)s+=e.readSVarint(),o+=e.readSVarint(),s<a&&(a=s),s>l&&(l=s),o<c&&(c=o),o>u&&(u=o);else if(7!==i)throw new Error("unknown command ".concat(i))}return[a,c,l,u]}_toGeoJSON(e){let r,s,t=this.loadGeometry(),i=bC.types[this.type];switch(this.type){case 1:const a=[];for(r=0;r<t.length;r++)a[r]=t[r][0];t=a,e(t,this);break;case 2:for(r=0;r<t.length;r++)e(t[r],this);break;case 3:for(t=function Sue(n){const e=n.length;if(e<=1)return[n];const t=[];let i,r;for(let s=0;s<e;s++){const o=Aue(n[s]);0!==o&&(void 0===r&&(r=o<0),r===o<0?(i&&t.push(i),i=[n[s]]):i&&i.push(n[s]))}return i&&t.push(i),t}(t),r=0;r<t.length;r++)for(s=0;s<t[r].length;s++)e(t[r][s],this)}1===t.length?t=t[0]:i="Multi".concat(i);const o={type:"Feature",geometry:{type:i,coordinates:t},properties:this.properties};return null!==this.id&&(o.id=this.id),o}toGeoJSON(e){if("function"==typeof e)return this._toGeoJSON(e);const{x:t,y:i,z:r}=e,s=this.extent*Math.pow(2,r),o=this.extent*t,a=this.extent*i;return this._toGeoJSON(function l(c){for(let u=0;u<c.length;u++){const d=c[u];d[0]=360*(d[0]+o)/s-180,d[1]=360/Math.PI*Math.atan(Math.exp((180-360*(d[1]+a)/s)*Math.PI/180))-90}})}}class Pue{constructor(e,t){g(this,"version",void 0),g(this,"name",void 0),g(this,"extent",void 0),g(this,"length",void 0),g(this,"_pbf",void 0),g(this,"_keys",void 0),g(this,"_values",void 0),g(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(kue,this,t),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const t=this._pbf.readVarint()+this._pbf.pos;return new bC(this._pbf,t,this.extent,this._keys,this._values)}}function kue(n,e,t){e&&t&&(15===n?e.version=t.readVarint():1===n?e.name=t.readString():5===n?e.extent=t.readVarint():2===n?e._features.push(t.pos):3===n?e._keys.push(t.readString()):4===n&&e._values.push(function Oue(n){let e=null;const t=n.readVarint()+n.pos;for(;n.pos<t;){const i=n.readVarint()>>3;e=1===i?n.readString():2===i?n.readFloat():3===i?n.readDouble():4===i?n.readVarint64():5===i?n.readVarint():6===i?n.readSVarint():7===i?n.readBoolean():null}return e}(t)))}class Rue{constructor(e,t){g(this,"layers",void 0),this.layers=e.readFields(Lue,{},t)}}function Lue(n,e,t){if(3===n&&t){const i=new Pue(t,t.readVarint()+t.pos);i.length&&e&&(e[i.name]=i)}}function Nue(n,e,t){e&&t&&(1===n?e.id=t.readVarint():2===n?function Bue(n,e){const t=n.readVarint()+n.pos;for(;n.pos<t;){const i=e._keys[n.readVarint()],r=e._values[n.readVarint()];e.properties[i]=r}}(t,e):3===n?e.type=t.readVarint():4===n&&(e._geometry=t.pos))}let GN,Ha,wC,_g,xC,CC,ph;class Vue{constructor(e,t,i,r,s,o){g(this,"properties",void 0),g(this,"extent",void 0),g(this,"type",void 0),g(this,"id",void 0),g(this,"_pbf",void 0),g(this,"_geometry",void 0),g(this,"_keys",void 0),g(this,"_values",void 0),g(this,"_geometryInfo",void 0),this.properties={},this.extent=i,this.type=0,this.id=null,this._pbf=e,this._geometry=-1,this._keys=r,this._values=s,this._geometryInfo=o,e.readFields(Nue,this,t)}loadGeometry(){const e=this._pbf;e.pos=this._geometry,GN=e.readVarint()+e.pos,Ha=1,_g=0,xC=0,CC=0,ph=0;const t=[],i=[];for(;e.pos<GN;)if(_g<=0&&(wC=e.readVarint(),Ha=7&wC,_g=wC>>3),_g--,1===Ha||2===Ha)xC+=e.readSVarint(),CC+=e.readSVarint(),1===Ha&&t.push(ph),i.push(xC,CC),ph+=2;else{if(7!==Ha)throw new Error("unknown command ".concat(Ha));if(ph>0){const r=t[t.length-1];i.push(i[r],i[r+1]),ph+=2}}return{data:i,indices:t}}_toBinaryCoordinates(e){const t=this.loadGeometry();let i;switch(e(t.data,this),this.type){case 1:this._geometryInfo.pointFeaturesCount++,this._geometryInfo.pointPositionsCount+=t.indices.length,i=k({type:"Point"},t);break;case 2:this._geometryInfo.lineFeaturesCount++,this._geometryInfo.linePathsCount+=t.indices.length,this._geometryInfo.linePositionsCount+=t.data.length/2,i=k({type:"LineString"},t);break;case 3:i=function HN(n){const e=n.indices.length,t="Polygon";if(e<=1)return{type:t,data:n.data,areas:[[sg(n.data)]],indices:[n.indices]};const i=[],r=[];let a,s=[],o=[],l=0;for(let c,d,u=0;u<e;u++){d=n.indices[u]-l,c=n.indices[u+1]-l||n.data.length;const f=sg(n.data.slice(d,c));if(0!==f)void 0===a&&(a=f<0),a===f<0?(o.length&&(i.push(s),r.push(o)),o=[d],s=[f]):(s.push(f),o.push(d));else{const p=n.data.slice(0,d),m=n.data.slice(c);n.data=p.concat(m),l+=c-d}}return s&&i.push(s),o.length&&r.push(o),{type:t,areas:i,indices:r,data:n.data}}(t),this._geometryInfo.polygonFeaturesCount++,this._geometryInfo.polygonObjectsCount+=i.indices.length;for(const o of i.indices)this._geometryInfo.polygonRingsCount+=o.length;this._geometryInfo.polygonPositionsCount+=i.data.length/2;break;default:throw new Error("Invalid geometry type: ".concat(this.type))}const s={type:"Feature",geometry:i,properties:this.properties};return null!==this.id&&(s.id=this.id),s}toBinaryCoordinates(e){if("function"==typeof e)return this._toBinaryCoordinates(e);const{x:t,y:i,z:r}=e,s=this.extent*Math.pow(2,r),o=this.extent*t,a=this.extent*i;return this._toBinaryCoordinates(l=>function Fue(n,e,t,i){for(let r=0,s=n.length;r<s;r+=2)n[r]=360*(n[r]+e)/i-180,n[r+1]=360/Math.PI*Math.atan(Math.exp((180-360*(n[r+1]+t)/i)*Math.PI/180))-90}(l,o,a,s))}}class zue{constructor(e,t){g(this,"version",void 0),g(this,"name",void 0),g(this,"extent",void 0),g(this,"length",void 0),g(this,"_pbf",void 0),g(this,"_keys",void 0),g(this,"_values",void 0),g(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(jue,this,t),this.length=this._features.length}feature(e,t){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const i=this._pbf.readVarint()+this._pbf.pos;return new Vue(this._pbf,i,this.extent,this._keys,this._values,t)}}function jue(n,e,t){e&&t&&(15===n?e.version=t.readVarint():1===n?e.name=t.readString():5===n?e.extent=t.readVarint():2===n?e._features.push(t.pos):3===n?e._keys.push(t.readString()):4===n&&e._values.push(function Uue(n){let e=null;const t=n.readVarint()+n.pos;for(;n.pos<t;){const i=n.readVarint()>>3;e=1===i?n.readString():2===i?n.readFloat():3===i?n.readDouble():4===i?n.readVarint64():5===i?n.readVarint():6===i?n.readSVarint():7===i?n.readBoolean():null}return e}(t)))}class Hue{constructor(e,t){g(this,"layers",void 0),this.layers=e.readFields(Gue,{},t)}}function Gue(n,e,t){if(3===n&&t){const i=new zue(t,t.readVarint()+t.pos);i.length&&e&&(e[i.name]=i)}}function WN(n,e){var t,i;const r=function que(n){var e;if(null==n||!n.mvt)throw new Error("mvt options required");const t="wgs84"===(null===(e=n.mvt)||void 0===e?void 0:e.coordinates),{tileIndex:i}=n.mvt,r=i&&Number.isFinite(i.x)&&Number.isFinite(i.y)&&Number.isFinite(i.z);if(t&&!r)throw new Error("MVT Loader: WGS84 coordinates need tileIndex property");return n.mvt}(e),s=(null==e||null===(t=e.gis)||void 0===t?void 0:t.format)||(null==e||null===(i=e.mvt)||void 0===i?void 0:i.shape);switch(s){case"columnar-table":return{shape:"columnar-table",data:EC(n,r)};case"geojson-row-table":return{shape:"geojson-row-table",data:qN(n,r)};case"geojson":return qN(n,r);case"binary-geometry":case"binary":return EC(n,r);default:throw new Error(s)}}function EC(n,e){const[t,i]=function Wue(n,e){const t=[],i={coordLength:2,pointPositionsCount:0,pointFeaturesCount:0,linePositionsCount:0,linePathsCount:0,lineFeaturesCount:0,polygonPositionsCount:0,polygonObjectsCount:0,polygonRingsCount:0,polygonFeaturesCount:0};if(n.byteLength<=0)return[t,i];const r=new Hue(new(UN())(n));return(e&&Array.isArray(e.layers)?e.layers:Object.keys(r.layers)).forEach(o=>{const a=r.layers[o];if(a)for(let l=0;l<a.length;l++){const u=Yue(a.feature(l,i),e,o);t.push(u)}}),[t,i]}(n,e),r=yue(t,i);return r.byteLength=n.byteLength,r}function qN(n,e){if(n.byteLength<=0)return[];const t=[],i=new Rue(new(UN())(n));return(Array.isArray(e.layers)?e.layers:Object.keys(i.layers)).forEach(s=>{const o=i.layers[s];if(o)for(let a=0;a<o.length;a++){const c=$ue(o.feature(a),e,s);t.push(c)}}),t}function $ue(n,e,t){const i=n.toGeoJSON("wgs84"===e.coordinates?e.tileIndex:Zue);return e.layerProperty&&(i.properties[e.layerProperty]=t),i}function Yue(n,e,t){const i=n.toBinaryCoordinates("wgs84"===e.coordinates?e.tileIndex:Xue);return e.layerProperty&&i.properties&&(i.properties[e.layerProperty]=t),i}function Zue(n,e){const{extent:t}=e;for(let i=0;i<n.length;i++){const r=n[i];r[0]/=t,r[1]/=t}}function Xue(n,e){const{extent:t}=e;for(let i=0,r=n.length;i<r;++i)n[i]/=t}const $N={name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:"3.2.9",extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:{mvt:{shape:"geojson",coordinates:"local",layerProperty:"layerName",layers:void 0,tileIndex:null}}};function YN(n,e){const t=null==e?void 0:e.globalFeatureId;return void 0!==t?function Kue(n,e){const t=KN(n);for(const i of t){let r=0,s=i.featureIds.value[0];for(let o=0;o<i.featureIds.value.length;o++){const a=i.featureIds.value[o];if(a!==s){if(e===i.globalFeatureIds.value[r])return yg(i,r,o);r=o,s=a}}if(e===i.globalFeatureIds.value[r])return yg(i,r,i.featureIds.value.length)}throw new Error("featureId:".concat(e," not found"))}(n,t):function ZN(n,e){return function Que(n){const e=[];for(const t of n){if(0===t.featureIds.value.length)continue;let i=0,r=t.featureIds.value[0];for(let s=0;s<t.featureIds.value.length;s++){const o=t.featureIds.value[s];o!==r&&(e.push(yg(t,i,s)),i=s,r=o)}e.push(yg(t,i,t.featureIds.value.length))}return e}(KN(n,e))}(n,null==e?void 0:e.type)}function XN(n,e,t){switch(n.type){case"Point":return function nde(n,e,t){const{positions:i}=n,r=vg(i,e,t);return r.length>1?{type:"MultiPoint",coordinates:r}:{type:"Point",coordinates:r[0]}}(n,e,t);case"LineString":return function tde(n,e=-1/0,t=1/0){const{positions:i}=n,r=n.pathIndices.value.filter(a=>a>=e&&a<=t);if(!(r.length>2))return{type:"LineString",coordinates:vg(i,r[0],r[1])};const o=[];for(let a=0;a<r.length-1;a++){const l=vg(i,r[a],r[a+1]);o.push(l)}return{type:"MultiLineString",coordinates:o}}(n,e,t);case"Polygon":return QN(n,e,t);default:const i=n;throw new Error("Unsupported geometry type: ".concat(null==i?void 0:i.type))}}function KN(n,e){if(!Boolean(n.points||n.lines||n.polygons))return n.type=e||function ide(n){return n.pathIndices?"LineString":n.polygonIndices?"Polygon":"Point"}(n),[n];const i=[];return n.points&&(n.points.type="Point",i.push(n.points)),n.lines&&(n.lines.type="LineString",i.push(n.lines)),n.polygons&&(n.polygons.type="Polygon",i.push(n.polygons)),i}function yg(n,e,t){const i=XN(n,e,t),r=function ede(n,e=0,t){const i=Object.assign({},n.properties[n.featureIds.value[e]]);for(const r in n.numericProps)i[r]=n.numericProps[r].value[e];return i}(n,e),s=function Jue(n,e=0,t){return n.fields&&n.fields[n.featureIds.value[e]]}(n,e);return k({type:"Feature",geometry:i,properties:r},s)}function QN(n,e=-1/0,t=1/0){const{positions:i}=n,r=n.polygonIndices.value.filter(l=>l>=e&&l<=t),s=n.primitivePolygonIndices.value.filter(l=>l>=e&&l<=t);if(!(r.length>2)){const l=[];for(let c=0;c<s.length-1;c++){const h=vg(i,s[c],s[c+1]);l.push(h)}return{type:"Polygon",coordinates:l}}const a=[];for(let l=0;l<r.length-1;l++){const d=QN(n,r[l],r[l+1]).coordinates;a.push(d)}return{type:"MultiPolygon",coordinates:a}}function vg(n,e,t){t=t||n.value.length/n.size;const i=[];for(let r=e=e||0;r<t;r++){const s=Array();for(let o=r*n.size;o<(r+1)*n.size;o++)s.push(Number(n.value[o]));i.push(s)}return i}X(k({},$N),{parse:function(){var n=Bt(function*(e,t){return WN(e,t)});return function(t,i){return n.apply(this,arguments)}}(),parseSync:WN,binary:!0});class JN{constructor(e){g(this,"opts",void 0),e&&(this.opts=e)}equals(e){return this===e||this.constructor===e.constructor&&za(this.opts,e.opts)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:t}=e.constructor,i={updateTriggers:{}};for(const r in t)if(r in this.props){const s=t[r],o=this.props[r];i[r]=o,s&&"accessor"===s.type&&(i.updateTriggers[r]=this.props.updateTriggers[r],"function"==typeof o&&(i[r]=this.getSubLayerAccessor(o)))}return i}initializeState(e,t){}updateState(e,t){}draw(e,t){}finalizeState(e,t){}}g(JN,"defaultProps",{});const eB={clipBounds:[0,0,1,1]},tB="\nuniform vec4 clip_bounds;\n\nbool clip_isInBounds(vec2 position) {\n  return position.x >= clip_bounds[0] && position.y >= clip_bounds[1] && position.x < clip_bounds[2] && position.y < clip_bounds[3];\n}\n",rde={name:"clip-vs",vs:tB},sde={"vs:#decl":"\nvarying float clip_isVisible;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_isVisible = float(clip_isInBounds(geometry.worldPosition.xy));\n","fs:#decl":"\nvarying float clip_isVisible;\n","fs:DECKGL_FILTER_COLOR":"\n  if (clip_isVisible < 0.5) discard;\n"},ode={name:"clip-fs",fs:tB},ade={"vs:#decl":"\nvarying vec2 clip_commonPosition;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_commonPosition = geometry.position.xy;\n","fs:#decl":"\nvarying vec2 clip_commonPosition;\n","fs:DECKGL_FILTER_COLOR":"\n  if (!clip_isInBounds(clip_commonPosition)) discard;\n"};class MC extends JN{getShaders(){let e="instancePositions"in this.getAttributeManager().attributes;return"clipByInstance"in this.props&&(e=this.props.clipByInstance),this.state.clipByInstance=e,e?{modules:[rde],inject:sde}:{modules:[ode],inject:ade}}draw({uniforms:e}){const{clipBounds:t=eB.clipBounds}=this.props;if(this.state.clipByInstance)e.clip_bounds=t;else{const i=this.projectPosition([t[0],t[1],0]),r=this.projectPosition([t[2],t[3],0]);e.clip_bounds=[Math.min(i[0],r[0]),Math.min(i[1],r[1]),Math.max(i[0],r[0]),Math.max(i[1],r[1])]}}}g(MC,"defaultProps",eB),g(MC,"extensionName","ClipExtension");class lde{constructor(e){g(this,"index",void 0),g(this,"isVisible",void 0),g(this,"isSelected",void 0),g(this,"parent",void 0),g(this,"children",void 0),g(this,"content",void 0),g(this,"state",void 0),g(this,"layers",void 0),g(this,"id",void 0),g(this,"bbox",void 0),g(this,"zoom",void 0),g(this,"userData",void 0),g(this,"_abortController",void 0),g(this,"_loader",void 0),g(this,"_loaderId",void 0),g(this,"_isLoaded",void 0),g(this,"_isCancelled",void 0),g(this,"_needsReload",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||Ye.error("byteLength not defined in tile data")(),e}_loadData({getData:e,requestScheduler:t,onLoad:i,onError:r}){var s=this;return Bt(function*(){const{index:o,id:a,bbox:l,userData:c,zoom:u}=s,d=s._loaderId;s._abortController=new AbortController;const{signal:h}=s._abortController,f=yield t.scheduleRequest(s,_=>_.isSelected?1:-1);if(!f)return void(s._isCancelled=!0);if(s._isCancelled)return void f.done();let m,p=null;try{p=yield e({index:o,id:a,bbox:l,userData:c,zoom:u,signal:h})}catch(_){m=_||!0}finally{f.done()}if(d===s._loaderId){if(s._loader=void 0,s.content=p,s._isCancelled&&!p)return void(s._isLoaded=!1);s._isLoaded=!0,s._isCancelled=!1,m?r(m,s):i(s)}})()}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,null===(e=this._abortController)||void 0===e||e.abort())}}const bg=Math.PI/180,nB=180/Math.PI,wg=6370972;function cde(){const n=256/wg,e=Math.PI/180*256;return{unitsPerMeter:[n,n,n],unitsPerMeter2:[0,0,0],metersPerUnit:[1/n,1/n,1/n],unitsPerDegree:[e,e,n],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/n]}}class ude extends Vo{constructor(e={}){const{latitude:t=0,longitude:i=0,zoom:r=0,nearZMultiplier:s=.1,farZMultiplier:o=2,resolution:a=10}=e;let{height:l,altitude:c=1.5}=e;l=l||1,c=Math.max(.75,c);const u=(new zn).lookAt({eye:[0,-c,0],up:[0,0,1]}),d=Math.pow(2,r);u.rotateX(t*bg),u.rotateZ(-i*bg),u.scale(d/l);const h=Math.atan(.5/c),f=512*d/l;super(X(k({},e),{height:l,viewMatrix:u,longitude:i,latitude:t,zoom:r,distanceScales:cde(),fovyRadians:2*h,focalDistance:c,near:s,far:Math.min(2,1/f+1)*c*o})),g(this,"longitude",void 0),g(this,"latitude",void 0),g(this,"resolution",void 0),this.latitude=t,this.longitude=i,this.resolution=a}get projectionMode(){return Ur.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const t={targetZ:e.z||0},i=this.unproject([0,this.height/2],t),r=this.unproject([this.width/2,0],t),s=this.unproject([this.width,this.height/2],t),o=this.unproject([this.width/2,this.height],t);return s[0]<this.longitude&&(s[0]+=360),i[0]>this.longitude&&(i[0]-=360),[Math.min(i[0],s[0],r[0],o[0]),Math.min(i[1],s[1],r[1],o[1]),Math.max(i[0],s[0],r[0],o[0]),Math.max(i[1],s[1],r[1],o[1])]}unproject(e,{topLeft:t=!0,targetZ:i}={}){const[r,s,o]=e,a=t?s:this.height-s,{pixelUnprojectionMatrix:l}=this;let c;if(Number.isFinite(o))c=TC(l,[r,a,o,1]);else{const f=TC(l,[r,a,-1,1]),p=TC(l,[r,a,1,1]),m=256*((i||0)/wg+1),_=Fw(nL([],f,p)),y=Fw(f),v=Fw(p),M=(4*y*v-(_-y-v)**2)/16*4/_;c=function lee(n,e,t,i){var r=e[0],s=e[1],o=e[2];return n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n[2]=o+i*(t[2]-o),n}([],f,p,(Math.sqrt(y-M)-Math.sqrt(Math.max(0,m*m-M)))/Math.sqrt(_))}const[u,d,h]=this.unprojectPosition(c);return Number.isFinite(o)?[u,d,h]:Number.isFinite(i)?[u,d,i]:[u,d]}projectPosition(e){const[t,i,r=0]=e,s=t*bg,o=i*bg,a=Math.cos(o),l=256*(r/wg+1);return[Math.sin(s)*a*l,-Math.cos(s)*a*l,Math.sin(o)*l]}unprojectPosition(e){const[t,i,r]=e,s=iL(e),o=Math.asin(r/s);return[Math.atan2(t,-i)*nB,o*nB,(s/256-1)*wg]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,t){const i=this.unproject(t);return{longitude:e[0]-i[0]+this.longitude,latitude:e[1]-i[1]+this.latitude}}}function TC(n,e){const t=Mc([],e,n);return jw(t,t,1/t[3]),t}const iB=new le,dde=new le;class SC{constructor(e=[0,0,0],t=[0,0,0],i){g(this,"center",void 0),g(this,"halfDiagonal",void 0),g(this,"minimum",void 0),g(this,"maximum",void 0),i=i||iB.copy(e).add(t).scale(.5),this.center=new le(i),this.halfDiagonal=new le(t).subtract(this.center),this.minimum=new le(e),this.maximum=new le(t)}clone(){return new SC(this.minimum,this.maximum,this.center)}equals(e){return this===e||Boolean(e)&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:t}=this,i=dde.from(e.normal),r=t.x*Math.abs(i.x)+t.y*Math.abs(i.y)+t.z*Math.abs(i.z),s=this.center.dot(i)+e.distance;return s-r>0?1:s+r<0?-1:0}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=iB.from(e).subtract(this.center),{halfDiagonal:i}=this;let s,r=0;return s=Math.abs(t.x)-i.x,s>0&&(r+=s*s),s=Math.abs(t.y)-i.y,s>0&&(r+=s*s),s=Math.abs(t.z)-i.z,s>0&&(r+=s*s),r}}const mh=new le,rB=new le;class AC{constructor(e=[0,0,0],t=0){g(this,"center",void 0),g(this,"radius",void 0),this.radius=-0,this.center=new le,this.fromCenterRadius(e,t)}fromCenterRadius(e,t){return this.center.from(e),this.radius=t,this}fromCornerPoints(e,t){return t=mh.from(t),this.center=(new le).from(e).add(t).scale(.5),this.radius=this.center.distance(t),this}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new AC(this.center,this.radius)}union(e){const t=this.center,i=this.radius,s=e.radius,o=mh.copy(e.center).subtract(t),a=o.magnitude();if(i>=a+s)return this.clone();if(s>=a+i)return e.clone();const l=.5*(i+a+s);return rB.copy(o).scale((-i+l)/a).add(t),this.center.copy(rB),this.radius=l,this}expand(e){const i=mh.from(e).subtract(this.center).magnitude();return i>this.radius&&(this.radius=i),this}transform(e){this.center.transform(e);const t=function dL(n,e){var s=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return n[0]=Math.hypot(e[0],e[1],e[2]),n[1]=Math.hypot(s,o,a),n[2]=Math.hypot(l,c,u),n}(mh,e);return this.radius=Math.max(t[0],Math.max(t[1],t[2]))*this.radius,this}distanceSquaredTo(e){const t=this.distanceTo(e);return t*t}distanceTo(e){const i=mh.from(e).subtract(this.center);return Math.max(0,i.len()-this.radius)}intersectPlane(e){const i=this.radius,s=e.normal.dot(this.center)+e.distance;return s<-i?-1:s<i?0:1}}function sB(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8],h=t[0],f=t[1],p=t[2],m=t[3],_=t[4],y=t[5],v=t[6],E=t[7],M=t[8];return n[0]=h*i+f*o+p*c,n[1]=h*r+f*a+p*u,n[2]=h*s+f*l+p*d,n[3]=m*i+_*o+y*c,n[4]=m*r+_*a+y*u,n[5]=m*s+_*l+y*d,n[6]=v*i+E*o+M*c,n[7]=v*r+E*a+M*u,n[8]=v*s+E*l+M*d,n}function oB(n,e,t){var i=t[0],r=t[1];return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=r*e[3],n[4]=r*e[4],n[5]=r*e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n}var xg=(()=>(function(n){n[n.COL0ROW0=0]="COL0ROW0",n[n.COL0ROW1=1]="COL0ROW1",n[n.COL0ROW2=2]="COL0ROW2",n[n.COL1ROW0=3]="COL1ROW0",n[n.COL1ROW1=4]="COL1ROW1",n[n.COL1ROW2=5]="COL1ROW2",n[n.COL2ROW0=6]="COL2ROW0",n[n.COL2ROW1=7]="COL2ROW1",n[n.COL2ROW2=8]="COL2ROW2"}(xg||(xg={})),xg))();const vde=Object.freeze([1,0,0,0,1,0,0,0,1]);class qn extends lL{static get IDENTITY(){return function wde(){return Eg||(Eg=new qn,Object.freeze(Eg)),Eg}()}static get ZERO(){return function bde(){return Cg||(Cg=new qn([0,0,0,0,0,0,0,0,0]),Object.freeze(Cg)),Cg}()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return xg}constructor(e,...t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):t.length>0?this.copy([e,...t]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(vde)}fromObject(e){return this.check()}fromQuaternion(e){return function yde(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t+t,a=i+i,l=r+r,c=t*o,u=i*o,d=i*a,h=r*o,f=r*a,p=r*l,m=s*o,_=s*a,y=s*l;n[0]=1-d-p,n[3]=u-y,n[6]=h+_,n[1]=u+y,n[4]=1-c-p,n[7]=f-m,n[2]=h-_,n[5]=f+m,n[8]=1-c-d}(this,e),this.check()}set(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this.check()}setRowMajor(e,t,i,r,s,o,a,l,c){return this[0]=e,this[1]=r,this[2]=a,this[3]=t,this[4]=s,this[5]=l,this[6]=i,this[7]=o,this[8]=c,this.check()}determinant(){return function mde(n){var r=n[3],s=n[4],o=n[5],a=n[6],l=n[7],c=n[8];return n[0]*(c*s-o*l)+n[1]*(-c*r+o*a)+n[2]*(l*r-s*a)}(this)}transpose(){return function fde(n,e){if(n===e){var t=e[1],i=e[2],r=e[5];n[1]=e[3],n[2]=e[6],n[3]=t,n[5]=e[7],n[6]=i,n[7]=r}else n[0]=e[0],n[1]=e[3],n[2]=e[6],n[3]=e[1],n[4]=e[4],n[5]=e[7],n[6]=e[2],n[7]=e[5],n[8]=e[8]}(this,this),this.check()}invert(){return function pde(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],d=u*o-a*c,h=-u*s+a*l,f=c*s-o*l,p=t*d+i*h+r*f;p&&(n[0]=d*(p=1/p),n[1]=(-u*i+r*c)*p,n[2]=(a*i-r*o)*p,n[3]=h*p,n[4]=(u*t-r*l)*p,n[5]=(-a*t+r*s)*p,n[6]=f*p,n[7]=(-c*t+i*l)*p,n[8]=(o*t-i*s)*p)}(this,this),this.check()}multiplyLeft(e){return sB(this,e,this),this.check()}multiplyRight(e){return sB(this,this,e),this.check()}rotate(e){return function _de(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8],h=Math.sin(t),f=Math.cos(t);n[0]=f*i+h*o,n[1]=f*r+h*a,n[2]=f*s+h*l,n[3]=f*o-h*i,n[4]=f*a-h*r,n[5]=f*l-h*s,n[6]=c,n[7]=u,n[8]=d}(this,this,e),this.check()}scale(e){return Array.isArray(e)?oB(this,this,e):oB(this,this,[e,e]),this.check()}translate(e){return function gde(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],d=e[8],h=t[0],f=t[1];n[0]=i,n[1]=r,n[2]=s,n[3]=o,n[4]=a,n[5]=l,n[6]=h*i+f*o+c,n[7]=h*r+f*a+u,n[8]=h*s+f*l+d}(this,this,e),this.check()}transform(e,t){let i;switch(e.length){case 2:i=pL(t||[-0,-0],e,this);break;case 3:i=eL(t||[-0,-0,-0],e,this);break;case 4:i=oL(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Bd(i,e.length),i}transformVector(e,t){return this.transform(e,t)}transformVector2(e,t){return this.transform(e,t)}transformVector3(e,t){return this.transform(e,t)}}let Cg,Eg,Mg;class DC extends Rw{static get ZERO(){return Mg||(Mg=new DC(0,0,0,0),Object.freeze(Mg)),Mg}constructor(e=0,t=0,i=0,r=0){super(-0,-0,-0,-0),gs(e)&&1===arguments.length?this.copy(e):(en.debug&&(Dt(e),Dt(t),Dt(i),Dt(r)),this[0]=e,this[1]=t,this[2]=i,this[3]=r)}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return en.debug&&(Dt(e.x),Dt(e.y),Dt(e.z),Dt(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=Dt(e)}get w(){return this[3]}set w(e){this[3]=Dt(e)}transform(e){return Lw(this,this,e),this.check()}transformByMatrix3(e){return oL(this,this,e),this.check()}transformByMatrix2(e){return function pee(n,e,t){const i=e[0],r=e[1];n[0]=t[0]*i+t[2]*r,n[1]=t[1]*i+t[3]*r,n[2]=e[2],n[3]=e[3]}(this,this,e),this.check()}transformByQuaternion(e){return tL(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}function aB(){var n=new Pi(4);return Pi!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n[3]=1,n}function lB(n,e,t){t*=.5;var i=Math.sin(t);return n[0]=i*e[0],n[1]=i*e[1],n[2]=i*e[2],n[3]=Math.cos(t),n}function cB(n,e,t){var i=e[0],r=e[1],s=e[2],o=e[3],a=t[0],l=t[1],c=t[2],u=t[3];return n[0]=i*u+o*a+r*c-s*l,n[1]=r*u+o*l+s*a-i*c,n[2]=s*u+o*c+i*l-r*a,n[3]=o*u-i*a-r*l-s*c,n}var dB=jw,Lde=function(){var n=KR(),e=QR(1,0,0),t=QR(0,1,0);return function(i,r,s){var o=JR(r,s);return o<-.999999?(Cm(n,e,r),iL(n)<1e-6&&Cm(n,t,r),function aee(n,e){var t=e[0],i=e[1],r=e[2],s=t*t+i*i+r*r;s>0&&(s=1/Math.sqrt(s)),n[0]=e[0]*s,n[1]=e[1]*s,n[2]=e[2]*s}(n,n),lB(i,n,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(Cm(n,r,s),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=1+o,function Hee(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),n[0]=t*o,n[1]=i*o,n[2]=r*o,n[3]=s*o,n}(i,i))}}();aB(),aB(),function hde(){var n=new Pi(9);Pi!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1}();const Fde=[0,0,0,1];class pB extends Ow{constructor(e=0,t=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&1===arguments.length?this.copy(e):this.set(e,t,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,t,i,r){return this[0]=e,this[1]=t,this[2]=i,this[3]=r,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return function uB(n,e){var i,t=e[0]+e[4]+e[8];if(t>0)i=Math.sqrt(t+1),n[3]=.5*i,n[0]=(e[5]-e[7])*(i=.5/i),n[1]=(e[6]-e[2])*i,n[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*s+s]-e[3*o+o]+1),n[r]=.5*i,n[3]=(e[3*s+o]-e[3*o+s])*(i=.5/i),n[s]=(e[3*s+r]+e[3*r+s])*i,n[o]=(e[3*o+r]+e[3*r+o])*i}return n}(this,e),this.check()}fromAxisRotation(e,t){return lB(this,e,t),this.check()}identity(){return function xde(n){n[0]=0,n[1]=0,n[2]=0,n[3]=1}(this),this.check()}setAxisAngle(e,t){return this.fromAxisRotation(e,t)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Dt(e)}get y(){return this[1]}set y(e){this[1]=Dt(e)}get z(){return this[2]}set z(e){this[2]=Dt(e)}get w(){return this[3]}set w(e){this[3]=Dt(e)}len(){return function jee(n){return Math.hypot(n[0],n[1],n[2],n[3])}(this)}lengthSquared(){return function Uee(n){var e=n[0],t=n[1],i=n[2],r=n[3];return e*e+t*t+i*i+r*r}(this)}dot(e){return function Gee(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]}(this,e)}rotationTo(e,t){return Lde(this,e,t),this.check()}add(e){return function zee(n,e,t){n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3]}(this,this,e),this.check()}calculateW(){return function Tde(n,e){var t=e[0],i=e[1],r=e[2];n[0]=t,n[1]=i,n[2]=r,n[3]=Math.sqrt(Math.abs(1-t*t-i*i-r*r))}(this,this),this.check()}conjugate(){return function Ide(n,e){n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n[3]=e[3]}(this,this),this.check()}invert(){return function Dde(n,e){var t=e[0],i=e[1],r=e[2],s=e[3],o=t*t+i*i+r*r+s*s,a=o?1/o:0;n[0]=-t*a,n[1]=-i*a,n[2]=-r*a,n[3]=s*a}(this,this),this.check()}lerp(e,t,i){return void 0===i?this.lerp(this,e,t):(function Wee(n,e,t,i){var r=e[0],s=e[1],o=e[2],a=e[3];n[0]=r+i*(t[0]-r),n[1]=s+i*(t[1]-s),n[2]=o+i*(t[2]-o),n[3]=a+i*(t[3]-a)}(this,e,t,i),this.check())}multiplyRight(e){return cB(this,this,e),this.check()}multiplyLeft(e){return cB(this,e,this),this.check()}normalize(){const e=this.len(),t=e>0?1/e:0;return this[0]=this[0]*t,this[1]=this[1]*t,this[2]=this[2]*t,this[3]=this[3]*t,0===e&&(this[3]=1),this.check()}rotateX(e){return function Cde(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);n[0]=i*l+o*a,n[1]=r*l+s*a,n[2]=s*l-r*a,n[3]=o*l-i*a}(this,this,e),this.check()}rotateY(e){return function Ede(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);n[0]=i*l-s*a,n[1]=r*l+o*a,n[2]=s*l+i*a,n[3]=o*l-r*a}(this,this,e),this.check()}rotateZ(e){return function Mde(n,e,t){t*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(t),l=Math.cos(t);n[0]=i*l+r*a,n[1]=r*l-i*a,n[2]=s*l+o*a,n[3]=o*l-s*a}(this,this,e),this.check()}scale(e){return dB(this,this,e),this.check()}slerp(e,t,i){let r,s,o;switch(arguments.length){case 1:({start:r=Fde,target:s,ratio:o}=e);break;case 2:r=this,s=e,o=t;break;default:r=e,s=t,o=i}return function Tg(n,e,t,i){var h,f,p,m,_,r=e[0],s=e[1],o=e[2],a=e[3],l=t[0],c=t[1],u=t[2],d=t[3];return(f=r*l+s*c+o*u+a*d)<0&&(f=-f,l=-l,c=-c,u=-u,d=-d),1-f>ys?(h=Math.acos(f),p=Math.sin(h),m=Math.sin((1-i)*h)/p,_=Math.sin(i*h)/p):(m=1-i,_=i),n[0]=m*r+_*l,n[1]=m*s+_*c,n[2]=m*o+_*u,n[3]=m*a+_*d,n}(this,r,s,o),this.check()}transformVector4(e,t=new DC){return function qee(n,e,t){var i=e[0],r=e[1],s=e[2],o=t[0],a=t[1],l=t[2],c=t[3],u=c*i+a*s-l*r,d=c*r+l*i-o*s,h=c*s+o*r-a*i,f=-o*i-a*r-l*s;n[0]=u*c+f*-o+d*-l-h*-a,n[1]=d*c+f*-a+h*-o-u*-l,n[2]=h*c+f*-l+u*-a-d*-o,n[3]=e[3]}(t,e,this),Bd(t,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,t){return this.setAxisAngle(e,t)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const Nde=new le,Bde=new le,Sg=new le,Ag=new le,Dg=new le,Vde=new le,zde=new le;class IC{constructor(e=[0,0,0],t=[0,0,0,0,0,0,0,0,0]){g(this,"center",void 0),g(this,"halfAxes",void 0),this.center=(new le).from(e),this.halfAxes=new qn(t)}get halfSize(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2);return[new le(e).len(),new le(t).len(),new le(i).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),t=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2),r=new le(e).normalize(),s=new le(t).normalize(),o=new le(i).normalize();return(new pB).fromMatrix3(new qn([...r,...s,...o]))}fromCenterHalfSizeQuaternion(e,t,i){const r=new pB(i),s=(new qn).fromQuaternion(r);return s[0]=s[0]*t[0],s[1]=s[1]*t[0],s[2]=s[2]*t[0],s[3]=s[3]*t[1],s[4]=s[4]*t[1],s[5]=s[5]*t[1],s[6]=s[6]*t[2],s[7]=s[7]*t[2],s[8]=s[8]*t[2],this.center=(new le).from(e),this.halfAxes=s,this}clone(){return new IC(this.center,this.halfAxes)}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new AC){const t=this.halfAxes,i=t.getColumn(0,Sg),r=t.getColumn(1,Ag),s=t.getColumn(2,Dg),o=Nde.copy(i).add(r).add(s);return e.center.copy(this.center),e.radius=o.magnitude(),e}intersectPlane(e){const t=this.center,i=e.normal,r=this.halfAxes,s=i.x,o=i.y,a=i.z,l=Math.abs(s*r[0]+o*r[1]+a*r[2])+Math.abs(s*r[3]+o*r[4]+a*r[5])+Math.abs(s*r[6]+o*r[7]+a*r[8]),c=i.dot(t)+e.distance;return c<=-l?-1:c>=l?1:0}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const t=Bde.from(e).subtract(this.center),i=this.halfAxes,r=i.getColumn(0,Sg),s=i.getColumn(1,Ag),o=i.getColumn(2,Dg),a=r.magnitude(),l=s.magnitude(),c=o.magnitude();r.normalize(),s.normalize(),o.normalize();let d,u=0;return d=Math.abs(t.dot(r))-a,d>0&&(u+=d*d),d=Math.abs(t.dot(s))-l,d>0&&(u+=d*d),d=Math.abs(t.dot(o))-c,d>0&&(u+=d*d),u}computePlaneDistances(e,t,i=[-0,-0]){let r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const o=this.center,a=this.halfAxes,l=a.getColumn(0,Sg),c=a.getColumn(1,Ag),u=a.getColumn(2,Dg),d=Vde.copy(l).add(c).add(u).add(o),h=zde.copy(d).subtract(e);let f=t.dot(h);return r=Math.min(f,r),s=Math.max(f,s),d.copy(o).add(l).add(c).subtract(u),h.copy(d).subtract(e),f=t.dot(h),r=Math.min(f,r),s=Math.max(f,s),d.copy(o).add(l).subtract(c).add(u),h.copy(d).subtract(e),f=t.dot(h),r=Math.min(f,r),s=Math.max(f,s),d.copy(o).add(l).subtract(c).subtract(u),h.copy(d).subtract(e),f=t.dot(h),r=Math.min(f,r),s=Math.max(f,s),o.copy(d).subtract(l).add(c).add(u),h.copy(d).subtract(e),f=t.dot(h),r=Math.min(f,r),s=Math.max(f,s),o.copy(d).subtract(l).add(c).subtract(u),h.copy(d).subtract(e),f=t.dot(h),r=Math.min(f,r),s=Math.max(f,s),o.copy(d).subtract(l).subtract(c).add(u),h.copy(d).subtract(e),f=t.dot(h),r=Math.min(f,r),s=Math.max(f,s),o.copy(d).subtract(l).subtract(c).subtract(u),h.copy(d).subtract(e),f=t.dot(h),r=Math.min(f,r),s=Math.max(f,s),i[0]=r,i[1]=s,i}transform(e){this.center.transformAsPoint(e);const t=this.halfAxes.getColumn(0,Sg);t.transformAsPoint(e);const i=this.halfAxes.getColumn(1,Ag);i.transformAsPoint(e);const r=this.halfAxes.getColumn(2,Dg);return r.transformAsPoint(e),this.halfAxes=new qn([...t,...i,...r]),this}getTransform(){throw new Error("not implemented")}}const mB=new le,gB=new le;class Gc{constructor(e=[0,0,1],t=0){g(this,"normal",void 0),g(this,"distance",void 0),this.normal=new le,this.distance=-0,this.fromNormalDistance(e,t)}fromNormalDistance(e,t){return Vd(Number.isFinite(t)),this.normal.from(e).normalize(),this.distance=t,this}fromPointNormal(e,t){e=mB.from(e),this.normal.from(t).normalize();const i=-this.normal.dot(e);return this.distance=i,this}fromCoefficients(e,t,i,r){return this.normal.set(e,t,i),Vd(_s(this.normal.len(),1)),this.distance=r,this}clone(){return new Gc(this.normal,this.distance)}equals(e){return _s(this.distance,e.distance)&&_s(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const t=gB.copy(this.normal).transformAsVector(e).normalize(),i=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(i,t)}projectPointOntoPlane(e,t=[0,0,0]){e=mB.from(e);const i=this.getPointDistance(e),r=gB.copy(this.normal).scale(i);return e.subtract(r).to(t)}}const _B=[new le([1,0,0]),new le([0,1,0]),new le([0,0,1])],yB=new le,jde=new le;new Gc(new le(1,0,0),0);class ro{constructor(e=[]){g(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*_B.length;const t=e.center,i=e.radius;let r=0;for(const s of _B){let o=this.planes[r],a=this.planes[r+1];o||(o=this.planes[r]=new Gc),a||(a=this.planes[r+1]=new Gc);const l=yB.copy(s).scale(-i).add(t);s.dot(l),o.fromPointNormal(l,s);const u=yB.copy(s).scale(i).add(t),d=jde.copy(s).negate();d.dot(u),a.fromPointNormal(u,d),r+=2}return this}computeVisibility(e){let t=1;for(const i of this.planes)switch(e.intersectPlane(i)){case-1:return-1;case 0:t=0}return t}computeVisibilityWithPlaneMask(e,t){if(Vd(Number.isFinite(t),"parentPlaneMask is required."),t===ro.MASK_OUTSIDE||t===ro.MASK_INSIDE)return t;let i=ro.MASK_INSIDE;const r=this.planes;for(let s=0;s<this.planes.length;++s){const o=s<31?1<<s:0;if(s<31&&0==(t&o))continue;const l=e.intersectPlane(r[s]);if(-1===l)return ro.MASK_OUTSIDE;0===l&&(i|=o)}return i}}g(ro,"MASK_OUTSIDE",4294967295),g(ro,"MASK_INSIDE",0),g(ro,"MASK_INDETERMINATE",2147483647),new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,new le,Math;const Es=(Math,Math,Math,Math,new qn),she=new qn,ohe=new qn,Ig=new qn,bB=new qn;const OC=[1,0,0],RC=[2,2,1];function che(n){let e=0;for(let t=0;t<3;++t){const i=n[Es.getElementIndex(RC[t],OC[t])];e+=2*i*i}return Math.sqrt(e)}function uhe(n,e){let i=0,r=1;for(let c=0;c<3;++c){const u=Math.abs(n[Es.getElementIndex(RC[c],OC[c])]);u>i&&(r=c,i=u)}const s=OC[r],o=RC[r];let a=1,l=0;if(Math.abs(n[Es.getElementIndex(o,s)])>1e-15){const h=(n[Es.getElementIndex(o,o)]-n[Es.getElementIndex(s,s)])/2/n[Es.getElementIndex(o,s)];let f;f=h<0?-1/(-h+Math.sqrt(1+h*h)):1/(h+Math.sqrt(1+h*h)),a=1/Math.sqrt(1+f*f),l=f*a}return qn.IDENTITY.to(e),e[Es.getElementIndex(s,s)]=e[Es.getElementIndex(o,o)]=a,e[Es.getElementIndex(o,s)]=l,e[Es.getElementIndex(s,o)]=-l,e}const Zo=new le,dhe=new le,hhe=new le,fhe=new le,phe=new le,mhe=new qn,ghe={diagonal:new qn,unitary:new qn},xB=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],CB=xB.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),yhe=CB.concat([[.25,.5],[.75,.5]]);class $c{constructor(e,t,i){g(this,"x",void 0),g(this,"y",void 0),g(this,"z",void 0),g(this,"childVisible",void 0),g(this,"selected",void 0),g(this,"_children",void 0),this.x=e,this.y=t,this.z=i}get children(){if(!this._children){const e=2*this.x,t=2*this.y,i=this.z+1;this._children=[new $c(e,t,i),new $c(e,t+1,i),new $c(e+1,t,i),new $c(e+1,t+1,i)]}return this._children}update(e){const{viewport:t,cullingVolume:i,elevationBounds:r,minZ:s,maxZ:o,bounds:a,offset:l,project:c}=e,u=this.getBoundingVolume(r,l,c);if(a&&!this.insideBounds(a)||i.computeVisibility(u)<0)return!1;if(!this.childVisible){let{z:h}=this;if(h<o&&h>=s){const f=u.distanceTo(t.cameraPosition)*t.scale/t.height;h+=Math.floor(Math.log2(f))}if(h>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const h of this.children)h.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const t of this._children)t.getSelected(e);return e}insideBounds([e,t,i,r]){const o=512/Math.pow(2,this.z);return this.x*o<i&&this.y*o<r&&(this.x+1)*o>e&&(this.y+1)*o>t}getBoundingVolume(e,t,i){if(i){const l=this.z<1?yhe:this.z<2?CB:xB,c=[];for(const u of l){const d=FC(this.x+u[0],this.y+u[1],this.z);d[2]=e[0],c.push(i(d)),e[0]!==e[1]&&(d[2]=e[1],c.push(i(d)))}return function _he(n,e=new IC){if(!n||0===n.length)return e.halfAxes=new qn([0,0,0,0,0,0,0,0,0]),e.center=new le,e;const t=n.length,i=new le(0,0,0);for(const Y of n)i.add(Y);const r=1/t;i.multiplyByScalar(r);let s=0,o=0,a=0,l=0,c=0,u=0;for(const Y of n){const $=Zo.copy(Y).subtract(i);s+=$.x*$.x,o+=$.x*$.y,a+=$.x*$.z,l+=$.y*$.y,c+=$.y*$.z,u+=$.z*$.z}s*=r,o*=r,a*=r,l*=r,c*=r,u*=r;const d=mhe;d[0]=s,d[1]=o,d[2]=a,d[3]=o,d[4]=l,d[5]=c,d[6]=a,d[7]=c,d[8]=u;const{unitary:h}=function ahe(n,e={}){let r=0,s=0;const o=she,a=ohe;o.identity(),a.copy(n);const l=1e-20*function lhe(n){let e=0;for(let t=0;t<9;++t){const i=n[t];e+=i*i}return Math.sqrt(e)}(a);for(;s<10&&che(a)>l;)uhe(a,Ig),bB.copy(Ig).transpose(),a.multiplyRight(Ig),a.multiplyLeft(bB),o.multiplyRight(Ig),++r>2&&(++s,r=0);return e.unitary=o.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}(d,ghe),f=e.halfAxes.copy(h);let p=f.getColumn(0,hhe),m=f.getColumn(1,fhe),_=f.getColumn(2,phe),y=-Number.MAX_VALUE,v=-Number.MAX_VALUE,E=-Number.MAX_VALUE,M=Number.MAX_VALUE,R=Number.MAX_VALUE,B=Number.MAX_VALUE;for(const Y of n)Zo.copy(Y),y=Math.max(Zo.dot(p),y),v=Math.max(Zo.dot(m),v),E=Math.max(Zo.dot(_),E),M=Math.min(Zo.dot(p),M),R=Math.min(Zo.dot(m),R),B=Math.min(Zo.dot(_),B);p=p.multiplyByScalar(.5*(M+y)),m=m.multiplyByScalar(.5*(R+v)),_=_.multiplyByScalar(.5*(B+E)),e.center.copy(p).add(m).add(_);const V=dhe.set(y-M,v-R,E-B).multiplyByScalar(.5),Z=new qn([V[0],0,0,0,V[1],0,0,0,V[2]]);return e.halfAxes.multiplyRight(Z),e}(c)}const s=512/Math.pow(2,this.z),o=this.x*s+512*t,a=512-(this.y+1)*s;return new SC([o,a,e[0]],[o+s,a+s,e[1]])}}const so=512,bhe=[-1/0,-1/0,1/0,1/0],whe={type:"url",value:null,validate:(n,e)=>e.optional&&null===n||"string"==typeof n||Array.isArray(n)&&n.every(t=>"string"==typeof t),equals:(n,e)=>{if(n===e)return!0;if(!Array.isArray(n)||!Array.isArray(e))return!1;const t=n.length;if(t!==e.length)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}};function EB(n,e){const t=[e.transformAsPoint([n[0],n[1]]),e.transformAsPoint([n[2],n[1]]),e.transformAsPoint([n[0],n[3]]),e.transformAsPoint([n[2],n[3]])];return[Math.min(...t.map(r=>r[0])),Math.min(...t.map(r=>r[1])),Math.max(...t.map(r=>r[0])),Math.max(...t.map(r=>r[1]))]}function MB(n,e){if(!n||!n.length)return null;const{index:t,id:i}=e;if(Array.isArray(n)){const s=function xhe(n){return Math.abs(n.split("").reduce((e,t)=>(e<<5)-e+t.charCodeAt(0)|0,0))}(i)%n.length;n=n[s]}let r=n;for(const s of Object.keys(t)){const o=new RegExp("{".concat(s,"}"),"g");r=r.replace(o,String(t[s]))}return Number.isInteger(t.y)&&Number.isInteger(t.z)&&(r=r.replace(/\{-y\}/g,String(Math.pow(2,t.z)-t.y-1))),r}function Pg({viewport:n,z:e,cullRect:t}){const i=t.x-n.x,r=t.y-n.y,{width:s,height:o}=t;if(!Array.isArray(e)){const c={targetZ:e||0},u=n.unproject([i,r],c),d=n.unproject([i+s,r],c),h=n.unproject([i,r+o],c),f=n.unproject([i+s,r+o],c);return[Math.min(u[0],d[0],h[0],f[0]),Math.min(u[1],d[1],h[1],f[1]),Math.max(u[0],d[0],h[0],f[0]),Math.max(u[1],d[1],h[1],f[1])]}const a=Pg({viewport:n,z:e[0],cullRect:t}),l=Pg({viewport:n,z:e[1],cullRect:t});return[Math.min(a[0],l[0]),Math.min(a[1],l[1]),Math.max(a[2],l[2]),Math.max(a[3],l[3])]}function LC(n,e){return Math.pow(2,n)*so/e}function FC(n,e,t){const i=LC(t,so),s=Math.PI-2*Math.PI*e/i;return[n/i*360-180,180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)))]}function TB(n,e,t,i){const r=LC(t,i);return[n/r*so,e/r*so]}function Mhe(n,e,t,i,r=so){if(n.isGeospatial){const[c,u]=FC(e,t,i),[d,h]=FC(e+1,t+1,i);return{west:c,north:u,east:d,south:h}}const[s,o]=TB(e,t,i,r),[a,l]=TB(e+1,t+1,i,r);return{left:s,top:o,right:a,bottom:l}}function She({viewport:n,maxZoom:e,minZoom:t,zRange:i,extent:r,tileSize:s=so,modelMatrix:o,modelMatrixInverse:a,zoomOffset:l=0}){let c=n.isGeospatial?Math.round(n.zoom+Math.log2(so/s))+l:Math.ceil(n.zoom)+l;if("number"==typeof t&&Number.isFinite(t)&&c<t){if(!r)return[];c=t}"number"==typeof e&&Number.isFinite(e)&&c>e&&(c=e);let u=r;return o&&a&&r&&!n.isGeospatial&&(u=EB(r,o)),n.isGeospatial?function vhe(n,e,t,i){const r=n instanceof ude&&n.resolution?n.projectPosition:null,s=Object.values(n.getFrustumPlanes()).map(({normal:f,distance:p})=>new Gc(f.clone().negate(),p)),o=new ro(s),a=n.distanceScales.unitsPerMeter[2],l=t&&t[0]*a||0,c=t&&t[1]*a||0,u=n instanceof vs&&n.pitch<=60?e:0;if(i){const[f,p,m,_]=i,y=Bo([f,_]),v=Bo([m,p]);i=[y[0],512-y[1],v[0],512-v[1]]}const d=new $c(0,0,0),h={viewport:n,project:r,cullingVolume:o,elevationBounds:[l,c],minZ:u,maxZ:e,bounds:i,offset:0};if(d.update(h),n instanceof vs&&n.subViewports&&n.subViewports.length>1){for(h.offset=-1;d.update(h)&&!(--h.offset<-3););for(h.offset=1;d.update(h)&&!(++h.offset>3););}return d.getSelected()}(n,c,i,r):function The(n,e,t,i,r){const s=function Che(n,e,t){let i;if(e&&2===e.length){const[r,s]=e,o=n.getBounds({z:r}),a=n.getBounds({z:s});i=[Math.min(o[0],a[0]),Math.min(o[1],a[1]),Math.max(o[2],a[2]),Math.max(o[3],a[3])]}else i=n.getBounds();return n.isGeospatial?[Math.max(i[0],t[0]),Math.max(i[1],t[1]),Math.min(i[2],t[2]),Math.min(i[3],t[3])]:[Math.max(Math.min(i[0],t[2]),t[0]),Math.max(Math.min(i[1],t[3]),t[1]),Math.min(Math.max(i[2],t[0]),t[2]),Math.min(Math.max(i[3],t[1]),t[3])]}(n,null,i),o=LC(e,t),[a,l,c,u]=function Ehe(n,e,t){return t?EB(n,t).map(r=>r*e/so):n.map(i=>i*e/so)}(s,o,r),d=[];for(let h=Math.floor(a);h<c;h++)for(let f=Math.floor(l);f<u;f++)d.push({x:h,y:f,z:e});return d}(n,c,s,u||bhe,a)}const Lhe={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class Fhe{constructor(e={}){g(this,"props",void 0),g(this,"stats",void 0),g(this,"activeRequestCount",0),g(this,"requestQueue",[]),g(this,"requestMap",new Map),g(this,"deferredUpdate",null),this.props=k(k({},Lhe),e),this.stats=new gm({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(e,t=(()=>0)){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const i={handle:e,priority:0,getPriority:t},r=new Promise(s=>(i.resolve=s,i));return this.requestQueue.push(i),this.requestMap.set(e,r),this._issueNewRequests(),r}_issueRequest(e){const{handle:t,resolve:i}=e;let r=!1;const s=()=>{r||(r=!0,this.requestMap.delete(t),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,i?i({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==e){this._updateAllRequests();for(let t=0;t<e;++t){const i=this.requestQueue.shift();i&&this._issueRequest(i)}}}_updateAllRequests(){const e=this.requestQueue;for(let t=0;t<e.length;++t){const i=e[t];this._updateRequest(i)||(e.splice(t,1),this.requestMap.delete(i.handle),t--)}e.sort((t,i)=>t.priority-i.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),!(e.priority<0&&(e.resolve(null),1))}}const NC="best-available",zhe={[NC]:function Uhe(n){for(const e of n)e.state=0;for(const e of n)e.isSelected&&!AB(e)&&BC(e);for(const e of n)e.isVisible=Boolean(2&e.state)},"no-overlap":function Hhe(n){for(const t of n)t.state=0;for(const t of n)t.isSelected&&AB(t);const e=Array.from(n).sort((t,i)=>t.zoom-i.zoom);for(const t of e)if(t.isVisible=Boolean(2&t.state),t.children&&(t.isVisible||1&t.state))for(const i of t.children)i.state=1;else t.isSelected&&BC(t)},never:()=>{}};function AB(n){let e=n;for(;e;){if(e.isLoaded||e.content)return e.state|=2,!0;e=e.parent}return!1}function BC(n){for(const e of n.children)e.isLoaded||e.content?e.state|=2:BC(e)}const Ghe={TilesetClass:class jhe{constructor(e){g(this,"opts",void 0),g(this,"_requestScheduler",void 0),g(this,"_cache",void 0),g(this,"_dirty",void 0),g(this,"_tiles",void 0),g(this,"_cacheByteSize",void 0),g(this,"_viewport",void 0),g(this,"_zRange",void 0),g(this,"_selectedTiles",void 0),g(this,"_frameNumber",void 0),g(this,"_modelMatrix",void 0),g(this,"_modelMatrixInverse",void 0),g(this,"_maxZoom",void 0),g(this,"_minZoom",void 0),g(this,"onTileLoad",void 0),g(this,"_getCullBounds",Kd(Pg)),this.opts=e,this.onTileLoad=t=>{this.opts.onTileLoad(t),this.opts.maxCacheByteSize&&(this._cacheByteSize+=t.byteLength,this._resizeCache())},this._requestScheduler=new Fhe({maxRequests:e.maxRequests,throttleRequests:e.maxRequests>0}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new zn,this._modelMatrixInverse=new zn,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return null!==this._selectedTiles&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return null!==this._selectedTiles&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const t=this._cache.get(e);this._selectedTiles&&this._selectedTiles.includes(t)?t.setNeedsReload():this._cache.delete(e)}}update(e,{zRange:t,modelMatrix:i}={}){const r=new zn(i),s=!r.equals(this._modelMatrix);if(this._viewport&&e.equals(this._viewport)&&_s(this._zRange,t)&&!s)this.needsReload&&(this._selectedTiles=this._selectedTiles.map(a=>this._getTile(a.index,!0)));else{s&&(this._modelMatrixInverse=r.clone().invert(),this._modelMatrix=r),this._viewport=e,this._zRange=t;const a=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:t,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=a.map(l=>this._getTile(l,!0)),this._dirty&&this._rebuildTree()}const o=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),o&&this._frameNumber++,this._frameNumber}isTileVisible(e,t){if(!e.isVisible)return!1;if(t&&this._viewport){const[i,r,s,o]=Pg({viewport:this._viewport,z:this._zRange,cullRect:t}),{bbox:a}=e;if("west"in a)return a.west<s&&a.east>i&&a.south<o&&a.north>r;const l=Math.min(a.top,a.bottom),c=Math.max(a.top,a.bottom);return a.left<s&&a.right>i&&l<o&&c>r}return!0}getTileIndices({viewport:e,maxZoom:t,minZoom:i,zRange:r,modelMatrix:s,modelMatrixInverse:o}){const{tileSize:a,extent:l,zoomOffset:c}=this.opts;return She({viewport:e,maxZoom:t,minZoom:i,zRange:r,tileSize:a,extent:l,modelMatrix:s,modelMatrixInverse:o,zoomOffset:c})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:t}=this.opts;return{bbox:Mhe(this._viewport,e.x,e.y,e.z,t)}}getParentIndex(e){return{x:Math.floor(e.x/2),y:Math.floor(e.y/2),z:e.z-1}}updateTileStates(){const e=this.opts.refinementStrategy||NC,t=new Array(this._cache.size);let i=0;for(const r of this._cache.values())t[i++]=r.isVisible,r.isSelected=!1,r.isVisible=!1;for(const r of this._selectedTiles)r.isSelected=!0,r.isVisible=!0;("function"==typeof e?e:zhe[e])(Array.from(this._cache.values())),i=0;for(const r of this._cache.values())if(t[i++]!==r.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e}=this.opts,t=[];let i=0;for(const r of this._cache.values())r.isLoading&&(i++,!r.isSelected&&!r.isVisible&&t.push(r));for(;e>0&&i>e&&t.length>0;)t.shift().abort(),i--}_rebuildTree(){const{_cache:e}=this;for(const t of e.values())t.parent=null,t.children&&(t.children.length=0);for(const t of e.values()){const i=this._getNearestAncestor(t);t.parent=i,null!=i&&i.children&&i.children.push(t)}}_resizeCache(){const{_cache:e,opts:t}=this,i=t.maxCacheSize||(t.maxCacheByteSize?1/0:5*this.selectedTiles.length),r=t.maxCacheByteSize||1/0;if(e.size>i||this._cacheByteSize>r){for(const[o,a]of e)if(a.isVisible||(this._cacheByteSize-=t.maxCacheByteSize?a.byteLength:0,e.delete(o),this.opts.onTileUnload(a)),e.size<=i&&this._cacheByteSize<=r)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((o,a)=>o.zoom-a.zoom),this._dirty=!1)}_getTile(e,t){const i=this.getTileId(e);let r=this._cache.get(i),s=!1;return!r&&t?(r=new lde(e),Object.assign(r,this.getTileMetadata(r.index)),Object.assign(r,{id:i,zoom:this.getTileZoom(r.index)}),s=!0,this._cache.set(i,r),this._dirty=!0):r&&r.needsReload&&(s=!0),r&&s&&r.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),r}_getNearestAncestor(e){const{_minZoom:t=0}=this;let i=e.index;for(;this.getTileZoom(i)>t;){i=this.getParentIndex(i);const r=this._getTile(i);if(r)return r}return null}},data:{type:"data",value:[]},dataComparator:whe.equals,renderSubLayers:{type:"function",value:n=>new fh(n),compare:!1},getTileData:{type:"function",optional:!0,value:null,compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileLoad:{type:"function",value:n=>{},compare:!1},onTileUnload:{type:"function",value:n=>{},compare:!1},onTileError:{type:"function",value:n=>console.error(n),compare:!1},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:NC,zRange:null,maxRequests:6,zoomOffset:0};class Og extends ng{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,t;null===(e=this.state)||void 0===e||null===(t=e.tileset)||void 0===t||t.finalize()}get isLoaded(){var e,t;return null===(e=this.state)||void 0===e||null===(t=e.tileset)||void 0===t?void 0:t.selectedTiles.every(i=>i.isLoaded&&i.layers&&i.layers.every(r=>r.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:t}=this.state;const r=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);t?(e.propsOrDataChanged||e.updateTriggersChanged)&&(t.setOptions(this._getTilesetOptions()),r?t.reloadAll():this.state.tileset.tiles.forEach(s=>{s.layers=null})):(t=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:t})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:t,maxCacheByteSize:i,refinementStrategy:r,extent:s,maxZoom:o,minZoom:a,maxRequests:l,zoomOffset:c}=this.props;return{maxCacheSize:t,maxCacheByteSize:i,maxZoom:o,minZoom:a,tileSize:e,refinementStrategy:r,extent:s,maxRequests:l,zoomOffset:c,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:t,modelMatrix:i}=this.props,r=e.update(this.context.viewport,{zRange:t,modelMatrix:i}),{isLoaded:s}=e,a=this.state.frameNumber!==r;s&&(this.state.isLoaded!==s||a)&&this._onViewportLoad(),a&&this.setState({frameNumber:r}),this.state.isLoaded=s}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:t}=this.props;t&&t(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,t){this.props.onTileError(e),t.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:t,getTileData:i,fetch:r}=this.props,{signal:s}=e;return e.url="string"==typeof t||Array.isArray(t)?MB(t,e):null,i?i(e):r&&e.url?r(e.url,{propName:"data",layer:this,signal:s}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:t}){return e.tile=t.props.tile,e}_updateAutoHighlight(e){e.sourceLayer&&e.sourceLayer.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const t=this.getSubLayerPropsByTile(e);if(e.isLoaded||e.content)if(e.layers)t&&e.layers[0]&&Object.keys(t).some(i=>e.layers[0].props[i]!==t[i])&&(e.layers=e.layers.map(i=>i.clone(t)));else{const i=this.renderSubLayers(X(k({},this.props),{id:"".concat(this.id,"-").concat(e.id),data:e.content,_offset:0,tile:e}));e.layers=mm(i,Boolean).map(r=>r.clone(k({tile:e},t)))}return e.layers})}filterSubLayer({layer:e,cullRect:t}){const{tile:i}=e.props;return this.state.tileset.isTileVisible(i,t)}}g(Og,"defaultProps",Ghe),g(Og,"layerName","TileLayer");const Whe={Point:DB,MultiPoint:function qhe(n,e,t){return VC(n,e,t)},LineString:IB,MultiLineString:function $he(n,e,t){return n.map(i=>IB(i,e,t))},Polygon:PB,MultiPolygon:function Yhe(n,e,t){return n.map(i=>PB(i,e,t))}};function DB([n,e],[t,i],r){const s=Ks(t[0],i[0],n),o=Ks(t[1],i[1],e);return r.unprojectFlat([s,o])}function VC(n,e,t){return n.map(i=>DB(i,e,t))}function IB(n,e,t){return VC(n,e,t)}function PB(n,e,t){return n.map(i=>VC(i,e,t))}const Xhe=["points","lines","polygons"];function Qhe(n,e,t,i){const r=n.featureIds.value;if(!r.length)return-1;let s=0,o=r[r.length-1]+1;if(i){const l=function Jhe(n,e){if(!n.__layers){const t={},{properties:i}=n;for(let r=0;r<i.length;r++){const{layerName:s}=i[r];s&&(t[s]?t[s][1]=r:t[s]=[r,r])}n.__layers=t}return n.__layers[e]}(n,i);if(!l)return-1;s=l[0],o=l[1]+1}let a=-1;if(e in n.numericProps){const l=n.numericProps[e].value.findIndex((c,u)=>c===t&&r[u]>=s&&r[u]<o);return l>=0?n.globalFeatureIds.value[l]:-1}return e?a=kB(n.properties,l=>l[e]===t,s,o):n.fields&&(a=kB(n.fields,l=>l.id===t,s,o)),a>=0?function efe(n,e){if(!n.__ids){const t=[],i=n.featureIds.value,r=n.globalFeatureIds.value;for(let s=0;s<i.length;s++)t[i[s]]=r[s];n.__ids=t}return n.__ids[e]}(n,a):-1}function kB(n,e,t,i){for(let r=t;r<i;r++)if(e(n[r],r))return r;return-1}const tfe=X(k({},fh.defaultProps),{onDataLoad:{type:"function",value:null,optional:!0,compare:!1},uniqueIdProperty:"",highlightedFeatureId:null,loaders:[$N],binary:!0});class jC extends Og{initializeState(){super.initializeState(),this.setState({binary:void 0===this.context.viewport.resolution&&this.props.binary,data:null,tileJSON:null})}get isLoaded(){return this.state&&this.state.data&&this.state.tileset&&super.isLoaded}updateState({props:e,oldProps:t,context:i,changeFlags:r}){var s;r.dataChanged&&this._updateTileData(),null!==(s=this.state)&&void 0!==s&&s.data&&(super.updateState({props:e,oldProps:t,context:i,changeFlags:r}),this._setWGS84PropertyForTiles());const{highlightColor:o}=e;o!==t.highlightColor&&Array.isArray(o)&&this.setState({highlightColor:o})}_updateTileData(){var e=this;return Bt(function*(){let t=e.props.data,i=null;if("string"!=typeof t||function Ahe(n){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(n)}(t))t.tilejson&&(i=t);else{const{onDataLoad:r,fetch:s}=e.props;e.setState({data:null,tileJSON:null});try{i=yield s(t,{propName:"data",layer:e,loaders:[]})}catch(o){e.raiseError(o,"loading TileJSON"),t=null}r&&r(i,{propName:"data",layer:e})}i&&(t=i.tiles),e.setState({data:t,tileJSON:i})})()}_getTilesetOptions(){const e=super._getTilesetOptions(),t=this.state.tileJSON,{minZoom:i,maxZoom:r}=this.props;return t&&(Number.isFinite(t.minzoom)&&t.minzoom>i&&(e.minZoom=t.minzoom),Number.isFinite(t.maxzoom)&&(!Number.isFinite(r)||t.maxzoom<r)&&(e.maxZoom=t.maxzoom)),e}renderLayers(){var e;return null!==(e=this.state)&&void 0!==e&&e.data?super.renderLayers():null}getTileData(e){var t;const{data:i,binary:r}=this.state,{index:s,signal:o}=e,a=MB(i,e);if(!a)return Promise.reject("Invalid URL");let l=this.getLoadOptions();const{fetch:c}=this.props;return l=X(k({},l),{mimeType:"application/x-protobuf",mvt:X(k({},null===(t=l)||void 0===t?void 0:t.mvt),{coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:s}),gis:r?{format:"binary"}:{}}),c(a,{propName:"data",layer:this,loadOptions:l,signal:o})}renderSubLayers(e){const{x:t,y:i,z:r}=e.tile.index,s=Math.pow(2,r),o=512/s,a=-o,l=512*t/s,c=512*(1-i/s),u=(new zn).scale([o,a,1]);e.autoHighlight=!1,this.context.viewport.resolution||(e.modelMatrix=u,e.coordinateOrigin=[l,c,0],e.coordinateSystem=gt.CARTESIAN,e.extensions=[...e.extensions||[],new MC]);const d=super.renderSubLayers(e);return this.state.binary&&!(d instanceof fh)&&Ye.warn("renderSubLayers() must return GeoJsonLayer when using binary:true")(),d}_updateAutoHighlight(e){const{uniqueIdProperty:t}=this.props,{hoveredFeatureId:i,hoveredFeatureLayerName:r}=this.state,s=e.object;let o,a;s&&(o=UC(s,t),a=OB(s));let{highlightColor:l}=this.props;"function"==typeof l&&(l=l(e)),(i!==o||r!==a)&&this.setState({highlightColor:l,hoveredFeatureId:o,hoveredFeatureLayerName:a})}getPickingInfo(e){const t=super.getPickingInfo(e),i=Boolean(this.context.viewport.resolution);if(this.state.binary&&-1!==t.index){const{data:r}=e.sourceLayer.props;t.object=YN(r,{globalFeatureId:t.index})}return t.object&&!i&&(t.object=LB(t.object,t.tile.bbox,this.context.viewport)),t}getSubLayerPropsByTile(e){return{highlightedObjectIndex:this.getHighlightedObjectIndex(e),highlightColor:this.state.highlightColor}}getHighlightedObjectIndex(e){const{hoveredFeatureId:t,hoveredFeatureLayerName:i,binary:r}=this.state,{uniqueIdProperty:s,highlightedFeatureId:o}=this.props,a=e.content,l=RB(o);if(!RB(t)&&!l)return-1;const u=l?o:t;return Array.isArray(a)?a.findIndex(d=>{const h=UC(d,s)===u,f=l||OB(d)===i;return h&&f}):a&&r?function Khe(n,e,t,i){for(const r of Xhe){const s=n[r]&&Qhe(n[r],e,t,i);if(s>=0)return s}return-1}(a,s,u,l?"":i):-1}_pickObjects(e){const{deck:t,viewport:i}=this.context;return t.pickObjects({x:i.x,y:i.y,width:i.width,height:i.height,layerIds:[this.id],maxObjects:e})}getRenderedFeatures(e=null){const t=this._pickObjects(e),i=new Set,r=[];for(const s of t){const o=UC(s.object,this.props.uniqueIdProperty);void 0===o?r.push(s.object):i.has(o)||(i.add(o),r.push(s.object))}return r}_setWGS84PropertyForTiles(){const e="dataInWGS84";this.state.tileset.selectedTiles.forEach(i=>{i.hasOwnProperty(e)||Object.defineProperty(i,e,{get:()=>{if(!i.content)return null;if(this.state.binary&&Array.isArray(i.content)&&!i.content.length)return[];const{bbox:r}=i;if(void 0===i._contentWGS84&&function Dhe(n){return Number.isFinite(n.west)&&Number.isFinite(n.north)&&Number.isFinite(n.east)&&Number.isFinite(n.south)}(r)){const s=this.state.binary?YN(i.content):i.content;i._contentWGS84=s.map(o=>LB(o,r,this.context.viewport))}return i._contentWGS84}})})}}function UC(n,e){return n.properties&&e?n.properties[e]:"id"in n?n.id:void 0}function OB(n){var e;return(null===(e=n.properties)||void 0===e?void 0:e.layerName)||null}function RB(n){return null!=n&&""!==n}function LB(n,e,t){const i=X(k({},n),{geometry:{type:n.geometry.type}});return Object.defineProperty(i.geometry,"coordinates",{get:()=>function Zhe(n,e,t){const s=[t.projectFlat([e.west,e.north]),t.projectFlat([e.east,e.south])];return X(k({},n),{coordinates:Whe[n.type](n.coordinates,s,t)})}(n.geometry,e,t).coordinates}),i}g(jC,"layerName","MVTLayer"),g(jC,"defaultProps",tfe);const nfe=new Uint16Array([0,2,1,0,3,2]),ife=new Float32Array([0,1,0,0,1,0,1,1]);function ofe(n,e,t){return Ks(Ks(n[0],n[1],t),Ks(n[3],n[2],t),e)}const cfe="\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\nuniform float coordinateConversion;\nuniform vec4 bounds;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  return mix(transparentColor, vec4(color, 1.0), alpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),\n    (pos.y - bounds[3]) / (bounds[1] - bounds[3])\n  );\n}\n\n".concat("\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n","\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture2D(bitmapTexture, uv);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n\n  if (picking_uActive) {\n    // Since instance information is not used, we can use picking color for pixel index\n    gl_FragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n"),ufe={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:gt.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]}};class HC extends no{constructor(...e){super(...e),g(this,"state",void 0)}getShaders(){return super.getShaders({vs:"\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float coordinateConversion;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;\n  } else if (coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:cfe,modules:[Bc,Vc]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const t=!0;e.add({indices:{size:1,isIndexed:!0,update:i=>i.value=this.state.mesh.indices,noAlloc:t},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:i=>i.value=this.state.mesh.positions,noAlloc:t},texCoords:{size:2,update:i=>i.value=this.state.mesh.texCoords,noAlloc:t}})}updateState({props:e,oldProps:t,changeFlags:i}){const r=this.getAttributeManager();if(i.extensionsChanged){var s;const{gl:o}=this.context;null===(s=this.state.model)||void 0===s||s.delete(),this.state.model=this._getModel(o),r.invalidateAll()}if(e.bounds!==t.bounds){const o=this.state.mesh,a=this._createMesh();this.state.model.setVertexCount(a.vertexCount);for(const l in a)o&&o[l]!==a[l]&&r.invalidate(l);this.setState(k({mesh:a},this._getCoordinateUniforms()))}else e._imageCoordinateSystem!==t._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:t}=this.props,i=e.info;if(!i.color||!t)return i.bitmap=null,i;const{width:r,height:s}=t;i.index=0;const o=function dfe(n){const[e,t,i]=n;return[(e+(15&i)/16)/256,(t+(240&i)/256)/256]}(i.color),a=[Math.floor(o[0]*r),Math.floor(o[1]*s)];return i.bitmap={size:{width:r,height:s},uv:o,pixel:a},i}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight(X(k({},e),{color:this.encodePickingColor(0)}))}_createMesh(){const{bounds:e}=this.props;let t=e;return FB(e)&&(t=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),function rfe(n,e){if(!e)return function sfe(n){const e=new Float64Array(12);for(let t=0;t<n.length;t++)e[3*t+0]=n[t][0],e[3*t+1]=n[t][1],e[3*t+2]=n[t][2]||0;return{vertexCount:6,positions:e,indices:nfe,texCoords:ife}}(n);const t=Math.max(Math.abs(n[0][0]-n[3][0]),Math.abs(n[1][0]-n[2][0])),i=Math.max(Math.abs(n[1][1]-n[0][1]),Math.abs(n[2][1]-n[3][1])),r=Math.ceil(t/e)+1,s=Math.ceil(i/e)+1,o=(r-1)*(s-1)*6,a=new Uint32Array(o),l=new Float32Array(r*s*2),c=new Float64Array(r*s*3);let u=0,d=0;for(let h=0;h<r;h++){const f=h/(r-1);for(let p=0;p<s;p++){const m=p/(s-1),_=ofe(n,f,m);c[3*u+0]=_[0],c[3*u+1]=_[1],c[3*u+2]=_[2]||0,l[2*u+0]=f,l[2*u+1]=1-m,h>0&&p>0&&(a[d++]=u-s,a[d++]=u-s-1,a[d++]=u-1,a[d++]=u-s,a[d++]=u-1,a[d++]=u),u++}}return{vertexCount:o,positions:c,indices:a,texCoords:l}}(t,this.context.viewport.resolution)}_getModel(e){return e?new qo(e,X(k({},this.getShaders()),{id:this.props.id,geometry:new zc({drawMode:4,vertexCount:6}),isInstanced:!1})):null}draw(e){const{uniforms:t,moduleParameters:i}=e,{model:r,coordinateConversion:s,bounds:o,disablePicking:a}=this.state,{image:l,desaturate:c,transparentColor:u,tintColor:d}=this.props;i.pickingActive&&a||l&&r&&r.setUniforms(t).setUniforms({bitmapTexture:l,desaturate:c,transparentColor:u.map(h=>h/255),tintColor:d.slice(0,3).map(h=>h/255),coordinateConversion:s,bounds:o}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:t,DEFAULT:i}=gt;let{_imageCoordinateSystem:r}=this.props;if(r!==i){const{bounds:s}=this.props;if(!FB(s))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const o=this.context.viewport.resolution?e:t;if(r=r===e?e:t,r===e&&o===t)return{coordinateConversion:-1,bounds:s};if(r===t&&o===e){const a=Bo([s[0],s[1]]),l=Bo([s[2],s[3]]);return{coordinateConversion:1,bounds:[a[0],a[1],l[0],l[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}function FB(n){return Number.isFinite(n[0])}g(HC,"layerName","BitmapLayer"),g(HC,"defaultProps",ufe);const hfe=["map"];let ffe=(()=>{class n{constructor(t,i){this.mapState=t,this.ref=i,this.layers=[],this.contextChange=new Oe,this.mapClick=new Oe,setInterval(()=>{this.ref.markForCheck()},1e3),this.ready=!1}setOverlay(t){let r;if(this.ready&&t.mapIds.indexOf(this.mapId)>=0){r="XYZ"==t.type.format?new Og({data:t.type.tileurl,id:t.id,opacity:t.opacity>=0?t.opacity:.8,minZoom:t.minzoom,maxZoom:t.maxnativezoom,tileSize:256,renderSubLayers:o=>{const{bbox:{west:a,south:l,east:c,north:u}}=o.tile;return new HC(o,{data:null,image:o.data,bounds:[a,l,c,u]})}}):new jC({data:t.type.tileurl,id:t.id,minZoom:0,maxZoom:23,getLineColor:[250,100,100,100],getFillColor:[140,170,180,0],getLineWidth:0,lineWidthMinPixels:0,pickable:!0,onClick:(o,a)=>{this.mapClick.emit(o.object.properties)}}),this.layers.push(r);let s=document.createElement("div").style;this.deckgl.setProps({layers:this.layers,style:s})}}addControl(t,i){this.map.controls[i].push(t)}applyParams(t){const i=(t.ll||"").split(",")[0],r=(t.ll||"").split(",")[1];new google.maps.LatLng(i,r)}ngAfterViewInit(){const t=this,i={center:this.context.center,zoom:this.context.zoom,streetViewControl:!1,mapTypeId:this.basemap,styles:(new dK).style,scaleControl:!0,tilt:0,minZoom:4,maxZoom:20,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_TOP},controlSize:24};this.map=new google.maps.Map(this.mapRef.nativeElement,i),this.deckgl=new xoe({}),this.deckgl.setMap(this.map),this.ready=!0;const r=document.createElement("input");r.placeholder="Search for a location",r.style.margin="5px",r.style.padding="5px",r.style.border="1pt solid gray",r.style.borderRadius="2px";const s=new google.maps.places.Autocomplete(r,{types:["(regions)"],componentRestrictions:{country:"US"}});this.map.controls[google.maps.ControlPosition.TOP_LEFT].push(r),s.addListener("place_changed",function(){var o;t.mapState.setBounds(null===(o=s.getPlace().geometry)||void 0===o?void 0:o.viewport)}),this.addListeners(),this.mapState.overlays.subscribe(o=>{this.deckgl.setProps({layers:[]}),o.forEach(a=>this.setOverlay(a))})}addListeners(){const t=this;google.maps.event.addListener(this.map,"bounds_changed",function(){t.contextChange.emit({zoom:t.map.getZoom(),center:t.map.getCenter(),source:t.mapId})})}clearListeners(){google.maps.event.clearListeners(this.map,"bounds_changed")}ngOnChanges(t){this.map&&this.ready&&t.context&&t.context.currentValue.source!==this.mapId&&(this.ready=!1,this.map.setZoom(t.context.currentValue.zoom),this.map.setCenter(t.context.currentValue.center),setTimeout(()=>{this.ready=!0,this.addListeners()},1))}}return n.\u0275fac=function(t){return new(t||n)(T(ac),T(Fn))},n.\u0275cmp=Ot({type:n,selectors:[["app-map"]],viewQuery:function(t,i){if(1&t&&Ti(hfe,5),2&t){let r;Wt(r=qt())&&(i.mapRef=r.first)}},inputs:{context:"context",mapId:"mapId",basemap:"basemap"},outputs:{contextChange:"contextChange",mapClick:"mapClick"},features:[fn],decls:3,vars:0,consts:[[1,"gutter","gutter-horizontal",2,"width","10px"],[1,"map"],["map",""]],template:function(t,i){1&t&&(rt(0,"div",0),rt(1,"div",1,2))},styles:["[_nghost-%COMP%]{display:flex;flex:1;position:relative}.map[_ngcontent-%COMP%]{display:flex;flex:1}.fade[_ngcontent-%COMP%]{transition:display .6s ease-in-out}#map.pac-item[_ngcontent-%COMP%]{display:none}.gutter[_ngcontent-%COMP%]{position:relative;left:50%;height:100%;width:5px;z-index:100;background-color:#eee;background-repeat:no-repeat;background-position:50%}.gutter.gutter-horizontal[_ngcontent-%COMP%]{cursor:col-resize;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==)}"]}),n})();const pfe=[{path:"",component:(()=>{class n{constructor(t,i){this.router=t,this.routing=i,this.leftToggle=!0,this.rightToggle=!0,this.leftBasemap=google.maps.MapTypeId.SATELLITE,this.rightBasemap=google.maps.MapTypeId.SATELLITE,this.featureData={},this.tabIndex=0,this.context={center:new google.maps.LatLng(47.8,-112.65),zoom:15,source:""},this.routing.url.subscribe(s=>s||this.router.navigateByUrl(""));const r=this.routing.getParams();r.tab&&(this.tabIndex=r.tab)}handleClick(t){console.log(t),this.featureData=J$.toHtml(t,{lineNumbers:!0})}}return n.\u0275fac=function(t){return new(t||n)(T(Vn),T(Sa))},n.\u0275cmp=Ot({type:n,selectors:[["app-layout"]],decls:5,vars:3,consts:[[1,"sidebar"],[1,"feature-data",3,"innerHTML"],[1,"map-container"],["mapId","right",1,"mapLeft",3,"context","basemap","contextChange","mapClick"]],template:function(t,i){1&t&&(ue(0,"div",0),rt(1,"app-landcover-control"),rt(2,"div",1),de(),ue(3,"div",2),ue(4,"app-map",3),At("contextChange",function(s){return i.context=s})("mapClick",function(s){return i.handleClick(s)}),de(),de()),2&t&&(Fe(2),He("innerHTML",i.featureData,pM),Fe(2),He("context",i.context)("basemap",i.rightBasemap))},directives:[uK,ffe],styles:["[_nghost-%COMP%]{display:flex;flex:1}.sidebar[_ngcontent-%COMP%]{flex:.5;display:block;min-width:400px;max-width:400px;height:100vh}.map-container[_ngcontent-%COMP%]{display:flex;flex:1}mat-tab-body[_ngcontent-%COMP%]{width:400px}"]}),n})()}];let mfe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:[ac,Sa],imports:[[Nk.forRoot(pfe)],Nk]}),n})(),Rg=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Ai,Ne,Td],Ne]}),n})();const Efe={provide:new q("mat-autocomplete-scroll-strategy"),deps:[_r],useFactory:function Cfe(n){return()=>n.scrollStrategies.reposition()}};let Afe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:[Efe],imports:[[hc,om,Ne,Ai],dc,om,Ne]}),n})(),zB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({}),n})(),zfe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Oo,Ne,Td,zB],Ne,zB]}),n})(),jB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({}),n})(),jfe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:[OZ],imports:[[jB,Rg,Ne],jB,Rg]}),n})();const qfe={provide:new q("mat-select-scroll-strategy"),deps:[_r],useFactory:function Wfe(n){return()=>n.scrollStrategies.reposition()}};let $fe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:[qfe],imports:[[Ai,hc,om,Ne],dc,Rg,om,Ne]}),n})(),Yfe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Ne],Ne]}),n})(),Zfe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Ne],Ne]}),n})(),cpe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[MO,Oo,Ne,F0,Ai],MO,Ne,F0,Zfe]}),n})(),ppe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Ai,Ne,tm,Oo,Td,CO],Ne]}),n})(),wpe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Ne,Oo],Ne]}),n})(),Ape=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Ne],Ne]}),n})();function Dpe(n,e){if(1&n&&(ol(),rt(0,"circle",4)),2&n){const t=ei(),i=Ls(1);Fl("animation-name","mat-progress-spinner-stroke-rotate-"+t._spinnerAnimationLabel)("stroke-dashoffset",t._getStrokeDashOffset(),"px")("stroke-dasharray",t._getStrokeCircumference(),"px")("stroke-width",t._getCircleStrokeWidth(),"%")("transform-origin",t._getCircleTransformOrigin(i)),yt("r",t._getCircleRadius())}}function Ipe(n,e){if(1&n&&(ol(),rt(0,"circle",4)),2&n){const t=ei(),i=Ls(1);Fl("stroke-dashoffset",t._getStrokeDashOffset(),"px")("stroke-dasharray",t._getStrokeCircumference(),"px")("stroke-width",t._getCircleStrokeWidth(),"%")("transform-origin",t._getCircleTransformOrigin(i)),yt("r",t._getCircleRadius())}}const kpe=Ad(class{constructor(n){this._elementRef=n}},"primary"),Ope=new q("mat-progress-spinner-default-options",{providedIn:"root",factory:function Rpe(){return{diameter:100}}});class Xo extends kpe{constructor(e,t,i,r,s,o,a,l){super(e),this._document=i,this._diameter=100,this._value=0,this._resizeSubscription=ee.EMPTY,this.mode="determinate";const c=Xo._diameters;this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),c.has(i.head)||c.set(i.head,new Set([100])),this._noopAnimations="NoopAnimations"===r&&!!s&&!s._forceAnimations,"mat-spinner"===e.nativeElement.nodeName.toLowerCase()&&(this.mode="indeterminate"),s&&(s.diameter&&(this.diameter=s.diameter),s.strokeWidth&&(this.strokeWidth=s.strokeWidth)),t.isBrowser&&t.SAFARI&&a&&o&&l&&(this._resizeSubscription=a.change(150).subscribe(()=>{"indeterminate"===this.mode&&l.run(()=>o.markForCheck())}))}get diameter(){return this._diameter}set diameter(e){this._diameter=us(e),this._spinnerAnimationLabel=this._getSpinnerAnimationLabel(),this._styleRoot&&this._attachStyleNode()}get strokeWidth(){return this._strokeWidth||this.diameter/10}set strokeWidth(e){this._strokeWidth=us(e)}get value(){return"determinate"===this.mode?this._value:0}set value(e){this._value=Math.max(0,Math.min(100,us(e)))}ngOnInit(){const e=this._elementRef.nativeElement;this._styleRoot=$k(e)||this._document.head,this._attachStyleNode(),e.classList.add("mat-progress-spinner-indeterminate-animation")}ngOnDestroy(){this._resizeSubscription.unsubscribe()}_getCircleRadius(){return(this.diameter-10)/2}_getViewBox(){const e=2*this._getCircleRadius()+this.strokeWidth;return`0 0 ${e} ${e}`}_getStrokeCircumference(){return 2*Math.PI*this._getCircleRadius()}_getStrokeDashOffset(){return"determinate"===this.mode?this._getStrokeCircumference()*(100-this._value)/100:null}_getCircleStrokeWidth(){return this.strokeWidth/this.diameter*100}_getCircleTransformOrigin(e){var t;const i=50*(null!==(t=e.currentScale)&&void 0!==t?t:1);return`${i}% ${i}%`}_attachStyleNode(){const e=this._styleRoot,t=this._diameter,i=Xo._diameters;let r=i.get(e);if(!r||!r.has(t)){const s=this._document.createElement("style");s.setAttribute("mat-spinner-animation",this._spinnerAnimationLabel),s.textContent=this._getAnimationText(),e.appendChild(s),r||(r=new Set,i.set(e,r)),r.add(t)}}_getAnimationText(){const e=this._getStrokeCircumference();return"\n @keyframes mat-progress-spinner-stroke-rotate-DIAMETER {\n    0%      { stroke-dashoffset: START_VALUE;  transform: rotate(0); }\n    12.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(0); }\n    12.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(72.5deg); }\n    25%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(72.5deg); }\n\n    25.0001%   { stroke-dashoffset: START_VALUE;  transform: rotate(270deg); }\n    37.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(270deg); }\n    37.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(161.5deg); }\n    50%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(161.5deg); }\n\n    50.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(180deg); }\n    62.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(180deg); }\n    62.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(251.5deg); }\n    75%     { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(251.5deg); }\n\n    75.0001%  { stroke-dashoffset: START_VALUE;  transform: rotate(90deg); }\n    87.5%   { stroke-dashoffset: END_VALUE;    transform: rotate(90deg); }\n    87.5001%  { stroke-dashoffset: END_VALUE;    transform: rotateX(180deg) rotate(341.5deg); }\n    100%    { stroke-dashoffset: START_VALUE;  transform: rotateX(180deg) rotate(341.5deg); }\n  }\n".replace(/START_VALUE/g,""+.95*e).replace(/END_VALUE/g,""+.2*e).replace(/DIAMETER/g,`${this._spinnerAnimationLabel}`)}_getSpinnerAnimationLabel(){return this.diameter.toString().replace(".","_")}}Xo._diameters=new WeakMap,Xo.\u0275fac=function(e){return new(e||Xo)(T(pt),T(qi),T(je,8),T(as,8),T(Ope),T(Fn),T(Qp),T(_e))},Xo.\u0275cmp=Ot({type:Xo,selectors:[["mat-progress-spinner"],["mat-spinner"]],hostAttrs:["role","progressbar","tabindex","-1",1,"mat-progress-spinner","mat-spinner"],hostVars:10,hostBindings:function(e,t){2&e&&(yt("aria-valuemin","determinate"===t.mode?0:null)("aria-valuemax","determinate"===t.mode?100:null)("aria-valuenow","determinate"===t.mode?t.value:null)("mode",t.mode),Fl("width",t.diameter,"px")("height",t.diameter,"px"),Pn("_mat-animation-noopable",t._noopAnimations))},inputs:{color:"color",diameter:"diameter",strokeWidth:"strokeWidth",mode:"mode",value:"value"},exportAs:["matProgressSpinner"],features:[ke],decls:4,vars:8,consts:[["preserveAspectRatio","xMidYMid meet","focusable","false","aria-hidden","true",3,"ngSwitch"],["svg",""],["cx","50%","cy","50%",3,"animation-name","stroke-dashoffset","stroke-dasharray","stroke-width","transform-origin",4,"ngSwitchCase"],["cx","50%","cy","50%",3,"stroke-dashoffset","stroke-dasharray","stroke-width","transform-origin",4,"ngSwitchCase"],["cx","50%","cy","50%"]],template:function(e,t){1&e&&(ol(),ue(0,"svg",0,1),Jn(2,Dpe,1,11,"circle",2),Jn(3,Ipe,1,9,"circle",3),de()),2&e&&(Fl("width",t.diameter,"px")("height",t.diameter,"px"),He("ngSwitch","indeterminate"===t.mode),yt("viewBox",t._getViewBox()),Fe(2),He("ngSwitchCase",!0),Fe(1),He("ngSwitchCase",!1))},directives:[Zf,Q1],styles:[".mat-progress-spinner{display:block;position:relative;overflow:hidden}.mat-progress-spinner svg{position:absolute;transform:rotate(-90deg);top:0;left:0;transform-origin:center;overflow:visible}.mat-progress-spinner circle{fill:transparent;transition:stroke-dashoffset 225ms linear}._mat-animation-noopable.mat-progress-spinner circle{transition:none;animation:none}.cdk-high-contrast-active .mat-progress-spinner circle{stroke:CanvasText}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{animation:mat-progress-spinner-linear-rotate 2000ms linear infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] svg{transition:none;animation:none}.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition-property:stroke;animation-duration:4000ms;animation-timing-function:cubic-bezier(0.35, 0, 0.25, 1);animation-iteration-count:infinite}._mat-animation-noopable.mat-progress-spinner.mat-progress-spinner-indeterminate-animation[mode=indeterminate] circle{transition:none;animation:none}@keyframes mat-progress-spinner-linear-rotate{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes mat-progress-spinner-stroke-rotate-100{0%{stroke-dashoffset:268.606171575px;transform:rotate(0)}12.5%{stroke-dashoffset:56.5486677px;transform:rotate(0)}12.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(72.5deg)}25%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(72.5deg)}25.0001%{stroke-dashoffset:268.606171575px;transform:rotate(270deg)}37.5%{stroke-dashoffset:56.5486677px;transform:rotate(270deg)}37.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(161.5deg)}50%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(161.5deg)}50.0001%{stroke-dashoffset:268.606171575px;transform:rotate(180deg)}62.5%{stroke-dashoffset:56.5486677px;transform:rotate(180deg)}62.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(251.5deg)}75%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(251.5deg)}75.0001%{stroke-dashoffset:268.606171575px;transform:rotate(90deg)}87.5%{stroke-dashoffset:56.5486677px;transform:rotate(90deg)}87.5001%{stroke-dashoffset:56.5486677px;transform:rotateX(180deg) rotate(341.5deg)}100%{stroke-dashoffset:268.606171575px;transform:rotateX(180deg) rotate(341.5deg)}}\n"],encapsulation:2,changeDetection:0});let Fpe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Ne,Ai],Ne]}),n})(),Bpe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Ai,Ne],Ne]}),n})();function Vpe(n,e){}class $C{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}const zpe={dialogContainer:Di("dialogContainer",[yn("void, exit",ve({opacity:0,transform:"scale(0.7)"})),yn("enter",ve({transform:"none"})),jt("* => enter",VI([$t("150ms cubic-bezier(0, 0, 0.2, 1)",ve({transform:"none",opacity:1})),_b("@*",gb(),{optional:!0})])),jt("* => void, * => exit",VI([$t("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",ve({opacity:0})),_b("@*",gb(),{optional:!0})]))])};let jpe=(()=>{class n extends Jp{constructor(t,i,r,s,o,a,l,c){super(),this._elementRef=t,this._focusTrapFactory=i,this._changeDetectorRef=r,this._config=o,this._interactivityChecker=a,this._ngZone=l,this._focusMonitor=c,this._animationStateChanged=new Oe,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=u=>(this._portalOutlet.hasAttached(),this._portalOutlet.attachDomPortal(u)),this._ariaLabelledBy=o.ariaLabelledBy||null,this._document=s}_initializeWithAttachedContent(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=E0())}attachComponentPortal(t){return this._portalOutlet.hasAttached(),this._portalOutlet.attachComponentPortal(t)}attachTemplatePortal(t){return this._portalOutlet.hasAttached(),this._portalOutlet.attachTemplatePortal(t)}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(t,i){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(i)}_focusByCssSelector(t,i){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,i)}_trapFocus(){const t=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||t.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(i=>{i||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const t=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&t&&"function"==typeof t.focus){const i=E0(),r=this._elementRef.nativeElement;(!i||i===this._document.body||i===r||r.contains(i))&&(this._focusMonitor?(this._focusMonitor.focusVia(t,this._closeInteractionType),this._closeInteractionType=null):t.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const t=this._elementRef.nativeElement,i=E0();return t===i||t.contains(i)}}return n.\u0275fac=function(t){return new(t||n)(T(pt),T(xZ),T(Fn),T(je,8),T($C),T(mO),T(_e),T(Ys))},n.\u0275dir=te({type:n,viewQuery:function(t,i){if(1&t&&Ti(em,7),2&t){let r;Wt(r=qt())&&(i._portalOutlet=r.first)}},features:[ke]}),n})(),Upe=(()=>{class n extends jpe{constructor(){super(...arguments),this._state="enter"}_onAnimationDone({toState:t,totalTime:i}){"enter"===t?(this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:i})):"exit"===t&&(this._restoreFocus(),this._animationStateChanged.next({state:"closed",totalTime:i}))}_onAnimationStart({toState:t,totalTime:i}){"enter"===t?this._animationStateChanged.next({state:"opening",totalTime:i}):("exit"===t||"void"===t)&&this._animationStateChanged.next({state:"closing",totalTime:i})}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}_initializeWithAttachedContent(){super._initializeWithAttachedContent(),this._config.delayFocusTrap||this._trapFocus()}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=pn(n)))(i||n)}}(),n.\u0275cmp=Ot({type:n,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(t,i){1&t&&xf("@dialogContainer.start",function(s){return i._onAnimationStart(s)})("@dialogContainer.done",function(s){return i._onAnimationDone(s)}),2&t&&(Nl("id",i._id),yt("role",i._config.role)("aria-labelledby",i._config.ariaLabel?null:i._ariaLabelledBy)("aria-label",i._config.ariaLabel)("aria-describedby",i._config.ariaDescribedBy||null),Mf("@dialogContainer",i._state))},features:[ke],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,i){1&t&&Jn(0,Vpe,0,0,"ng-template",0)},directives:[em],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;box-sizing:content-box;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[zpe.dialogContainer]}}),n})(),Hpe=0;class Gpe{constructor(e,t,i="mat-dialog-"+Hpe++){this._overlayRef=e,this._containerInstance=t,this.id=i,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new O,this._afterClosed=new O,this._beforeClosed=new O,this._state=0,t._id=i,t._animationStateChanged.pipe(gn(r=>"opened"===r.state),Mt(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),t._animationStateChanged.pipe(gn(r=>"closed"===r.state),Mt(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),e.keydownEvents().pipe(gn(r=>27===r.keyCode&&!this.disableClose&&!$s(r))).subscribe(r=>{r.preventDefault(),QB(this,"keyboard")}),e.backdropClick().subscribe(()=>{this.disableClose?this._containerInstance._recaptureFocus():QB(this,"mouse")})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(gn(t=>"closing"===t.state),Mt(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._afterClosed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}updatePosition(e){let t=this._getPositionStrategy();return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._overlayRef.updatePosition(),this}updateSize(e="",t=""){return this._overlayRef.updateSize({width:e,height:t}),this._overlayRef.updatePosition(),this}addPanelClass(e){return this._overlayRef.addPanelClass(e),this}removePanelClass(e){return this._overlayRef.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._overlayRef.dispose()}_getPositionStrategy(){return this._overlayRef.getConfig().positionStrategy}}function QB(n,e,t){return void 0!==n._containerInstance&&(n._containerInstance._closeInteractionType=e),n.close(t)}const Wpe=new q("MatDialogData"),qpe=new q("mat-dialog-default-options"),JB=new q("mat-dialog-scroll-strategy"),Ype={provide:JB,deps:[_r],useFactory:function $pe(n){return()=>n.scrollStrategies.block()}};let Zpe=(()=>{class n{constructor(t,i,r,s,o,a,l,c,u,d){this._overlay=t,this._injector=i,this._defaultOptions=r,this._parentDialog=s,this._overlayContainer=o,this._dialogRefConstructor=l,this._dialogContainerType=c,this._dialogDataToken=u,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new O,this._afterOpenedAtThisLevel=new O,this._ariaHiddenElements=new Map,this.afterAllClosed=Ip(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Hs(void 0))),this._scrollStrategy=a}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(t,i){i=function Kpe(n,e){return Object.assign(Object.assign({},e),n)}(i,this._defaultOptions||new $C),i.id&&this.getDialogById(i.id);const r=this._createOverlay(i),s=this._attachDialogContainer(r,i),o=this._attachDialogContent(t,s,r,i);return this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(o),o.afterClosed().subscribe(()=>this._removeOpenDialog(o)),this.afterOpened.next(o),s._initializeWithAttachedContent(),o}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_createOverlay(t){const i=this._getOverlayConfig(t);return this._overlay.create(i)}_getOverlayConfig(t){const i=new Ed({positionStrategy:this._overlay.position().global(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(i.backdropClass=t.backdropClass),i}_attachDialogContainer(t,i){const s=Nt.create({parent:i&&i.viewContainerRef&&i.viewContainerRef.injector||this._injector,providers:[{provide:$C,useValue:i}]}),o=new xd(this._dialogContainerType,i.viewContainerRef,s,i.componentFactoryResolver);return t.attach(o).instance}_attachDialogContent(t,i,r,s){const o=new this._dialogRefConstructor(r,i,s.id);if(t instanceof ur)i.attachTemplatePortal(new Cd(t,null,{$implicit:s.data,dialogRef:o}));else{const a=this._createInjector(s,o,i),l=i.attachComponentPortal(new xd(t,s.viewContainerRef,a,s.componentFactoryResolver));o.componentInstance=l.instance}return o.updateSize(s.width,s.height).updatePosition(s.position),o}_createInjector(t,i,r){const s=t&&t.viewContainerRef&&t.viewContainerRef.injector,o=[{provide:this._dialogContainerType,useValue:r},{provide:this._dialogDataToken,useValue:t.data},{provide:this._dialogRefConstructor,useValue:i}];return t.direction&&(!s||!s.get(uc,null,Ve.Optional))&&o.push({provide:uc,useValue:{value:t.direction,change:Ce()}}),Nt.create({parent:s||this._injector,providers:o})}_removeOpenDialog(t){const i=this.openDialogs.indexOf(t);i>-1&&(this.openDialogs.splice(i,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((r,s)=>{r?s.setAttribute("aria-hidden",r):s.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const i=t.parentElement.children;for(let r=i.length-1;r>-1;r--){let s=i[r];s!==t&&"SCRIPT"!==s.nodeName&&"STYLE"!==s.nodeName&&!s.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(s,s.getAttribute("aria-hidden")),s.setAttribute("aria-hidden","true"))}}}_closeDialogs(t){let i=t.length;for(;i--;)t[i].close()}}return n.\u0275fac=function(t){wf()},n.\u0275dir=te({type:n}),n})(),Xpe=(()=>{class n extends Zpe{constructor(t,i,r,s,o,a,l,c){super(t,i,s,a,l,o,Gpe,Upe,Wpe,c)}}return n.\u0275fac=function(t){return new(t||n)(L(_r),L(Nt),L(Zl,8),L(qpe,8),L(JB),L(n,12),L(A0),L(as,8))},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})(),Qpe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:[Xpe,Ype],imports:[[hc,tm,Ne],Ne]}),n})();const nme={provide:new q("mat-tooltip-scroll-strategy"),deps:[_r],useFactory:function tme(n){return()=>n.scrollStrategies.reposition({scrollThrottle:20})}};let rme=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({providers:[nme],imports:[[CO,Ai,hc,Ne],Ne,dc]}),n})();new q("angular-split-global-config");let cme=(()=>{class n{static forRoot(){return console.warn("AngularSplitModule.forRoot() is deprecated and will be removed in v6"),{ngModule:n,providers:[]}}static forChild(){return console.warn("AngularSplitModule.forChild() is deprecated and will be removed in v6"),{ngModule:n,providers:[]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({imports:[[Ai]]}),n})(),ume=(()=>{class n{constructor(t){this.routing=t}}return n.\u0275fac=function(t){return new(t||n)(T(Sa))},n.\u0275cmp=Ot({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,i){1&t&&rt(0,"router-outlet")},directives:[l0],styles:["[_nghost-%COMP%]{position:absolute;left:0;right:0;top:0;bottom:0;display:flex}"]}),n})(),Ame=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n}),n.\u0275inj=Te({}),n})(),o3=(()=>{class n{load(){return this.promise||(this.promise=new Promise(t=>{const i=document.createElement("script");i.src="https://maps.googleapis.com/maps/api/js?v=3&key=AIzaSyAP3woooQpzzqKaLumyrht8toMVbX0GnbI&libraries=places",i.type="text/javascript",i.onload=r=>t(!0),console.log("Maps loaded"),document.getElementsByTagName("head")[0].appendChild(i)})),this.promise}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=J({token:n,factory:n.\u0275fac}),n})();function Ime(n){return()=>n.load()}let Pme=(()=>{class n{constructor(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Se({type:n,bootstrap:[ume]}),n.\u0275inj=Te({providers:[o3,{provide:Hu,useFactory:Ime,deps:[o3],multi:!0},ac,Sa],imports:[[Ame,cme,mD,zq,GW,mfe,d7,h7,MX,Qpe,RO,Yfe,$fe,zX,cpe,jfe,rme,DO,Fpe,KX,wpe,zfe,Afe,Ape,ppe,Bpe,Rg]]}),n})();(function l6(){x1=!1})(),S8().bootstrapModule(Pme).catch(n=>console.error(n))},469:vt=>{"use strict";function nt(w,P,S){S=S||2;var H,Q,W,Et,It,dt,xt,F=P&&P.length,O=F?P[0]*S:w.length,z=Re(w,0,O,S,!0),j=[];if(!z||z.next===z.prev)return j;if(F&&(z=function $e(w,P,S,F){var z,j,W,O=[];for(z=0,j=P.length;z<j;z++)(W=Re(w,P[z]*F,z<j-1?P[z+1]*F:w.length,F,!1))===W.next&&(W.steiner=!0),O.push(bt(W));for(O.sort(Ue),z=0;z<O.length;z++)S=Ie(O[z],S);return S}(w,P,z,S)),w.length>80*S){H=W=w[0],Q=Et=w[1];for(var ht=S;ht<O;ht+=S)(It=w[ht])<H&&(H=It),(dt=w[ht+1])<Q&&(Q=dt),It>W&&(W=It),dt>Et&&(Et=dt);xt=0!==(xt=Math.max(W-H,Et-Q))?32767/xt:0}return ce(z,j,S,H,Q,xt,0),j}function Re(w,P,S,F,O){var z,j;if(O===D(w,P,S,F)>0)for(z=P;z<S;z+=F)j=Rn(z,w[z],w[z+1],j);else for(z=S-F;z>=P;z-=F)j=Rn(z,w[z],w[z+1],j);return j&&Gt(j,j.next)&&(oi(j),j=j.next),j}function K(w,P){if(!w)return w;P||(P=w);var F,S=w;do{if(F=!1,S.steiner||!Gt(S,S.next)&&0!==Qe(S.prev,S,S.next))S=S.next;else{if(oi(S),(S=P=S.prev)===S.next)break;F=!0}}while(F||S!==P);return P}function ce(w,P,S,F,O,z,j){if(w){!j&&z&&function re(w,P,S,F){var O=w;do{0===O.z&&(O.z=ut(O.x,O.y,P,S,F)),O.prevZ=O.prev,O.nextZ=O.next,O=O.next}while(O!==w);O.prevZ.nextZ=null,O.prevZ=null,function xe(w){var P,S,F,O,z,j,H,Q,W=1;do{for(S=w,w=null,z=null,j=0;S;){for(j++,F=S,H=0,P=0;P<W&&(H++,F=F.nextZ);P++);for(Q=W;H>0||Q>0&&F;)0!==H&&(0===Q||!F||S.z<=F.z)?(O=S,S=S.nextZ,H--):(O=F,F=F.nextZ,Q--),z?z.nextZ=O:w=O,O.prevZ=z,z=O;S=F}z.nextZ=null,W*=2}while(j>1)}(O)}(w,F,O,z);for(var Q,W,H=w;w.prev!==w.next;)if(Q=w.prev,W=w.next,z?Ht(w,F,O,z):Qt(w))P.push(Q.i/S|0),P.push(w.i/S|0),P.push(W.i/S|0),oi(w),w=W.next,H=W.next;else if((w=W)===H){j?1===j?ce(w=ee(K(w),P,S),P,S,F,O,z,2):2===j&&be(w,P,S,F,O,z):ce(K(w),P,S,F,O,z,1);break}}}function Qt(w){var P=w.prev,S=w,F=w.next;if(Qe(P,S,F)>=0)return!1;for(var O=P.x,z=S.x,j=F.x,H=P.y,Q=S.y,W=F.y,Et=O<z?O<j?O:j:z<j?z:j,It=H<Q?H<W?H:W:Q<W?Q:W,dt=O>z?O>j?O:j:z>j?z:j,xt=H>Q?H>W?H:W:Q>W?Q:W,ht=F.next;ht!==P;){if(ht.x>=Et&&ht.x<=dt&&ht.y>=It&&ht.y<=xt&&wt(O,H,z,Q,j,W,ht.x,ht.y)&&Qe(ht.prev,ht,ht.next)>=0)return!1;ht=ht.next}return!0}function Ht(w,P,S,F){var O=w.prev,z=w,j=w.next;if(Qe(O,z,j)>=0)return!1;for(var H=O.x,Q=z.x,W=j.x,Et=O.y,It=z.y,dt=j.y,xt=H<Q?H<W?H:W:Q<W?Q:W,ht=Et<It?Et<dt?Et:dt:It<dt?It:dt,Lt=H>Q?H>W?H:W:Q>W?Q:W,dn=Et>It?Et>dt?Et:dt:It>dt?It:dt,Ss=ut(xt,ht,P,S,F),As=ut(Lt,dn,P,S,F),Ze=w.prevZ,it=w.nextZ;Ze&&Ze.z>=Ss&&it&&it.z<=As;){if(Ze.x>=xt&&Ze.x<=Lt&&Ze.y>=ht&&Ze.y<=dn&&Ze!==O&&Ze!==j&&wt(H,Et,Q,It,W,dt,Ze.x,Ze.y)&&Qe(Ze.prev,Ze,Ze.next)>=0||(Ze=Ze.prevZ,it.x>=xt&&it.x<=Lt&&it.y>=ht&&it.y<=dn&&it!==O&&it!==j&&wt(H,Et,Q,It,W,dt,it.x,it.y)&&Qe(it.prev,it,it.next)>=0))return!1;it=it.nextZ}for(;Ze&&Ze.z>=Ss;){if(Ze.x>=xt&&Ze.x<=Lt&&Ze.y>=ht&&Ze.y<=dn&&Ze!==O&&Ze!==j&&wt(H,Et,Q,It,W,dt,Ze.x,Ze.y)&&Qe(Ze.prev,Ze,Ze.next)>=0)return!1;Ze=Ze.prevZ}for(;it&&it.z<=As;){if(it.x>=xt&&it.x<=Lt&&it.y>=ht&&it.y<=dn&&it!==O&&it!==j&&wt(H,Et,Q,It,W,dt,it.x,it.y)&&Qe(it.prev,it,it.next)>=0)return!1;it=it.nextZ}return!0}function ee(w,P,S){var F=w;do{var O=F.prev,z=F.next.next;!Gt(O,z)&&Ji(O,F,F.next,z)&&un(O,z)&&un(z,O)&&(P.push(O.i/S|0),P.push(F.i/S|0),P.push(z.i/S|0),oi(F),oi(F.next),F=w=z),F=F.next}while(F!==w);return K(F)}function be(w,P,S,F,O,z){var j=w;do{for(var H=j.next.next;H!==j.prev;){if(j.i!==H.i&&cn(j,H)){var Q=$n(j,H);return j=K(j,j.next),Q=K(Q,Q.next),ce(j,P,S,F,O,z,0),void ce(Q,P,S,F,O,z,0)}H=H.next}j=j.next}while(j!==w)}function Ue(w,P){return w.x-P.x}function Ie(w,P){var S=function me(w,P){var j,S=P,F=w.x,O=w.y,z=-1/0;do{if(O<=S.y&&O>=S.next.y&&S.next.y!==S.y){var H=S.x+(O-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(H<=F&&H>z&&(z=H,j=S.x<S.next.x?S:S.next,H===F))return j}S=S.next}while(S!==P);if(!j)return null;var dt,Q=j,W=j.x,Et=j.y,It=1/0;S=j;do{F>=S.x&&S.x>=W&&F!==S.x&&wt(O<Et?F:z,O,W,Et,O<Et?z:F,O,S.x,S.y)&&(dt=Math.abs(O-S.y)/(F-S.x),un(S,w)&&(dt<It||dt===It&&(S.x>j.x||S.x===j.x&&we(j,S)))&&(j=S,It=dt)),S=S.next}while(S!==Q);return j}(w,P);if(!S)return P;var F=$n(S,w);return K(F,F.next),K(S,S.next)}function we(w,P){return Qe(w.prev,w,P.prev)<0&&Qe(P.next,w,w.next)<0}function ut(w,P,S,F,O){return(w=1431655765&((w=858993459&((w=252645135&((w=16711935&((w=(w-S)*O|0)|w<<8))|w<<4))|w<<2))|w<<1))|(P=1431655765&((P=858993459&((P=252645135&((P=16711935&((P=(P-F)*O|0)|P<<8))|P<<4))|P<<2))|P<<1))<<1}function bt(w){var P=w,S=w;do{(P.x<S.x||P.x===S.x&&P.y<S.y)&&(S=P),P=P.next}while(P!==w);return S}function wt(w,P,S,F,O,z,j,H){return(O-j)*(P-H)>=(w-j)*(z-H)&&(w-j)*(F-H)>=(S-j)*(P-H)&&(S-j)*(z-H)>=(O-j)*(F-H)}function cn(w,P){return w.next.i!==P.i&&w.prev.i!==P.i&&!function vi(w,P){var S=w;do{if(S.i!==w.i&&S.next.i!==w.i&&S.i!==P.i&&S.next.i!==P.i&&Ji(S,S.next,w,P))return!0;S=S.next}while(S!==w);return!1}(w,P)&&(un(w,P)&&un(P,w)&&function Ts(w,P){var S=w,F=!1,O=(w.x+P.x)/2,z=(w.y+P.y)/2;do{S.y>z!=S.next.y>z&&S.next.y!==S.y&&O<(S.next.x-S.x)*(z-S.y)/(S.next.y-S.y)+S.x&&(F=!F),S=S.next}while(S!==w);return F}(w,P)&&(Qe(w.prev,w,P.prev)||Qe(w,P.prev,P))||Gt(w,P)&&Qe(w.prev,w,w.next)>0&&Qe(P.prev,P,P.next)>0)}function Qe(w,P,S){return(P.y-w.y)*(S.x-P.x)-(P.x-w.x)*(S.y-P.y)}function Gt(w,P){return w.x===P.x&&w.y===P.y}function Ji(w,P,S,F){var O=Oi(Qe(w,P,S)),z=Oi(Qe(w,P,F)),j=Oi(Qe(S,F,w)),H=Oi(Qe(S,F,P));return!!(O!==z&&j!==H||0===O&&yi(w,S,P)||0===z&&yi(w,F,P)||0===j&&yi(S,w,F)||0===H&&yi(S,P,F))}function yi(w,P,S){return P.x<=Math.max(w.x,S.x)&&P.x>=Math.min(w.x,S.x)&&P.y<=Math.max(w.y,S.y)&&P.y>=Math.min(w.y,S.y)}function Oi(w){return w>0?1:w<0?-1:0}function un(w,P){return Qe(w.prev,w,w.next)<0?Qe(w,P,w.next)>=0&&Qe(w,w.prev,P)>=0:Qe(w,P,w.prev)<0||Qe(w,w.next,P)<0}function $n(w,P){var S=new x(w.i,w.x,w.y),F=new x(P.i,P.x,P.y),O=w.next,z=P.prev;return w.next=P,P.prev=w,S.next=O,O.prev=S,F.next=S,S.prev=F,z.next=F,F.prev=z,F}function Rn(w,P,S,F){var O=new x(w,P,S);return F?(O.next=F.next,O.prev=F,F.next.prev=O,F.next=O):(O.prev=O,O.next=O),O}function oi(w){w.next.prev=w.prev,w.prev.next=w.next,w.prevZ&&(w.prevZ.nextZ=w.nextZ),w.nextZ&&(w.nextZ.prevZ=w.prevZ)}function x(w,P,S){this.i=w,this.x=P,this.y=S,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function D(w,P,S,F){for(var O=0,z=P,j=S-F;z<S;z+=F)O+=(w[j]-w[z])*(w[z+1]+w[j+1]),j=z;return O}vt.exports=nt,vt.exports.default=nt,nt.deviation=function(w,P,S,F){var O=P&&P.length,j=Math.abs(D(w,0,O?P[0]*S:w.length,S));if(O)for(var H=0,Q=P.length;H<Q;H++)j-=Math.abs(D(w,P[H]*S,H<Q-1?P[H+1]*S:w.length,S));var It=0;for(H=0;H<F.length;H+=3){var dt=F[H]*S,xt=F[H+1]*S,ht=F[H+2]*S;It+=Math.abs((w[dt]-w[ht])*(w[xt+1]-w[dt+1])-(w[dt]-w[xt])*(w[ht+1]-w[dt+1]))}return 0===j&&0===It?0:Math.abs((It-j)/j)},nt.flatten=function(w){for(var P=w[0][0].length,S={vertices:[],holes:[],dimensions:P},F=0,O=0;O<w.length;O++){for(var z=0;z<w[O].length;z++)for(var j=0;j<P;j++)S.vertices.push(w[O][z][j]);O>0&&S.holes.push(F+=w[O-1].length)}return S}},386:(vt,nt,Re)=>{var K;!function(ce,Qt,Ht,ee){"use strict";var wt,be=["","webkit","Moz","MS","ms","o"],$e=Qt.createElement("div"),Ie=Math.round,me=Math.abs,we=Date.now;function re(b,C,I){return setTimeout(Ji(b,I),C)}function xe(b,C,I){return!!Array.isArray(b)&&(ut(b,I[C],I),!0)}function ut(b,C,I){var N;if(b)if(b.forEach)b.forEach(C,I);else if(b.length!==ee)for(N=0;N<b.length;)C.call(I,b[N],N,b),N++;else for(N in b)b.hasOwnProperty(N)&&C.call(I,b[N],N,b)}function bt(b,C,I){var N="DEPRECATED METHOD: "+C+"\n"+I+" AT \n";return function(){var G=new Error("get-stack-trace"),ae=G&&G.stack?G.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Ke=ce.console&&(ce.console.warn||ce.console.log);return Ke&&Ke.call(ce.console,N,ae),b.apply(this,arguments)}}wt="function"!=typeof Object.assign?function(C){if(C===ee||null===C)throw new TypeError("Cannot convert undefined or null to object");for(var I=Object(C),N=1;N<arguments.length;N++){var G=arguments[N];if(G!==ee&&null!==G)for(var ae in G)G.hasOwnProperty(ae)&&(I[ae]=G[ae])}return I}:Object.assign;var cn=bt(function(C,I,N){for(var G=Object.keys(I),ae=0;ae<G.length;)(!N||N&&C[G[ae]]===ee)&&(C[G[ae]]=I[G[ae]]),ae++;return C},"extend","Use `assign`."),Qe=bt(function(C,I){return cn(C,I,!0)},"merge","Use `assign`.");function Gt(b,C,I){var G,N=C.prototype;(G=b.prototype=Object.create(N)).constructor=b,G._super=N,I&&wt(G,I)}function Ji(b,C){return function(){return b.apply(C,arguments)}}function yi(b,C){return"function"==typeof b?b.apply(C&&C[0]||ee,C):b}function Oi(b,C){return b===ee?C:b}function vi(b,C,I){ut(Rn(C),function(N){b.addEventListener(N,I,!1)})}function un(b,C,I){ut(Rn(C),function(N){b.removeEventListener(N,I,!1)})}function Ts(b,C){for(;b;){if(b==C)return!0;b=b.parentNode}return!1}function $n(b,C){return b.indexOf(C)>-1}function Rn(b){return b.trim().split(/\s+/g)}function oi(b,C,I){if(b.indexOf&&!I)return b.indexOf(C);for(var N=0;N<b.length;){if(I&&b[N][I]==C||!I&&b[N]===C)return N;N++}return-1}function x(b){return Array.prototype.slice.call(b,0)}function D(b,C,I){for(var N=[],G=[],ae=0;ae<b.length;){var Ke=C?b[ae][C]:b[ae];oi(G,Ke)<0&&N.push(b[ae]),G[ae]=Ke,ae++}return I&&(N=C?N.sort(function(Tt,Ge){return Tt[C]>Ge[C]}):N.sort()),N}function w(b,C){for(var I,N,G=C[0].toUpperCase()+C.slice(1),ae=0;ae<be.length;){if((N=(I=be[ae])?I+G:C)in b)return N;ae++}return ee}var P=1;function F(b){var C=b.ownerDocument||b;return C.defaultView||C.parentWindow||ce}var z="ontouchstart"in ce,j=w(ce,"PointerEvent")!==ee,H=z&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Q="touch",Et="mouse",Vg=["x","y"],tr=["clientX","clientY"];function bi(b,C){var I=this;this.manager=b,this.callback=C,this.element=b.element,this.target=b.options.inputTarget,this.domHandler=function(N){yi(b.options.enable,[b])&&I.handler(N)},this.init()}function zg(b,C,I){var N=I.pointers.length,G=I.changedPointers.length,ae=1&C&&N-G==0,Ke=12&C&&N-G==0;I.isFirst=!!ae,I.isFinal=!!Ke,ae&&(b.session={}),I.eventType=C,function QC(b,C){var I=b.session,N=C.pointers,G=N.length;I.firstInput||(I.firstInput=Ug(C)),G>1&&!I.firstMultiple?I.firstMultiple=Ug(C):1===G&&(I.firstMultiple=!1);var ae=I.firstInput,Ke=I.firstMultiple,Sn=Ke?Ke.center:ae.center,Tt=C.center=Hg(N);C.timeStamp=we(),C.deltaTime=C.timeStamp-ae.timeStamp,C.angle=Ya(Sn,Tt),C.distance=Jo(Sn,Tt),function jg(b,C){var I=C.center,N=b.offsetDelta||{},G=b.prevDelta||{},ae=b.prevInput||{};(1===C.eventType||4===ae.eventType)&&(G=b.prevDelta={x:ae.deltaX||0,y:ae.deltaY||0},N=b.offsetDelta={x:I.x,y:I.y}),C.deltaX=G.x+(I.x-N.x),C.deltaY=G.y+(I.y-N.y)}(I,C),C.offsetDirection=$a(C.deltaX,C.deltaY);var Ge=Gg(C.deltaTime,C.deltaX,C.deltaY);C.overallVelocityX=Ge.x,C.overallVelocityY=Ge.y,C.overallVelocity=me(Ge.x)>me(Ge.y)?Ge.x:Ge.y,C.scale=Ke?function vh(b,C){return Jo(C[0],C[1],tr)/Jo(b[0],b[1],tr)}(Ke.pointers,N):1,C.rotation=Ke?function yh(b,C){return Ya(C[1],C[0],tr)+Ya(b[1],b[0],tr)}(Ke.pointers,N):0,C.maxPointers=I.prevInput?C.pointers.length>I.prevInput.maxPointers?C.pointers.length:I.prevInput.maxPointers:C.pointers.length,function JC(b,C){var G,ae,Ke,Sn,I=b.lastInterval||C,N=C.timeStamp-I.timeStamp;if(8!=C.eventType&&(N>25||I.velocity===ee)){var Tt=C.deltaX-I.deltaX,Ge=C.deltaY-I.deltaY,Tr=Gg(N,Tt,Ge);ae=Tr.x,Ke=Tr.y,G=me(Tr.x)>me(Tr.y)?Tr.x:Tr.y,Sn=$a(Tt,Ge),b.lastInterval=C}else G=I.velocity,ae=I.velocityX,Ke=I.velocityY,Sn=I.direction;C.velocity=G,C.velocityX=ae,C.velocityY=Ke,C.direction=Sn}(I,C);var Tr=b.element;Ts(C.srcEvent.target,Tr)&&(Tr=C.srcEvent.target),C.target=Tr}(b,I),b.emit("hammer.input",I),b.recognize(I),b.session.prevInput=I}function Ug(b){for(var C=[],I=0;I<b.pointers.length;)C[I]={clientX:Ie(b.pointers[I].clientX),clientY:Ie(b.pointers[I].clientY)},I++;return{timeStamp:we(),pointers:C,center:Hg(C),deltaX:b.deltaX,deltaY:b.deltaY}}function Hg(b){var C=b.length;if(1===C)return{x:Ie(b[0].clientX),y:Ie(b[0].clientY)};for(var I=0,N=0,G=0;G<C;)I+=b[G].clientX,N+=b[G].clientY,G++;return{x:Ie(I/C),y:Ie(N/C)}}function Gg(b,C,I){return{x:C/b||0,y:I/b||0}}function $a(b,C){return b===C?1:me(b)>=me(C)?b<0?2:4:C<0?8:16}function Jo(b,C,I){I||(I=Vg);var N=C[I[0]]-b[I[0]],G=C[I[1]]-b[I[1]];return Math.sqrt(N*N+G*G)}function Ya(b,C,I){return I||(I=Vg),180*Math.atan2(C[I[1]]-b[I[1]],C[I[0]]-b[I[0]])/Math.PI}bi.prototype={handler:function(){},init:function(){this.evEl&&vi(this.element,this.evEl,this.domHandler),this.evTarget&&vi(this.target,this.evTarget,this.domHandler),this.evWin&&vi(F(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&un(this.element,this.evEl,this.domHandler),this.evTarget&&un(this.target,this.evTarget,this.domHandler),this.evWin&&un(F(this.element),this.evWin,this.domHandler)}};var Wg={mousedown:1,mousemove:2,mouseup:4},bh="mousedown",wh="mousemove mouseup";function ea(){this.evEl=bh,this.evWin=wh,this.pressed=!1,bi.apply(this,arguments)}Gt(ea,bi,{handler:function(C){var I=Wg[C.type];1&I&&0===C.button&&(this.pressed=!0),2&I&&1!==C.which&&(I=4),this.pressed&&(4&I&&(this.pressed=!1),this.callback(this.manager,I,{pointers:[C],changedPointers:[C],pointerType:Et,srcEvent:C}))}});var xh={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},ai={2:Q,3:"pen",4:Et,5:"kinect"},Ch="pointerdown",Eh="pointermove pointerup pointercancel";function Yc(){this.evEl=Ch,this.evWin=Eh,bi.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}ce.MSPointerEvent&&!ce.PointerEvent&&(Ch="MSPointerDown",Eh="MSPointerMove MSPointerUp MSPointerCancel"),Gt(Yc,bi,{handler:function(C){var I=this.store,N=!1,G=C.type.toLowerCase().replace("ms",""),ae=xh[G],Ke=ai[C.pointerType]||C.pointerType,Sn=Ke==Q,Tt=oi(I,C.pointerId,"pointerId");1&ae&&(0===C.button||Sn)?Tt<0&&(I.push(C),Tt=I.length-1):12&ae&&(N=!0),!(Tt<0)&&(I[Tt]=C,this.callback(this.manager,ae,{pointers:I,changedPointers:[C],pointerType:Ke,srcEvent:C}),N&&I.splice(Tt,1))}});var qg={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Mh="touchstart",$g="touchstart touchmove touchend touchcancel";function Th(){this.evTarget=Mh,this.evWin=$g,this.started=!1,bi.apply(this,arguments)}function wr(b,C){var I=x(b.touches),N=x(b.changedTouches);return 12&C&&(I=D(I.concat(N),"identifier",!0)),[I,N]}Gt(Th,bi,{handler:function(C){var I=qg[C.type];if(1===I&&(this.started=!0),this.started){var N=wr.call(this,C,I);12&I&&N[0].length-N[1].length==0&&(this.started=!1),this.callback(this.manager,I,{pointers:N[0],changedPointers:N[1],pointerType:Q,srcEvent:C})}}});var Yg={touchstart:1,touchmove:2,touchend:4,touchcancel:8},rn="touchstart touchmove touchend touchcancel";function Wr(){this.evTarget=rn,this.targetIds={},bi.apply(this,arguments)}function xr(b,C){var I=x(b.touches),N=this.targetIds;if(3&C&&1===I.length)return N[I[0].identifier]=!0,[I,I];var G,ae,Ke=x(b.changedTouches),Sn=[],Tt=this.target;if(ae=I.filter(function(Ge){return Ts(Ge.target,Tt)}),1===C)for(G=0;G<ae.length;)N[ae[G].identifier]=!0,G++;for(G=0;G<Ke.length;)N[Ke[G].identifier]&&Sn.push(Ke[G]),12&C&&delete N[Ke[G].identifier],G++;return Sn.length?[D(ae.concat(Sn),"identifier",!0),Sn]:void 0}function Za(){bi.apply(this,arguments);var b=Ji(this.handler,this);this.touch=new Wr(this.manager,b),this.mouse=new ea(this.manager,b),this.primaryTouch=null,this.lastTouches=[]}function Zc(b,C){1&b?(this.primaryTouch=C.changedPointers[0].identifier,Xc.call(this,C)):12&b&&Xc.call(this,C)}function Xc(b){var C=b.changedPointers[0];if(C.identifier===this.primaryTouch){var I={x:C.clientX,y:C.clientY};this.lastTouches.push(I);var N=this.lastTouches;setTimeout(function(){var ae=N.indexOf(I);ae>-1&&N.splice(ae,1)},2500)}}function ta(b){for(var C=b.srcEvent.clientX,I=b.srcEvent.clientY,N=0;N<this.lastTouches.length;N++){var G=this.lastTouches[N],ae=Math.abs(C-G.x),Ke=Math.abs(I-G.y);if(ae<=25&&Ke<=25)return!0}return!1}Gt(Wr,bi,{handler:function(C){var I=Yg[C.type],N=xr.call(this,C,I);!N||this.callback(this.manager,I,{pointers:N[0],changedPointers:N[1],pointerType:Q,srcEvent:C})}}),Gt(Za,bi,{handler:function(C,I,N){var ae=N.pointerType==Et;if(!(ae&&N.sourceCapabilities&&N.sourceCapabilities.firesTouchEvents)){if(N.pointerType==Q)Zc.call(this,I,N);else if(ae&&ta.call(this,N))return;this.callback(C,I,N)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ah=w($e.style,"touchAction"),Kc=Ah!==ee,Qc="compute",Jc="manipulation",Ds="none",na="pan-x",lo="pan-y",Xa=function Cr(){if(!Kc)return!1;var b={},C=ce.CSS&&ce.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(I){b[I]=!C||ce.CSS.supports("touch-action",I)}),b}();function eu(b,C){this.manager=b,this.set(C)}function Er(b){this.options=wt({},this.defaults,b||{}),this.id=function S(){return P++}(),this.manager=null,this.options.enable=Oi(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Je(b){return 16&b?"cancel":8&b?"end":4&b?"move":2&b?"start":""}function Be(b){return 16==b?"down":8==b?"up":2==b?"left":4==b?"right":""}function ia(b,C){var I=C.manager;return I?I.get(b):b}function nr(){Er.apply(this,arguments)}function Xe(){nr.apply(this,arguments),this.pX=null,this.pY=null}function ra(){nr.apply(this,arguments)}function Pe(){Er.apply(this,arguments),this._timer=null,this._input=null}function Tn(){nr.apply(this,arguments)}function tu(){nr.apply(this,arguments)}function nu(){Er.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function co(b,C){return(C=C||{}).recognizers=Oi(C.recognizers,co.defaults.preset),new Ih(b,C)}function Ih(b,C){this.options=wt({},co.defaults,C||{}),this.options.inputTarget=this.options.inputTarget||b,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=b,this.input=function KC(b){return new(b.options.inputClass||(j?Yc:H?Wr:z?Za:ea))(b,zg)}(this),this.touchAction=new eu(this,this.options.touchAction),Ph(this,!0),ut(this.options.recognizers,function(I){var N=this.add(new I[0](I[1]));I[2]&&N.recognizeWith(I[2]),I[3]&&N.requireFailure(I[3])},this)}function Ph(b,C){var N,I=b.element;I.style&&(ut(b.options.cssProps,function(G,ae){N=w(I.style,ae),C?(b.oldCssProps[N]=I.style[N],I.style[N]=G):I.style[N]=b.oldCssProps[N]||""}),C||(b.oldCssProps={}))}eu.prototype={set:function(b){b==Qc&&(b=this.compute()),Kc&&this.manager.element.style&&Xa[b]&&(this.manager.element.style[Ah]=b),this.actions=b.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var b=[];return ut(this.manager.recognizers,function(C){yi(C.options.enable,[C])&&(b=b.concat(C.getTouchAction()))}),function vn(b){if($n(b,Ds))return Ds;var C=$n(b,na),I=$n(b,lo);return C&&I?Ds:C||I?C?na:lo:$n(b,Jc)?Jc:"auto"}(b.join(" "))},preventDefaults:function(b){var C=b.srcEvent,I=b.offsetDirection;if(!this.manager.session.prevented){var N=this.actions,G=$n(N,Ds)&&!Xa[Ds],ae=$n(N,lo)&&!Xa[lo],Ke=$n(N,na)&&!Xa[na];if(G&&1===b.pointers.length&&b.distance<2&&b.deltaTime<250)return;return Ke&&ae||!(G||ae&&6&I||Ke&&24&I)?void 0:this.preventSrc(C)}C.preventDefault()},preventSrc:function(b){this.manager.session.prevented=!0,b.preventDefault()}},Er.prototype={defaults:{},set:function(b){return wt(this.options,b),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(b){if(xe(b,"recognizeWith",this))return this;var C=this.simultaneous;return C[(b=ia(b,this)).id]||(C[b.id]=b,b.recognizeWith(this)),this},dropRecognizeWith:function(b){return xe(b,"dropRecognizeWith",this)||(b=ia(b,this),delete this.simultaneous[b.id]),this},requireFailure:function(b){if(xe(b,"requireFailure",this))return this;var C=this.requireFail;return-1===oi(C,b=ia(b,this))&&(C.push(b),b.requireFailure(this)),this},dropRequireFailure:function(b){if(xe(b,"dropRequireFailure",this))return this;b=ia(b,this);var C=oi(this.requireFail,b);return C>-1&&this.requireFail.splice(C,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(b){return!!this.simultaneous[b.id]},emit:function(b){var C=this,I=this.state;function N(G){C.manager.emit(G,b)}I<8&&N(C.options.event+Je(I)),N(C.options.event),b.additionalEvent&&N(b.additionalEvent),I>=8&&N(C.options.event+Je(I))},tryEmit:function(b){if(this.canEmit())return this.emit(b);this.state=32},canEmit:function(){for(var b=0;b<this.requireFail.length;){if(!(33&this.requireFail[b].state))return!1;b++}return!0},recognize:function(b){var C=wt({},b);if(!yi(this.options.enable,[this,C]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(C),30&this.state&&this.tryEmit(C)},process:function(b){},getTouchAction:function(){},reset:function(){}},Gt(nr,Er,{defaults:{pointers:1},attrTest:function(b){var C=this.options.pointers;return 0===C||b.pointers.length===C},process:function(b){var C=this.state,I=b.eventType,N=6&C,G=this.attrTest(b);return N&&(8&I||!G)?16|C:N||G?4&I?8|C:2&C?4|C:2:32}}),Gt(Xe,nr,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var b=this.options.direction,C=[];return 6&b&&C.push(lo),24&b&&C.push(na),C},directionTest:function(b){var C=this.options,I=!0,N=b.distance,G=b.direction,ae=b.deltaX,Ke=b.deltaY;return G&C.direction||(6&C.direction?(G=0===ae?1:ae<0?2:4,I=ae!=this.pX,N=Math.abs(b.deltaX)):(G=0===Ke?1:Ke<0?8:16,I=Ke!=this.pY,N=Math.abs(b.deltaY))),b.direction=G,I&&N>C.threshold&&G&C.direction},attrTest:function(b){return nr.prototype.attrTest.call(this,b)&&(2&this.state||!(2&this.state)&&this.directionTest(b))},emit:function(b){this.pX=b.deltaX,this.pY=b.deltaY;var C=Be(b.direction);C&&(b.additionalEvent=this.options.event+C),this._super.emit.call(this,b)}}),Gt(ra,nr,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ds]},attrTest:function(b){return this._super.attrTest.call(this,b)&&(Math.abs(b.scale-1)>this.options.threshold||2&this.state)},emit:function(b){1!==b.scale&&(b.additionalEvent=this.options.event+(b.scale<1?"in":"out")),this._super.emit.call(this,b)}}),Gt(Pe,Er,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(b){var C=this.options,I=b.pointers.length===C.pointers,N=b.distance<C.threshold,G=b.deltaTime>C.time;if(this._input=b,!N||!I||12&b.eventType&&!G)this.reset();else if(1&b.eventType)this.reset(),this._timer=re(function(){this.state=8,this.tryEmit()},C.time,this);else if(4&b.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(b){8===this.state&&(b&&4&b.eventType?this.manager.emit(this.options.event+"up",b):(this._input.timeStamp=we(),this.manager.emit(this.options.event,this._input)))}}),Gt(Tn,nr,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ds]},attrTest:function(b){return this._super.attrTest.call(this,b)&&(Math.abs(b.rotation)>this.options.threshold||2&this.state)}}),Gt(tu,nr,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Xe.prototype.getTouchAction.call(this)},attrTest:function(b){var I,C=this.options.direction;return 30&C?I=b.overallVelocity:6&C?I=b.overallVelocityX:24&C&&(I=b.overallVelocityY),this._super.attrTest.call(this,b)&&C&b.offsetDirection&&b.distance>this.options.threshold&&b.maxPointers==this.options.pointers&&me(I)>this.options.velocity&&4&b.eventType},emit:function(b){var C=Be(b.offsetDirection);C&&this.manager.emit(this.options.event+C,b),this.manager.emit(this.options.event,b)}}),Gt(nu,Er,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Jc]},process:function(b){var C=this.options,I=b.pointers.length===C.pointers,N=b.distance<C.threshold,G=b.deltaTime<C.time;if(this.reset(),1&b.eventType&&0===this.count)return this.failTimeout();if(N&&G&&I){if(4!=b.eventType)return this.failTimeout();var ae=!this.pTime||b.timeStamp-this.pTime<C.interval,Ke=!this.pCenter||Jo(this.pCenter,b.center)<C.posThreshold;if(this.pTime=b.timeStamp,this.pCenter=b.center,Ke&&ae?this.count+=1:this.count=1,this._input=b,0==this.count%C.taps)return this.hasRequireFailures()?(this._timer=re(function(){this.state=8,this.tryEmit()},C.interval,this),2):8}return 32},failTimeout:function(){return this._timer=re(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),co.VERSION="2.0.7",co.defaults={domEvents:!1,touchAction:Qc,enable:!0,inputTarget:null,inputClass:null,preset:[[Tn,{enable:!1}],[ra,{enable:!1},["rotate"]],[tu,{direction:6}],[Xe,{direction:6},["swipe"]],[nu],[nu,{event:"doubletap",taps:2},["tap"]],[Pe]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ih.prototype={set:function(b){return wt(this.options,b),b.touchAction&&this.touchAction.update(),b.inputTarget&&(this.input.destroy(),this.input.target=b.inputTarget,this.input.init()),this},stop:function(b){this.session.stopped=b?2:1},recognize:function(b){var C=this.session;if(!C.stopped){this.touchAction.preventDefaults(b);var I,N=this.recognizers,G=C.curRecognizer;(!G||G&&8&G.state)&&(G=C.curRecognizer=null);for(var ae=0;ae<N.length;)I=N[ae],2===C.stopped||G&&I!=G&&!I.canRecognizeWith(G)?I.reset():I.recognize(b),!G&&14&I.state&&(G=C.curRecognizer=I),ae++}},get:function(b){if(b instanceof Er)return b;for(var C=this.recognizers,I=0;I<C.length;I++)if(C[I].options.event==b)return C[I];return null},add:function(b){if(xe(b,"add",this))return this;var C=this.get(b.options.event);return C&&this.remove(C),this.recognizers.push(b),b.manager=this,this.touchAction.update(),b},remove:function(b){if(xe(b,"remove",this))return this;if(b=this.get(b)){var C=this.recognizers,I=oi(C,b);-1!==I&&(C.splice(I,1),this.touchAction.update())}return this},on:function(b,C){if(b!==ee&&C!==ee){var I=this.handlers;return ut(Rn(b),function(N){I[N]=I[N]||[],I[N].push(C)}),this}},off:function(b,C){if(b!==ee){var I=this.handlers;return ut(Rn(b),function(N){C?I[N]&&I[N].splice(oi(I[N],C),1):delete I[N]}),this}},emit:function(b,C){this.options.domEvents&&function tE(b,C){var I=Qt.createEvent("Event");I.initEvent(b,!0,!0),I.gesture=C,C.target.dispatchEvent(I)}(b,C);var I=this.handlers[b]&&this.handlers[b].slice();if(I&&I.length){C.type=b,C.preventDefault=function(){C.srcEvent.preventDefault()};for(var N=0;N<I.length;)I[N](C),N++}},destroy:function(){this.element&&Ph(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},wt(co,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ih,Input:bi,TouchAction:eu,TouchInput:Wr,MouseInput:ea,PointerEventInput:Yc,TouchMouseInput:Za,SingleTouchInput:Th,Recognizer:Er,AttrRecognizer:nr,Tap:nu,Pan:Xe,Swipe:tu,Pinch:ra,Rotate:Tn,Press:Pe,on:vi,off:un,each:ut,merge:Qe,extend:cn,assign:wt,inherit:Gt,bindFn:Ji,prefixed:w}),(void 0!==ce?ce:"undefined"!=typeof self?self:{}).Hammer=co,(K=function(){return co}.call(nt,Re,nt,vt))!==ee&&(vt.exports=K)}(window,document)},461:(vt,nt)=>{nt.read=function(Re,K,ce,Qt,Ht){var ee,be,$e=8*Ht-Qt-1,Ue=(1<<$e)-1,Ie=Ue>>1,me=-7,we=ce?Ht-1:0,re=ce?-1:1,xe=Re[K+we];for(we+=re,ee=xe&(1<<-me)-1,xe>>=-me,me+=$e;me>0;ee=256*ee+Re[K+we],we+=re,me-=8);for(be=ee&(1<<-me)-1,ee>>=-me,me+=Qt;me>0;be=256*be+Re[K+we],we+=re,me-=8);if(0===ee)ee=1-Ie;else{if(ee===Ue)return be?NaN:1/0*(xe?-1:1);be+=Math.pow(2,Qt),ee-=Ie}return(xe?-1:1)*be*Math.pow(2,ee-Qt)},nt.write=function(Re,K,ce,Qt,Ht,ee){var be,$e,Ue,Ie=8*ee-Ht-1,me=(1<<Ie)-1,we=me>>1,re=23===Ht?Math.pow(2,-24)-Math.pow(2,-77):0,xe=Qt?0:ee-1,ut=Qt?1:-1,bt=K<0||0===K&&1/K<0?1:0;for(K=Math.abs(K),isNaN(K)||K===1/0?($e=isNaN(K)?1:0,be=me):(be=Math.floor(Math.log(K)/Math.LN2),K*(Ue=Math.pow(2,-be))<1&&(be--,Ue*=2),(K+=be+we>=1?re/Ue:re*Math.pow(2,1-we))*Ue>=2&&(be++,Ue/=2),be+we>=me?($e=0,be=me):be+we>=1?($e=(K*Ue-1)*Math.pow(2,Ht),be+=we):($e=K*Math.pow(2,we-1)*Math.pow(2,Ht),be=0));Ht>=8;Re[ce+xe]=255&$e,xe+=ut,$e/=256,Ht-=8);for(be=be<<Ht|$e,Ie+=Ht;Ie>0;Re[ce+xe]=255&be,xe+=ut,be/=256,Ie-=8);Re[ce+xe-ut]|=128*bt}},808:(vt,nt,Re)=>{"use strict";vt.exports=ce;var K=Re(461);function ce(x){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(x)?x:new Uint8Array(x||0),this.pos=0,this.type=0,this.length=this.buf.length}ce.Varint=0,ce.Fixed64=1,ce.Bytes=2,ce.Fixed32=5;var Qt=4294967296,Ht=1/Qt,be="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Ue(x){return x.type===ce.Bytes?x.readVarint()+x.pos:x.pos+1}function xe(x,D,w){var P=D<=16383?1:D<=2097151?2:D<=268435455?3:Math.floor(Math.log(D)/(7*Math.LN2));w.realloc(P);for(var S=w.pos-1;S>=x;S--)w.buf[S+P]=w.buf[S]}function ut(x,D){for(var w=0;w<x.length;w++)D.writeVarint(x[w])}function bt(x,D){for(var w=0;w<x.length;w++)D.writeSVarint(x[w])}function wt(x,D){for(var w=0;w<x.length;w++)D.writeFloat(x[w])}function cn(x,D){for(var w=0;w<x.length;w++)D.writeDouble(x[w])}function Qe(x,D){for(var w=0;w<x.length;w++)D.writeBoolean(x[w])}function Gt(x,D){for(var w=0;w<x.length;w++)D.writeFixed32(x[w])}function Ji(x,D){for(var w=0;w<x.length;w++)D.writeSFixed32(x[w])}function yi(x,D){for(var w=0;w<x.length;w++)D.writeFixed64(x[w])}function Oi(x,D){for(var w=0;w<x.length;w++)D.writeSFixed64(x[w])}function vi(x,D){return(x[D]|x[D+1]<<8|x[D+2]<<16)+16777216*x[D+3]}function un(x,D,w){x[w]=D,x[w+1]=D>>>8,x[w+2]=D>>>16,x[w+3]=D>>>24}function Ts(x,D){return(x[D]|x[D+1]<<8|x[D+2]<<16)+(x[D+3]<<24)}ce.prototype={destroy:function(){this.buf=null},readFields:function(x,D,w){for(w=w||this.length;this.pos<w;){var P=this.readVarint(),S=P>>3,F=this.pos;this.type=7&P,x(S,D,this),this.pos===F&&this.skip(P)}return D},readMessage:function(x,D){return this.readFields(x,D,this.readVarint()+this.pos)},readFixed32:function(){var x=vi(this.buf,this.pos);return this.pos+=4,x},readSFixed32:function(){var x=Ts(this.buf,this.pos);return this.pos+=4,x},readFixed64:function(){var x=vi(this.buf,this.pos)+vi(this.buf,this.pos+4)*Qt;return this.pos+=8,x},readSFixed64:function(){var x=vi(this.buf,this.pos)+Ts(this.buf,this.pos+4)*Qt;return this.pos+=8,x},readFloat:function(){var x=K.read(this.buf,this.pos,!0,23,4);return this.pos+=4,x},readDouble:function(){var x=K.read(this.buf,this.pos,!0,52,8);return this.pos+=8,x},readVarint:function(x){var w,P,D=this.buf;return w=127&(P=D[this.pos++]),P<128||(w|=(127&(P=D[this.pos++]))<<7,P<128)||(w|=(127&(P=D[this.pos++]))<<14,P<128)||(w|=(127&(P=D[this.pos++]))<<21,P<128)?w:function $e(x,D,w){var S,F,P=w.buf;if(S=(112&(F=P[w.pos++]))>>4,F<128||(S|=(127&(F=P[w.pos++]))<<3,F<128)||(S|=(127&(F=P[w.pos++]))<<10,F<128)||(S|=(127&(F=P[w.pos++]))<<17,F<128)||(S|=(127&(F=P[w.pos++]))<<24,F<128)||(S|=(1&(F=P[w.pos++]))<<31,F<128))return function Ie(x,D,w){return w?4294967296*D+(x>>>0):4294967296*(D>>>0)+(x>>>0)}(x,S,D);throw new Error("Expected varint not more than 10 bytes")}(w|=(15&(P=D[this.pos]))<<28,x,this)},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var x=this.readVarint();return x%2==1?(x+1)/-2:x/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var x=this.readVarint()+this.pos,D=this.pos;return this.pos=x,x-D>=12&&be?function Rn(x,D,w){return be.decode(x.subarray(D,w))}(this.buf,D,x):function $n(x,D,w){for(var P="",S=D;S<w;){var j,H,Q,F=x[S],O=null,z=F>239?4:F>223?3:F>191?2:1;if(S+z>w)break;1===z?F<128&&(O=F):2===z?128==(192&(j=x[S+1]))&&(O=(31&F)<<6|63&j)<=127&&(O=null):3===z?(H=x[S+2],128==(192&(j=x[S+1]))&&128==(192&H)&&((O=(15&F)<<12|(63&j)<<6|63&H)<=2047||O>=55296&&O<=57343)&&(O=null)):4===z&&(H=x[S+2],Q=x[S+3],128==(192&(j=x[S+1]))&&128==(192&H)&&128==(192&Q)&&((O=(15&F)<<18|(63&j)<<12|(63&H)<<6|63&Q)<=65535||O>=1114112)&&(O=null)),null===O?(O=65533,z=1):O>65535&&(O-=65536,P+=String.fromCharCode(O>>>10&1023|55296),O=56320|1023&O),P+=String.fromCharCode(O),S+=z}return P}(this.buf,D,x)},readBytes:function(){var x=this.readVarint()+this.pos,D=this.buf.subarray(this.pos,x);return this.pos=x,D},readPackedVarint:function(x,D){if(this.type!==ce.Bytes)return x.push(this.readVarint(D));var w=Ue(this);for(x=x||[];this.pos<w;)x.push(this.readVarint(D));return x},readPackedSVarint:function(x){if(this.type!==ce.Bytes)return x.push(this.readSVarint());var D=Ue(this);for(x=x||[];this.pos<D;)x.push(this.readSVarint());return x},readPackedBoolean:function(x){if(this.type!==ce.Bytes)return x.push(this.readBoolean());var D=Ue(this);for(x=x||[];this.pos<D;)x.push(this.readBoolean());return x},readPackedFloat:function(x){if(this.type!==ce.Bytes)return x.push(this.readFloat());var D=Ue(this);for(x=x||[];this.pos<D;)x.push(this.readFloat());return x},readPackedDouble:function(x){if(this.type!==ce.Bytes)return x.push(this.readDouble());var D=Ue(this);for(x=x||[];this.pos<D;)x.push(this.readDouble());return x},readPackedFixed32:function(x){if(this.type!==ce.Bytes)return x.push(this.readFixed32());var D=Ue(this);for(x=x||[];this.pos<D;)x.push(this.readFixed32());return x},readPackedSFixed32:function(x){if(this.type!==ce.Bytes)return x.push(this.readSFixed32());var D=Ue(this);for(x=x||[];this.pos<D;)x.push(this.readSFixed32());return x},readPackedFixed64:function(x){if(this.type!==ce.Bytes)return x.push(this.readFixed64());var D=Ue(this);for(x=x||[];this.pos<D;)x.push(this.readFixed64());return x},readPackedSFixed64:function(x){if(this.type!==ce.Bytes)return x.push(this.readSFixed64());var D=Ue(this);for(x=x||[];this.pos<D;)x.push(this.readSFixed64());return x},skip:function(x){var D=7&x;if(D===ce.Varint)for(;this.buf[this.pos++]>127;);else if(D===ce.Bytes)this.pos=this.readVarint()+this.pos;else if(D===ce.Fixed32)this.pos+=4;else{if(D!==ce.Fixed64)throw new Error("Unimplemented type: "+D);this.pos+=8}},writeTag:function(x,D){this.writeVarint(x<<3|D)},realloc:function(x){for(var D=this.length||16;D<this.pos+x;)D*=2;if(D!==this.length){var w=new Uint8Array(D);w.set(this.buf),this.buf=w,this.length=D}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(x){this.realloc(4),un(this.buf,x,this.pos),this.pos+=4},writeSFixed32:function(x){this.realloc(4),un(this.buf,x,this.pos),this.pos+=4},writeFixed64:function(x){this.realloc(8),un(this.buf,-1&x,this.pos),un(this.buf,Math.floor(x*Ht),this.pos+4),this.pos+=8},writeSFixed64:function(x){this.realloc(8),un(this.buf,-1&x,this.pos),un(this.buf,Math.floor(x*Ht),this.pos+4),this.pos+=8},writeVarint:function(x){(x=+x||0)>268435455||x<0?function me(x,D){var w,P;if(x>=0?(w=x%4294967296|0,P=x/4294967296|0):(P=~(-x/4294967296),4294967295^(w=~(-x%4294967296))?w=w+1|0:(w=0,P=P+1|0)),x>=0x10000000000000000||x<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");D.realloc(10),function we(x,D,w){w.buf[w.pos++]=127&x|128,x>>>=7,w.buf[w.pos++]=127&x|128,x>>>=7,w.buf[w.pos++]=127&x|128,x>>>=7,w.buf[w.pos++]=127&x|128,w.buf[w.pos]=127&(x>>>=7)}(w,0,D),function re(x,D){var w=(7&x)<<4;D.buf[D.pos++]|=w|((x>>>=3)?128:0),x&&(D.buf[D.pos++]=127&x|((x>>>=7)?128:0),x&&(D.buf[D.pos++]=127&x|((x>>>=7)?128:0),x&&(D.buf[D.pos++]=127&x|((x>>>=7)?128:0),x&&(D.buf[D.pos++]=127&x|((x>>>=7)?128:0),x&&(D.buf[D.pos++]=127&x)))))}(P,D)}(x,this):(this.realloc(4),this.buf[this.pos++]=127&x|(x>127?128:0),!(x<=127)&&(this.buf[this.pos++]=127&(x>>>=7)|(x>127?128:0),!(x<=127)&&(this.buf[this.pos++]=127&(x>>>=7)|(x>127?128:0),!(x<=127)&&(this.buf[this.pos++]=x>>>7&127))))},writeSVarint:function(x){this.writeVarint(x<0?2*-x-1:2*x)},writeBoolean:function(x){this.writeVarint(Boolean(x))},writeString:function(x){x=String(x),this.realloc(4*x.length),this.pos++;var D=this.pos;this.pos=function oi(x,D,w){for(var S,F,P=0;P<D.length;P++){if((S=D.charCodeAt(P))>55295&&S<57344){if(!F){S>56319||P+1===D.length?(x[w++]=239,x[w++]=191,x[w++]=189):F=S;continue}if(S<56320){x[w++]=239,x[w++]=191,x[w++]=189,F=S;continue}S=F-55296<<10|S-56320|65536,F=null}else F&&(x[w++]=239,x[w++]=191,x[w++]=189,F=null);S<128?x[w++]=S:(S<2048?x[w++]=S>>6|192:(S<65536?x[w++]=S>>12|224:(x[w++]=S>>18|240,x[w++]=S>>12&63|128),x[w++]=S>>6&63|128),x[w++]=63&S|128)}return w}(this.buf,x,this.pos);var w=this.pos-D;w>=128&&xe(D,w,this),this.pos=D-1,this.writeVarint(w),this.pos+=w},writeFloat:function(x){this.realloc(4),K.write(this.buf,x,this.pos,!0,23,4),this.pos+=4},writeDouble:function(x){this.realloc(8),K.write(this.buf,x,this.pos,!0,52,8),this.pos+=8},writeBytes:function(x){var D=x.length;this.writeVarint(D),this.realloc(D);for(var w=0;w<D;w++)this.buf[this.pos++]=x[w]},writeRawMessage:function(x,D){this.pos++;var w=this.pos;x(D,this);var P=this.pos-w;P>=128&&xe(w,P,this),this.pos=w-1,this.writeVarint(P),this.pos+=P},writeMessage:function(x,D,w){this.writeTag(x,ce.Bytes),this.writeRawMessage(D,w)},writePackedVarint:function(x,D){D.length&&this.writeMessage(x,ut,D)},writePackedSVarint:function(x,D){D.length&&this.writeMessage(x,bt,D)},writePackedBoolean:function(x,D){D.length&&this.writeMessage(x,Qe,D)},writePackedFloat:function(x,D){D.length&&this.writeMessage(x,wt,D)},writePackedDouble:function(x,D){D.length&&this.writeMessage(x,cn,D)},writePackedFixed32:function(x,D){D.length&&this.writeMessage(x,Gt,D)},writePackedSFixed32:function(x,D){D.length&&this.writeMessage(x,Ji,D)},writePackedFixed64:function(x,D){D.length&&this.writeMessage(x,yi,D)},writePackedSFixed64:function(x,D){D.length&&this.writeMessage(x,Oi,D)},writeBytesField:function(x,D){this.writeTag(x,ce.Bytes),this.writeBytes(D)},writeFixed32Field:function(x,D){this.writeTag(x,ce.Fixed32),this.writeFixed32(D)},writeSFixed32Field:function(x,D){this.writeTag(x,ce.Fixed32),this.writeSFixed32(D)},writeFixed64Field:function(x,D){this.writeTag(x,ce.Fixed64),this.writeFixed64(D)},writeSFixed64Field:function(x,D){this.writeTag(x,ce.Fixed64),this.writeSFixed64(D)},writeVarintField:function(x,D){this.writeTag(x,ce.Varint),this.writeVarint(D)},writeSVarintField:function(x,D){this.writeTag(x,ce.Varint),this.writeSVarint(D)},writeStringField:function(x,D){this.writeTag(x,ce.Bytes),this.writeString(D)},writeFloatField:function(x,D){this.writeTag(x,ce.Fixed32),this.writeFloat(D)},writeDoubleField:function(x,D){this.writeTag(x,ce.Fixed64),this.writeDouble(D)},writeBooleanField:function(x,D){this.writeVarintField(x,Boolean(D))}}},521:()=>{},249:()=>{}},vt=>{vt(vt.s=105)}]);